!_TAG_FILE_SORTED	1	/0=unsorted, 1=sorted, 2=foldcase/
!_TAG_FILE_FORMAT	2	/extended format; --format=1 will not append ;" to lines/
!_TAG_PROGRAM_VERSION	5.9~svn20110310	//
!_TAG_PROGRAM_AUTHOR	Darren Hiebert	/dhiebert@users.sourceforge.net/
!_TAG_PROGRAM_NAME	Exuberant Ctags	//
ACLOCAL	Makefile	/^ACLOCAL = \/home\/liping\/wifidog-master\/config\/missing aclocal-1.4$/;"	m
ACLOCAL_M4	Makefile	/^ACLOCAL_M4 = $(top_srcdir)\/aclocal.m4$/;"	m
AR	Makefile	/^AR = ar$/;"	m
AS	Makefile	/^AS = @AS@$/;"	m
AUTOCONF	Makefile	/^AUTOCONF = autoconf$/;"	m
AUTOHEADER	Makefile	/^AUTOHEADER = autoheader$/;"	m
AUTOMAKE	Makefile	/^AUTOMAKE = \/home\/liping\/wifidog-master\/config\/missing automake-1.4$/;"	m
BUILDROOT	Makefile	/^BUILDROOT = $/;"	m
CC	Makefile	/^CC = gcc$/;"	m
CONFIG_CLEAN_FILES	Makefile	/^CONFIG_CLEAN_FILES =  wifidog.spec wifidog-msg.html$/;"	m
CONFIG_HEADER	Makefile	/^CONFIG_HEADER = config.h$/;"	m
CXX	Makefile	/^CXX = g++$/;"	m
CXXCPP	Makefile	/^CXXCPP = g++ -E$/;"	m
DATA	Makefile	/^DATA =  $(doc_DATA)$/;"	m
DESTDIR	Makefile	/^DESTDIR =$/;"	m
DISTFILES	Makefile	/^DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)$/;"	m
DIST_COMMON	Makefile	/^DIST_COMMON =  README .\/stamp-h.in AUTHORS COPYING ChangeLog INSTALL \\$/;"	m
DLLTOOL	Makefile	/^DLLTOOL = @DLLTOOL@$/;"	m
DOT	Makefile	/^DOT = $/;"	m
DOXYGEN	Makefile	/^DOXYGEN = $/;"	m
DSYMUTIL	Makefile	/^DSYMUTIL = $/;"	m
ECHO	Makefile	/^ECHO = echo$/;"	m
EGREP	Makefile	/^EGREP = \/bin\/grep -E$/;"	m
EXEEXT	Makefile	/^EXEEXT = $/;"	m
EXTRA_DIST	Makefile	/^EXTRA_DIST =    FAQ   wifidog.spec.in   wifidog.spec   config   scripts   contrib   wifidog.conf$/;"	m
F77	Makefile	/^F77 = $/;"	m
GCJ	Makefile	/^GCJ = @GCJ@$/;"	m
GCJFLAGS	Makefile	/^GCJFLAGS = @GCJFLAGS@$/;"	m
GZIP_ENV	Makefile	/^GZIP_ENV = --best$/;"	m
HAVE_LIB	Makefile	/^HAVE_LIB = @HAVE_LIB@$/;"	m
INSTALL	Makefile	/^INSTALL = \/usr\/bin\/install -c$/;"	m
INSTALL_DATA	Makefile	/^INSTALL_DATA = ${INSTALL} -m 644$/;"	m
INSTALL_PROGRAM	Makefile	/^INSTALL_PROGRAM = ${INSTALL} $(AM_INSTALL_PROGRAM_FLAGS)$/;"	m
INSTALL_SCRIPT	Makefile	/^INSTALL_SCRIPT = ${INSTALL}$/;"	m
LIB	Makefile	/^LIB = @LIB@$/;"	m
LIBTOOL	Makefile	/^LIBTOOL = $(SHELL) $(top_builddir)\/libtool$/;"	m
LN_S	Makefile	/^LN_S = ln -s$/;"	m
LTLIB	Makefile	/^LTLIB = @LTLIB@$/;"	m
MAINT	Makefile	/^MAINT = #$/;"	m
MAKEINFO	Makefile	/^MAKEINFO = \/home\/liping\/wifidog-master\/config\/missing makeinfo$/;"	m
NMEDIT	Makefile	/^NMEDIT = $/;"	m
NORMAL_INSTALL	Makefile	/^NORMAL_INSTALL = :$/;"	m
NORMAL_UNINSTALL	Makefile	/^NORMAL_UNINSTALL = :$/;"	m
OBJDUMP	Makefile	/^OBJDUMP = @OBJDUMP@$/;"	m
OBJEXT	Makefile	/^OBJEXT = o$/;"	m
PACKAGE	Makefile	/^PACKAGE = wifidog$/;"	m
POST_INSTALL	Makefile	/^POST_INSTALL = :$/;"	m
POST_UNINSTALL	Makefile	/^POST_UNINSTALL = :$/;"	m
PRE_INSTALL	Makefile	/^PRE_INSTALL = :$/;"	m
PRE_UNINSTALL	Makefile	/^PRE_UNINSTALL = :$/;"	m
RANLIB	Makefile	/^RANLIB = ranlib$/;"	m
RC	Makefile	/^RC = @RC@$/;"	m
SED	Makefile	/^SED = \/bin\/sed$/;"	m
SHELL	Makefile	/^SHELL = \/bin\/bash$/;"	m
STRIP	Makefile	/^STRIP = strip$/;"	m
SUBDIRS	Makefile	/^SUBDIRS = libhttpd src . doc $/;"	m
TAR	Makefile	/^TAR = tar$/;"	m
VERSION	Makefile	/^VERSION = 20090925$/;"	m
WIFIDOG_MAJOR_VERSION	Makefile	/^WIFIDOG_MAJOR_VERSION = 1$/;"	m
WIFIDOG_MICRO_VERSION	Makefile	/^WIFIDOG_MICRO_VERSION = 5$/;"	m
WIFIDOG_MINOR_VERSION	Makefile	/^WIFIDOG_MINOR_VERSION = 1$/;"	m
WIFIDOG_VERSION	Makefile	/^WIFIDOG_VERSION = 20090925$/;"	m
bindir	Makefile	/^bindir = ${exec_prefix}\/bin$/;"	m
datadir	Makefile	/^datadir = ${prefix}\/share$/;"	m
dc_install_base	Makefile	/^	dc_install_base=`cd $(distdir)\/=inst && pwd`; \\$/;"	m
distdir	Makefile	/^distdir = $(PACKAGE)-$(VERSION)$/;"	m
doc_DATA	Makefile	/^doc_DATA =    AUTHORS   COPYING   INSTALL   NEWS   README   ChangeLog$/;"	m
docdir	Makefile	/^docdir = ${prefix}\/share\/doc\/wifidog-20090925$/;"	m
enable_dot	Makefile	/^enable_dot = no$/;"	m
enable_html_docs	Makefile	/^enable_html_docs = yes$/;"	m
enable_latex_docs	Makefile	/^enable_latex_docs = no$/;"	m
exec_prefix	Makefile	/^exec_prefix = ${prefix}$/;"	m
host_alias	Makefile	/^host_alias = $/;"	m
host_triplet	Makefile	/^host_triplet = i686-pc-linux-gnu$/;"	m
includedir	Makefile	/^includedir = ${prefix}\/include$/;"	m
infodir	Makefile	/^infodir = ${prefix}\/share\/info$/;"	m
libdir	Makefile	/^libdir = ${exec_prefix}\/lib$/;"	m
libexecdir	Makefile	/^libexecdir = ${exec_prefix}\/libexec$/;"	m
list	Makefile	/^	list='$(doc_DATA)'; for p in $$list; do \\$/;"	m
localstatedir	Makefile	/^localstatedir = ${prefix}\/var$/;"	m
mandir	Makefile	/^mandir = ${prefix}\/share\/man$/;"	m
mkinstalldirs	Makefile	/^mkinstalldirs = $(SHELL) $(top_srcdir)\/config\/mkinstalldirs$/;"	m
oldincludedir	Makefile	/^oldincludedir = \/usr\/include$/;"	m
pkgdatadir	Makefile	/^pkgdatadir = $(datadir)\/wifidog$/;"	m
pkgincludedir	Makefile	/^pkgincludedir = $(includedir)\/wifidog$/;"	m
pkglibdir	Makefile	/^pkglibdir = $(libdir)\/wifidog$/;"	m
prefix	Makefile	/^prefix = \/home\/liping\/wifidog-master\/install$/;"	m
sbindir	Makefile	/^sbindir = ${exec_prefix}\/sbin$/;"	m
sharedstatedir	Makefile	/^sharedstatedir = ${prefix}\/com$/;"	m
srcdir	Makefile	/^srcdir = .$/;"	m
sysconfdir	Makefile	/^sysconfdir = ${prefix}\/etc$/;"	m
top_builddir	Makefile	/^top_builddir = .$/;"	m
top_distdir	Makefile	/^top_distdir = $(distdir)$/;"	m
top_srcdir	Makefile	/^top_srcdir = .$/;"	m
transform	Makefile	/^transform = s,x,x,$/;"	m
HAVE_DLFCN_H	config.h	5;"	d
HAVE_INTTYPES_H	config.h	8;"	d
HAVE_LIBNSL	config.h	11;"	d
HAVE_LIBPTHREAD	config.h	14;"	d
HAVE_MEMORY_H	config.h	20;"	d
HAVE_STDARG_H	config.h	23;"	d
HAVE_STDINT_H	config.h	26;"	d
HAVE_STDLIB_H	config.h	29;"	d
HAVE_STRINGS_H	config.h	32;"	d
HAVE_STRING_H	config.h	35;"	d
HAVE_SYS_STAT_H	config.h	38;"	d
HAVE_SYS_TYPES_H	config.h	41;"	d
HAVE_UNISTD_H	config.h	44;"	d
PACKAGE	config.h	47;"	d
PACKAGE_BUGREPORT	config.h	50;"	d
PACKAGE_NAME	config.h	53;"	d
PACKAGE_STRING	config.h	56;"	d
PACKAGE_TARNAME	config.h	59;"	d
PACKAGE_VERSION	config.h	62;"	d
STDC_HEADERS	config.h	65;"	d
VERSION	config.h	68;"	d
main	config/config.guess	/^		main()$/;"	f
main	config/config.guess	/^	main ()$/;"	f
main	config/config.guess	/^main ()$/;"	f
func_extract_an_archive	config/ltmain.sh	/^func_extract_an_archive ()$/;"	f
func_extract_archives	config/ltmain.sh	/^func_extract_archives ()$/;"	f
func_infer_tag	config/ltmain.sh	/^func_infer_tag ()$/;"	f
func_mktempdir	config/ltmain.sh	/^func_mktempdir ()$/;"	f
func_win32_libid	config/ltmain.sh	/^func_win32_libid ()$/;"	f
_ascii	configure	/^ _ascii (); _ebcdic ();$/;"	f
as_func_failure	configure	/^as_func_failure () {$/;"	f
as_func_ret_failure	configure	/^as_func_ret_failure () {$/;"	f
as_func_ret_success	configure	/^as_func_ret_success () {$/;"	f
as_func_success	configure	/^as_func_success () {$/;"	f
prototypes	configure	/^   function prototypes and stuff, but not '\\xHH' hex character constants.$/;"	f
-prefix	contrib/build-deb/rules	/^	.\/configure --prefix=\/usr$/;"	m
PKG_FIXUP	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^PKG_FIXUP = libtool$/;"	m
PKG_MD5SUM	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^PKG_MD5SUM:=$/;"	m
PKG_NAME	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^PKG_NAME:=wifidog$/;"	m
PKG_RELEASE	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^PKG_RELEASE:=1$/;"	m
PKG_SOURCE	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.gz$/;"	m
PKG_SOURCE_URL	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^PKG_SOURCE_URL:= @SF\/$(PKG_NAME)$/;"	m
PKG_VERSION	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^PKG_VERSION:=20090925$/;"	m
Package	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^define Package\/wifidog$/;"	m
Package	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^define Package\/wifidog\/conffiles$/;"	m
Package	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^define Package\/wifidog\/description$/;"	m
Package	contrib/build-openwrt-kamikazeipk/wifidog/Makefile	/^define Package\/wifidog\/install$/;"	m
PKG_FIXUP	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^PKG_FIXUP = libtool$/;"	m
PKG_MD5SUM	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^PKG_MD5SUM:=$/;"	m
PKG_NAME	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^PKG_NAME:=wifidog$/;"	m
PKG_RELEASE	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^PKG_RELEASE:=1$/;"	m
PKG_SOURCE	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.gz$/;"	m
PKG_SOURCE_URL	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^PKG_SOURCE_URL:= @SF\/$(PKG_NAME)$/;"	m
PKG_VERSION	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^PKG_VERSION:=20090925$/;"	m
Package	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^define Package\/wifidog$/;"	m
Package	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^define Package\/wifidog\/conffiles$/;"	m
Package	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^define Package\/wifidog\/description$/;"	m
Package	contrib/build-openwrt-kamikazeipk8.09up/wifidog/Makefile	/^define Package\/wifidog\/install$/;"	m
ERR	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^	        ERR := $(Please set TOPDIR to OpenWRT SDK's buildroot)$/;"	m
PKG_BUILD_DIR	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_BUILD_DIR:=$(BUILD_DIR)\/$(PKG_NAME)-$(PKG_VERSION)$/;"	m
PKG_CAT	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_CAT:=zcat$/;"	m
PKG_INSTALL_DIR	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_INSTALL_DIR:=$(PKG_BUILD_DIR)\/ipkg-install$/;"	m
PKG_MD5SUM	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_MD5SUM:=$/;"	m
PKG_NAME	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_NAME:=wifidog$/;"	m
PKG_RELEASE	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_RELEASE:=1$/;"	m
PKG_SOURCE	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.gz$/;"	m
PKG_SOURCE_URL	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_SOURCE_URL:= @SF\/$(PKG_NAME)$/;"	m
PKG_VERSION	contrib/build-openwrt-whiterussianipk/wifidog/Makefile	/^PKG_VERSION:=20090925$/;"	m
ACLOCAL	doc/Makefile	/^ACLOCAL = \/home\/liping\/wifidog-master\/config\/missing aclocal-1.4$/;"	m
AR	doc/Makefile	/^AR = ar$/;"	m
AS	doc/Makefile	/^AS = @AS@$/;"	m
AUTOCONF	doc/Makefile	/^AUTOCONF = autoconf$/;"	m
AUTOHEADER	doc/Makefile	/^AUTOHEADER = autoheader$/;"	m
AUTOMAKE	doc/Makefile	/^AUTOMAKE = \/home\/liping\/wifidog-master\/config\/missing automake-1.4$/;"	m
BUILDROOT	doc/Makefile	/^BUILDROOT = $/;"	m
CC	doc/Makefile	/^CC = gcc$/;"	m
CONFIG_CLEAN_FILES	doc/Makefile	/^CONFIG_CLEAN_FILES = $/;"	m
CONFIG_HEADER	doc/Makefile	/^CONFIG_HEADER = ..\/config.h$/;"	m
CXX	doc/Makefile	/^CXX = g++$/;"	m
CXXCPP	doc/Makefile	/^CXXCPP = g++ -E$/;"	m
DESTDIR	doc/Makefile	/^DESTDIR =$/;"	m
DISTFILES	doc/Makefile	/^DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)$/;"	m
DIST_COMMON	doc/Makefile	/^DIST_COMMON =  Makefile.am Makefile.in$/;"	m
DLLTOOL	doc/Makefile	/^DLLTOOL = @DLLTOOL@$/;"	m
DOT	doc/Makefile	/^DOT = $/;"	m
DOXYGEN	doc/Makefile	/^DOXYGEN = $/;"	m
DSYMUTIL	doc/Makefile	/^DSYMUTIL = $/;"	m
ECHO	doc/Makefile	/^ECHO = echo$/;"	m
EGREP	doc/Makefile	/^EGREP = \/bin\/grep -E$/;"	m
EXEEXT	doc/Makefile	/^EXEEXT = $/;"	m
EXTRA_DIST	doc/Makefile	/^EXTRA_DIST =  	doxygen.cfg 	doxygen.cfg.in 	README.developers.txt$/;"	m
F77	doc/Makefile	/^F77 = $/;"	m
GCJ	doc/Makefile	/^GCJ = @GCJ@$/;"	m
GCJFLAGS	doc/Makefile	/^GCJFLAGS = @GCJFLAGS@$/;"	m
GZIP_ENV	doc/Makefile	/^GZIP_ENV = --best$/;"	m
HAVE_LIB	doc/Makefile	/^HAVE_LIB = @HAVE_LIB@$/;"	m
INSTALL	doc/Makefile	/^INSTALL = \/usr\/bin\/install -c$/;"	m
INSTALL_DATA	doc/Makefile	/^INSTALL_DATA = ${INSTALL} -m 644$/;"	m
INSTALL_PROGRAM	doc/Makefile	/^INSTALL_PROGRAM = ${INSTALL} $(AM_INSTALL_PROGRAM_FLAGS)$/;"	m
INSTALL_SCRIPT	doc/Makefile	/^INSTALL_SCRIPT = ${INSTALL}$/;"	m
LIB	doc/Makefile	/^LIB = @LIB@$/;"	m
LIBTOOL	doc/Makefile	/^LIBTOOL = $(SHELL) $(top_builddir)\/libtool$/;"	m
LN_S	doc/Makefile	/^LN_S = ln -s$/;"	m
LTLIB	doc/Makefile	/^LTLIB = @LTLIB@$/;"	m
MAINT	doc/Makefile	/^MAINT = #$/;"	m
MAKEINFO	doc/Makefile	/^MAKEINFO = \/home\/liping\/wifidog-master\/config\/missing makeinfo$/;"	m
NMEDIT	doc/Makefile	/^NMEDIT = $/;"	m
NORMAL_INSTALL	doc/Makefile	/^NORMAL_INSTALL = :$/;"	m
NORMAL_UNINSTALL	doc/Makefile	/^NORMAL_UNINSTALL = :$/;"	m
OBJDUMP	doc/Makefile	/^OBJDUMP = @OBJDUMP@$/;"	m
OBJEXT	doc/Makefile	/^OBJEXT = o$/;"	m
PACKAGE	doc/Makefile	/^PACKAGE = wifidog$/;"	m
POST_INSTALL	doc/Makefile	/^POST_INSTALL = :$/;"	m
POST_UNINSTALL	doc/Makefile	/^POST_UNINSTALL = :$/;"	m
PRE_INSTALL	doc/Makefile	/^PRE_INSTALL = :$/;"	m
PRE_UNINSTALL	doc/Makefile	/^PRE_UNINSTALL = :$/;"	m
RANLIB	doc/Makefile	/^RANLIB = ranlib$/;"	m
RC	doc/Makefile	/^RC = @RC@$/;"	m
SED	doc/Makefile	/^SED = \/bin\/sed$/;"	m
SHELL	doc/Makefile	/^SHELL = \/bin\/bash$/;"	m
STRIP	doc/Makefile	/^STRIP = strip$/;"	m
SUBDIRS	doc/Makefile	/^SUBDIRS = $/;"	m
TAR	doc/Makefile	/^TAR = tar$/;"	m
VERSION	doc/Makefile	/^VERSION = 20090925$/;"	m
WIFIDOG_MAJOR_VERSION	doc/Makefile	/^WIFIDOG_MAJOR_VERSION = 1$/;"	m
WIFIDOG_MICRO_VERSION	doc/Makefile	/^WIFIDOG_MICRO_VERSION = 5$/;"	m
WIFIDOG_MINOR_VERSION	doc/Makefile	/^WIFIDOG_MINOR_VERSION = 1$/;"	m
WIFIDOG_VERSION	doc/Makefile	/^WIFIDOG_VERSION = 20090925$/;"	m
bindir	doc/Makefile	/^bindir = ${exec_prefix}\/bin$/;"	m
datadir	doc/Makefile	/^datadir = ${prefix}\/share$/;"	m
distdir	doc/Makefile	/^distdir = $(top_builddir)\/$(PACKAGE)-$(VERSION)\/$(subdir)$/;"	m
docdir	doc/Makefile	/^docdir = ${prefix}\/share\/doc\/wifidog-20090925$/;"	m
enable_dot	doc/Makefile	/^enable_dot = no$/;"	m
enable_html_docs	doc/Makefile	/^enable_html_docs = yes$/;"	m
enable_latex_docs	doc/Makefile	/^enable_latex_docs = no$/;"	m
exec_prefix	doc/Makefile	/^exec_prefix = ${prefix}$/;"	m
host_alias	doc/Makefile	/^host_alias = $/;"	m
host_triplet	doc/Makefile	/^host_triplet = i686-pc-linux-gnu$/;"	m
includedir	doc/Makefile	/^includedir = ${prefix}\/include$/;"	m
infodir	doc/Makefile	/^infodir = ${prefix}\/share\/info$/;"	m
libdir	doc/Makefile	/^libdir = ${exec_prefix}\/lib$/;"	m
libexecdir	doc/Makefile	/^libexecdir = ${exec_prefix}\/libexec$/;"	m
localstatedir	doc/Makefile	/^localstatedir = ${prefix}\/var$/;"	m
mandir	doc/Makefile	/^mandir = ${prefix}\/share\/man$/;"	m
mkinstalldirs	doc/Makefile	/^mkinstalldirs = $(SHELL) $(top_srcdir)\/config\/mkinstalldirs$/;"	m
oldincludedir	doc/Makefile	/^oldincludedir = \/usr\/include$/;"	m
pkgdatadir	doc/Makefile	/^pkgdatadir = $(datadir)\/wifidog$/;"	m
pkgincludedir	doc/Makefile	/^pkgincludedir = $(includedir)\/wifidog$/;"	m
pkglibdir	doc/Makefile	/^pkglibdir = $(libdir)\/wifidog$/;"	m
prefix	doc/Makefile	/^prefix = \/home\/liping\/wifidog-master\/install$/;"	m
sbindir	doc/Makefile	/^sbindir = ${exec_prefix}\/sbin$/;"	m
sharedstatedir	doc/Makefile	/^sharedstatedir = ${prefix}\/com$/;"	m
srcdir	doc/Makefile	/^srcdir = .$/;"	m
subdir	doc/Makefile	/^subdir = doc$/;"	m
sysconfdir	doc/Makefile	/^sysconfdir = ${prefix}\/etc$/;"	m
top_builddir	doc/Makefile	/^top_builddir = ..$/;"	m
top_srcdir	doc/Makefile	/^top_srcdir = ..$/;"	m
transform	doc/Makefile	/^transform = s,x,x,$/;"	m
l00001	doc/html/auth_8c-source.html	/^<h1>auth.c<\/h1><a href="auth_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/auth_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/auth_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/auth_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/auth_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/auth_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/auth_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/auth_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/auth_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/auth_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/auth_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/auth_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/auth_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/auth_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/auth_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/auth_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/auth_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/auth_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/auth_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/auth_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/auth_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: auth.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/auth_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00028	doc/html/auth_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span>$/;"	a
l00029	doc/html/auth_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00030	doc/html/auth_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00031	doc/html/auth_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00032	doc/html/auth_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00033	doc/html/auth_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00034	doc/html/auth_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00035	doc/html/auth_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00036	doc/html/auth_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00037	doc/html/auth_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00038	doc/html/auth_8c-source.html	/^<a name="l00038"><\/a>00038 $/;"	a
l00039	doc/html/auth_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00040	doc/html/auth_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include "<a class="code" href="http_8h.html" title="HTTP IO functions.">http.h<\/a>"<\/span>$/;"	a
l00041	doc/html/auth_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00042	doc/html/auth_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00043	doc/html/auth_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00044	doc/html/auth_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00045	doc/html/auth_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00046	doc/html/auth_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="fw__iptables_8h.html" title="Firewall iptables functions.">fw_iptables.h<\/a>"<\/span>$/;"	a
l00047	doc/html/auth_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00048	doc/html/auth_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00049	doc/html/auth_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00050	doc/html/auth_8c-source.html	/^<a name="l00050"><\/a>00050 $/;"	a
l00051	doc/html/auth_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="comment">\/* Defined in clientlist.c *\/<\/span>$/;"	a
l00052	doc/html/auth_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00053	doc/html/auth_8c-source.html	/^<a name="l00053"><\/a>00053 $/;"	a
l00054	doc/html/auth_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="comment">\/* Defined in util.c *\/<\/span>$/;"	a
l00055	doc/html/auth_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="keyword">extern<\/span> <span class="keywordtype">long<\/span> served_this_session;$/;"	a
l00056	doc/html/auth_8c-source.html	/^<a name="l00056"><\/a>00056 $/;"	a
l00062	doc/html/auth_8c-source.html	/^<a name="l00062"><\/a>00062 <span class="keywordtype">void<\/span>$/;"	a
l00063	doc/html/auth_8c-source.html	/^<a name="l00063"><\/a><a class="code" href="auth_8h.html#0d343be361ec134828fe457a4d4b94e7">00063<\/a> <a class="code" href="auth_8c.html#0d343be361ec134828fe457a4d4b94e7" title="Periodically check if connections expired.">thread_client_timeout_check<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">void<\/span> *arg)$/;"	a
l00064	doc/html/auth_8c-source.html	/^<a name="l00064"><\/a>00064 {$/;"	a
l00065	doc/html/auth_8c-source.html	/^<a name="l00065"><\/a>00065         pthread_cond_t          cond = PTHREAD_COND_INITIALIZER;$/;"	a
l00066	doc/html/auth_8c-source.html	/^<a name="l00066"><\/a>00066         pthread_mutex_t         cond_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00067	doc/html/auth_8c-source.html	/^<a name="l00067"><\/a>00067         <span class="keyword">struct  <\/span>timespec        timeout;$/;"	a
l00068	doc/html/auth_8c-source.html	/^<a name="l00068"><\/a>00068         $/;"	a
l00069	doc/html/auth_8c-source.html	/^<a name="l00069"><\/a>00069         <span class="keywordflow">while<\/span> (1) {$/;"	a
l00070	doc/html/auth_8c-source.html	/^<a name="l00070"><\/a>00070                 <span class="comment">\/* Sleep for config.checkinterval seconds... *\/<\/span>$/;"	a
l00071	doc/html/auth_8c-source.html	/^<a name="l00071"><\/a>00071                 timeout.tv_sec = time(NULL) + <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a>;$/;"	a
l00072	doc/html/auth_8c-source.html	/^<a name="l00072"><\/a>00072                 timeout.tv_nsec = 0;$/;"	a
l00073	doc/html/auth_8c-source.html	/^<a name="l00073"><\/a>00073 $/;"	a
l00074	doc/html/auth_8c-source.html	/^<a name="l00074"><\/a>00074                 <span class="comment">\/* Mutex must be locked for pthread_cond_timedwait... *\/<\/span>$/;"	a
l00075	doc/html/auth_8c-source.html	/^<a name="l00075"><\/a>00075                 pthread_mutex_lock(&amp;cond_mutex);$/;"	a
l00076	doc/html/auth_8c-source.html	/^<a name="l00076"><\/a>00076                 $/;"	a
l00077	doc/html/auth_8c-source.html	/^<a name="l00077"><\/a>00077                 <span class="comment">\/* Thread safe "sleep" *\/<\/span>$/;"	a
l00078	doc/html/auth_8c-source.html	/^<a name="l00078"><\/a>00078                 pthread_cond_timedwait(&amp;cond, &amp;cond_mutex, &amp;timeout);$/;"	a
l00079	doc/html/auth_8c-source.html	/^<a name="l00079"><\/a>00079 $/;"	a
l00080	doc/html/auth_8c-source.html	/^<a name="l00080"><\/a>00080                 <span class="comment">\/* No longer needs to be locked *\/<\/span>$/;"	a
l00081	doc/html/auth_8c-source.html	/^<a name="l00081"><\/a>00081                 pthread_mutex_unlock(&amp;cond_mutex);$/;"	a
l00082	doc/html/auth_8c-source.html	/^<a name="l00082"><\/a>00082         $/;"	a
l00083	doc/html/auth_8c-source.html	/^<a name="l00083"><\/a>00083                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Running fw_counter()"<\/span>);$/;"	a
l00084	doc/html/auth_8c-source.html	/^<a name="l00084"><\/a>00084         $/;"	a
l00085	doc/html/auth_8c-source.html	/^<a name="l00085"><\/a>00085                 fw_sync_with_authserver();$/;"	a
l00086	doc/html/auth_8c-source.html	/^<a name="l00086"><\/a>00086         }$/;"	a
l00087	doc/html/auth_8c-source.html	/^<a name="l00087"><\/a>00087 }$/;"	a
l00088	doc/html/auth_8c-source.html	/^<a name="l00088"><\/a>00088 $/;"	a
l00093	doc/html/auth_8c-source.html	/^<a name="l00093"><\/a>00093 <span class="keywordtype">void<\/span>$/;"	a
l00094	doc/html/auth_8c-source.html	/^<a name="l00094"><\/a><a class="code" href="auth_8h.html#99776c0fc887b87928dce05a9760ed3d">00094<\/a> <a class="code" href="auth_8c.html#88932f2cd4b44875ef888e2fc0817da5" title="Authenticate a single client against the central server.">authenticate_client<\/a>(request *r)$/;"	a
l00095	doc/html/auth_8c-source.html	/^<a name="l00095"><\/a>00095 {$/;"	a
l00096	doc/html/auth_8c-source.html	/^<a name="l00096"><\/a>00096         <a class="code" href="struct__t__client.html">t_client<\/a>        *client;$/;"	a
l00097	doc/html/auth_8c-source.html	/^<a name="l00097"><\/a>00097         <a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a>  auth_response;$/;"	a
l00098	doc/html/auth_8c-source.html	/^<a name="l00098"><\/a>00098         <span class="keywordtype">char<\/span>    *mac,$/;"	a
l00099	doc/html/auth_8c-source.html	/^<a name="l00099"><\/a>00099                 *token;$/;"	a
l00100	doc/html/auth_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="keywordtype">char<\/span> *urlFragment = NULL;$/;"	a
l00101	doc/html/auth_8c-source.html	/^<a name="l00101"><\/a>00101         <a class="code" href="structs__config.html">s_config<\/a>        *config = NULL;$/;"	a
l00102	doc/html/auth_8c-source.html	/^<a name="l00102"><\/a>00102         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = NULL;$/;"	a
l00103	doc/html/auth_8c-source.html	/^<a name="l00103"><\/a>00103 $/;"	a
l00104	doc/html/auth_8c-source.html	/^<a name="l00104"><\/a>00104         LOCK_CLIENT_LIST();$/;"	a
l00105	doc/html/auth_8c-source.html	/^<a name="l00105"><\/a>00105 $/;"	a
l00106	doc/html/auth_8c-source.html	/^<a name="l00106"><\/a>00106         client = <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(r-&gt;clientAddr);$/;"	a
l00107	doc/html/auth_8c-source.html	/^<a name="l00107"><\/a>00107 $/;"	a
l00108	doc/html/auth_8c-source.html	/^<a name="l00108"><\/a>00108         <span class="keywordflow">if<\/span> (client == NULL) {$/;"	a
l00109	doc/html/auth_8c-source.html	/^<a name="l00109"><\/a>00109                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not find client for %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00110	doc/html/auth_8c-source.html	/^<a name="l00110"><\/a>00110                 UNLOCK_CLIENT_LIST();$/;"	a
l00111	doc/html/auth_8c-source.html	/^<a name="l00111"><\/a>00111                 <span class="keywordflow">return<\/span>;$/;"	a
l00112	doc/html/auth_8c-source.html	/^<a name="l00112"><\/a>00112         }$/;"	a
l00113	doc/html/auth_8c-source.html	/^<a name="l00113"><\/a>00113         $/;"	a
l00114	doc/html/auth_8c-source.html	/^<a name="l00114"><\/a>00114         mac = safe_strdup(client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00115	doc/html/auth_8c-source.html	/^<a name="l00115"><\/a>00115         token = safe_strdup(client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00116	doc/html/auth_8c-source.html	/^<a name="l00116"><\/a>00116         $/;"	a
l00117	doc/html/auth_8c-source.html	/^<a name="l00117"><\/a>00117         UNLOCK_CLIENT_LIST();$/;"	a
l00118	doc/html/auth_8c-source.html	/^<a name="l00118"><\/a>00118         $/;"	a
l00119	doc/html/auth_8c-source.html	/^<a name="l00119"><\/a>00119         <span class="comment">\/* <\/span>$/;"	a
l00120	doc/html/auth_8c-source.html	/^<a name="l00120"><\/a>00120 <span class="comment">         * At this point we've released the lock while we do an HTTP request since it could<\/span>$/;"	a
l00121	doc/html/auth_8c-source.html	/^<a name="l00121"><\/a>00121 <span class="comment">         * take multiple seconds to do and the gateway would effectively be frozen if we<\/span>$/;"	a
l00122	doc/html/auth_8c-source.html	/^<a name="l00122"><\/a>00122 <span class="comment">         * kept the lock.<\/span>$/;"	a
l00123	doc/html/auth_8c-source.html	/^<a name="l00123"><\/a>00123 <span class="comment">         *\/<\/span>$/;"	a
l00124	doc/html/auth_8c-source.html	/^<a name="l00124"><\/a>00124         <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(&amp;auth_response, <a class="code" href="centralserver_8h.html#6fc858ffaac7b85a57a262f86febf5bf" title="Ask the central server to login a client.">REQUEST_TYPE_LOGIN<\/a>, r-&gt;clientAddr, mac, token, 0, 0);$/;"	a
l00125	doc/html/auth_8c-source.html	/^<a name="l00125"><\/a>00125         $/;"	a
l00126	doc/html/auth_8c-source.html	/^<a name="l00126"><\/a>00126         LOCK_CLIENT_LIST();$/;"	a
l00127	doc/html/auth_8c-source.html	/^<a name="l00127"><\/a>00127         $/;"	a
l00128	doc/html/auth_8c-source.html	/^<a name="l00128"><\/a>00128         <span class="comment">\/* can't trust the client to still exist after n seconds have passed *\/<\/span>$/;"	a
l00129	doc/html/auth_8c-source.html	/^<a name="l00129"><\/a>00129         client = <a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(r-&gt;clientAddr, mac);$/;"	a
l00130	doc/html/auth_8c-source.html	/^<a name="l00130"><\/a>00130         $/;"	a
l00131	doc/html/auth_8c-source.html	/^<a name="l00131"><\/a>00131         <span class="keywordflow">if<\/span> (client == NULL) {$/;"	a
l00132	doc/html/auth_8c-source.html	/^<a name="l00132"><\/a>00132                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not find client node for %s (%s)"<\/span>, r-&gt;clientAddr, mac);$/;"	a
l00133	doc/html/auth_8c-source.html	/^<a name="l00133"><\/a>00133                 UNLOCK_CLIENT_LIST();$/;"	a
l00134	doc/html/auth_8c-source.html	/^<a name="l00134"><\/a>00134                 free(token);$/;"	a
l00135	doc/html/auth_8c-source.html	/^<a name="l00135"><\/a>00135                 free(mac);$/;"	a
l00136	doc/html/auth_8c-source.html	/^<a name="l00136"><\/a>00136                 <span class="keywordflow">return<\/span>;$/;"	a
l00137	doc/html/auth_8c-source.html	/^<a name="l00137"><\/a>00137         }$/;"	a
l00138	doc/html/auth_8c-source.html	/^<a name="l00138"><\/a>00138         $/;"	a
l00139	doc/html/auth_8c-source.html	/^<a name="l00139"><\/a>00139         free(token);$/;"	a
l00140	doc/html/auth_8c-source.html	/^<a name="l00140"><\/a>00140         free(mac);$/;"	a
l00141	doc/html/auth_8c-source.html	/^<a name="l00141"><\/a>00141 $/;"	a
l00142	doc/html/auth_8c-source.html	/^<a name="l00142"><\/a>00142         <span class="comment">\/* Prepare some variables we'll need below *\/<\/span>$/;"	a
l00143	doc/html/auth_8c-source.html	/^<a name="l00143"><\/a>00143         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00144	doc/html/auth_8c-source.html	/^<a name="l00144"><\/a>00144         auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00145	doc/html/auth_8c-source.html	/^<a name="l00145"><\/a>00145 $/;"	a
l00146	doc/html/auth_8c-source.html	/^<a name="l00146"><\/a>00146         <span class="keywordflow">switch<\/span>(auth_response.<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>) {$/;"	a
l00147	doc/html/auth_8c-source.html	/^<a name="l00147"><\/a>00147 $/;"	a
l00148	doc/html/auth_8c-source.html	/^<a name="l00148"><\/a>00148         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>:$/;"	a
l00149	doc/html/auth_8c-source.html	/^<a name="l00149"><\/a>00149                 <span class="comment">\/* Error talking to central server *\/<\/span>$/;"	a
l00150	doc/html/auth_8c-source.html	/^<a name="l00150"><\/a>00150                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Got %d from central server authenticating token %s from %s at %s"<\/span>, auth_response, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00151	doc/html/auth_8c-source.html	/^<a name="l00151"><\/a>00151                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"Error!"<\/span>, <span class="stringliteral">"Error: We did not get a valid answer from the central server"<\/span>);$/;"	a
l00152	doc/html/auth_8c-source.html	/^<a name="l00152"><\/a>00152                 <span class="keywordflow">break<\/span>;$/;"	a
l00153	doc/html/auth_8c-source.html	/^<a name="l00153"><\/a>00153 $/;"	a
l00154	doc/html/auth_8c-source.html	/^<a name="l00154"><\/a>00154         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75">AUTH_DENIED<\/a>:$/;"	a
l00155	doc/html/auth_8c-source.html	/^<a name="l00155"><\/a>00155                 <span class="comment">\/* Central server said invalid token *\/<\/span>$/;"	a
l00156	doc/html/auth_8c-source.html	/^<a name="l00156"><\/a>00156                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got DENIED from central server authenticating token %s from %s at %s - redirecting them to denied message"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00157	doc/html/auth_8c-source.html	/^<a name="l00157"><\/a>00157                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%smessage=%s"<\/span>,$/;"	a
l00158	doc/html/auth_8c-source.html	/^<a name="l00158"><\/a>00158                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>,$/;"	a
l00159	doc/html/auth_8c-source.html	/^<a name="l00159"><\/a>00159                         <a class="code" href="centralserver_8h.html#becb4a093d3aaf41645172f373acb4d7" title="Sent when the user&amp;#39;s token is denied by the central server.">GATEWAY_MESSAGE_DENIED<\/a>$/;"	a
l00160	doc/html/auth_8c-source.html	/^<a name="l00160"><\/a>00160                 );$/;"	a
l00161	doc/html/auth_8c-source.html	/^<a name="l00161"><\/a>00161                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to denied message"<\/span>);$/;"	a
l00162	doc/html/auth_8c-source.html	/^<a name="l00162"><\/a>00162                 free(urlFragment);$/;"	a
l00163	doc/html/auth_8c-source.html	/^<a name="l00163"><\/a>00163                 <span class="keywordflow">break<\/span>;$/;"	a
l00164	doc/html/auth_8c-source.html	/^<a name="l00164"><\/a>00164 $/;"	a
l00165	doc/html/auth_8c-source.html	/^<a name="l00165"><\/a>00165     <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae">AUTH_VALIDATION<\/a>:$/;"	a
l00166	doc/html/auth_8c-source.html	/^<a name="l00166"><\/a>00166                 <span class="comment">\/* They just got validated for X minutes to check their email *\/<\/span>$/;"	a
l00167	doc/html/auth_8c-source.html	/^<a name="l00167"><\/a>00167                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got VALIDATION from central server authenticating token %s from %s at %s"<\/span>$/;"	a
l00168	doc/html/auth_8c-source.html	/^<a name="l00168"><\/a>00168                                 <span class="stringliteral">"- adding to firewall and redirecting them to activate message"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>,$/;"	a
l00169	doc/html/auth_8c-source.html	/^<a name="l00169"><\/a>00169                                 client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00170	doc/html/auth_8c-source.html	/^<a name="l00170"><\/a>00170                 client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> = <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>;$/;"	a
l00171	doc/html/auth_8c-source.html	/^<a name="l00171"><\/a>00171                 fw_allow(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>);$/;"	a
l00172	doc/html/auth_8c-source.html	/^<a name="l00172"><\/a>00172                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%smessage=%s"<\/span>,$/;"	a
l00173	doc/html/auth_8c-source.html	/^<a name="l00173"><\/a>00173                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>,$/;"	a
l00174	doc/html/auth_8c-source.html	/^<a name="l00174"><\/a>00174                         <a class="code" href="centralserver_8h.html#46de6b10ed6b0269da637b1e6c96d128" title="Sent when the user&amp;#39;s token is accepted, but user is on probation.">GATEWAY_MESSAGE_ACTIVATE_ACCOUNT<\/a>$/;"	a
l00175	doc/html/auth_8c-source.html	/^<a name="l00175"><\/a>00175                 );$/;"	a
l00176	doc/html/auth_8c-source.html	/^<a name="l00176"><\/a>00176                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to activate message"<\/span>);$/;"	a
l00177	doc/html/auth_8c-source.html	/^<a name="l00177"><\/a>00177                 free(urlFragment);$/;"	a
l00178	doc/html/auth_8c-source.html	/^<a name="l00178"><\/a>00178             <span class="keywordflow">break<\/span>;$/;"	a
l00179	doc/html/auth_8c-source.html	/^<a name="l00179"><\/a>00179 $/;"	a
l00180	doc/html/auth_8c-source.html	/^<a name="l00180"><\/a>00180     <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926">AUTH_ALLOWED<\/a>:$/;"	a
l00181	doc/html/auth_8c-source.html	/^<a name="l00181"><\/a>00181                 <span class="comment">\/* Logged in successfully as a regular account *\/<\/span>$/;"	a
l00182	doc/html/auth_8c-source.html	/^<a name="l00182"><\/a>00182                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got ALLOWED from central server authenticating token %s from %s at %s - "<\/span>$/;"	a
l00183	doc/html/auth_8c-source.html	/^<a name="l00183"><\/a>00183                                 <span class="stringliteral">"adding to firewall and redirecting them to portal"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00184	doc/html/auth_8c-source.html	/^<a name="l00184"><\/a>00184                 client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> = <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>;$/;"	a
l00185	doc/html/auth_8c-source.html	/^<a name="l00185"><\/a>00185                 fw_allow(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>);$/;"	a
l00186	doc/html/auth_8c-source.html	/^<a name="l00186"><\/a>00186         served_this_session++;$/;"	a
l00187	doc/html/auth_8c-source.html	/^<a name="l00187"><\/a>00187                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%sgw_id=%s"<\/span>,$/;"	a
l00188	doc/html/auth_8c-source.html	/^<a name="l00188"><\/a>00188                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bcf430ab833dd65830904abf5793e1c6" title="This is the script the user will be sent to after a successfull login.">authserv_portal_script_path_fragment<\/a>,$/;"	a
l00189	doc/html/auth_8c-source.html	/^<a name="l00189"><\/a>00189                         config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>$/;"	a
l00190	doc/html/auth_8c-source.html	/^<a name="l00190"><\/a>00190                 );$/;"	a
l00191	doc/html/auth_8c-source.html	/^<a name="l00191"><\/a>00191                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to portal"<\/span>);$/;"	a
l00192	doc/html/auth_8c-source.html	/^<a name="l00192"><\/a>00192                 free(urlFragment);$/;"	a
l00193	doc/html/auth_8c-source.html	/^<a name="l00193"><\/a>00193             <span class="keywordflow">break<\/span>;$/;"	a
l00194	doc/html/auth_8c-source.html	/^<a name="l00194"><\/a>00194 $/;"	a
l00195	doc/html/auth_8c-source.html	/^<a name="l00195"><\/a>00195     <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb">AUTH_VALIDATION_FAILED<\/a>:$/;"	a
l00196	doc/html/auth_8c-source.html	/^<a name="l00196"><\/a>00196                  <span class="comment">\/* Client had X minutes to validate account by email and didn't = too late *\/<\/span>$/;"	a
l00197	doc/html/auth_8c-source.html	/^<a name="l00197"><\/a>00197                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got VALIDATION_FAILED from central server authenticating token %s from %s at %s "<\/span>$/;"	a
l00198	doc/html/auth_8c-source.html	/^<a name="l00198"><\/a>00198                                 <span class="stringliteral">"- redirecting them to failed_validation message"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00199	doc/html/auth_8c-source.html	/^<a name="l00199"><\/a>00199                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%smessage=%s"<\/span>,$/;"	a
l00200	doc/html/auth_8c-source.html	/^<a name="l00200"><\/a>00200                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>,$/;"	a
l00201	doc/html/auth_8c-source.html	/^<a name="l00201"><\/a>00201                         <a class="code" href="centralserver_8h.html#1a829447172cc69e643e77a2a64eaf23" title="Sent when the user&amp;#39;s token is denied by the central server because the probation...">GATEWAY_MESSAGE_ACCOUNT_VALIDATION_FAILED<\/a>$/;"	a
l00202	doc/html/auth_8c-source.html	/^<a name="l00202"><\/a>00202                 );$/;"	a
l00203	doc/html/auth_8c-source.html	/^<a name="l00203"><\/a>00203                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to failed validation message"<\/span>);$/;"	a
l00204	doc/html/auth_8c-source.html	/^<a name="l00204"><\/a>00204                 free(urlFragment);$/;"	a
l00205	doc/html/auth_8c-source.html	/^<a name="l00205"><\/a>00205             <span class="keywordflow">break<\/span>;$/;"	a
l00206	doc/html/auth_8c-source.html	/^<a name="l00206"><\/a>00206 $/;"	a
l00207	doc/html/auth_8c-source.html	/^<a name="l00207"><\/a>00207     <span class="keywordflow">default<\/span>:$/;"	a
l00208	doc/html/auth_8c-source.html	/^<a name="l00208"><\/a>00208                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"I don't know what the validation code %d means for token %s from %s at %s - sending error message"<\/span>, auth_response.<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00209	doc/html/auth_8c-source.html	/^<a name="l00209"><\/a>00209                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"Internal Error"<\/span>, <span class="stringliteral">"We can not validate your request at this time"<\/span>);$/;"	a
l00210	doc/html/auth_8c-source.html	/^<a name="l00210"><\/a>00210             <span class="keywordflow">break<\/span>;$/;"	a
l00211	doc/html/auth_8c-source.html	/^<a name="l00211"><\/a>00211 $/;"	a
l00212	doc/html/auth_8c-source.html	/^<a name="l00212"><\/a>00212         }$/;"	a
l00213	doc/html/auth_8c-source.html	/^<a name="l00213"><\/a>00213 $/;"	a
l00214	doc/html/auth_8c-source.html	/^<a name="l00214"><\/a>00214         UNLOCK_CLIENT_LIST();$/;"	a
l00215	doc/html/auth_8c-source.html	/^<a name="l00215"><\/a>00215         <span class="keywordflow">return<\/span>;$/;"	a
l00216	doc/html/auth_8c-source.html	/^<a name="l00216"><\/a>00216 }$/;"	a
l00217	doc/html/auth_8c-source.html	/^<a name="l00217"><\/a>00217 $/;"	a
l00218	doc/html/auth_8c-source.html	/^<a name="l00218"><\/a>00218 $/;"	a
0d343be361ec134828fe457a4d4b94e7	doc/html/auth_8c.html	/^<a class="anchor" name="0d343be361ec134828fe457a4d4b94e7"><\/a><!-- doxytag: member="auth.c::thread_client_timeout_check" ref="0d343be361ec134828fe457a4d4b94e7" args="(const void *arg)" -->$/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	doc/html/auth_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="auth.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
88932f2cd4b44875ef888e2fc0817da5	doc/html/auth_8c.html	/^<a class="anchor" name="88932f2cd4b44875ef888e2fc0817da5"><\/a><!-- doxytag: member="auth.c::authenticate_client" ref="88932f2cd4b44875ef888e2fc0817da5" args="(request *r)" -->$/;"	a
_details	doc/html/auth_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
d309c457ebb918832a3f7910ba2c7b3a	doc/html/auth_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d309c457ebb918832a3f7910ba2c7b3a"><\/a><!-- doxytag: member="auth.c::served_this_session" ref="d309c457ebb918832a3f7910ba2c7b3a" args="" -->$/;"	a
l00001	doc/html/auth_8h-source.html	/^<h1>auth.h<\/h1><a href="auth_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/auth_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/auth_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/auth_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/auth_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/auth_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/auth_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/auth_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/auth_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/auth_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/auth_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/auth_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/auth_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/auth_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/auth_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/auth_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/auth_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/auth_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/auth_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/auth_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/auth_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: auth.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/auth_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _AUTH_H_<\/span>$/;"	a
l00028	doc/html/auth_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _AUTH_H_<\/span>$/;"	a
l00029	doc/html/auth_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/auth_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00031	doc/html/auth_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00038	doc/html/auth_8h-source.html	/^<a name="l00038"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0">00038<\/a> <span class="keyword">typedef<\/span> <span class="keyword">enum<\/span> {$/;"	a
l00039	doc/html/auth_8h-source.html	/^<a name="l00039"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">00039<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a> = -1, $/;"	a
l00040	doc/html/auth_8h-source.html	/^<a name="l00040"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75">00040<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75">AUTH_DENIED<\/a> = 0, $/;"	a
l00041	doc/html/auth_8h-source.html	/^<a name="l00041"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926">00041<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926">AUTH_ALLOWED<\/a> = 1, $/;"	a
l00042	doc/html/auth_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae">00042<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae">AUTH_VALIDATION<\/a> = 5, $/;"	a
l00043	doc/html/auth_8h-source.html	/^<a name="l00043"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb">00043<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb">AUTH_VALIDATION_FAILED<\/a> = 6, $/;"	a
l00044	doc/html/auth_8h-source.html	/^<a name="l00044"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce">00044<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce">AUTH_LOCKED<\/a> = 254 $/;"	a
l00045	doc/html/auth_8h-source.html	/^<a name="l00045"><\/a>00045 } <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0" title="Authentication codes returned by auth server.">t_authcode<\/a>;$/;"	a
l00046	doc/html/auth_8h-source.html	/^<a name="l00046"><\/a>00046 $/;"	a
l00050	doc/html/auth_8h-source.html	/^<a name="l00050"><\/a><a class="code" href="struct__t__authresponse.html">00050<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">_t_authresponse<\/a> {$/;"	a
l00051	doc/html/auth_8h-source.html	/^<a name="l00051"><\/a><a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">00051<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0" title="Authentication codes returned by auth server.">t_authcode<\/a> <a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>; $/;"	a
l00052	doc/html/auth_8h-source.html	/^<a name="l00052"><\/a>00052 } <a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a>;$/;"	a
l00053	doc/html/auth_8h-source.html	/^<a name="l00053"><\/a>00053 $/;"	a
l00054	doc/html/auth_8h-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00056	doc/html/auth_8h-source.html	/^<a name="l00056"><\/a>00056 <span class="keywordtype">void<\/span> <a class="code" href="auth_8c.html#88932f2cd4b44875ef888e2fc0817da5" title="Authenticate a single client against the central server.">authenticate_client<\/a>(request *);$/;"	a
l00057	doc/html/auth_8h-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00059	doc/html/auth_8h-source.html	/^<a name="l00059"><\/a>00059 <span class="keywordtype">void<\/span> <a class="code" href="auth_8c.html#0d343be361ec134828fe457a4d4b94e7" title="Periodically check if connections expired.">thread_client_timeout_check<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">void<\/span> *arg);$/;"	a
l00060	doc/html/auth_8h-source.html	/^<a name="l00060"><\/a>00060 $/;"	a
l00061	doc/html/auth_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="preprocessor">#endif<\/span>$/;"	a
0d343be361ec134828fe457a4d4b94e7	doc/html/auth_8h.html	/^<a class="anchor" name="0d343be361ec134828fe457a4d4b94e7"><\/a><!-- doxytag: member="auth.h::thread_client_timeout_check" ref="0d343be361ec134828fe457a4d4b94e7" args="(const void *arg)" -->$/;"	a
99776c0fc887b87928dce05a9760ed3d	doc/html/auth_8h.html	/^<a class="anchor" name="99776c0fc887b87928dce05a9760ed3d"><\/a><!-- doxytag: member="auth.h::authenticate_client" ref="99776c0fc887b87928dce05a9760ed3d" args="(request *)" -->$/;"	a
_details	doc/html/auth_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
bf7b8d37cbbecff9af70c46566b7c11c	doc/html/auth_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bf7b8d37cbbecff9af70c46566b7c11c"><\/a><!-- doxytag: member="auth.h::t_authresponse" ref="bf7b8d37cbbecff9af70c46566b7c11c" args="" -->$/;"	a
ddcddbad4007d50702fdad951f611db0	doc/html/auth_8h.html	/^<a class="anchor" name="ddcddbad4007d50702fdad951f611db0"><\/a><!-- doxytag: member="auth.h::t_authcode" ref="ddcddbad4007d50702fdad951f611db0" args="" -->$/;"	a
ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75	doc/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75"><\/a><!-- doxytag: member="AUTH_DENIED" ref="ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75" args="" -->AUTH_DENIED<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce	doc/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce"><\/a><!-- doxytag: member="AUTH_LOCKED" ref="ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce" args="" -->AUTH_LOCKED<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392	doc/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392"><\/a><!-- doxytag: member="AUTH_ERROR" ref="ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392" args="" -->AUTH_ERROR<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb	doc/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb"><\/a><!-- doxytag: member="AUTH_VALIDATION_FAILED" ref="ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb" args="" -->AUTH_VALIDATION_FAILED<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926	doc/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926"><\/a><!-- doxytag: member="AUTH_ALLOWED" ref="ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926" args="" -->AUTH_ALLOWED<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae	doc/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae"><\/a><!-- doxytag: member="AUTH_VALIDATION" ref="ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae" args="" -->AUTH_VALIDATION<\/em>&nbsp;<\/td><td>$/;"	a
l00001	doc/html/centralserver_8c-source.html	/^<h1>centralserver.c<\/h1><a href="centralserver_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/centralserver_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/centralserver_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/centralserver_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/centralserver_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/centralserver_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/centralserver_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/centralserver_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/centralserver_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/centralserver_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/centralserver_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/centralserver_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/centralserver_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/centralserver_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/centralserver_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/centralserver_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/centralserver_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/centralserver_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/centralserver_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/centralserver_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/centralserver_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: centralserver.c 1377 2008-09-30 10:36:25Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/centralserver_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00028	doc/html/centralserver_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00029	doc/html/centralserver_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00030	doc/html/centralserver_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00031	doc/html/centralserver_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00032	doc/html/centralserver_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;sys\/stat.h&gt;<\/span>$/;"	a
l00033	doc/html/centralserver_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00034	doc/html/centralserver_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00035	doc/html/centralserver_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00036	doc/html/centralserver_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00037	doc/html/centralserver_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00038	doc/html/centralserver_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00039	doc/html/centralserver_8c-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00040	doc/html/centralserver_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00041	doc/html/centralserver_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	doc/html/centralserver_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00043	doc/html/centralserver_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00044	doc/html/centralserver_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00045	doc/html/centralserver_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00046	doc/html/centralserver_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00047	doc/html/centralserver_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00048	doc/html/centralserver_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00049	doc/html/centralserver_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00050	doc/html/centralserver_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00051	doc/html/centralserver_8c-source.html	/^<a name="l00051"><\/a>00051 $/;"	a
l00052	doc/html/centralserver_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="keyword">extern<\/span> pthread_mutex_t  <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a>;$/;"	a
l00053	doc/html/centralserver_8c-source.html	/^<a name="l00053"><\/a>00053 $/;"	a
l00064	doc/html/centralserver_8c-source.html	/^<a name="l00064"><\/a>00064 <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0" title="Authentication codes returned by auth server.">t_authcode<\/a>$/;"	a
l00065	doc/html/centralserver_8c-source.html	/^<a name="l00065"><\/a><a class="code" href="centralserver_8h.html#5c562f637bd218d2f397e8b1d9eae656">00065<\/a> <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(<a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a> *authresponse, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *request_type, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *token, <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> incoming, <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> outgoing)$/;"	a
l00066	doc/html/centralserver_8c-source.html	/^<a name="l00066"><\/a>00066 {$/;"	a
l00067	doc/html/centralserver_8c-source.html	/^<a name="l00067"><\/a>00067         <span class="keywordtype">int<\/span> sockfd;$/;"	a
l00068	doc/html/centralserver_8c-source.html	/^<a name="l00068"><\/a>00068         ssize_t numbytes;$/;"	a
l00069	doc/html/centralserver_8c-source.html	/^<a name="l00069"><\/a>00069         <span class="keywordtype">size_t<\/span> totalbytes;$/;"	a
l00070	doc/html/centralserver_8c-source.html	/^<a name="l00070"><\/a>00070         <span class="keywordtype">char<\/span> buf[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00071	doc/html/centralserver_8c-source.html	/^<a name="l00071"><\/a>00071         <span class="keywordtype">char<\/span> *tmp;$/;"	a
l00072	doc/html/centralserver_8c-source.html	/^<a name="l00072"><\/a>00072         <span class="keywordtype">char<\/span> *safe_token;$/;"	a
l00073	doc/html/centralserver_8c-source.html	/^<a name="l00073"><\/a>00073         <span class="keywordtype">int<\/span> done, nfds;$/;"	a
l00074	doc/html/centralserver_8c-source.html	/^<a name="l00074"><\/a>00074         fd_set                  readfds;$/;"	a
l00075	doc/html/centralserver_8c-source.html	/^<a name="l00075"><\/a>00075         <span class="keyword">struct <\/span>timeval          timeout;$/;"	a
l00076	doc/html/centralserver_8c-source.html	/^<a name="l00076"><\/a>00076         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = NULL;$/;"	a
l00077	doc/html/centralserver_8c-source.html	/^<a name="l00077"><\/a>00077         auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00078	doc/html/centralserver_8c-source.html	/^<a name="l00078"><\/a>00078         $/;"	a
l00079	doc/html/centralserver_8c-source.html	/^<a name="l00079"><\/a>00079         <span class="comment">\/* Blanket default is error. *\/<\/span>$/;"	a
l00080	doc/html/centralserver_8c-source.html	/^<a name="l00080"><\/a>00080         authresponse-&gt;<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a> = <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>;$/;"	a
l00081	doc/html/centralserver_8c-source.html	/^<a name="l00081"><\/a>00081         $/;"	a
l00082	doc/html/centralserver_8c-source.html	/^<a name="l00082"><\/a>00082         sockfd = <a class="code" href="centralserver_8c.html#168b78813319c6f409394019fcf45f62" title="Tries really hard to connect to an auth server. Returns a connected file descriptor...">connect_auth_server<\/a>();$/;"	a
l00083	doc/html/centralserver_8c-source.html	/^<a name="l00083"><\/a>00083         <span class="keywordflow">if<\/span> (sockfd == -1) {$/;"	a
l00084	doc/html/centralserver_8c-source.html	/^<a name="l00084"><\/a>00084                 <span class="comment">\/* Could not connect to any auth server *\/<\/span>$/;"	a
l00085	doc/html/centralserver_8c-source.html	/^<a name="l00085"><\/a>00085                 <span class="keywordflow">return<\/span> (<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00086	doc/html/centralserver_8c-source.html	/^<a name="l00086"><\/a>00086         }$/;"	a
l00087	doc/html/centralserver_8c-source.html	/^<a name="l00087"><\/a>00087 $/;"	a
l00092	doc/html/centralserver_8c-source.html	/^<a name="l00092"><\/a>00092         memset(buf, 0, <span class="keyword">sizeof<\/span>(buf));$/;"	a
l00093	doc/html/centralserver_8c-source.html	/^<a name="l00093"><\/a>00093         safe_token=httpdUrlEncode(token);$/;"	a
l00094	doc/html/centralserver_8c-source.html	/^<a name="l00094"><\/a>00094         snprintf(buf, (<span class="keyword">sizeof<\/span>(buf) - 1),$/;"	a
l00095	doc/html/centralserver_8c-source.html	/^<a name="l00095"><\/a>00095                 <span class="stringliteral">"GET %s%sstage=%s&amp;ip=%s&amp;mac=%s&amp;token=%s&amp;incoming=%llu&amp;outgoing=%llu&amp;gw_id=%s HTTP\/1.0\\r\\n"<\/span>$/;"	a
l00096	doc/html/centralserver_8c-source.html	/^<a name="l00096"><\/a>00096                 <span class="stringliteral">"User-Agent: WiFiDog %s\\r\\n"<\/span>$/;"	a
l00097	doc/html/centralserver_8c-source.html	/^<a name="l00097"><\/a>00097                 <span class="stringliteral">"Host: %s\\r\\n"<\/span>$/;"	a
l00098	doc/html/centralserver_8c-source.html	/^<a name="l00098"><\/a>00098                 <span class="stringliteral">"\\r\\n"<\/span>,$/;"	a
l00099	doc/html/centralserver_8c-source.html	/^<a name="l00099"><\/a>00099                 auth_server-&gt;authserv_path,$/;"	a
l00100	doc/html/centralserver_8c-source.html	/^<a name="l00100"><\/a>00100                 auth_server-&gt;authserv_auth_script_path_fragment,$/;"	a
l00101	doc/html/centralserver_8c-source.html	/^<a name="l00101"><\/a>00101                 request_type,$/;"	a
l00102	doc/html/centralserver_8c-source.html	/^<a name="l00102"><\/a>00102                 ip,$/;"	a
l00103	doc/html/centralserver_8c-source.html	/^<a name="l00103"><\/a>00103                 mac,$/;"	a
l00104	doc/html/centralserver_8c-source.html	/^<a name="l00104"><\/a>00104                 safe_token,$/;"	a
l00105	doc/html/centralserver_8c-source.html	/^<a name="l00105"><\/a>00105                 incoming,$/;"	a
l00106	doc/html/centralserver_8c-source.html	/^<a name="l00106"><\/a>00106                 outgoing,$/;"	a
l00107	doc/html/centralserver_8c-source.html	/^<a name="l00107"><\/a>00107                 <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;gw_id,$/;"	a
l00108	doc/html/centralserver_8c-source.html	/^<a name="l00108"><\/a>00108                 VERSION,$/;"	a
l00109	doc/html/centralserver_8c-source.html	/^<a name="l00109"><\/a>00109                 auth_server-&gt;authserv_hostname$/;"	a
l00110	doc/html/centralserver_8c-source.html	/^<a name="l00110"><\/a>00110         );$/;"	a
l00111	doc/html/centralserver_8c-source.html	/^<a name="l00111"><\/a>00111 $/;"	a
l00112	doc/html/centralserver_8c-source.html	/^<a name="l00112"><\/a>00112         free(safe_token);$/;"	a
l00113	doc/html/centralserver_8c-source.html	/^<a name="l00113"><\/a>00113 $/;"	a
l00114	doc/html/centralserver_8c-source.html	/^<a name="l00114"><\/a>00114         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Sending HTTP request to auth server: [%s]\\n"<\/span>, buf);$/;"	a
l00115	doc/html/centralserver_8c-source.html	/^<a name="l00115"><\/a>00115         send(sockfd, buf, strlen(buf), 0);$/;"	a
l00116	doc/html/centralserver_8c-source.html	/^<a name="l00116"><\/a>00116 $/;"	a
l00117	doc/html/centralserver_8c-source.html	/^<a name="l00117"><\/a>00117         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Reading response"<\/span>);$/;"	a
l00118	doc/html/centralserver_8c-source.html	/^<a name="l00118"><\/a>00118         numbytes = totalbytes = 0;$/;"	a
l00119	doc/html/centralserver_8c-source.html	/^<a name="l00119"><\/a>00119         done = 0;$/;"	a
l00120	doc/html/centralserver_8c-source.html	/^<a name="l00120"><\/a>00120         <span class="keywordflow">do<\/span> {$/;"	a
l00121	doc/html/centralserver_8c-source.html	/^<a name="l00121"><\/a>00121                 FD_ZERO(&amp;readfds);$/;"	a
l00122	doc/html/centralserver_8c-source.html	/^<a name="l00122"><\/a>00122                 FD_SET(sockfd, &amp;readfds);$/;"	a
l00123	doc/html/centralserver_8c-source.html	/^<a name="l00123"><\/a>00123                 timeout.tv_sec = 30; <span class="comment">\/* XXX magic... 30 second is as good a timeout as any *\/<\/span>$/;"	a
l00124	doc/html/centralserver_8c-source.html	/^<a name="l00124"><\/a>00124                 timeout.tv_usec = 0;$/;"	a
l00125	doc/html/centralserver_8c-source.html	/^<a name="l00125"><\/a>00125                 nfds = sockfd + 1;$/;"	a
l00126	doc/html/centralserver_8c-source.html	/^<a name="l00126"><\/a>00126 $/;"	a
l00127	doc/html/centralserver_8c-source.html	/^<a name="l00127"><\/a>00127                 nfds = select(nfds, &amp;readfds, NULL, NULL, &amp;timeout);$/;"	a
l00128	doc/html/centralserver_8c-source.html	/^<a name="l00128"><\/a>00128 $/;"	a
l00129	doc/html/centralserver_8c-source.html	/^<a name="l00129"><\/a>00129                 <span class="keywordflow">if<\/span> (nfds &gt; 0) {$/;"	a
l00132	doc/html/centralserver_8c-source.html	/^<a name="l00132"><\/a>00132                         numbytes = read(sockfd, buf + totalbytes, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - (totalbytes + 1));$/;"	a
l00133	doc/html/centralserver_8c-source.html	/^<a name="l00133"><\/a>00133                         <span class="keywordflow">if<\/span> (numbytes &lt; 0) {$/;"	a
l00134	doc/html/centralserver_8c-source.html	/^<a name="l00134"><\/a>00134                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"An error occurred while reading from auth server: %s"<\/span>, strerror(errno));$/;"	a
l00135	doc/html/centralserver_8c-source.html	/^<a name="l00135"><\/a>00135                                 <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00136	doc/html/centralserver_8c-source.html	/^<a name="l00136"><\/a>00136                                 close(sockfd);$/;"	a
l00137	doc/html/centralserver_8c-source.html	/^<a name="l00137"><\/a>00137                                 <span class="keywordflow">return<\/span> (<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00138	doc/html/centralserver_8c-source.html	/^<a name="l00138"><\/a>00138                         }$/;"	a
l00139	doc/html/centralserver_8c-source.html	/^<a name="l00139"><\/a>00139                         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (numbytes == 0) {$/;"	a
l00140	doc/html/centralserver_8c-source.html	/^<a name="l00140"><\/a>00140                                 done = 1;$/;"	a
l00141	doc/html/centralserver_8c-source.html	/^<a name="l00141"><\/a>00141                         }$/;"	a
l00142	doc/html/centralserver_8c-source.html	/^<a name="l00142"><\/a>00142                         <span class="keywordflow">else<\/span> {$/;"	a
l00143	doc/html/centralserver_8c-source.html	/^<a name="l00143"><\/a>00143                                 totalbytes += numbytes;$/;"	a
l00144	doc/html/centralserver_8c-source.html	/^<a name="l00144"><\/a>00144                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read %d bytes, total now %d"<\/span>, numbytes, totalbytes);$/;"	a
l00145	doc/html/centralserver_8c-source.html	/^<a name="l00145"><\/a>00145                         }$/;"	a
l00146	doc/html/centralserver_8c-source.html	/^<a name="l00146"><\/a>00146                 }$/;"	a
l00147	doc/html/centralserver_8c-source.html	/^<a name="l00147"><\/a>00147                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (nfds == 0) {$/;"	a
l00148	doc/html/centralserver_8c-source.html	/^<a name="l00148"><\/a>00148                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Timed out reading data via select() from auth server"<\/span>);$/;"	a
l00149	doc/html/centralserver_8c-source.html	/^<a name="l00149"><\/a>00149                         <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00150	doc/html/centralserver_8c-source.html	/^<a name="l00150"><\/a>00150                         close(sockfd);$/;"	a
l00151	doc/html/centralserver_8c-source.html	/^<a name="l00151"><\/a>00151                         <span class="keywordflow">return<\/span> (<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00152	doc/html/centralserver_8c-source.html	/^<a name="l00152"><\/a>00152                 }$/;"	a
l00153	doc/html/centralserver_8c-source.html	/^<a name="l00153"><\/a>00153                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (nfds &lt; 0) {$/;"	a
l00154	doc/html/centralserver_8c-source.html	/^<a name="l00154"><\/a>00154                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Error reading data via select() from auth server: %s"<\/span>, strerror(errno));$/;"	a
l00155	doc/html/centralserver_8c-source.html	/^<a name="l00155"><\/a>00155                         <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00156	doc/html/centralserver_8c-source.html	/^<a name="l00156"><\/a>00156                         close(sockfd);$/;"	a
l00157	doc/html/centralserver_8c-source.html	/^<a name="l00157"><\/a>00157                         <span class="keywordflow">return<\/span> (<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00158	doc/html/centralserver_8c-source.html	/^<a name="l00158"><\/a>00158                 }$/;"	a
l00159	doc/html/centralserver_8c-source.html	/^<a name="l00159"><\/a>00159         } <span class="keywordflow">while<\/span> (!done);$/;"	a
l00160	doc/html/centralserver_8c-source.html	/^<a name="l00160"><\/a>00160 $/;"	a
l00161	doc/html/centralserver_8c-source.html	/^<a name="l00161"><\/a>00161         close(sockfd);$/;"	a
l00162	doc/html/centralserver_8c-source.html	/^<a name="l00162"><\/a>00162 $/;"	a
l00163	doc/html/centralserver_8c-source.html	/^<a name="l00163"><\/a>00163         buf[totalbytes] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00164	doc/html/centralserver_8c-source.html	/^<a name="l00164"><\/a>00164         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"HTTP Response from Server: [%s]"<\/span>, buf);$/;"	a
l00165	doc/html/centralserver_8c-source.html	/^<a name="l00165"><\/a>00165         $/;"	a
l00166	doc/html/centralserver_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordflow">if<\/span> ((tmp = strstr(buf, <span class="stringliteral">"Auth: "<\/span>))) {$/;"	a
l00167	doc/html/centralserver_8c-source.html	/^<a name="l00167"><\/a>00167                 <span class="keywordflow">if<\/span> (sscanf(tmp, <span class="stringliteral">"Auth: %d"<\/span>, (<span class="keywordtype">int<\/span> *)&amp;authresponse-&gt;<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>) == 1) {$/;"	a
l00168	doc/html/centralserver_8c-source.html	/^<a name="l00168"><\/a>00168                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Auth server returned authentication code %d"<\/span>, authresponse-&gt;<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>);$/;"	a
l00169	doc/html/centralserver_8c-source.html	/^<a name="l00169"><\/a>00169                         <span class="keywordflow">return<\/span>(authresponse-&gt;<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>);$/;"	a
l00170	doc/html/centralserver_8c-source.html	/^<a name="l00170"><\/a>00170                 } <span class="keywordflow">else<\/span> {$/;"	a
l00171	doc/html/centralserver_8c-source.html	/^<a name="l00171"><\/a>00171                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"Auth server did not return expected authentication code"<\/span>);$/;"	a
l00172	doc/html/centralserver_8c-source.html	/^<a name="l00172"><\/a>00172                         <span class="keywordflow">return<\/span>(<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00173	doc/html/centralserver_8c-source.html	/^<a name="l00173"><\/a>00173                 }$/;"	a
l00174	doc/html/centralserver_8c-source.html	/^<a name="l00174"><\/a>00174         }$/;"	a
l00175	doc/html/centralserver_8c-source.html	/^<a name="l00175"><\/a>00175         <span class="keywordflow">else<\/span> {$/;"	a
l00176	doc/html/centralserver_8c-source.html	/^<a name="l00176"><\/a>00176                 <span class="keywordflow">return<\/span>(<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00177	doc/html/centralserver_8c-source.html	/^<a name="l00177"><\/a>00177         }$/;"	a
l00178	doc/html/centralserver_8c-source.html	/^<a name="l00178"><\/a>00178 $/;"	a
l00179	doc/html/centralserver_8c-source.html	/^<a name="l00179"><\/a>00179         <span class="comment">\/* XXX Never reached because of the above if()\/else pair. *\/<\/span>$/;"	a
l00180	doc/html/centralserver_8c-source.html	/^<a name="l00180"><\/a>00180         <span class="keywordflow">return<\/span>(<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00181	doc/html/centralserver_8c-source.html	/^<a name="l00181"><\/a>00181 }$/;"	a
l00182	doc/html/centralserver_8c-source.html	/^<a name="l00182"><\/a>00182 $/;"	a
l00183	doc/html/centralserver_8c-source.html	/^<a name="l00183"><\/a>00183 <span class="comment">\/* Tries really hard to connect to an auth server. Returns a file descriptor, -1 on error<\/span>$/;"	a
l00184	doc/html/centralserver_8c-source.html	/^<a name="l00184"><\/a>00184 <span class="comment"> *\/<\/span>$/;"	a
l00185	doc/html/centralserver_8c-source.html	/^<a name="l00185"><\/a><a class="code" href="centralserver_8h.html#168b78813319c6f409394019fcf45f62">00185<\/a> <span class="keywordtype">int<\/span> <a class="code" href="centralserver_8c.html#168b78813319c6f409394019fcf45f62" title="Tries really hard to connect to an auth server. Returns a connected file descriptor...">connect_auth_server<\/a>() {$/;"	a
l00186	doc/html/centralserver_8c-source.html	/^<a name="l00186"><\/a>00186         <span class="keywordtype">int<\/span> sockfd;$/;"	a
l00187	doc/html/centralserver_8c-source.html	/^<a name="l00187"><\/a>00187 $/;"	a
l00188	doc/html/centralserver_8c-source.html	/^<a name="l00188"><\/a>00188         LOCK_CONFIG();$/;"	a
l00189	doc/html/centralserver_8c-source.html	/^<a name="l00189"><\/a>00189         sockfd = <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(0);$/;"	a
l00190	doc/html/centralserver_8c-source.html	/^<a name="l00190"><\/a>00190         UNLOCK_CONFIG();$/;"	a
l00191	doc/html/centralserver_8c-source.html	/^<a name="l00191"><\/a>00191 $/;"	a
l00192	doc/html/centralserver_8c-source.html	/^<a name="l00192"><\/a>00192         <span class="keywordflow">if<\/span> (sockfd == -1) {$/;"	a
l00193	doc/html/centralserver_8c-source.html	/^<a name="l00193"><\/a>00193                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Failed to connect to any of the auth servers"<\/span>);$/;"	a
l00194	doc/html/centralserver_8c-source.html	/^<a name="l00194"><\/a>00194                 mark_auth_offline();$/;"	a
l00195	doc/html/centralserver_8c-source.html	/^<a name="l00195"><\/a>00195         }$/;"	a
l00196	doc/html/centralserver_8c-source.html	/^<a name="l00196"><\/a>00196         <span class="keywordflow">else<\/span> {$/;"	a
l00197	doc/html/centralserver_8c-source.html	/^<a name="l00197"><\/a>00197                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Connected to auth server"<\/span>);$/;"	a
l00198	doc/html/centralserver_8c-source.html	/^<a name="l00198"><\/a>00198                 mark_auth_online();$/;"	a
l00199	doc/html/centralserver_8c-source.html	/^<a name="l00199"><\/a>00199         }$/;"	a
l00200	doc/html/centralserver_8c-source.html	/^<a name="l00200"><\/a>00200         <span class="keywordflow">return<\/span> (sockfd);$/;"	a
l00201	doc/html/centralserver_8c-source.html	/^<a name="l00201"><\/a>00201 }$/;"	a
l00202	doc/html/centralserver_8c-source.html	/^<a name="l00202"><\/a>00202 $/;"	a
l00203	doc/html/centralserver_8c-source.html	/^<a name="l00203"><\/a>00203 <span class="comment">\/* Helper function called by connect_auth_server() to do the actual work including recursion<\/span>$/;"	a
l00204	doc/html/centralserver_8c-source.html	/^<a name="l00204"><\/a>00204 <span class="comment"> * DO NOT CALL DIRECTLY<\/span>$/;"	a
l00205	doc/html/centralserver_8c-source.html	/^<a name="l00205"><\/a>00205 <span class="comment"> @param level recursion level indicator must be 0 when not called by _connect_auth_server()<\/span>$/;"	a
l00206	doc/html/centralserver_8c-source.html	/^<a name="l00206"><\/a>00206 <span class="comment"> *\/<\/span>$/;"	a
l00207	doc/html/centralserver_8c-source.html	/^<a name="l00207"><\/a><a class="code" href="centralserver_8h.html#e19e5fef3df77ca03ce69852f016fdc6">00207<\/a> <span class="keywordtype">int<\/span> <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(<span class="keywordtype">int<\/span> level) {$/;"	a
l00208	doc/html/centralserver_8c-source.html	/^<a name="l00208"><\/a>00208         <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00209	doc/html/centralserver_8c-source.html	/^<a name="l00209"><\/a>00209         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_server = NULL;$/;"	a
l00210	doc/html/centralserver_8c-source.html	/^<a name="l00210"><\/a>00210         <span class="keyword">struct <\/span>in_addr *h_addr;$/;"	a
l00211	doc/html/centralserver_8c-source.html	/^<a name="l00211"><\/a>00211         <span class="keywordtype">int<\/span> num_servers = 0;$/;"	a
l00212	doc/html/centralserver_8c-source.html	/^<a name="l00212"><\/a>00212         <span class="keywordtype">char<\/span> * hostname = NULL;$/;"	a
l00213	doc/html/centralserver_8c-source.html	/^<a name="l00213"><\/a>00213         <span class="keywordtype">char<\/span> * popular_servers[] = {$/;"	a
l00214	doc/html/centralserver_8c-source.html	/^<a name="l00214"><\/a>00214                   <span class="stringliteral">"www.google.com"<\/span>,$/;"	a
l00215	doc/html/centralserver_8c-source.html	/^<a name="l00215"><\/a>00215                   <span class="stringliteral">"www.yahoo.com"<\/span>,$/;"	a
l00216	doc/html/centralserver_8c-source.html	/^<a name="l00216"><\/a>00216                   NULL$/;"	a
l00217	doc/html/centralserver_8c-source.html	/^<a name="l00217"><\/a>00217         };$/;"	a
l00218	doc/html/centralserver_8c-source.html	/^<a name="l00218"><\/a>00218         <span class="keywordtype">char<\/span> ** popularserver;$/;"	a
l00219	doc/html/centralserver_8c-source.html	/^<a name="l00219"><\/a>00219         <span class="keywordtype">char<\/span> * ip;$/;"	a
l00220	doc/html/centralserver_8c-source.html	/^<a name="l00220"><\/a>00220         <span class="keyword">struct <\/span>sockaddr_in their_addr;$/;"	a
l00221	doc/html/centralserver_8c-source.html	/^<a name="l00221"><\/a>00221         <span class="keywordtype">int<\/span> sockfd;$/;"	a
l00222	doc/html/centralserver_8c-source.html	/^<a name="l00222"><\/a>00222 $/;"	a
l00223	doc/html/centralserver_8c-source.html	/^<a name="l00223"><\/a>00223         <span class="comment">\/* XXX level starts out at 0 and gets incremented by every iterations. *\/<\/span>$/;"	a
l00224	doc/html/centralserver_8c-source.html	/^<a name="l00224"><\/a>00224         level++;$/;"	a
l00225	doc/html/centralserver_8c-source.html	/^<a name="l00225"><\/a>00225 $/;"	a
l00226	doc/html/centralserver_8c-source.html	/^<a name="l00226"><\/a>00226         <span class="comment">\/*<\/span>$/;"	a
l00227	doc/html/centralserver_8c-source.html	/^<a name="l00227"><\/a>00227 <span class="comment">         * Let's calculate the number of servers we have<\/span>$/;"	a
l00228	doc/html/centralserver_8c-source.html	/^<a name="l00228"><\/a>00228 <span class="comment">         *\/<\/span>$/;"	a
l00229	doc/html/centralserver_8c-source.html	/^<a name="l00229"><\/a>00229         <span class="keywordflow">for<\/span> (auth_server = config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; auth_server; auth_server = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>) {$/;"	a
l00230	doc/html/centralserver_8c-source.html	/^<a name="l00230"><\/a>00230                 num_servers++;$/;"	a
l00231	doc/html/centralserver_8c-source.html	/^<a name="l00231"><\/a>00231         }$/;"	a
l00232	doc/html/centralserver_8c-source.html	/^<a name="l00232"><\/a>00232         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Calculated %d auth servers in list"<\/span>, level, num_servers);$/;"	a
l00233	doc/html/centralserver_8c-source.html	/^<a name="l00233"><\/a>00233 $/;"	a
l00234	doc/html/centralserver_8c-source.html	/^<a name="l00234"><\/a>00234         <span class="keywordflow">if<\/span> (level &gt; num_servers) {$/;"	a
l00235	doc/html/centralserver_8c-source.html	/^<a name="l00235"><\/a>00235                 <span class="comment">\/*<\/span>$/;"	a
l00236	doc/html/centralserver_8c-source.html	/^<a name="l00236"><\/a>00236 <span class="comment">                 * We've called ourselves too many times<\/span>$/;"	a
l00237	doc/html/centralserver_8c-source.html	/^<a name="l00237"><\/a>00237 <span class="comment">                 * This means we've cycled through all the servers in the server list<\/span>$/;"	a
l00238	doc/html/centralserver_8c-source.html	/^<a name="l00238"><\/a>00238 <span class="comment">                 * at least once and none are accessible<\/span>$/;"	a
l00239	doc/html/centralserver_8c-source.html	/^<a name="l00239"><\/a>00239 <span class="comment">                 *\/<\/span>$/;"	a
l00240	doc/html/centralserver_8c-source.html	/^<a name="l00240"><\/a>00240                 <span class="keywordflow">return<\/span> (-1);$/;"	a
l00241	doc/html/centralserver_8c-source.html	/^<a name="l00241"><\/a>00241         }$/;"	a
l00242	doc/html/centralserver_8c-source.html	/^<a name="l00242"><\/a>00242 $/;"	a
l00243	doc/html/centralserver_8c-source.html	/^<a name="l00243"><\/a>00243         <span class="comment">\/*<\/span>$/;"	a
l00244	doc/html/centralserver_8c-source.html	/^<a name="l00244"><\/a>00244 <span class="comment">         * Let's resolve the hostname of the top server to an IP address<\/span>$/;"	a
l00245	doc/html/centralserver_8c-source.html	/^<a name="l00245"><\/a>00245 <span class="comment">         *\/<\/span>$/;"	a
l00246	doc/html/centralserver_8c-source.html	/^<a name="l00246"><\/a>00246         auth_server = config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>;$/;"	a
l00247	doc/html/centralserver_8c-source.html	/^<a name="l00247"><\/a>00247         hostname = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>;$/;"	a
l00248	doc/html/centralserver_8c-source.html	/^<a name="l00248"><\/a>00248         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving auth server [%s]"<\/span>, level, hostname);$/;"	a
l00249	doc/html/centralserver_8c-source.html	/^<a name="l00249"><\/a>00249         h_addr = wd_gethostbyname(hostname);$/;"	a
l00250	doc/html/centralserver_8c-source.html	/^<a name="l00250"><\/a>00250         <span class="keywordflow">if<\/span> (!h_addr) {$/;"	a
l00251	doc/html/centralserver_8c-source.html	/^<a name="l00251"><\/a>00251                 <span class="comment">\/*<\/span>$/;"	a
l00252	doc/html/centralserver_8c-source.html	/^<a name="l00252"><\/a>00252 <span class="comment">                 * DNS resolving it failed<\/span>$/;"	a
l00253	doc/html/centralserver_8c-source.html	/^<a name="l00253"><\/a>00253 <span class="comment">                 *<\/span>$/;"	a
l00254	doc/html/centralserver_8c-source.html	/^<a name="l00254"><\/a>00254 <span class="comment">                 * Can we resolve any of the popular servers ?<\/span>$/;"	a
l00255	doc/html/centralserver_8c-source.html	/^<a name="l00255"><\/a>00255 <span class="comment">                 *\/<\/span>$/;"	a
l00256	doc/html/centralserver_8c-source.html	/^<a name="l00256"><\/a>00256                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving auth server [%s] failed"<\/span>, level, hostname);$/;"	a
l00257	doc/html/centralserver_8c-source.html	/^<a name="l00257"><\/a>00257 $/;"	a
l00258	doc/html/centralserver_8c-source.html	/^<a name="l00258"><\/a>00258                 <span class="keywordflow">for<\/span> (popularserver = popular_servers; *popularserver; popularserver++) {$/;"	a
l00259	doc/html/centralserver_8c-source.html	/^<a name="l00259"><\/a>00259                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving popular server [%s]"<\/span>, level, *popularserver);$/;"	a
l00260	doc/html/centralserver_8c-source.html	/^<a name="l00260"><\/a>00260                         h_addr = wd_gethostbyname(*popularserver);$/;"	a
l00261	doc/html/centralserver_8c-source.html	/^<a name="l00261"><\/a>00261                         <span class="keywordflow">if<\/span> (h_addr) {$/;"	a
l00262	doc/html/centralserver_8c-source.html	/^<a name="l00262"><\/a>00262                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving popular server [%s] succeeded = [%s]"<\/span>, level, *popularserver, inet_ntoa(*h_addr));$/;"	a
l00263	doc/html/centralserver_8c-source.html	/^<a name="l00263"><\/a>00263                                 <span class="keywordflow">break<\/span>;$/;"	a
l00264	doc/html/centralserver_8c-source.html	/^<a name="l00264"><\/a>00264                         }$/;"	a
l00265	doc/html/centralserver_8c-source.html	/^<a name="l00265"><\/a>00265                         <span class="keywordflow">else<\/span> {$/;"	a
l00266	doc/html/centralserver_8c-source.html	/^<a name="l00266"><\/a>00266                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving popular server [%s] failed"<\/span>, level, *popularserver);$/;"	a
l00267	doc/html/centralserver_8c-source.html	/^<a name="l00267"><\/a>00267                         }$/;"	a
l00268	doc/html/centralserver_8c-source.html	/^<a name="l00268"><\/a>00268                 }$/;"	a
l00269	doc/html/centralserver_8c-source.html	/^<a name="l00269"><\/a>00269 $/;"	a
l00270	doc/html/centralserver_8c-source.html	/^<a name="l00270"><\/a>00270                 <span class="comment">\/* <\/span>$/;"	a
l00271	doc/html/centralserver_8c-source.html	/^<a name="l00271"><\/a>00271 <span class="comment">                 * If we got any h_addr buffer for one of the popular servers, in other<\/span>$/;"	a
l00272	doc/html/centralserver_8c-source.html	/^<a name="l00272"><\/a>00272 <span class="comment">                 * words, if one of the popular servers resolved, we'll assume the DNS<\/span>$/;"	a
l00273	doc/html/centralserver_8c-source.html	/^<a name="l00273"><\/a>00273 <span class="comment">                 * works, otherwise we'll deal with net connection or DNS failure.<\/span>$/;"	a
l00274	doc/html/centralserver_8c-source.html	/^<a name="l00274"><\/a>00274 <span class="comment">                 *\/<\/span>$/;"	a
l00275	doc/html/centralserver_8c-source.html	/^<a name="l00275"><\/a>00275                 <span class="keywordflow">if<\/span> (h_addr) {$/;"	a
l00276	doc/html/centralserver_8c-source.html	/^<a name="l00276"><\/a>00276                         free (h_addr);$/;"	a
l00277	doc/html/centralserver_8c-source.html	/^<a name="l00277"><\/a>00277                         <span class="comment">\/*<\/span>$/;"	a
l00278	doc/html/centralserver_8c-source.html	/^<a name="l00278"><\/a>00278 <span class="comment">                         * Yes<\/span>$/;"	a
l00279	doc/html/centralserver_8c-source.html	/^<a name="l00279"><\/a>00279 <span class="comment">                         *<\/span>$/;"	a
l00280	doc/html/centralserver_8c-source.html	/^<a name="l00280"><\/a>00280 <span class="comment">                         * The auth server's DNS server is probably dead. Try the next auth server<\/span>$/;"	a
l00281	doc/html/centralserver_8c-source.html	/^<a name="l00281"><\/a>00281 <span class="comment">                         *\/<\/span>$/;"	a
l00282	doc/html/centralserver_8c-source.html	/^<a name="l00282"><\/a>00282                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Marking auth server [%s] as bad and trying next if possible"<\/span>, level, hostname);$/;"	a
l00283	doc/html/centralserver_8c-source.html	/^<a name="l00283"><\/a>00283                         <span class="keywordflow">if<\/span> (auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>) {$/;"	a
l00284	doc/html/centralserver_8c-source.html	/^<a name="l00284"><\/a>00284                                 free(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00285	doc/html/centralserver_8c-source.html	/^<a name="l00285"><\/a>00285                                 auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a> = NULL;$/;"	a
l00286	doc/html/centralserver_8c-source.html	/^<a name="l00286"><\/a>00286                         }$/;"	a
l00287	doc/html/centralserver_8c-source.html	/^<a name="l00287"><\/a>00287                         <a class="code" href="conf_8c.html#d1e677696fcef826740ca906587af8ac" title="Bump server to bottom of the list.">mark_auth_server_bad<\/a>(auth_server);$/;"	a
l00288	doc/html/centralserver_8c-source.html	/^<a name="l00288"><\/a>00288                         <span class="keywordflow">return<\/span> <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(level);$/;"	a
l00289	doc/html/centralserver_8c-source.html	/^<a name="l00289"><\/a>00289                 }$/;"	a
l00290	doc/html/centralserver_8c-source.html	/^<a name="l00290"><\/a>00290                 <span class="keywordflow">else<\/span> {$/;"	a
l00291	doc/html/centralserver_8c-source.html	/^<a name="l00291"><\/a>00291                         <span class="comment">\/*<\/span>$/;"	a
l00292	doc/html/centralserver_8c-source.html	/^<a name="l00292"><\/a>00292 <span class="comment">                         * No<\/span>$/;"	a
l00293	doc/html/centralserver_8c-source.html	/^<a name="l00293"><\/a>00293 <span class="comment">                         *<\/span>$/;"	a
l00294	doc/html/centralserver_8c-source.html	/^<a name="l00294"><\/a>00294 <span class="comment">                         * It's probably safe to assume that the internet connection is malfunctioning<\/span>$/;"	a
l00295	doc/html/centralserver_8c-source.html	/^<a name="l00295"><\/a>00295 <span class="comment">                         * and nothing we can do will make it work<\/span>$/;"	a
l00296	doc/html/centralserver_8c-source.html	/^<a name="l00296"><\/a>00296 <span class="comment">                         *\/<\/span>$/;"	a
l00297	doc/html/centralserver_8c-source.html	/^<a name="l00297"><\/a>00297                         mark_offline();$/;"	a
l00298	doc/html/centralserver_8c-source.html	/^<a name="l00298"><\/a>00298                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Failed to resolve auth server and all popular servers. "<\/span>$/;"	a
l00299	doc/html/centralserver_8c-source.html	/^<a name="l00299"><\/a>00299                                         <span class="stringliteral">"The internet connection is probably down"<\/span>, level);$/;"	a
l00300	doc/html/centralserver_8c-source.html	/^<a name="l00300"><\/a>00300                         <span class="keywordflow">return<\/span>(-1);$/;"	a
l00301	doc/html/centralserver_8c-source.html	/^<a name="l00301"><\/a>00301                 }$/;"	a
l00302	doc/html/centralserver_8c-source.html	/^<a name="l00302"><\/a>00302         }$/;"	a
l00303	doc/html/centralserver_8c-source.html	/^<a name="l00303"><\/a>00303         <span class="keywordflow">else<\/span> {$/;"	a
l00304	doc/html/centralserver_8c-source.html	/^<a name="l00304"><\/a>00304                 <span class="comment">\/*<\/span>$/;"	a
l00305	doc/html/centralserver_8c-source.html	/^<a name="l00305"><\/a>00305 <span class="comment">                 * DNS resolving was successful<\/span>$/;"	a
l00306	doc/html/centralserver_8c-source.html	/^<a name="l00306"><\/a>00306 <span class="comment">                 *\/<\/span>$/;"	a
l00307	doc/html/centralserver_8c-source.html	/^<a name="l00307"><\/a>00307                 ip = safe_strdup(inet_ntoa(*h_addr));$/;"	a
l00308	doc/html/centralserver_8c-source.html	/^<a name="l00308"><\/a>00308                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving auth server [%s] succeeded = [%s]"<\/span>, level, hostname, ip);$/;"	a
l00309	doc/html/centralserver_8c-source.html	/^<a name="l00309"><\/a>00309 $/;"	a
l00310	doc/html/centralserver_8c-source.html	/^<a name="l00310"><\/a>00310                 <span class="keywordflow">if<\/span> (!auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a> || strcmp(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>, ip) != 0) {$/;"	a
l00311	doc/html/centralserver_8c-source.html	/^<a name="l00311"><\/a>00311                         <span class="comment">\/*<\/span>$/;"	a
l00312	doc/html/centralserver_8c-source.html	/^<a name="l00312"><\/a>00312 <span class="comment">                         * But the IP address is different from the last one we knew<\/span>$/;"	a
l00313	doc/html/centralserver_8c-source.html	/^<a name="l00313"><\/a>00313 <span class="comment">                         * Update it<\/span>$/;"	a
l00314	doc/html/centralserver_8c-source.html	/^<a name="l00314"><\/a>00314 <span class="comment">                         *\/<\/span>$/;"	a
l00315	doc/html/centralserver_8c-source.html	/^<a name="l00315"><\/a>00315                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Updating last_ip IP of server [%s] to [%s]"<\/span>, level, hostname, ip);$/;"	a
l00316	doc/html/centralserver_8c-source.html	/^<a name="l00316"><\/a>00316                         <span class="keywordflow">if<\/span> (auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>) free(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00317	doc/html/centralserver_8c-source.html	/^<a name="l00317"><\/a>00317                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a> = ip;$/;"	a
l00318	doc/html/centralserver_8c-source.html	/^<a name="l00318"><\/a>00318 $/;"	a
l00319	doc/html/centralserver_8c-source.html	/^<a name="l00319"><\/a>00319                         <span class="comment">\/* Update firewall rules *\/<\/span>$/;"	a
l00320	doc/html/centralserver_8c-source.html	/^<a name="l00320"><\/a>00320                         fw_clear_authservers();$/;"	a
l00321	doc/html/centralserver_8c-source.html	/^<a name="l00321"><\/a>00321                         fw_set_authservers();$/;"	a
l00322	doc/html/centralserver_8c-source.html	/^<a name="l00322"><\/a>00322                 }$/;"	a
l00323	doc/html/centralserver_8c-source.html	/^<a name="l00323"><\/a>00323                 <span class="keywordflow">else<\/span> {$/;"	a
l00324	doc/html/centralserver_8c-source.html	/^<a name="l00324"><\/a>00324                         <span class="comment">\/*<\/span>$/;"	a
l00325	doc/html/centralserver_8c-source.html	/^<a name="l00325"><\/a>00325 <span class="comment">                         * IP is the same as last time<\/span>$/;"	a
l00326	doc/html/centralserver_8c-source.html	/^<a name="l00326"><\/a>00326 <span class="comment">                         *\/<\/span>$/;"	a
l00327	doc/html/centralserver_8c-source.html	/^<a name="l00327"><\/a>00327                         free(ip);$/;"	a
l00328	doc/html/centralserver_8c-source.html	/^<a name="l00328"><\/a>00328                 }$/;"	a
l00329	doc/html/centralserver_8c-source.html	/^<a name="l00329"><\/a>00329 $/;"	a
l00330	doc/html/centralserver_8c-source.html	/^<a name="l00330"><\/a>00330                 <span class="comment">\/*<\/span>$/;"	a
l00331	doc/html/centralserver_8c-source.html	/^<a name="l00331"><\/a>00331 <span class="comment">                 * Connect to it<\/span>$/;"	a
l00332	doc/html/centralserver_8c-source.html	/^<a name="l00332"><\/a>00332 <span class="comment">                 *\/<\/span>$/;"	a
l00333	doc/html/centralserver_8c-source.html	/^<a name="l00333"><\/a>00333                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Connecting to auth server %s:%d"<\/span>, level, hostname, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>);$/;"	a
l00334	doc/html/centralserver_8c-source.html	/^<a name="l00334"><\/a>00334                 their_addr.sin_family = AF_INET;$/;"	a
l00335	doc/html/centralserver_8c-source.html	/^<a name="l00335"><\/a>00335                 their_addr.sin_port = htons(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>);$/;"	a
l00336	doc/html/centralserver_8c-source.html	/^<a name="l00336"><\/a>00336                 their_addr.sin_addr = *h_addr;$/;"	a
l00337	doc/html/centralserver_8c-source.html	/^<a name="l00337"><\/a>00337                 memset(&amp;(their_addr.sin_zero), <span class="charliteral">'\\0'<\/span>, <span class="keyword">sizeof<\/span>(their_addr.sin_zero));$/;"	a
l00338	doc/html/centralserver_8c-source.html	/^<a name="l00338"><\/a>00338                 free (h_addr);$/;"	a
l00339	doc/html/centralserver_8c-source.html	/^<a name="l00339"><\/a>00339 $/;"	a
l00340	doc/html/centralserver_8c-source.html	/^<a name="l00340"><\/a>00340                 <span class="keywordflow">if<\/span> ((sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1) {$/;"	a
l00341	doc/html/centralserver_8c-source.html	/^<a name="l00341"><\/a>00341                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Level %d: Failed to create a new SOCK_STREAM socket: %s"<\/span>, strerror(errno));$/;"	a
l00342	doc/html/centralserver_8c-source.html	/^<a name="l00342"><\/a>00342                         <span class="keywordflow">return<\/span>(-1);$/;"	a
l00343	doc/html/centralserver_8c-source.html	/^<a name="l00343"><\/a>00343                 }$/;"	a
l00344	doc/html/centralserver_8c-source.html	/^<a name="l00344"><\/a>00344 $/;"	a
l00345	doc/html/centralserver_8c-source.html	/^<a name="l00345"><\/a>00345                 <span class="keywordflow">if<\/span> (connect(sockfd, (<span class="keyword">struct<\/span> sockaddr *)&amp;their_addr, <span class="keyword">sizeof<\/span>(<span class="keyword">struct<\/span> sockaddr)) == -1) {$/;"	a
l00346	doc/html/centralserver_8c-source.html	/^<a name="l00346"><\/a>00346                         <span class="comment">\/*<\/span>$/;"	a
l00347	doc/html/centralserver_8c-source.html	/^<a name="l00347"><\/a>00347 <span class="comment">                         * Failed to connect<\/span>$/;"	a
l00348	doc/html/centralserver_8c-source.html	/^<a name="l00348"><\/a>00348 <span class="comment">                         * Mark the server as bad and try the next one<\/span>$/;"	a
l00349	doc/html/centralserver_8c-source.html	/^<a name="l00349"><\/a>00349 <span class="comment">                         *\/<\/span>$/;"	a
l00350	doc/html/centralserver_8c-source.html	/^<a name="l00350"><\/a>00350                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Failed to connect to auth server %s:%d (%s). Marking it as bad and trying next if possible"<\/span>, level, hostname, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>, strerror(errno));$/;"	a
l00351	doc/html/centralserver_8c-source.html	/^<a name="l00351"><\/a>00351                         close(sockfd);$/;"	a
l00352	doc/html/centralserver_8c-source.html	/^<a name="l00352"><\/a>00352                         <a class="code" href="conf_8c.html#d1e677696fcef826740ca906587af8ac" title="Bump server to bottom of the list.">mark_auth_server_bad<\/a>(auth_server);$/;"	a
l00353	doc/html/centralserver_8c-source.html	/^<a name="l00353"><\/a>00353                         <span class="keywordflow">return<\/span> <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(level); <span class="comment">\/* Yay recursion! *\/<\/span>$/;"	a
l00354	doc/html/centralserver_8c-source.html	/^<a name="l00354"><\/a>00354                 }$/;"	a
l00355	doc/html/centralserver_8c-source.html	/^<a name="l00355"><\/a>00355                 <span class="keywordflow">else<\/span> {$/;"	a
l00356	doc/html/centralserver_8c-source.html	/^<a name="l00356"><\/a>00356                         <span class="comment">\/*<\/span>$/;"	a
l00357	doc/html/centralserver_8c-source.html	/^<a name="l00357"><\/a>00357 <span class="comment">                         * We have successfully connected<\/span>$/;"	a
l00358	doc/html/centralserver_8c-source.html	/^<a name="l00358"><\/a>00358 <span class="comment">                         *\/<\/span>$/;"	a
l00359	doc/html/centralserver_8c-source.html	/^<a name="l00359"><\/a>00359                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Successfully connected to auth server %s:%d"<\/span>, level, hostname, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>);$/;"	a
l00360	doc/html/centralserver_8c-source.html	/^<a name="l00360"><\/a>00360                         <span class="keywordflow">return<\/span> sockfd;$/;"	a
l00361	doc/html/centralserver_8c-source.html	/^<a name="l00361"><\/a>00361                 }$/;"	a
l00362	doc/html/centralserver_8c-source.html	/^<a name="l00362"><\/a>00362         }$/;"	a
l00363	doc/html/centralserver_8c-source.html	/^<a name="l00363"><\/a>00363 }$/;"	a
168b78813319c6f409394019fcf45f62	doc/html/centralserver_8c.html	/^<a class="anchor" name="168b78813319c6f409394019fcf45f62"><\/a><!-- doxytag: member="centralserver.c::connect_auth_server" ref="168b78813319c6f409394019fcf45f62" args="()" -->$/;"	a
5c562f637bd218d2f397e8b1d9eae656	doc/html/centralserver_8c.html	/^<a class="anchor" name="5c562f637bd218d2f397e8b1d9eae656"><\/a><!-- doxytag: member="centralserver.c::auth_server_request" ref="5c562f637bd218d2f397e8b1d9eae656" args="(t_authresponse *authresponse, const char *request_type, const char *ip, const char *mac, const char *token, unsigned long long int incoming, unsigned long long int outgoing)" -->$/;"	a
_details	doc/html/centralserver_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b374ff230d9977e6b952612d61689f39	doc/html/centralserver_8c.html	/^<a class="anchor" name="b374ff230d9977e6b952612d61689f39"><\/a><!-- doxytag: member="centralserver.c::config_mutex" ref="b374ff230d9977e6b952612d61689f39" args="" -->$/;"	a
e19e5fef3df77ca03ce69852f016fdc6	doc/html/centralserver_8c.html	/^<a class="anchor" name="e19e5fef3df77ca03ce69852f016fdc6"><\/a><!-- doxytag: member="centralserver.c::_connect_auth_server" ref="e19e5fef3df77ca03ce69852f016fdc6" args="(int level)" -->$/;"	a
l00001	doc/html/centralserver_8h-source.html	/^<h1>centralserver.h<\/h1><a href="centralserver_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/centralserver_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/centralserver_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/centralserver_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/centralserver_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/centralserver_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/centralserver_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/centralserver_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/centralserver_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/centralserver_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/centralserver_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/centralserver_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/centralserver_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/centralserver_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/centralserver_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/centralserver_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/centralserver_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/centralserver_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/centralserver_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/centralserver_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/centralserver_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: centralserver.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/centralserver_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _CENTRALSERVER_H_<\/span>$/;"	a
l00028	doc/html/centralserver_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _CENTRALSERVER_H_<\/span>$/;"	a
l00029	doc/html/centralserver_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/centralserver_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00031	doc/html/centralserver_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00033	doc/html/centralserver_8h-source.html	/^<a name="l00033"><\/a><a class="code" href="centralserver_8h.html#6fc858ffaac7b85a57a262f86febf5bf">00033<\/a> <span class="preprocessor">#define REQUEST_TYPE_LOGIN     "login"<\/span>$/;"	a
l00034	doc/html/centralserver_8h-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor"><\/span>$/;"	a
l00035	doc/html/centralserver_8h-source.html	/^<a name="l00035"><\/a><a class="code" href="centralserver_8h.html#b262747ac931a0a8c357448e7a2cf301">00035<\/a> <span class="preprocessor">#define REQUEST_TYPE_LOGOUT    "logout"<\/span>$/;"	a
l00036	doc/html/centralserver_8h-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor"><\/span>$/;"	a
l00037	doc/html/centralserver_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="centralserver_8h.html#3ebb2c04a3ef087a8956e171068759f7">00037<\/a> <span class="preprocessor">#define REQUEST_TYPE_COUNTERS  "counters"<\/span>$/;"	a
l00038	doc/html/centralserver_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor"><\/span>$/;"	a
l00040	doc/html/centralserver_8h-source.html	/^<a name="l00040"><\/a><a class="code" href="centralserver_8h.html#becb4a093d3aaf41645172f373acb4d7">00040<\/a> <span class="preprocessor">#define GATEWAY_MESSAGE_DENIED     "denied"<\/span>$/;"	a
l00041	doc/html/centralserver_8h-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor"><\/span>$/;"	a
l00042	doc/html/centralserver_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="centralserver_8h.html#46de6b10ed6b0269da637b1e6c96d128">00042<\/a> <span class="preprocessor">#define GATEWAY_MESSAGE_ACTIVATE_ACCOUNT     "activate"<\/span>$/;"	a
l00043	doc/html/centralserver_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor"><\/span>$/;"	a
l00044	doc/html/centralserver_8h-source.html	/^<a name="l00044"><\/a><a class="code" href="centralserver_8h.html#1a829447172cc69e643e77a2a64eaf23">00044<\/a> <span class="preprocessor">#define GATEWAY_MESSAGE_ACCOUNT_VALIDATION_FAILED     "failed_validation"<\/span>$/;"	a
l00045	doc/html/centralserver_8h-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor"><\/span>$/;"	a
l00046	doc/html/centralserver_8h-source.html	/^<a name="l00046"><\/a><a class="code" href="centralserver_8h.html#9aa808dd68665d6af8a050e22bb9e1c4">00046<\/a> <span class="preprocessor">#define GATEWAY_MESSAGE_ACCOUNT_LOGGED_OUT     "logged-out"<\/span>$/;"	a
l00047	doc/html/centralserver_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor"><\/span>$/;"	a
l00049	doc/html/centralserver_8h-source.html	/^<a name="l00049"><\/a>00049 <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0" title="Authentication codes returned by auth server.">t_authcode<\/a> <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(<a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a> *authresponse,$/;"	a
l00050	doc/html/centralserver_8h-source.html	/^<a name="l00050"><\/a>00050                         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *request_type,$/;"	a
l00051	doc/html/centralserver_8h-source.html	/^<a name="l00051"><\/a>00051                         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip,$/;"	a
l00052	doc/html/centralserver_8h-source.html	/^<a name="l00052"><\/a>00052                         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac,$/;"	a
l00053	doc/html/centralserver_8h-source.html	/^<a name="l00053"><\/a>00053                         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *token,$/;"	a
l00054	doc/html/centralserver_8h-source.html	/^<a name="l00054"><\/a>00054                         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> incoming,$/;"	a
l00055	doc/html/centralserver_8h-source.html	/^<a name="l00055"><\/a>00055                         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> outgoing);$/;"	a
l00056	doc/html/centralserver_8h-source.html	/^<a name="l00056"><\/a>00056 $/;"	a
l00058	doc/html/centralserver_8h-source.html	/^<a name="l00058"><\/a>00058 <span class="keywordtype">int<\/span> <a class="code" href="centralserver_8c.html#168b78813319c6f409394019fcf45f62" title="Tries really hard to connect to an auth server. Returns a connected file descriptor...">connect_auth_server<\/a>();$/;"	a
l00059	doc/html/centralserver_8h-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00061	doc/html/centralserver_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="keywordtype">int<\/span> <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(<span class="keywordtype">int<\/span> level);$/;"	a
l00062	doc/html/centralserver_8h-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00063	doc/html/centralserver_8h-source.html	/^<a name="l00063"><\/a>00063 <span class="preprocessor">#endif <\/span><span class="comment">\/* _CENTRALSERVER_H_ *\/<\/span>$/;"	a
168b78813319c6f409394019fcf45f62	doc/html/centralserver_8h.html	/^<a class="anchor" name="168b78813319c6f409394019fcf45f62"><\/a><!-- doxytag: member="centralserver.h::connect_auth_server" ref="168b78813319c6f409394019fcf45f62" args="()" -->$/;"	a
1a829447172cc69e643e77a2a64eaf23	doc/html/centralserver_8h.html	/^<a class="anchor" name="1a829447172cc69e643e77a2a64eaf23"><\/a><!-- doxytag: member="centralserver.h::GATEWAY_MESSAGE_ACCOUNT_VALIDATION_FAILED" ref="1a829447172cc69e643e77a2a64eaf23" args="" -->$/;"	a
3ebb2c04a3ef087a8956e171068759f7	doc/html/centralserver_8h.html	/^<a class="anchor" name="3ebb2c04a3ef087a8956e171068759f7"><\/a><!-- doxytag: member="centralserver.h::REQUEST_TYPE_COUNTERS" ref="3ebb2c04a3ef087a8956e171068759f7" args="" -->$/;"	a
46de6b10ed6b0269da637b1e6c96d128	doc/html/centralserver_8h.html	/^<a class="anchor" name="46de6b10ed6b0269da637b1e6c96d128"><\/a><!-- doxytag: member="centralserver.h::GATEWAY_MESSAGE_ACTIVATE_ACCOUNT" ref="46de6b10ed6b0269da637b1e6c96d128" args="" -->$/;"	a
5c562f637bd218d2f397e8b1d9eae656	doc/html/centralserver_8h.html	/^<a class="anchor" name="5c562f637bd218d2f397e8b1d9eae656"><\/a><!-- doxytag: member="centralserver.h::auth_server_request" ref="5c562f637bd218d2f397e8b1d9eae656" args="(t_authresponse *authresponse, const char *request_type, const char *ip, const char *mac, const char *token, unsigned long long int incoming, unsigned long long int outgoing)" -->$/;"	a
6fc858ffaac7b85a57a262f86febf5bf	doc/html/centralserver_8h.html	/^<a class="anchor" name="6fc858ffaac7b85a57a262f86febf5bf"><\/a><!-- doxytag: member="centralserver.h::REQUEST_TYPE_LOGIN" ref="6fc858ffaac7b85a57a262f86febf5bf" args="" -->$/;"	a
9aa808dd68665d6af8a050e22bb9e1c4	doc/html/centralserver_8h.html	/^<a class="anchor" name="9aa808dd68665d6af8a050e22bb9e1c4"><\/a><!-- doxytag: member="centralserver.h::GATEWAY_MESSAGE_ACCOUNT_LOGGED_OUT" ref="9aa808dd68665d6af8a050e22bb9e1c4" args="" -->$/;"	a
_details	doc/html/centralserver_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b262747ac931a0a8c357448e7a2cf301	doc/html/centralserver_8h.html	/^<a class="anchor" name="b262747ac931a0a8c357448e7a2cf301"><\/a><!-- doxytag: member="centralserver.h::REQUEST_TYPE_LOGOUT" ref="b262747ac931a0a8c357448e7a2cf301" args="" -->$/;"	a
becb4a093d3aaf41645172f373acb4d7	doc/html/centralserver_8h.html	/^<a class="anchor" name="becb4a093d3aaf41645172f373acb4d7"><\/a><!-- doxytag: member="centralserver.h::GATEWAY_MESSAGE_DENIED" ref="becb4a093d3aaf41645172f373acb4d7" args="" -->$/;"	a
e19e5fef3df77ca03ce69852f016fdc6	doc/html/centralserver_8h.html	/^<a class="anchor" name="e19e5fef3df77ca03ce69852f016fdc6"><\/a><!-- doxytag: member="centralserver.h::_connect_auth_server" ref="e19e5fef3df77ca03ce69852f016fdc6" args="(int level)" -->$/;"	a
l00001	doc/html/client__list_8c-source.html	/^<h1>client_list.c<\/h1><a href="client__list_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/client__list_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/client__list_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/client__list_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/client__list_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/client__list_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/client__list_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/client__list_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/client__list_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/client__list_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/client__list_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/client__list_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/client__list_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/client__list_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/client__list_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/client__list_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/client__list_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/client__list_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/client__list_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/client__list_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/client__list_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/*<\/span>$/;"	a
l00022	doc/html/client__list_8c-source.html	/^<a name="l00022"><\/a>00022 <span class="comment"> * $Id: client_list.c 1373 2008-09-30 09:27:40Z wichert $<\/span>$/;"	a
l00023	doc/html/client__list_8c-source.html	/^<a name="l00023"><\/a>00023 <span class="comment"> *\/<\/span>$/;"	a
l00029	doc/html/client__list_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00030	doc/html/client__list_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor"><\/span>$/;"	a
l00031	doc/html/client__list_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00032	doc/html/client__list_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00033	doc/html/client__list_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00034	doc/html/client__list_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00035	doc/html/client__list_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00036	doc/html/client__list_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;sys\/wait.h&gt;<\/span>$/;"	a
l00037	doc/html/client__list_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00038	doc/html/client__list_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;sys\/unistd.h&gt;<\/span>$/;"	a
l00039	doc/html/client__list_8c-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00040	doc/html/client__list_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00041	doc/html/client__list_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	doc/html/client__list_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00043	doc/html/client__list_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00044	doc/html/client__list_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00045	doc/html/client__list_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00046	doc/html/client__list_8c-source.html	/^<a name="l00046"><\/a>00046 $/;"	a
l00048	doc/html/client__list_8c-source.html	/^<a name="l00048"><\/a><a class="code" href="wdctl__thread_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">00048<\/a> pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a> = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00049	doc/html/client__list_8c-source.html	/^<a name="l00049"><\/a>00049 $/;"	a
l00053	doc/html/client__list_8c-source.html	/^<a name="l00053"><\/a>00053 <a class="code" href="struct__t__client.html">t_client<\/a>         *firstclient = NULL;$/;"	a
l00054	doc/html/client__list_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00057	doc/html/client__list_8c-source.html	/^<a name="l00057"><\/a>00057 <a class="code" href="struct__t__client.html">t_client<\/a> *$/;"	a
l00058	doc/html/client__list_8c-source.html	/^<a name="l00058"><\/a><a class="code" href="client__list_8h.html#4d619ca71763380120ec60d4f9c7d084">00058<\/a> <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00059	doc/html/client__list_8c-source.html	/^<a name="l00059"><\/a>00059 {$/;"	a
l00060	doc/html/client__list_8c-source.html	/^<a name="l00060"><\/a>00060     <span class="keywordflow">return<\/span> firstclient;$/;"	a
l00061	doc/html/client__list_8c-source.html	/^<a name="l00061"><\/a>00061 }$/;"	a
l00062	doc/html/client__list_8c-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00066	doc/html/client__list_8c-source.html	/^<a name="l00066"><\/a>00066 <span class="keywordtype">void<\/span>$/;"	a
l00067	doc/html/client__list_8c-source.html	/^<a name="l00067"><\/a><a class="code" href="client__list_8h.html#d624b5c33e086131f3af7b52589f5fd1">00067<\/a> <a class="code" href="client__list_8c.html#d624b5c33e086131f3af7b52589f5fd1" title="Initializes the client list.">client_list_init<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00068	doc/html/client__list_8c-source.html	/^<a name="l00068"><\/a>00068 {$/;"	a
l00069	doc/html/client__list_8c-source.html	/^<a name="l00069"><\/a>00069     firstclient = NULL;$/;"	a
l00070	doc/html/client__list_8c-source.html	/^<a name="l00070"><\/a>00070 }$/;"	a
l00071	doc/html/client__list_8c-source.html	/^<a name="l00071"><\/a>00071 $/;"	a
l00079	doc/html/client__list_8c-source.html	/^<a name="l00079"><\/a>00079 <a class="code" href="struct__t__client.html">t_client<\/a>         *$/;"	a
l00080	doc/html/client__list_8c-source.html	/^<a name="l00080"><\/a><a class="code" href="client__list_8h.html#65ad84da2af952d86d9ea8c326951911">00080<\/a> <a class="code" href="client__list_8c.html#65ad84da2af952d86d9ea8c326951911" title="Adds a new client to the connections list.">client_list_append<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *token)$/;"	a
l00081	doc/html/client__list_8c-source.html	/^<a name="l00081"><\/a>00081 {$/;"	a
l00082	doc/html/client__list_8c-source.html	/^<a name="l00082"><\/a>00082     <a class="code" href="struct__t__client.html">t_client<\/a>         *curclient, *prevclient;$/;"	a
l00083	doc/html/client__list_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	doc/html/client__list_8c-source.html	/^<a name="l00084"><\/a>00084     prevclient = NULL;$/;"	a
l00085	doc/html/client__list_8c-source.html	/^<a name="l00085"><\/a>00085     curclient = firstclient;$/;"	a
l00086	doc/html/client__list_8c-source.html	/^<a name="l00086"><\/a>00086 $/;"	a
l00087	doc/html/client__list_8c-source.html	/^<a name="l00087"><\/a>00087     <span class="keywordflow">while<\/span> (curclient != NULL) {$/;"	a
l00088	doc/html/client__list_8c-source.html	/^<a name="l00088"><\/a>00088         prevclient = curclient;$/;"	a
l00089	doc/html/client__list_8c-source.html	/^<a name="l00089"><\/a>00089         curclient = curclient-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00090	doc/html/client__list_8c-source.html	/^<a name="l00090"><\/a>00090     }$/;"	a
l00091	doc/html/client__list_8c-source.html	/^<a name="l00091"><\/a>00091 $/;"	a
l00092	doc/html/client__list_8c-source.html	/^<a name="l00092"><\/a>00092     curclient = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__t__client.html">t_client<\/a>));$/;"	a
l00093	doc/html/client__list_8c-source.html	/^<a name="l00093"><\/a>00093     memset(curclient, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__t__client.html">t_client<\/a>));$/;"	a
l00094	doc/html/client__list_8c-source.html	/^<a name="l00094"><\/a>00094 $/;"	a
l00095	doc/html/client__list_8c-source.html	/^<a name="l00095"><\/a>00095     curclient-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a> = safe_strdup(ip);$/;"	a
l00096	doc/html/client__list_8c-source.html	/^<a name="l00096"><\/a>00096     curclient-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a> = safe_strdup(mac);$/;"	a
l00097	doc/html/client__list_8c-source.html	/^<a name="l00097"><\/a>00097     curclient-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a> = safe_strdup(token);$/;"	a
l00098	doc/html/client__list_8c-source.html	/^<a name="l00098"><\/a>00098     curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> = curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a> = curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> = curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a> = 0;$/;"	a
l00099	doc/html/client__list_8c-source.html	/^<a name="l00099"><\/a>00099     curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a> = time(NULL);$/;"	a
l00100	doc/html/client__list_8c-source.html	/^<a name="l00100"><\/a>00100 $/;"	a
l00101	doc/html/client__list_8c-source.html	/^<a name="l00101"><\/a>00101     <span class="keywordflow">if<\/span> (prevclient == NULL) {$/;"	a
l00102	doc/html/client__list_8c-source.html	/^<a name="l00102"><\/a>00102         firstclient = curclient;$/;"	a
l00103	doc/html/client__list_8c-source.html	/^<a name="l00103"><\/a>00103     } <span class="keywordflow">else<\/span> {$/;"	a
l00104	doc/html/client__list_8c-source.html	/^<a name="l00104"><\/a>00104         prevclient-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> = curclient;$/;"	a
l00105	doc/html/client__list_8c-source.html	/^<a name="l00105"><\/a>00105     }$/;"	a
l00106	doc/html/client__list_8c-source.html	/^<a name="l00106"><\/a>00106 $/;"	a
l00107	doc/html/client__list_8c-source.html	/^<a name="l00107"><\/a>00107     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Added a new client to linked list: IP: %s Token: %s"<\/span>,$/;"	a
l00108	doc/html/client__list_8c-source.html	/^<a name="l00108"><\/a>00108           ip, token);$/;"	a
l00109	doc/html/client__list_8c-source.html	/^<a name="l00109"><\/a>00109 $/;"	a
l00110	doc/html/client__list_8c-source.html	/^<a name="l00110"><\/a>00110     <span class="keywordflow">return<\/span> curclient;$/;"	a
l00111	doc/html/client__list_8c-source.html	/^<a name="l00111"><\/a>00111 }$/;"	a
l00112	doc/html/client__list_8c-source.html	/^<a name="l00112"><\/a>00112 $/;"	a
l00119	doc/html/client__list_8c-source.html	/^<a name="l00119"><\/a>00119 <a class="code" href="struct__t__client.html">t_client<\/a>         *$/;"	a
l00120	doc/html/client__list_8c-source.html	/^<a name="l00120"><\/a><a class="code" href="client__list_8h.html#6ef7c0e44163b7ad9ed0353b095c1bbb">00120<\/a> <a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac)$/;"	a
l00121	doc/html/client__list_8c-source.html	/^<a name="l00121"><\/a>00121 {$/;"	a
l00122	doc/html/client__list_8c-source.html	/^<a name="l00122"><\/a>00122     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00123	doc/html/client__list_8c-source.html	/^<a name="l00123"><\/a>00123 $/;"	a
l00124	doc/html/client__list_8c-source.html	/^<a name="l00124"><\/a>00124     ptr = firstclient;$/;"	a
l00125	doc/html/client__list_8c-source.html	/^<a name="l00125"><\/a>00125     <span class="keywordflow">while<\/span> (NULL != ptr) {$/;"	a
l00126	doc/html/client__list_8c-source.html	/^<a name="l00126"><\/a>00126         <span class="keywordflow">if<\/span> (0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, ip) &amp;&amp; 0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, mac))$/;"	a
l00127	doc/html/client__list_8c-source.html	/^<a name="l00127"><\/a>00127             <span class="keywordflow">return<\/span> ptr;$/;"	a
l00128	doc/html/client__list_8c-source.html	/^<a name="l00128"><\/a>00128         ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00129	doc/html/client__list_8c-source.html	/^<a name="l00129"><\/a>00129     }$/;"	a
l00130	doc/html/client__list_8c-source.html	/^<a name="l00130"><\/a>00130 $/;"	a
l00131	doc/html/client__list_8c-source.html	/^<a name="l00131"><\/a>00131     <span class="keywordflow">return<\/span> NULL;$/;"	a
l00132	doc/html/client__list_8c-source.html	/^<a name="l00132"><\/a>00132 }$/;"	a
l00133	doc/html/client__list_8c-source.html	/^<a name="l00133"><\/a>00133 $/;"	a
l00140	doc/html/client__list_8c-source.html	/^<a name="l00140"><\/a>00140 <a class="code" href="struct__t__client.html">t_client<\/a>         *$/;"	a
l00141	doc/html/client__list_8c-source.html	/^<a name="l00141"><\/a><a class="code" href="client__list_8h.html#8d47e246eaa43b7e6216b0d698143dd3">00141<\/a> <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip)$/;"	a
l00142	doc/html/client__list_8c-source.html	/^<a name="l00142"><\/a>00142 {$/;"	a
l00143	doc/html/client__list_8c-source.html	/^<a name="l00143"><\/a>00143     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00144	doc/html/client__list_8c-source.html	/^<a name="l00144"><\/a>00144 $/;"	a
l00145	doc/html/client__list_8c-source.html	/^<a name="l00145"><\/a>00145     ptr = firstclient;$/;"	a
l00146	doc/html/client__list_8c-source.html	/^<a name="l00146"><\/a>00146     <span class="keywordflow">while<\/span> (NULL != ptr) {$/;"	a
l00147	doc/html/client__list_8c-source.html	/^<a name="l00147"><\/a>00147         <span class="keywordflow">if<\/span> (0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, ip))$/;"	a
l00148	doc/html/client__list_8c-source.html	/^<a name="l00148"><\/a>00148             <span class="keywordflow">return<\/span> ptr;$/;"	a
l00149	doc/html/client__list_8c-source.html	/^<a name="l00149"><\/a>00149         ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00150	doc/html/client__list_8c-source.html	/^<a name="l00150"><\/a>00150     }$/;"	a
l00151	doc/html/client__list_8c-source.html	/^<a name="l00151"><\/a>00151 $/;"	a
l00152	doc/html/client__list_8c-source.html	/^<a name="l00152"><\/a>00152     <span class="keywordflow">return<\/span> NULL;$/;"	a
l00153	doc/html/client__list_8c-source.html	/^<a name="l00153"><\/a>00153 }$/;"	a
l00154	doc/html/client__list_8c-source.html	/^<a name="l00154"><\/a>00154 $/;"	a
l00161	doc/html/client__list_8c-source.html	/^<a name="l00161"><\/a>00161 <a class="code" href="struct__t__client.html">t_client<\/a>         *$/;"	a
l00162	doc/html/client__list_8c-source.html	/^<a name="l00162"><\/a><a class="code" href="client__list_8h.html#5d741b8940ddeaa92f3b17c7fd1dab7b">00162<\/a> <a class="code" href="client__list_8c.html#5d741b8940ddeaa92f3b17c7fd1dab7b" title="Finds a client only by its Mac.">client_list_find_by_mac<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac)$/;"	a
l00163	doc/html/client__list_8c-source.html	/^<a name="l00163"><\/a>00163 {$/;"	a
l00164	doc/html/client__list_8c-source.html	/^<a name="l00164"><\/a>00164     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00165	doc/html/client__list_8c-source.html	/^<a name="l00165"><\/a>00165 $/;"	a
l00166	doc/html/client__list_8c-source.html	/^<a name="l00166"><\/a>00166     ptr = firstclient;$/;"	a
l00167	doc/html/client__list_8c-source.html	/^<a name="l00167"><\/a>00167     <span class="keywordflow">while<\/span> (NULL != ptr) {$/;"	a
l00168	doc/html/client__list_8c-source.html	/^<a name="l00168"><\/a>00168         <span class="keywordflow">if<\/span> (0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, mac))$/;"	a
l00169	doc/html/client__list_8c-source.html	/^<a name="l00169"><\/a>00169             <span class="keywordflow">return<\/span> ptr;$/;"	a
l00170	doc/html/client__list_8c-source.html	/^<a name="l00170"><\/a>00170         ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00171	doc/html/client__list_8c-source.html	/^<a name="l00171"><\/a>00171     }$/;"	a
l00172	doc/html/client__list_8c-source.html	/^<a name="l00172"><\/a>00172 $/;"	a
l00173	doc/html/client__list_8c-source.html	/^<a name="l00173"><\/a>00173     <span class="keywordflow">return<\/span> NULL;$/;"	a
l00174	doc/html/client__list_8c-source.html	/^<a name="l00174"><\/a>00174 }$/;"	a
l00175	doc/html/client__list_8c-source.html	/^<a name="l00175"><\/a>00175 $/;"	a
l00180	doc/html/client__list_8c-source.html	/^<a name="l00180"><\/a>00180 <a class="code" href="struct__t__client.html">t_client<\/a> *$/;"	a
l00181	doc/html/client__list_8c-source.html	/^<a name="l00181"><\/a><a class="code" href="client__list_8h.html#23155a3173c5be5b646686b61414ca62">00181<\/a> <a class="code" href="client__list_8c.html#23155a3173c5be5b646686b61414ca62" title="Finds a client by its token.">client_list_find_by_token<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *token)$/;"	a
l00182	doc/html/client__list_8c-source.html	/^<a name="l00182"><\/a>00182 {$/;"	a
l00183	doc/html/client__list_8c-source.html	/^<a name="l00183"><\/a>00183     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00184	doc/html/client__list_8c-source.html	/^<a name="l00184"><\/a>00184 $/;"	a
l00185	doc/html/client__list_8c-source.html	/^<a name="l00185"><\/a>00185     ptr = firstclient;$/;"	a
l00186	doc/html/client__list_8c-source.html	/^<a name="l00186"><\/a>00186     <span class="keywordflow">while<\/span> (NULL != ptr) {$/;"	a
l00187	doc/html/client__list_8c-source.html	/^<a name="l00187"><\/a>00187         <span class="keywordflow">if<\/span> (0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, token))$/;"	a
l00188	doc/html/client__list_8c-source.html	/^<a name="l00188"><\/a>00188             <span class="keywordflow">return<\/span> ptr;$/;"	a
l00189	doc/html/client__list_8c-source.html	/^<a name="l00189"><\/a>00189         ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00190	doc/html/client__list_8c-source.html	/^<a name="l00190"><\/a>00190     }$/;"	a
l00191	doc/html/client__list_8c-source.html	/^<a name="l00191"><\/a>00191 $/;"	a
l00192	doc/html/client__list_8c-source.html	/^<a name="l00192"><\/a>00192     <span class="keywordflow">return<\/span> NULL;$/;"	a
l00193	doc/html/client__list_8c-source.html	/^<a name="l00193"><\/a>00193 }$/;"	a
l00194	doc/html/client__list_8c-source.html	/^<a name="l00194"><\/a>00194 $/;"	a
l00201	doc/html/client__list_8c-source.html	/^<a name="l00201"><\/a>00201 <span class="keywordtype">void<\/span>$/;"	a
l00202	doc/html/client__list_8c-source.html	/^<a name="l00202"><\/a>00202 _client_list_free_node(<a class="code" href="struct__t__client.html">t_client<\/a> * client)$/;"	a
l00203	doc/html/client__list_8c-source.html	/^<a name="l00203"><\/a>00203 {$/;"	a
l00204	doc/html/client__list_8c-source.html	/^<a name="l00204"><\/a>00204 $/;"	a
l00205	doc/html/client__list_8c-source.html	/^<a name="l00205"><\/a>00205     <span class="keywordflow">if<\/span> (client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a> != NULL)$/;"	a
l00206	doc/html/client__list_8c-source.html	/^<a name="l00206"><\/a>00206         free(client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00207	doc/html/client__list_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	doc/html/client__list_8c-source.html	/^<a name="l00208"><\/a>00208     <span class="keywordflow">if<\/span> (client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a> != NULL)$/;"	a
l00209	doc/html/client__list_8c-source.html	/^<a name="l00209"><\/a>00209         free(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00210	doc/html/client__list_8c-source.html	/^<a name="l00210"><\/a>00210 $/;"	a
l00211	doc/html/client__list_8c-source.html	/^<a name="l00211"><\/a>00211     <span class="keywordflow">if<\/span> (client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a> != NULL)$/;"	a
l00212	doc/html/client__list_8c-source.html	/^<a name="l00212"><\/a>00212         free(client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00213	doc/html/client__list_8c-source.html	/^<a name="l00213"><\/a>00213 $/;"	a
l00214	doc/html/client__list_8c-source.html	/^<a name="l00214"><\/a>00214     free(client);$/;"	a
l00215	doc/html/client__list_8c-source.html	/^<a name="l00215"><\/a>00215 }$/;"	a
l00216	doc/html/client__list_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00224	doc/html/client__list_8c-source.html	/^<a name="l00224"><\/a>00224 <span class="keywordtype">void<\/span>$/;"	a
l00225	doc/html/client__list_8c-source.html	/^<a name="l00225"><\/a><a class="code" href="client__list_8h.html#6cb127e61a08a2910438c8d91272616a">00225<\/a> <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(<a class="code" href="struct__t__client.html">t_client<\/a> * client)$/;"	a
l00226	doc/html/client__list_8c-source.html	/^<a name="l00226"><\/a>00226 {$/;"	a
l00227	doc/html/client__list_8c-source.html	/^<a name="l00227"><\/a>00227     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00228	doc/html/client__list_8c-source.html	/^<a name="l00228"><\/a>00228 $/;"	a
l00229	doc/html/client__list_8c-source.html	/^<a name="l00229"><\/a>00229     ptr = firstclient;$/;"	a
l00230	doc/html/client__list_8c-source.html	/^<a name="l00230"><\/a>00230 $/;"	a
l00231	doc/html/client__list_8c-source.html	/^<a name="l00231"><\/a>00231     <span class="keywordflow">if<\/span> (ptr == NULL) {$/;"	a
l00232	doc/html/client__list_8c-source.html	/^<a name="l00232"><\/a>00232         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Node list empty!"<\/span>);$/;"	a
l00233	doc/html/client__list_8c-source.html	/^<a name="l00233"><\/a>00233     } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (ptr == client) {$/;"	a
l00234	doc/html/client__list_8c-source.html	/^<a name="l00234"><\/a>00234         firstclient = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00235	doc/html/client__list_8c-source.html	/^<a name="l00235"><\/a>00235         _client_list_free_node(client);$/;"	a
l00236	doc/html/client__list_8c-source.html	/^<a name="l00236"><\/a>00236     } <span class="keywordflow">else<\/span> {$/;"	a
l00237	doc/html/client__list_8c-source.html	/^<a name="l00237"><\/a>00237         <span class="comment">\/* Loop forward until we reach our point in the list. *\/<\/span>$/;"	a
l00238	doc/html/client__list_8c-source.html	/^<a name="l00238"><\/a>00238         <span class="keywordflow">while<\/span> (ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> != NULL &amp;&amp; ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> != client) {$/;"	a
l00239	doc/html/client__list_8c-source.html	/^<a name="l00239"><\/a>00239             ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00240	doc/html/client__list_8c-source.html	/^<a name="l00240"><\/a>00240         }$/;"	a
l00241	doc/html/client__list_8c-source.html	/^<a name="l00241"><\/a>00241         <span class="comment">\/* If we reach the end before finding out element, complain. *\/<\/span>$/;"	a
l00242	doc/html/client__list_8c-source.html	/^<a name="l00242"><\/a>00242         <span class="keywordflow">if<\/span> (ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> == NULL) {$/;"	a
l00243	doc/html/client__list_8c-source.html	/^<a name="l00243"><\/a>00243             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Node to delete could not be found."<\/span>);$/;"	a
l00244	doc/html/client__list_8c-source.html	/^<a name="l00244"><\/a>00244         <span class="comment">\/* Free element. *\/<\/span>$/;"	a
l00245	doc/html/client__list_8c-source.html	/^<a name="l00245"><\/a>00245         } <span class="keywordflow">else<\/span> {$/;"	a
l00246	doc/html/client__list_8c-source.html	/^<a name="l00246"><\/a>00246             ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> = client-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00247	doc/html/client__list_8c-source.html	/^<a name="l00247"><\/a>00247             _client_list_free_node(client);$/;"	a
l00248	doc/html/client__list_8c-source.html	/^<a name="l00248"><\/a>00248         }$/;"	a
l00249	doc/html/client__list_8c-source.html	/^<a name="l00249"><\/a>00249     }$/;"	a
l00250	doc/html/client__list_8c-source.html	/^<a name="l00250"><\/a>00250 }$/;"	a
23155a3173c5be5b646686b61414ca62	doc/html/client__list_8c.html	/^<a class="anchor" name="23155a3173c5be5b646686b61414ca62"><\/a><!-- doxytag: member="client_list.c::client_list_find_by_token" ref="23155a3173c5be5b646686b61414ca62" args="(const char *token)" -->$/;"	a
2ed4f40f55bdc1314fe84ad835708be9	doc/html/client__list_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2ed4f40f55bdc1314fe84ad835708be9"><\/a><!-- doxytag: member="client_list.c::firstclient" ref="2ed4f40f55bdc1314fe84ad835708be9" args="" -->$/;"	a
4d619ca71763380120ec60d4f9c7d084	doc/html/client__list_8c.html	/^<a class="anchor" name="4d619ca71763380120ec60d4f9c7d084"><\/a><!-- doxytag: member="client_list.c::client_get_first_client" ref="4d619ca71763380120ec60d4f9c7d084" args="(void)" -->$/;"	a
5d741b8940ddeaa92f3b17c7fd1dab7b	doc/html/client__list_8c.html	/^<a class="anchor" name="5d741b8940ddeaa92f3b17c7fd1dab7b"><\/a><!-- doxytag: member="client_list.c::client_list_find_by_mac" ref="5d741b8940ddeaa92f3b17c7fd1dab7b" args="(const char *mac)" -->$/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	doc/html/client__list_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="client_list.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
65ad84da2af952d86d9ea8c326951911	doc/html/client__list_8c.html	/^<a class="anchor" name="65ad84da2af952d86d9ea8c326951911"><\/a><!-- doxytag: member="client_list.c::client_list_append" ref="65ad84da2af952d86d9ea8c326951911" args="(const char *ip, const char *mac, const char *token)" -->$/;"	a
6cb127e61a08a2910438c8d91272616a	doc/html/client__list_8c.html	/^<a class="anchor" name="6cb127e61a08a2910438c8d91272616a"><\/a><!-- doxytag: member="client_list.c::client_list_delete" ref="6cb127e61a08a2910438c8d91272616a" args="(t_client *client)" -->$/;"	a
6ef7c0e44163b7ad9ed0353b095c1bbb	doc/html/client__list_8c.html	/^<a class="anchor" name="6ef7c0e44163b7ad9ed0353b095c1bbb"><\/a><!-- doxytag: member="client_list.c::client_list_find" ref="6ef7c0e44163b7ad9ed0353b095c1bbb" args="(const char *ip, const char *mac)" -->$/;"	a
8d47e246eaa43b7e6216b0d698143dd3	doc/html/client__list_8c.html	/^<a class="anchor" name="8d47e246eaa43b7e6216b0d698143dd3"><\/a><!-- doxytag: member="client_list.c::client_list_find_by_ip" ref="8d47e246eaa43b7e6216b0d698143dd3" args="(const char *ip)" -->$/;"	a
_details	doc/html/client__list_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
cf3a49fca65510729cdefb2be7c1c45e	doc/html/client__list_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cf3a49fca65510729cdefb2be7c1c45e"><\/a><!-- doxytag: member="client_list.c::_client_list_free_node" ref="cf3a49fca65510729cdefb2be7c1c45e" args="(t_client *client)" -->$/;"	a
d624b5c33e086131f3af7b52589f5fd1	doc/html/client__list_8c.html	/^<a class="anchor" name="d624b5c33e086131f3af7b52589f5fd1"><\/a><!-- doxytag: member="client_list.c::client_list_init" ref="d624b5c33e086131f3af7b52589f5fd1" args="(void)" -->$/;"	a
l00001	doc/html/client__list_8h-source.html	/^<h1>client_list.h<\/h1><a href="client__list_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/client__list_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/client__list_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/client__list_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/client__list_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/client__list_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/client__list_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/client__list_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/client__list_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/client__list_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/client__list_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/client__list_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/client__list_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/client__list_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/client__list_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/client__list_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/client__list_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/client__list_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/client__list_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/client__list_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/client__list_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: client_list.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/client__list_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _CLIENT_LIST_H_<\/span>$/;"	a
l00028	doc/html/client__list_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _CLIENT_LIST_H_<\/span>$/;"	a
l00029	doc/html/client__list_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00032	doc/html/client__list_8h-source.html	/^<a name="l00032"><\/a><a class="code" href="struct__t__counters.html">00032<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__t__counters.html">_t_counters<\/a> {$/;"	a
l00033	doc/html/client__list_8h-source.html	/^<a name="l00033"><\/a><a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063">00033<\/a>     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>  <a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>;       $/;"	a
l00034	doc/html/client__list_8h-source.html	/^<a name="l00034"><\/a><a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d">00034<\/a>     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>  <a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>;       $/;"	a
l00035	doc/html/client__list_8h-source.html	/^<a name="l00035"><\/a><a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9">00035<\/a>     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>  <a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a>;       $/;"	a
l00036	doc/html/client__list_8h-source.html	/^<a name="l00036"><\/a><a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba">00036<\/a>     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>  <a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a>;       $/;"	a
l00037	doc/html/client__list_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1">00037<\/a>     time_t      <a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>;   $/;"	a
l00038	doc/html/client__list_8h-source.html	/^<a name="l00038"><\/a>00038 } <a class="code" href="struct__t__counters.html">t_counters<\/a>;$/;"	a
l00039	doc/html/client__list_8h-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00042	doc/html/client__list_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="struct__t__client.html">00042<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct  <\/span><a class="code" href="struct__t__client.html">_t_client<\/a> {$/;"	a
l00043	doc/html/client__list_8h-source.html	/^<a name="l00043"><\/a><a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082">00043<\/a>   <span class="keyword">struct        <\/span><a class="code" href="struct__t__client.html">_t_client<\/a> *<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;        $/;"	a
l00044	doc/html/client__list_8h-source.html	/^<a name="l00044"><\/a><a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82">00044<\/a>         <span class="keywordtype">char<\/span>    *<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>;                    $/;"	a
l00045	doc/html/client__list_8h-source.html	/^<a name="l00045"><\/a><a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b">00045<\/a>         <span class="keywordtype">char<\/span>    *<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>;                   $/;"	a
l00046	doc/html/client__list_8h-source.html	/^<a name="l00046"><\/a><a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad">00046<\/a>         <span class="keywordtype">char<\/span>    *<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>;                 $/;"	a
l00047	doc/html/client__list_8h-source.html	/^<a name="l00047"><\/a><a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15">00047<\/a>         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span> <a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>; $/;"	a
l00049	doc/html/client__list_8h-source.html	/^<a name="l00049"><\/a><a class="code" href="struct__t__client.html#495baef8f1dc90c94c24561ebd61140d">00049<\/a>         <span class="keywordtype">int<\/span>     <a class="code" href="struct__t__client.html#495baef8f1dc90c94c24561ebd61140d" title="Client HTTP socket (valid only during login before one of the _http_* function is...">fd<\/a>;                     $/;"	a
l00052	doc/html/client__list_8h-source.html	/^<a name="l00052"><\/a><a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1">00052<\/a>         <a class="code" href="struct__t__counters.html">t_counters<\/a>      <a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>;       $/;"	a
l00054	doc/html/client__list_8h-source.html	/^<a name="l00054"><\/a>00054 } <a class="code" href="struct__t__client.html">t_client<\/a>;$/;"	a
l00055	doc/html/client__list_8h-source.html	/^<a name="l00055"><\/a>00055 $/;"	a
l00058	doc/html/client__list_8h-source.html	/^<a name="l00058"><\/a>00058 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00059	doc/html/client__list_8h-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00061	doc/html/client__list_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="keywordtype">void<\/span> <a class="code" href="client__list_8c.html#d624b5c33e086131f3af7b52589f5fd1" title="Initializes the client list.">client_list_init<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00062	doc/html/client__list_8h-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00064	doc/html/client__list_8h-source.html	/^<a name="l00064"><\/a>00064 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#65ad84da2af952d86d9ea8c326951911" title="Adds a new client to the connections list.">client_list_append<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00065	doc/html/client__list_8h-source.html	/^<a name="l00065"><\/a>00065 $/;"	a
l00067	doc/html/client__list_8h-source.html	/^<a name="l00067"><\/a>00067 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00068	doc/html/client__list_8h-source.html	/^<a name="l00068"><\/a>00068 $/;"	a
l00070	doc/html/client__list_8h-source.html	/^<a name="l00070"><\/a>00070 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>); <span class="comment">\/* needed by fw_iptables.c, auth.c <\/span>$/;"	a
l00071	doc/html/client__list_8h-source.html	/^<a name="l00071"><\/a>00071 <span class="comment">                                             * and wdctl_thread.c *\/<\/span>$/;"	a
l00072	doc/html/client__list_8h-source.html	/^<a name="l00072"><\/a>00072 $/;"	a
l00074	doc/html/client__list_8h-source.html	/^<a name="l00074"><\/a>00074 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#5d741b8940ddeaa92f3b17c7fd1dab7b" title="Finds a client only by its Mac.">client_list_find_by_mac<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>); <span class="comment">\/* needed by wdctl_thread.c *\/<\/span>$/;"	a
l00075	doc/html/client__list_8h-source.html	/^<a name="l00075"><\/a>00075 $/;"	a
l00077	doc/html/client__list_8h-source.html	/^<a name="l00077"><\/a>00077 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#23155a3173c5be5b646686b61414ca62" title="Finds a client by its token.">client_list_find_by_token<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00078	doc/html/client__list_8h-source.html	/^<a name="l00078"><\/a>00078 $/;"	a
l00080	doc/html/client__list_8h-source.html	/^<a name="l00080"><\/a>00080 <span class="keywordtype">void<\/span> <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(<a class="code" href="struct__t__client.html">t_client<\/a> *client);$/;"	a
l00081	doc/html/client__list_8h-source.html	/^<a name="l00081"><\/a>00081 $/;"	a
l00082	doc/html/client__list_8h-source.html	/^<a name="l00082"><\/a>00082 <span class="preprocessor">#define LOCK_CLIENT_LIST() do { \\<\/span>$/;"	a
l00083	doc/html/client__list_8h-source.html	/^<a name="l00083"><\/a>00083 <span class="preprocessor">        debug(LOG_DEBUG, "Locking client list"); \\<\/span>$/;"	a
l00084	doc/html/client__list_8h-source.html	/^<a name="l00084"><\/a>00084 <span class="preprocessor">        pthread_mutex_lock(&amp;client_list_mutex); \\<\/span>$/;"	a
l00085	doc/html/client__list_8h-source.html	/^<a name="l00085"><\/a>00085 <span class="preprocessor">        debug(LOG_DEBUG, "Client list locked"); \\<\/span>$/;"	a
l00086	doc/html/client__list_8h-source.html	/^<a name="l00086"><\/a>00086 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00087	doc/html/client__list_8h-source.html	/^<a name="l00087"><\/a>00087 <span class="preprocessor"><\/span>$/;"	a
l00088	doc/html/client__list_8h-source.html	/^<a name="l00088"><\/a>00088 <span class="preprocessor">#define UNLOCK_CLIENT_LIST() do { \\<\/span>$/;"	a
l00089	doc/html/client__list_8h-source.html	/^<a name="l00089"><\/a>00089 <span class="preprocessor">        debug(LOG_DEBUG, "Unlocking client list"); \\<\/span>$/;"	a
l00090	doc/html/client__list_8h-source.html	/^<a name="l00090"><\/a>00090 <span class="preprocessor">        pthread_mutex_unlock(&amp;client_list_mutex); \\<\/span>$/;"	a
l00091	doc/html/client__list_8h-source.html	/^<a name="l00091"><\/a>00091 <span class="preprocessor">        debug(LOG_DEBUG, "Client list unlocked"); \\<\/span>$/;"	a
l00092	doc/html/client__list_8h-source.html	/^<a name="l00092"><\/a>00092 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00093	doc/html/client__list_8h-source.html	/^<a name="l00093"><\/a>00093 <span class="preprocessor"><\/span>$/;"	a
l00094	doc/html/client__list_8h-source.html	/^<a name="l00094"><\/a>00094 <span class="preprocessor">#endif <\/span><span class="comment">\/* _CLIENT_LIST_H_ *\/<\/span>$/;"	a
010e96c8cbdfb080d09b5822c5cccbf7	doc/html/client__list_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="010e96c8cbdfb080d09b5822c5cccbf7"><\/a><!-- doxytag: member="client_list.h::t_client" ref="010e96c8cbdfb080d09b5822c5cccbf7" args="" -->$/;"	a
23155a3173c5be5b646686b61414ca62	doc/html/client__list_8h.html	/^<a class="anchor" name="23155a3173c5be5b646686b61414ca62"><\/a><!-- doxytag: member="client_list.h::client_list_find_by_token" ref="23155a3173c5be5b646686b61414ca62" args="(const char *token)" -->$/;"	a
4d619ca71763380120ec60d4f9c7d084	doc/html/client__list_8h.html	/^<a class="anchor" name="4d619ca71763380120ec60d4f9c7d084"><\/a><!-- doxytag: member="client_list.h::client_get_first_client" ref="4d619ca71763380120ec60d4f9c7d084" args="(void)" -->$/;"	a
4f5775440c8c60a619bb0dc6eefd9955	doc/html/client__list_8h.html	/^<a class="anchor" name="4f5775440c8c60a619bb0dc6eefd9955"><\/a><!-- doxytag: member="client_list.h::UNLOCK_CLIENT_LIST" ref="4f5775440c8c60a619bb0dc6eefd9955" args="()" -->$/;"	a
5d741b8940ddeaa92f3b17c7fd1dab7b	doc/html/client__list_8h.html	/^<a class="anchor" name="5d741b8940ddeaa92f3b17c7fd1dab7b"><\/a><!-- doxytag: member="client_list.h::client_list_find_by_mac" ref="5d741b8940ddeaa92f3b17c7fd1dab7b" args="(const char *mac)" -->$/;"	a
65ad84da2af952d86d9ea8c326951911	doc/html/client__list_8h.html	/^<a class="anchor" name="65ad84da2af952d86d9ea8c326951911"><\/a><!-- doxytag: member="client_list.h::client_list_append" ref="65ad84da2af952d86d9ea8c326951911" args="(const char *ip, const char *mac, const char *token)" -->$/;"	a
6cb127e61a08a2910438c8d91272616a	doc/html/client__list_8h.html	/^<a class="anchor" name="6cb127e61a08a2910438c8d91272616a"><\/a><!-- doxytag: member="client_list.h::client_list_delete" ref="6cb127e61a08a2910438c8d91272616a" args="(t_client *client)" -->$/;"	a
6ef7c0e44163b7ad9ed0353b095c1bbb	doc/html/client__list_8h.html	/^<a class="anchor" name="6ef7c0e44163b7ad9ed0353b095c1bbb"><\/a><!-- doxytag: member="client_list.h::client_list_find" ref="6ef7c0e44163b7ad9ed0353b095c1bbb" args="(const char *ip, const char *mac)" -->$/;"	a
854b711d92cda6b6567b46e5ba5585da	doc/html/client__list_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="854b711d92cda6b6567b46e5ba5585da"><\/a><!-- doxytag: member="client_list.h::t_counters" ref="854b711d92cda6b6567b46e5ba5585da" args="" -->$/;"	a
8d47e246eaa43b7e6216b0d698143dd3	doc/html/client__list_8h.html	/^<a class="anchor" name="8d47e246eaa43b7e6216b0d698143dd3"><\/a><!-- doxytag: member="client_list.h::client_list_find_by_ip" ref="8d47e246eaa43b7e6216b0d698143dd3" args="(const char *ip)" -->$/;"	a
_details	doc/html/client__list_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
c5c31895744019997451a4f325a59cd1	doc/html/client__list_8h.html	/^<a class="anchor" name="c5c31895744019997451a4f325a59cd1"><\/a><!-- doxytag: member="client_list.h::LOCK_CLIENT_LIST" ref="c5c31895744019997451a4f325a59cd1" args="()" -->$/;"	a
d624b5c33e086131f3af7b52589f5fd1	doc/html/client__list_8h.html	/^<a class="anchor" name="d624b5c33e086131f3af7b52589f5fd1"><\/a><!-- doxytag: member="client_list.h::client_list_init" ref="d624b5c33e086131f3af7b52589f5fd1" args="(void)" -->$/;"	a
l00001	doc/html/commandline_8c-source.html	/^<h1>commandline.c<\/h1><a href="commandline_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/commandline_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/commandline_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/commandline_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/commandline_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/commandline_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/commandline_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/commandline_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/commandline_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/commandline_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/commandline_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/commandline_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/commandline_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/commandline_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/commandline_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/commandline_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/commandline_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/commandline_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/commandline_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/commandline_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/commandline_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: commandline.c 935 2006-02-01 03:22:04Z benoitg $ *\/<\/span>$/;"	a
l00027	doc/html/commandline_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00028	doc/html/commandline_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00029	doc/html/commandline_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00030	doc/html/commandline_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00031	doc/html/commandline_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00032	doc/html/commandline_8c-source.html	/^<a name="l00032"><\/a>00032 $/;"	a
l00033	doc/html/commandline_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00034	doc/html/commandline_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00035	doc/html/commandline_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00036	doc/html/commandline_8c-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	doc/html/commandline_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00038	doc/html/commandline_8c-source.html	/^<a name="l00038"><\/a>00038 $/;"	a
l00039	doc/html/commandline_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="comment">\/*<\/span>$/;"	a
l00040	doc/html/commandline_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="comment"> * Holds an argv that could be passed to exec*() if we restart ourselves<\/span>$/;"	a
l00041	doc/html/commandline_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="comment"> *\/<\/span>$/;"	a
l00042	doc/html/commandline_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="keywordtype">char<\/span> ** restartargv = NULL;$/;"	a
l00043	doc/html/commandline_8c-source.html	/^<a name="l00043"><\/a>00043 $/;"	a
l00044	doc/html/commandline_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> usage(<span class="keywordtype">void<\/span>);$/;"	a
l00045	doc/html/commandline_8c-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	doc/html/commandline_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="comment">\/*<\/span>$/;"	a
l00047	doc/html/commandline_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="comment"> * A flag to denote whether we were restarted via a parent wifidog, or started normally<\/span>$/;"	a
l00048	doc/html/commandline_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="comment"> * 0 means normally, otherwise it will be populated by the PID of the parent<\/span>$/;"	a
l00049	doc/html/commandline_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="comment"> *\/<\/span>$/;"	a
l00050	doc/html/commandline_8c-source.html	/^<a name="l00050"><\/a>00050 pid_t restart_orig_pid = 0;$/;"	a
l00051	doc/html/commandline_8c-source.html	/^<a name="l00051"><\/a>00051 $/;"	a
l00057	doc/html/commandline_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00058	doc/html/commandline_8c-source.html	/^<a name="l00058"><\/a>00058 usage(<span class="keywordtype">void<\/span>)$/;"	a
l00059	doc/html/commandline_8c-source.html	/^<a name="l00059"><\/a>00059 {$/;"	a
l00060	doc/html/commandline_8c-source.html	/^<a name="l00060"><\/a>00060     printf(<span class="stringliteral">"Usage: wifidog [options]\\n"<\/span>);$/;"	a
l00061	doc/html/commandline_8c-source.html	/^<a name="l00061"><\/a>00061     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00062	doc/html/commandline_8c-source.html	/^<a name="l00062"><\/a>00062     printf(<span class="stringliteral">"  -c [filename] Use this config file\\n"<\/span>);$/;"	a
l00063	doc/html/commandline_8c-source.html	/^<a name="l00063"><\/a>00063     printf(<span class="stringliteral">"  -f            Run in foreground\\n"<\/span>);$/;"	a
l00064	doc/html/commandline_8c-source.html	/^<a name="l00064"><\/a>00064     printf(<span class="stringliteral">"  -d &lt;level&gt;    Debug level\\n"<\/span>);$/;"	a
l00065	doc/html/commandline_8c-source.html	/^<a name="l00065"><\/a>00065     printf(<span class="stringliteral">"  -s            Log to syslog\\n"<\/span>);$/;"	a
l00066	doc/html/commandline_8c-source.html	/^<a name="l00066"><\/a>00066     printf(<span class="stringliteral">"  -w &lt;path&gt;     Wdctl socket path\\n"<\/span>);$/;"	a
l00067	doc/html/commandline_8c-source.html	/^<a name="l00067"><\/a>00067     printf(<span class="stringliteral">"  -h            Print usage\\n"<\/span>);$/;"	a
l00068	doc/html/commandline_8c-source.html	/^<a name="l00068"><\/a>00068     printf(<span class="stringliteral">"  -v            Print version information\\n"<\/span>);$/;"	a
l00069	doc/html/commandline_8c-source.html	/^<a name="l00069"><\/a>00069     printf(<span class="stringliteral">"  -x pid        Used internally by WiFiDog when re-starting itself *DO NOT ISSUE THIS SWITCH MANUAlLY*\\n"<\/span>);$/;"	a
l00070	doc/html/commandline_8c-source.html	/^<a name="l00070"><\/a>00070     printf(<span class="stringliteral">"  -i &lt;path&gt;     Internal socket path used when re-starting self\\n"<\/span>);$/;"	a
l00071	doc/html/commandline_8c-source.html	/^<a name="l00071"><\/a>00071     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00072	doc/html/commandline_8c-source.html	/^<a name="l00072"><\/a>00072 }$/;"	a
l00073	doc/html/commandline_8c-source.html	/^<a name="l00073"><\/a>00073 $/;"	a
l00077	doc/html/commandline_8c-source.html	/^<a name="l00077"><\/a><a class="code" href="wdctl_8c.html#0cebabb746a51732ec95bf81af215b63">00077<\/a> <span class="keywordtype">void<\/span> <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(<span class="keywordtype">int<\/span> argc, <span class="keywordtype">char<\/span> **argv) {$/;"	a
l00078	doc/html/commandline_8c-source.html	/^<a name="l00078"><\/a>00078     <span class="keywordtype">int<\/span> c;$/;"	a
l00079	doc/html/commandline_8c-source.html	/^<a name="l00079"><\/a>00079          <span class="keywordtype">int<\/span> skiponrestart;$/;"	a
l00080	doc/html/commandline_8c-source.html	/^<a name="l00080"><\/a>00080          <span class="keywordtype">int<\/span> i;$/;"	a
l00081	doc/html/commandline_8c-source.html	/^<a name="l00081"><\/a>00081 $/;"	a
l00082	doc/html/commandline_8c-source.html	/^<a name="l00082"><\/a>00082     <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00083	doc/html/commandline_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	doc/html/commandline_8c-source.html	/^<a name="l00084"><\/a>00084         <span class="comment">\/\/MAGIC 3: Our own -x, the pid, and NULL :<\/span>$/;"	a
l00085	doc/html/commandline_8c-source.html	/^<a name="l00085"><\/a>00085         restartargv = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>((argc + 3) * <span class="keyword">sizeof<\/span>(<span class="keywordtype">char<\/span>*));$/;"	a
l00086	doc/html/commandline_8c-source.html	/^<a name="l00086"><\/a>00086         i=0;$/;"	a
l00087	doc/html/commandline_8c-source.html	/^<a name="l00087"><\/a>00087         restartargv[i++] = safe_strdup(argv[0]);$/;"	a
l00088	doc/html/commandline_8c-source.html	/^<a name="l00088"><\/a>00088 $/;"	a
l00089	doc/html/commandline_8c-source.html	/^<a name="l00089"><\/a>00089     <span class="keywordflow">while<\/span> (-1 != (c = getopt(argc, argv, <span class="stringliteral">"c:hfd:sw:vx:i:"<\/span>))) {$/;"	a
l00090	doc/html/commandline_8c-source.html	/^<a name="l00090"><\/a>00090 $/;"	a
l00091	doc/html/commandline_8c-source.html	/^<a name="l00091"><\/a>00091                 skiponrestart = 0;$/;"	a
l00092	doc/html/commandline_8c-source.html	/^<a name="l00092"><\/a>00092 $/;"	a
l00093	doc/html/commandline_8c-source.html	/^<a name="l00093"><\/a>00093                 <span class="keywordflow">switch<\/span>(c) {$/;"	a
l00094	doc/html/commandline_8c-source.html	/^<a name="l00094"><\/a>00094 $/;"	a
l00095	doc/html/commandline_8c-source.html	/^<a name="l00095"><\/a>00095                         <span class="keywordflow">case<\/span> <span class="charliteral">'h'<\/span>:$/;"	a
l00096	doc/html/commandline_8c-source.html	/^<a name="l00096"><\/a>00096                                 usage();$/;"	a
l00097	doc/html/commandline_8c-source.html	/^<a name="l00097"><\/a>00097                                 exit(1);$/;"	a
l00098	doc/html/commandline_8c-source.html	/^<a name="l00098"><\/a>00098                                 <span class="keywordflow">break<\/span>;$/;"	a
l00099	doc/html/commandline_8c-source.html	/^<a name="l00099"><\/a>00099 $/;"	a
l00100	doc/html/commandline_8c-source.html	/^<a name="l00100"><\/a>00100                         <span class="keywordflow">case<\/span> <span class="charliteral">'c'<\/span>:$/;"	a
l00101	doc/html/commandline_8c-source.html	/^<a name="l00101"><\/a>00101                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00102	doc/html/commandline_8c-source.html	/^<a name="l00102"><\/a>00102                                         strncpy(config-&gt;<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>, optarg, <span class="keyword">sizeof<\/span>(config-&gt;<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>));$/;"	a
l00103	doc/html/commandline_8c-source.html	/^<a name="l00103"><\/a>00103                                 }$/;"	a
l00104	doc/html/commandline_8c-source.html	/^<a name="l00104"><\/a>00104                                 <span class="keywordflow">break<\/span>;$/;"	a
l00105	doc/html/commandline_8c-source.html	/^<a name="l00105"><\/a>00105 $/;"	a
l00106	doc/html/commandline_8c-source.html	/^<a name="l00106"><\/a>00106                         <span class="keywordflow">case<\/span> <span class="charliteral">'w'<\/span>:$/;"	a
l00107	doc/html/commandline_8c-source.html	/^<a name="l00107"><\/a>00107                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00108	doc/html/commandline_8c-source.html	/^<a name="l00108"><\/a>00108                                         free(config-&gt;<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a>);$/;"	a
l00109	doc/html/commandline_8c-source.html	/^<a name="l00109"><\/a>00109                                         config-&gt;<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a> = safe_strdup(optarg);$/;"	a
l00110	doc/html/commandline_8c-source.html	/^<a name="l00110"><\/a>00110                                 }$/;"	a
l00111	doc/html/commandline_8c-source.html	/^<a name="l00111"><\/a>00111                                 <span class="keywordflow">break<\/span>;$/;"	a
l00112	doc/html/commandline_8c-source.html	/^<a name="l00112"><\/a>00112 $/;"	a
l00113	doc/html/commandline_8c-source.html	/^<a name="l00113"><\/a>00113                         <span class="keywordflow">case<\/span> <span class="charliteral">'f'<\/span>:$/;"	a
l00114	doc/html/commandline_8c-source.html	/^<a name="l00114"><\/a>00114                                 skiponrestart = 1;$/;"	a
l00115	doc/html/commandline_8c-source.html	/^<a name="l00115"><\/a>00115                                 config-&gt;<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> = 0;$/;"	a
l00116	doc/html/commandline_8c-source.html	/^<a name="l00116"><\/a>00116                                 <span class="keywordflow">break<\/span>;$/;"	a
l00117	doc/html/commandline_8c-source.html	/^<a name="l00117"><\/a>00117 $/;"	a
l00118	doc/html/commandline_8c-source.html	/^<a name="l00118"><\/a>00118                         <span class="keywordflow">case<\/span> <span class="charliteral">'d'<\/span>:$/;"	a
l00119	doc/html/commandline_8c-source.html	/^<a name="l00119"><\/a>00119                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00120	doc/html/commandline_8c-source.html	/^<a name="l00120"><\/a>00120                                         config-&gt;<a class="code" href="structs__config.html#72a375118114359c8fcf890bba1e77fb" title="Debug information verbosity.">debuglevel<\/a> = atoi(optarg);$/;"	a
l00121	doc/html/commandline_8c-source.html	/^<a name="l00121"><\/a>00121                                 }$/;"	a
l00122	doc/html/commandline_8c-source.html	/^<a name="l00122"><\/a>00122                                 <span class="keywordflow">break<\/span>;$/;"	a
l00123	doc/html/commandline_8c-source.html	/^<a name="l00123"><\/a>00123 $/;"	a
l00124	doc/html/commandline_8c-source.html	/^<a name="l00124"><\/a>00124                         <span class="keywordflow">case<\/span> <span class="charliteral">'s'<\/span>:$/;"	a
l00125	doc/html/commandline_8c-source.html	/^<a name="l00125"><\/a>00125                                 config-&gt;<a class="code" href="structs__config.html#784dd5fa3d27b3d1311b18f23e919362" title="boolean, wether to log to syslog">log_syslog<\/a> = 1;$/;"	a
l00126	doc/html/commandline_8c-source.html	/^<a name="l00126"><\/a>00126                                 <span class="keywordflow">break<\/span>;$/;"	a
l00127	doc/html/commandline_8c-source.html	/^<a name="l00127"><\/a>00127 $/;"	a
l00128	doc/html/commandline_8c-source.html	/^<a name="l00128"><\/a>00128                         <span class="keywordflow">case<\/span> <span class="charliteral">'v'<\/span>:$/;"	a
l00129	doc/html/commandline_8c-source.html	/^<a name="l00129"><\/a>00129                                 printf(<span class="stringliteral">"This is WiFiDog version "<\/span> VERSION <span class="stringliteral">"\\n"<\/span>);$/;"	a
l00130	doc/html/commandline_8c-source.html	/^<a name="l00130"><\/a>00130                                 exit(1);$/;"	a
l00131	doc/html/commandline_8c-source.html	/^<a name="l00131"><\/a>00131                                 <span class="keywordflow">break<\/span>;$/;"	a
l00132	doc/html/commandline_8c-source.html	/^<a name="l00132"><\/a>00132 $/;"	a
l00133	doc/html/commandline_8c-source.html	/^<a name="l00133"><\/a>00133                         <span class="keywordflow">case<\/span> <span class="charliteral">'x'<\/span>:$/;"	a
l00134	doc/html/commandline_8c-source.html	/^<a name="l00134"><\/a>00134                                 skiponrestart = 1;$/;"	a
l00135	doc/html/commandline_8c-source.html	/^<a name="l00135"><\/a>00135                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00136	doc/html/commandline_8c-source.html	/^<a name="l00136"><\/a>00136                                         restart_orig_pid = atoi(optarg);$/;"	a
l00137	doc/html/commandline_8c-source.html	/^<a name="l00137"><\/a>00137                                 }$/;"	a
l00138	doc/html/commandline_8c-source.html	/^<a name="l00138"><\/a>00138                                 <span class="keywordflow">else<\/span> {$/;"	a
l00139	doc/html/commandline_8c-source.html	/^<a name="l00139"><\/a>00139                                         printf(<span class="stringliteral">"The expected PID to the -x switch was not supplied!"<\/span>);$/;"	a
l00140	doc/html/commandline_8c-source.html	/^<a name="l00140"><\/a>00140                                         exit(1);$/;"	a
l00141	doc/html/commandline_8c-source.html	/^<a name="l00141"><\/a>00141                                 }$/;"	a
l00142	doc/html/commandline_8c-source.html	/^<a name="l00142"><\/a>00142                                 <span class="keywordflow">break<\/span>;$/;"	a
l00143	doc/html/commandline_8c-source.html	/^<a name="l00143"><\/a>00143 $/;"	a
l00144	doc/html/commandline_8c-source.html	/^<a name="l00144"><\/a>00144                         <span class="keywordflow">case<\/span> <span class="charliteral">'i'<\/span>:$/;"	a
l00145	doc/html/commandline_8c-source.html	/^<a name="l00145"><\/a>00145                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00146	doc/html/commandline_8c-source.html	/^<a name="l00146"><\/a>00146                                         free(config-&gt;<a class="code" href="structs__config.html#132360d3c982b91fe0cdff6622eee1f1" title="internal path to socket">internal_sock<\/a>);$/;"	a
l00147	doc/html/commandline_8c-source.html	/^<a name="l00147"><\/a>00147                                         config-&gt;<a class="code" href="structs__config.html#132360d3c982b91fe0cdff6622eee1f1" title="internal path to socket">internal_sock<\/a> = safe_strdup(optarg);$/;"	a
l00148	doc/html/commandline_8c-source.html	/^<a name="l00148"><\/a>00148                                 }$/;"	a
l00149	doc/html/commandline_8c-source.html	/^<a name="l00149"><\/a>00149                                 <span class="keywordflow">break<\/span>;$/;"	a
l00150	doc/html/commandline_8c-source.html	/^<a name="l00150"><\/a>00150 $/;"	a
l00151	doc/html/commandline_8c-source.html	/^<a name="l00151"><\/a>00151                         <span class="keywordflow">default<\/span>:$/;"	a
l00152	doc/html/commandline_8c-source.html	/^<a name="l00152"><\/a>00152                                 usage();$/;"	a
l00153	doc/html/commandline_8c-source.html	/^<a name="l00153"><\/a>00153                                 exit(1);$/;"	a
l00154	doc/html/commandline_8c-source.html	/^<a name="l00154"><\/a>00154                                 <span class="keywordflow">break<\/span>;$/;"	a
l00155	doc/html/commandline_8c-source.html	/^<a name="l00155"><\/a>00155 $/;"	a
l00156	doc/html/commandline_8c-source.html	/^<a name="l00156"><\/a>00156                 }$/;"	a
l00157	doc/html/commandline_8c-source.html	/^<a name="l00157"><\/a>00157 $/;"	a
l00158	doc/html/commandline_8c-source.html	/^<a name="l00158"><\/a>00158                 <span class="keywordflow">if<\/span> (!skiponrestart) {$/;"	a
l00159	doc/html/commandline_8c-source.html	/^<a name="l00159"><\/a>00159                         <span class="comment">\/* Add it to restartargv *\/<\/span>$/;"	a
l00160	doc/html/commandline_8c-source.html	/^<a name="l00160"><\/a>00160                         safe_asprintf(&amp;(restartargv[i++]), <span class="stringliteral">"-%c"<\/span>, c);$/;"	a
l00161	doc/html/commandline_8c-source.html	/^<a name="l00161"><\/a>00161                         <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00162	doc/html/commandline_8c-source.html	/^<a name="l00162"><\/a>00162                                 restartargv[i++] = safe_strdup(optarg);$/;"	a
l00163	doc/html/commandline_8c-source.html	/^<a name="l00163"><\/a>00163                         }$/;"	a
l00164	doc/html/commandline_8c-source.html	/^<a name="l00164"><\/a>00164                 }$/;"	a
l00165	doc/html/commandline_8c-source.html	/^<a name="l00165"><\/a>00165 $/;"	a
l00166	doc/html/commandline_8c-source.html	/^<a name="l00166"><\/a>00166         }$/;"	a
l00167	doc/html/commandline_8c-source.html	/^<a name="l00167"><\/a>00167 $/;"	a
l00168	doc/html/commandline_8c-source.html	/^<a name="l00168"><\/a>00168         <span class="comment">\/* Finally, we should add  the -x, pid and NULL to restartargv<\/span>$/;"	a
l00169	doc/html/commandline_8c-source.html	/^<a name="l00169"><\/a>00169 <span class="comment">         * HOWEVER we cannot do it here, since this is called before we fork to background<\/span>$/;"	a
l00170	doc/html/commandline_8c-source.html	/^<a name="l00170"><\/a>00170 <span class="comment">         * so we'll leave this job to gateway.c after forking is completed<\/span>$/;"	a
l00171	doc/html/commandline_8c-source.html	/^<a name="l00171"><\/a>00171 <span class="comment">         * so that the correct PID is assigned<\/span>$/;"	a
l00172	doc/html/commandline_8c-source.html	/^<a name="l00172"><\/a>00172 <span class="comment">         *<\/span>$/;"	a
l00173	doc/html/commandline_8c-source.html	/^<a name="l00173"><\/a>00173 <span class="comment">         * We add 3 nulls, and the first 2 will be overridden later<\/span>$/;"	a
l00174	doc/html/commandline_8c-source.html	/^<a name="l00174"><\/a>00174 <span class="comment">         *\/<\/span>$/;"	a
l00175	doc/html/commandline_8c-source.html	/^<a name="l00175"><\/a>00175         restartargv[i++] = NULL;$/;"	a
l00176	doc/html/commandline_8c-source.html	/^<a name="l00176"><\/a>00176         restartargv[i++] = NULL;$/;"	a
l00177	doc/html/commandline_8c-source.html	/^<a name="l00177"><\/a>00177         restartargv[i++] = NULL;$/;"	a
l00178	doc/html/commandline_8c-source.html	/^<a name="l00178"><\/a>00178 $/;"	a
l00179	doc/html/commandline_8c-source.html	/^<a name="l00179"><\/a>00179 }$/;"	a
l00180	doc/html/commandline_8c-source.html	/^<a name="l00180"><\/a>00180 $/;"	a
3c52dcc44643589b9f1039b576518dea	doc/html/commandline_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3c52dcc44643589b9f1039b576518dea"><\/a><!-- doxytag: member="commandline.c::restartargv" ref="3c52dcc44643589b9f1039b576518dea" args="" -->$/;"	a
_details	doc/html/commandline_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b55a47ffb38b07a1c8d865c4821d52cc	doc/html/commandline_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b55a47ffb38b07a1c8d865c4821d52cc"><\/a><!-- doxytag: member="commandline.c::restart_orig_pid" ref="b55a47ffb38b07a1c8d865c4821d52cc" args="" -->$/;"	a
d96d407a911fbb914fa8e4cfbf2faf0f	doc/html/commandline_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d96d407a911fbb914fa8e4cfbf2faf0f"><\/a><!-- doxytag: member="commandline.c::usage" ref="d96d407a911fbb914fa8e4cfbf2faf0f" args="(void)" -->$/;"	a
e24d4b7fe84e05687b4c390ed8096b8a	doc/html/commandline_8c.html	/^<a class="anchor" name="e24d4b7fe84e05687b4c390ed8096b8a"><\/a><!-- doxytag: member="commandline.c::parse_commandline" ref="e24d4b7fe84e05687b4c390ed8096b8a" args="(int argc, char **argv)" -->$/;"	a
l00001	doc/html/commandline_8h-source.html	/^<h1>commandline.h<\/h1><a href="commandline_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/commandline_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/commandline_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/commandline_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/commandline_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/commandline_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/commandline_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/commandline_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/commandline_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/commandline_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/commandline_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/commandline_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/commandline_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/commandline_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/commandline_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/commandline_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/commandline_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/commandline_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/commandline_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/commandline_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/commandline_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: commandline.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	doc/html/commandline_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _COMMANDLINE_H_<\/span>$/;"	a
l00028	doc/html/commandline_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _COMMANDLINE_H_<\/span>$/;"	a
l00029	doc/html/commandline_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00031	doc/html/commandline_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="keywordtype">void<\/span> <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(<span class="keywordtype">int<\/span>, <span class="keywordtype">char<\/span>**);$/;"	a
l00032	doc/html/commandline_8h-source.html	/^<a name="l00032"><\/a>00032 $/;"	a
l00033	doc/html/commandline_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#endif <\/span><span class="comment">\/* _COMMANDLINE_H_ *\/<\/span>$/;"	a
03b7907514bb723dea446381dbdf696d	doc/html/commandline_8h.html	/^<a class="anchor" name="03b7907514bb723dea446381dbdf696d"><\/a><!-- doxytag: member="commandline.h::parse_commandline" ref="03b7907514bb723dea446381dbdf696d" args="(int, char **)" -->$/;"	a
_details	doc/html/commandline_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	doc/html/common_8h-source.html	/^<h1>common.h<\/h1><a href="common_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/common_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/common_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/common_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/common_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/common_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/common_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/common_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/common_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/common_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/common_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/common_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/common_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/common_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/common_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/common_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/common_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/common_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/common_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/common_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/common_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: common.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	doc/html/common_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _COMMON_H_<\/span>$/;"	a
l00028	doc/html/common_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _COMMON_H_<\/span>$/;"	a
l00029	doc/html/common_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00031	doc/html/common_8h-source.html	/^<a name="l00031"><\/a><a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc">00031<\/a> <span class="preprocessor">#define MAX_BUF 4096<\/span>$/;"	a
l00032	doc/html/common_8h-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor"><\/span>$/;"	a
l00033	doc/html/common_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#endif <\/span><span class="comment">\/* _COMMON_H_ *\/<\/span>$/;"	a
2491303d0fe260aaba8f46717cda66cc	doc/html/common_8h.html	/^<a class="anchor" name="2491303d0fe260aaba8f46717cda66cc"><\/a><!-- doxytag: member="common.h::MAX_BUF" ref="2491303d0fe260aaba8f46717cda66cc" args="" -->$/;"	a
_details	doc/html/common_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	doc/html/conf_8c-source.html	/^<h1>conf.c<\/h1><a href="conf_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/conf_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/conf_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/conf_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/conf_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/conf_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/conf_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/conf_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/conf_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/conf_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/conf_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/conf_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/conf_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/conf_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/conf_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/conf_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/conf_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/conf_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/conf_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/conf_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/conf_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: conf.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00028	doc/html/conf_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00029	doc/html/conf_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/conf_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00031	doc/html/conf_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00032	doc/html/conf_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00033	doc/html/conf_8c-source.html	/^<a name="l00033"><\/a>00033 $/;"	a
l00034	doc/html/conf_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00035	doc/html/conf_8c-source.html	/^<a name="l00035"><\/a>00035 $/;"	a
l00036	doc/html/conf_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00037	doc/html/conf_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;ctype.h&gt;<\/span>$/;"	a
l00038	doc/html/conf_8c-source.html	/^<a name="l00038"><\/a>00038 $/;"	a
l00039	doc/html/conf_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00040	doc/html/conf_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00041	doc/html/conf_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00042	doc/html/conf_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00043	doc/html/conf_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="http_8h.html" title="HTTP IO functions.">http.h<\/a>"<\/span>$/;"	a
l00044	doc/html/conf_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00045	doc/html/conf_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00046	doc/html/conf_8c-source.html	/^<a name="l00046"><\/a>00046 $/;"	a
l00047	doc/html/conf_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00048	doc/html/conf_8c-source.html	/^<a name="l00048"><\/a>00048 $/;"	a
l00051	doc/html/conf_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="keyword">static<\/span> <a class="code" href="structs__config.html">s_config<\/a> config;$/;"	a
l00052	doc/html/conf_8c-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00056	doc/html/conf_8c-source.html	/^<a name="l00056"><\/a><a class="code" href="wdctl__thread_8c.html#b374ff230d9977e6b952612d61689f39">00056<\/a> pthread_mutex_t <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a> = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00057	doc/html/conf_8c-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00061	doc/html/conf_8c-source.html	/^<a name="l00061"><\/a>00061 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> missing_parms;$/;"	a
l00062	doc/html/conf_8c-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00065	doc/html/conf_8c-source.html	/^<a name="l00065"><\/a>00065 <span class="keyword">typedef<\/span> <span class="keyword">enum<\/span> {$/;"	a
l00066	doc/html/conf_8c-source.html	/^<a name="l00066"><\/a>00066         oBadOption,$/;"	a
l00067	doc/html/conf_8c-source.html	/^<a name="l00067"><\/a>00067         oDaemon,$/;"	a
l00068	doc/html/conf_8c-source.html	/^<a name="l00068"><\/a>00068         oDebugLevel,$/;"	a
l00069	doc/html/conf_8c-source.html	/^<a name="l00069"><\/a>00069         oExternalInterface,$/;"	a
l00070	doc/html/conf_8c-source.html	/^<a name="l00070"><\/a>00070         oGatewayID,$/;"	a
l00071	doc/html/conf_8c-source.html	/^<a name="l00071"><\/a>00071         oGatewayInterface,$/;"	a
l00072	doc/html/conf_8c-source.html	/^<a name="l00072"><\/a>00072         oGatewayAddress,$/;"	a
l00073	doc/html/conf_8c-source.html	/^<a name="l00073"><\/a>00073         oGatewayPort,$/;"	a
l00074	doc/html/conf_8c-source.html	/^<a name="l00074"><\/a>00074         oAuthServer,$/;"	a
l00075	doc/html/conf_8c-source.html	/^<a name="l00075"><\/a>00075         oAuthServHostname,$/;"	a
l00076	doc/html/conf_8c-source.html	/^<a name="l00076"><\/a>00076         oAuthServSSLAvailable,$/;"	a
l00077	doc/html/conf_8c-source.html	/^<a name="l00077"><\/a>00077         oAuthServSSLPort,$/;"	a
l00078	doc/html/conf_8c-source.html	/^<a name="l00078"><\/a>00078         oAuthServHTTPPort,$/;"	a
l00079	doc/html/conf_8c-source.html	/^<a name="l00079"><\/a>00079         oAuthServPath,$/;"	a
l00080	doc/html/conf_8c-source.html	/^<a name="l00080"><\/a>00080         oAuthServLoginScriptPathFragment,$/;"	a
l00081	doc/html/conf_8c-source.html	/^<a name="l00081"><\/a>00081         oAuthServPortalScriptPathFragment,$/;"	a
l00082	doc/html/conf_8c-source.html	/^<a name="l00082"><\/a>00082         oAuthServMsgScriptPathFragment,$/;"	a
l00083	doc/html/conf_8c-source.html	/^<a name="l00083"><\/a>00083         oAuthServPingScriptPathFragment,$/;"	a
l00084	doc/html/conf_8c-source.html	/^<a name="l00084"><\/a>00084         oAuthServAuthScriptPathFragment,$/;"	a
l00085	doc/html/conf_8c-source.html	/^<a name="l00085"><\/a>00085         oHTTPDMaxConn,$/;"	a
l00086	doc/html/conf_8c-source.html	/^<a name="l00086"><\/a>00086         oHTTPDName,$/;"	a
l00087	doc/html/conf_8c-source.html	/^<a name="l00087"><\/a>00087         oHTTPDRealm,$/;"	a
l00088	doc/html/conf_8c-source.html	/^<a name="l00088"><\/a>00088         oHTTPDUsername,$/;"	a
l00089	doc/html/conf_8c-source.html	/^<a name="l00089"><\/a>00089         oHTTPDPassword,$/;"	a
l00090	doc/html/conf_8c-source.html	/^<a name="l00090"><\/a>00090         oClientTimeout,$/;"	a
l00091	doc/html/conf_8c-source.html	/^<a name="l00091"><\/a>00091         oCheckInterval,$/;"	a
l00092	doc/html/conf_8c-source.html	/^<a name="l00092"><\/a>00092         oWdctlSocket,$/;"	a
l00093	doc/html/conf_8c-source.html	/^<a name="l00093"><\/a>00093         oSyslogFacility,$/;"	a
l00094	doc/html/conf_8c-source.html	/^<a name="l00094"><\/a>00094         oFirewallRule,$/;"	a
l00095	doc/html/conf_8c-source.html	/^<a name="l00095"><\/a>00095         oFirewallRuleSet,$/;"	a
l00096	doc/html/conf_8c-source.html	/^<a name="l00096"><\/a>00096         oTrustedMACList,$/;"	a
l00097	doc/html/conf_8c-source.html	/^<a name="l00097"><\/a>00097         oHtmlMessageFile,$/;"	a
l00098	doc/html/conf_8c-source.html	/^<a name="l00098"><\/a>00098 } OpCodes;$/;"	a
l00099	doc/html/conf_8c-source.html	/^<a name="l00099"><\/a>00099 $/;"	a
l00102	doc/html/conf_8c-source.html	/^<a name="l00102"><\/a>00102 <span class="keyword">static<\/span> <span class="keyword">const<\/span> <span class="keyword">struct <\/span>{$/;"	a
l00103	doc/html/conf_8c-source.html	/^<a name="l00103"><\/a>00103         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *name;$/;"	a
l00104	doc/html/conf_8c-source.html	/^<a name="l00104"><\/a>00104         OpCodes opcode;$/;"	a
l00105	doc/html/conf_8c-source.html	/^<a name="l00105"><\/a>00105 } keywords[] = {$/;"	a
l00106	doc/html/conf_8c-source.html	/^<a name="l00106"><\/a>00106         { <span class="stringliteral">"daemon"<\/span>,                     oDaemon },$/;"	a
l00107	doc/html/conf_8c-source.html	/^<a name="l00107"><\/a>00107         { <span class="stringliteral">"debuglevel"<\/span>,                 oDebugLevel },$/;"	a
l00108	doc/html/conf_8c-source.html	/^<a name="l00108"><\/a>00108         { <span class="stringliteral">"externalinterface"<\/span>,          oExternalInterface },$/;"	a
l00109	doc/html/conf_8c-source.html	/^<a name="l00109"><\/a>00109         { <span class="stringliteral">"gatewayid"<\/span>,                  oGatewayID },$/;"	a
l00110	doc/html/conf_8c-source.html	/^<a name="l00110"><\/a>00110         { <span class="stringliteral">"gatewayinterface"<\/span>,           oGatewayInterface },$/;"	a
l00111	doc/html/conf_8c-source.html	/^<a name="l00111"><\/a>00111         { <span class="stringliteral">"gatewayaddress"<\/span>,             oGatewayAddress },$/;"	a
l00112	doc/html/conf_8c-source.html	/^<a name="l00112"><\/a>00112         { <span class="stringliteral">"gatewayport"<\/span>,                oGatewayPort },$/;"	a
l00113	doc/html/conf_8c-source.html	/^<a name="l00113"><\/a>00113         { <span class="stringliteral">"authserver"<\/span>,                 oAuthServer },$/;"	a
l00114	doc/html/conf_8c-source.html	/^<a name="l00114"><\/a>00114         { <span class="stringliteral">"httpdmaxconn"<\/span>,               oHTTPDMaxConn },$/;"	a
l00115	doc/html/conf_8c-source.html	/^<a name="l00115"><\/a>00115         { <span class="stringliteral">"httpdname"<\/span>,                  oHTTPDName },$/;"	a
l00116	doc/html/conf_8c-source.html	/^<a name="l00116"><\/a>00116         { <span class="stringliteral">"httpdrealm"<\/span>,                 oHTTPDRealm },$/;"	a
l00117	doc/html/conf_8c-source.html	/^<a name="l00117"><\/a>00117         { <span class="stringliteral">"httpdusername"<\/span>,              oHTTPDUsername },$/;"	a
l00118	doc/html/conf_8c-source.html	/^<a name="l00118"><\/a>00118         { <span class="stringliteral">"httpdpassword"<\/span>,              oHTTPDPassword },$/;"	a
l00119	doc/html/conf_8c-source.html	/^<a name="l00119"><\/a>00119         { <span class="stringliteral">"clienttimeout"<\/span>,              oClientTimeout },$/;"	a
l00120	doc/html/conf_8c-source.html	/^<a name="l00120"><\/a>00120         { <span class="stringliteral">"checkinterval"<\/span>,              oCheckInterval },$/;"	a
l00121	doc/html/conf_8c-source.html	/^<a name="l00121"><\/a>00121         { <span class="stringliteral">"syslogfacility"<\/span>,             oSyslogFacility },$/;"	a
l00122	doc/html/conf_8c-source.html	/^<a name="l00122"><\/a>00122         { <span class="stringliteral">"wdctlsocket"<\/span>,                oWdctlSocket },$/;"	a
l00123	doc/html/conf_8c-source.html	/^<a name="l00123"><\/a>00123         { <span class="stringliteral">"hostname"<\/span>,                   oAuthServHostname },$/;"	a
l00124	doc/html/conf_8c-source.html	/^<a name="l00124"><\/a>00124         { <span class="stringliteral">"sslavailable"<\/span>,               oAuthServSSLAvailable },$/;"	a
l00125	doc/html/conf_8c-source.html	/^<a name="l00125"><\/a>00125         { <span class="stringliteral">"sslport"<\/span>,                    oAuthServSSLPort },$/;"	a
l00126	doc/html/conf_8c-source.html	/^<a name="l00126"><\/a>00126         { <span class="stringliteral">"httpport"<\/span>,                   oAuthServHTTPPort },$/;"	a
l00127	doc/html/conf_8c-source.html	/^<a name="l00127"><\/a>00127         { <span class="stringliteral">"path"<\/span>,                       oAuthServPath },$/;"	a
l00128	doc/html/conf_8c-source.html	/^<a name="l00128"><\/a>00128         { <span class="stringliteral">"loginscriptpathfragment"<\/span>,    oAuthServLoginScriptPathFragment },$/;"	a
l00129	doc/html/conf_8c-source.html	/^<a name="l00129"><\/a>00129         { <span class="stringliteral">"portalscriptpathfragment"<\/span>,   oAuthServPortalScriptPathFragment },$/;"	a
l00130	doc/html/conf_8c-source.html	/^<a name="l00130"><\/a>00130         { <span class="stringliteral">"msgscriptpathfragment"<\/span>,      oAuthServMsgScriptPathFragment },$/;"	a
l00131	doc/html/conf_8c-source.html	/^<a name="l00131"><\/a>00131         { <span class="stringliteral">"pingscriptpathfragment"<\/span>,     oAuthServPingScriptPathFragment },$/;"	a
l00132	doc/html/conf_8c-source.html	/^<a name="l00132"><\/a>00132         { <span class="stringliteral">"authscriptpathfragment"<\/span>,     oAuthServAuthScriptPathFragment },$/;"	a
l00133	doc/html/conf_8c-source.html	/^<a name="l00133"><\/a>00133         { <span class="stringliteral">"firewallruleset"<\/span>,            oFirewallRuleSet },$/;"	a
l00134	doc/html/conf_8c-source.html	/^<a name="l00134"><\/a>00134         { <span class="stringliteral">"firewallrule"<\/span>,               oFirewallRule },$/;"	a
l00135	doc/html/conf_8c-source.html	/^<a name="l00135"><\/a>00135         { <span class="stringliteral">"trustedmaclist"<\/span>,             oTrustedMACList },$/;"	a
l00136	doc/html/conf_8c-source.html	/^<a name="l00136"><\/a>00136         { <span class="stringliteral">"htmlmessagefile"<\/span>,            oHtmlMessageFile },$/;"	a
l00137	doc/html/conf_8c-source.html	/^<a name="l00137"><\/a>00137         { NULL,                         oBadOption },$/;"	a
l00138	doc/html/conf_8c-source.html	/^<a name="l00138"><\/a>00138 };$/;"	a
l00139	doc/html/conf_8c-source.html	/^<a name="l00139"><\/a>00139 $/;"	a
l00140	doc/html/conf_8c-source.html	/^<a name="l00140"><\/a>00140 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> config_notnull(<span class="keyword">const<\/span> <span class="keywordtype">void<\/span> *parm, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *parmname);$/;"	a
l00141	doc/html/conf_8c-source.html	/^<a name="l00141"><\/a>00141 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> parse_boolean_value(<span class="keywordtype">char<\/span> *);$/;"	a
l00142	doc/html/conf_8c-source.html	/^<a name="l00142"><\/a>00142 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> parse_auth_server(FILE *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keywordtype">int<\/span> *);$/;"	a
l00143	doc/html/conf_8c-source.html	/^<a name="l00143"><\/a>00143 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> <a class="code" href="conf_8c.html#c10ca895b5a20b458c1599f8a9766f4d">_parse_firewall_rule<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset, <span class="keywordtype">char<\/span> *leftover);$/;"	a
l00144	doc/html/conf_8c-source.html	/^<a name="l00144"><\/a>00144 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> parse_firewall_ruleset(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, FILE *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keywordtype">int<\/span> *);$/;"	a
l00145	doc/html/conf_8c-source.html	/^<a name="l00145"><\/a>00145 $/;"	a
l00146	doc/html/conf_8c-source.html	/^<a name="l00146"><\/a>00146 <span class="keyword">static<\/span> OpCodes config_parse_token(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *cp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> linenum);$/;"	a
l00147	doc/html/conf_8c-source.html	/^<a name="l00147"><\/a>00147 $/;"	a
l00151	doc/html/conf_8c-source.html	/^<a name="l00151"><\/a>00151 <a class="code" href="structs__config.html">s_config<\/a> *$/;"	a
l00152	doc/html/conf_8c-source.html	/^<a name="l00152"><\/a><a class="code" href="conf_8h.html#64e73012596dd6628c18742c8046069f">00152<\/a> <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00153	doc/html/conf_8c-source.html	/^<a name="l00153"><\/a>00153 {$/;"	a
l00154	doc/html/conf_8c-source.html	/^<a name="l00154"><\/a>00154     <span class="keywordflow">return<\/span> &amp;config;$/;"	a
l00155	doc/html/conf_8c-source.html	/^<a name="l00155"><\/a>00155 }$/;"	a
l00156	doc/html/conf_8c-source.html	/^<a name="l00156"><\/a>00156 $/;"	a
l00158	doc/html/conf_8c-source.html	/^<a name="l00158"><\/a>00158 <span class="keywordtype">void<\/span>$/;"	a
l00159	doc/html/conf_8c-source.html	/^<a name="l00159"><\/a><a class="code" href="conf_8h.html#068a358868c409bbd99d7eef3c988866">00159<\/a> <a class="code" href="conf_8c.html#068a358868c409bbd99d7eef3c988866" title="Initialise the conf system.">config_init<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00160	doc/html/conf_8c-source.html	/^<a name="l00160"><\/a>00160 {$/;"	a
l00161	doc/html/conf_8c-source.html	/^<a name="l00161"><\/a>00161         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Setting default config parameters"<\/span>);$/;"	a
l00162	doc/html/conf_8c-source.html	/^<a name="l00162"><\/a>00162         strncpy(config.<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>, <a class="code" href="conf_8h.html#0ec3017454ea7a8398d25c8ab83890fd">DEFAULT_CONFIGFILE<\/a>, <span class="keyword">sizeof<\/span>(config.<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>));$/;"	a
l00163	doc/html/conf_8c-source.html	/^<a name="l00163"><\/a>00163         config.<a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6" title="name of the HTML file used for messages">htmlmsgfile<\/a> = safe_strdup(<a class="code" href="conf_8h.html#16581929d818bc322bbebce8a7a12117">DEFAULT_HTMLMSGFILE<\/a>);$/;"	a
l00164	doc/html/conf_8c-source.html	/^<a name="l00164"><\/a>00164         config.<a class="code" href="structs__config.html#72a375118114359c8fcf890bba1e77fb" title="Debug information verbosity.">debuglevel<\/a> = <a class="code" href="conf_8h.html#32198b3d9cda9e7ea18d9680f805dc87">DEFAULT_DEBUGLEVEL<\/a>;$/;"	a
l00165	doc/html/conf_8c-source.html	/^<a name="l00165"><\/a>00165         config.<a class="code" href="structs__config.html#7a24ca5b2cc1ff099bda0af17e654a95" title="Used by libhttpd, not sure what it does.">httpdmaxconn<\/a> = <a class="code" href="conf_8h.html#ca85302a5a857716f3b0275fbbff135f">DEFAULT_HTTPDMAXCONN<\/a>;$/;"	a
l00166	doc/html/conf_8c-source.html	/^<a name="l00166"><\/a>00166         config.<a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62" title="External network interface name for firewall rules.">external_interface<\/a> = NULL;$/;"	a
l00167	doc/html/conf_8c-source.html	/^<a name="l00167"><\/a>00167         config.<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a> = <a class="code" href="conf_8h.html#e38786151577e46b298b7baf0ca0fe96">DEFAULT_GATEWAYID<\/a>;$/;"	a
l00168	doc/html/conf_8c-source.html	/^<a name="l00168"><\/a>00168         config.<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a> = NULL;$/;"	a
l00169	doc/html/conf_8c-source.html	/^<a name="l00169"><\/a>00169         config.<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a> = NULL;$/;"	a
l00170	doc/html/conf_8c-source.html	/^<a name="l00170"><\/a>00170         config.<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a> = <a class="code" href="conf_8h.html#f14cf5aa96a948b2d23a1ff0aeba3e48">DEFAULT_GATEWAYPORT<\/a>;$/;"	a
l00171	doc/html/conf_8c-source.html	/^<a name="l00171"><\/a>00171         config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> = NULL;$/;"	a
l00172	doc/html/conf_8c-source.html	/^<a name="l00172"><\/a>00172         config.<a class="code" href="structs__config.html#2ed9a59507be060fe0e1deae7fcc077b" title="Name the web server will return when replying to a request.">httpdname<\/a> = NULL;$/;"	a
l00173	doc/html/conf_8c-source.html	/^<a name="l00173"><\/a>00173         config.<a class="code" href="structs__config.html#283515007953f307a7b599ee480b743d" title="HTTP Authentication realm.">httpdrealm<\/a> = <a class="code" href="conf_8h.html#af813a168a0bd5a77aa515073950a135">DEFAULT_HTTPDNAME<\/a>;$/;"	a
l00174	doc/html/conf_8c-source.html	/^<a name="l00174"><\/a>00174         config.<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a> = NULL;$/;"	a
l00175	doc/html/conf_8c-source.html	/^<a name="l00175"><\/a>00175         config.<a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5" title="Password for HTTP authentication.">httpdpassword<\/a> = NULL;$/;"	a
l00176	doc/html/conf_8c-source.html	/^<a name="l00176"><\/a>00176         config.<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a> = <a class="code" href="conf_8h.html#1ea67d2117d4f50445d1c9428bac5a64">DEFAULT_CLIENTTIMEOUT<\/a>;$/;"	a
l00177	doc/html/conf_8c-source.html	/^<a name="l00177"><\/a>00177         config.<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a> = <a class="code" href="conf_8h.html#9bcb72263ba584b1da18d3b2f2b65e6a">DEFAULT_CHECKINTERVAL<\/a>;$/;"	a
l00178	doc/html/conf_8c-source.html	/^<a name="l00178"><\/a>00178         config.<a class="code" href="structs__config.html#eaad87f73a87a2f752b111dad813902d" title="facility to use when using syslog for logging">syslog_facility<\/a> = <a class="code" href="conf_8h.html#66cff01e093b0b7d5335a7939f839341">DEFAULT_SYSLOG_FACILITY<\/a>;$/;"	a
l00179	doc/html/conf_8c-source.html	/^<a name="l00179"><\/a>00179         config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> = -1;$/;"	a
l00180	doc/html/conf_8c-source.html	/^<a name="l00180"><\/a>00180         config.<a class="code" href="structs__config.html#784dd5fa3d27b3d1311b18f23e919362" title="boolean, wether to log to syslog">log_syslog<\/a> = <a class="code" href="conf_8h.html#41ce987eea16297a459249b1e4c69ed7">DEFAULT_LOG_SYSLOG<\/a>;$/;"	a
l00181	doc/html/conf_8c-source.html	/^<a name="l00181"><\/a>00181         config.<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a> = safe_strdup(<a class="code" href="conf_8h.html#cee7c0173f525e29800b87222b407386">DEFAULT_WDCTL_SOCK<\/a>);$/;"	a
l00182	doc/html/conf_8c-source.html	/^<a name="l00182"><\/a>00182         config.<a class="code" href="structs__config.html#132360d3c982b91fe0cdff6622eee1f1" title="internal path to socket">internal_sock<\/a> = safe_strdup(<a class="code" href="conf_8h.html#ea1d1da1ff4c9161109a81a0b1d6fd2c">DEFAULT_INTERNAL_SOCK<\/a>);$/;"	a
l00183	doc/html/conf_8c-source.html	/^<a name="l00183"><\/a>00183         config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a> = NULL;$/;"	a
l00184	doc/html/conf_8c-source.html	/^<a name="l00184"><\/a>00184         config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a> = NULL;$/;"	a
l00185	doc/html/conf_8c-source.html	/^<a name="l00185"><\/a>00185 }$/;"	a
l00186	doc/html/conf_8c-source.html	/^<a name="l00186"><\/a>00186 $/;"	a
l00190	doc/html/conf_8c-source.html	/^<a name="l00190"><\/a>00190 <span class="keywordtype">void<\/span>$/;"	a
l00191	doc/html/conf_8c-source.html	/^<a name="l00191"><\/a><a class="code" href="conf_8h.html#17b6b425f18de3865e44b534c1f1f1cc">00191<\/a> <a class="code" href="conf_8c.html#17b6b425f18de3865e44b534c1f1f1cc" title="Initialize the variables we override with the command line.">config_init_override<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00192	doc/html/conf_8c-source.html	/^<a name="l00192"><\/a>00192 {$/;"	a
l00193	doc/html/conf_8c-source.html	/^<a name="l00193"><\/a>00193     <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> == -1) config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> = <a class="code" href="conf_8h.html#c71029bbf7b0ee40ad72b17ff77f7896">DEFAULT_DAEMON<\/a>;$/;"	a
l00194	doc/html/conf_8c-source.html	/^<a name="l00194"><\/a>00194 }$/;"	a
l00195	doc/html/conf_8c-source.html	/^<a name="l00195"><\/a>00195 $/;"	a
l00199	doc/html/conf_8c-source.html	/^<a name="l00199"><\/a>00199 <span class="keyword">static<\/span> OpCodes$/;"	a
l00200	doc/html/conf_8c-source.html	/^<a name="l00200"><\/a>00200 config_parse_token(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *cp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> linenum)$/;"	a
l00201	doc/html/conf_8c-source.html	/^<a name="l00201"><\/a>00201 {$/;"	a
l00202	doc/html/conf_8c-source.html	/^<a name="l00202"><\/a>00202         <span class="keywordtype">int<\/span> i;$/;"	a
l00203	doc/html/conf_8c-source.html	/^<a name="l00203"><\/a>00203 $/;"	a
l00204	doc/html/conf_8c-source.html	/^<a name="l00204"><\/a>00204         <span class="keywordflow">for<\/span> (i = 0; keywords[i].name; i++)$/;"	a
l00205	doc/html/conf_8c-source.html	/^<a name="l00205"><\/a>00205                 <span class="keywordflow">if<\/span> (strcasecmp(cp, keywords[i].name) == 0)$/;"	a
l00206	doc/html/conf_8c-source.html	/^<a name="l00206"><\/a>00206                         <span class="keywordflow">return<\/span> keywords[i].opcode;$/;"	a
l00207	doc/html/conf_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	doc/html/conf_8c-source.html	/^<a name="l00208"><\/a>00208         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"%s: line %d: Bad configuration option: %s"<\/span>, $/;"	a
l00209	doc/html/conf_8c-source.html	/^<a name="l00209"><\/a>00209                         filename, linenum, cp);$/;"	a
l00210	doc/html/conf_8c-source.html	/^<a name="l00210"><\/a>00210         <span class="keywordflow">return<\/span> oBadOption;$/;"	a
l00211	doc/html/conf_8c-source.html	/^<a name="l00211"><\/a>00211 }$/;"	a
l00212	doc/html/conf_8c-source.html	/^<a name="l00212"><\/a>00212 $/;"	a
l00216	doc/html/conf_8c-source.html	/^<a name="l00216"><\/a>00216 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00217	doc/html/conf_8c-source.html	/^<a name="l00217"><\/a>00217 parse_auth_server(FILE *file, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> *linenum)$/;"	a
l00218	doc/html/conf_8c-source.html	/^<a name="l00218"><\/a>00218 {$/;"	a
l00219	doc/html/conf_8c-source.html	/^<a name="l00219"><\/a>00219         <span class="keywordtype">char<\/span>            *host = NULL,$/;"	a
l00220	doc/html/conf_8c-source.html	/^<a name="l00220"><\/a>00220                         *path = NULL,$/;"	a
l00221	doc/html/conf_8c-source.html	/^<a name="l00221"><\/a>00221                         *loginscriptpathfragment = NULL,$/;"	a
l00222	doc/html/conf_8c-source.html	/^<a name="l00222"><\/a>00222                         *portalscriptpathfragment = NULL,$/;"	a
l00223	doc/html/conf_8c-source.html	/^<a name="l00223"><\/a>00223                         *msgscriptpathfragment = NULL,$/;"	a
l00224	doc/html/conf_8c-source.html	/^<a name="l00224"><\/a>00224                         *pingscriptpathfragment = NULL,$/;"	a
l00225	doc/html/conf_8c-source.html	/^<a name="l00225"><\/a>00225                         *authscriptpathfragment = NULL,$/;"	a
l00226	doc/html/conf_8c-source.html	/^<a name="l00226"><\/a>00226                         line[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>],$/;"	a
l00227	doc/html/conf_8c-source.html	/^<a name="l00227"><\/a>00227                         *p1,$/;"	a
l00228	doc/html/conf_8c-source.html	/^<a name="l00228"><\/a>00228                         *p2;$/;"	a
l00229	doc/html/conf_8c-source.html	/^<a name="l00229"><\/a>00229         <span class="keywordtype">int<\/span>             http_port,$/;"	a
l00230	doc/html/conf_8c-source.html	/^<a name="l00230"><\/a>00230                         ssl_port,$/;"	a
l00231	doc/html/conf_8c-source.html	/^<a name="l00231"><\/a>00231                         ssl_available,$/;"	a
l00232	doc/html/conf_8c-source.html	/^<a name="l00232"><\/a>00232                         opcode;$/;"	a
l00233	doc/html/conf_8c-source.html	/^<a name="l00233"><\/a>00233         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *<span class="keyword">new<\/span>,$/;"	a
l00234	doc/html/conf_8c-source.html	/^<a name="l00234"><\/a>00234                         *tmp;$/;"	a
l00235	doc/html/conf_8c-source.html	/^<a name="l00235"><\/a>00235 $/;"	a
l00236	doc/html/conf_8c-source.html	/^<a name="l00236"><\/a>00236         <span class="comment">\/* Defaults *\/<\/span>$/;"	a
l00237	doc/html/conf_8c-source.html	/^<a name="l00237"><\/a>00237         path = safe_strdup(<a class="code" href="conf_8h.html#d1127f95cef99fe1384a30fca8b9c392">DEFAULT_AUTHSERVPATH<\/a>);$/;"	a
l00238	doc/html/conf_8c-source.html	/^<a name="l00238"><\/a>00238         loginscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#12e10b7db61ec0a23264d2a7762c6ef3">DEFAULT_AUTHSERVLOGINPATHFRAGMENT<\/a>);$/;"	a
l00239	doc/html/conf_8c-source.html	/^<a name="l00239"><\/a>00239         portalscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#29ca3acd6665cd70286185f3dd4ab09d">DEFAULT_AUTHSERVPORTALPATHFRAGMENT<\/a>);$/;"	a
l00240	doc/html/conf_8c-source.html	/^<a name="l00240"><\/a>00240         msgscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#d26385411b1807104fa1504dff7bfb0d">DEFAULT_AUTHSERVMSGPATHFRAGMENT<\/a>);$/;"	a
l00241	doc/html/conf_8c-source.html	/^<a name="l00241"><\/a>00241         pingscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#11ea6dd746ca0526817bdd6515cbcc29">DEFAULT_AUTHSERVPINGPATHFRAGMENT<\/a>);$/;"	a
l00242	doc/html/conf_8c-source.html	/^<a name="l00242"><\/a>00242         authscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#f83da39ab6845671d9b1a2bf635951fa">DEFAULT_AUTHSERVAUTHPATHFRAGMENT<\/a>);$/;"	a
l00243	doc/html/conf_8c-source.html	/^<a name="l00243"><\/a>00243         http_port = <a class="code" href="conf_8h.html#4468d0b44b441d03ea8270e09de86f65">DEFAULT_AUTHSERVPORT<\/a>;$/;"	a
l00244	doc/html/conf_8c-source.html	/^<a name="l00244"><\/a>00244         ssl_port = <a class="code" href="conf_8h.html#eecec081c6ba90900777bc8db01f774f">DEFAULT_AUTHSERVSSLPORT<\/a>;$/;"	a
l00245	doc/html/conf_8c-source.html	/^<a name="l00245"><\/a>00245         ssl_available = <a class="code" href="conf_8h.html#784fe164c1e4d1e62365a2505460592a">DEFAULT_AUTHSERVSSLAVAILABLE<\/a>;$/;"	a
l00246	doc/html/conf_8c-source.html	/^<a name="l00246"><\/a>00246         $/;"	a
l00247	doc/html/conf_8c-source.html	/^<a name="l00247"><\/a>00247         <span class="comment">\/* Read first line *\/<\/span>   $/;"	a
l00248	doc/html/conf_8c-source.html	/^<a name="l00248"><\/a>00248         memset(line, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00249	doc/html/conf_8c-source.html	/^<a name="l00249"><\/a>00249         fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - 1, file);$/;"	a
l00250	doc/html/conf_8c-source.html	/^<a name="l00250"><\/a>00250         (*linenum)++; <span class="comment">\/* increment line counter. *\/<\/span>$/;"	a
l00251	doc/html/conf_8c-source.html	/^<a name="l00251"><\/a>00251 $/;"	a
l00252	doc/html/conf_8c-source.html	/^<a name="l00252"><\/a>00252         <span class="comment">\/* Parsing loop *\/<\/span>$/;"	a
l00253	doc/html/conf_8c-source.html	/^<a name="l00253"><\/a>00253         <span class="keywordflow">while<\/span> ((line[0] != <span class="charliteral">'\\0'<\/span>) &amp;&amp; (strchr(line, <span class="charliteral">'}'<\/span>) == NULL)) {$/;"	a
l00254	doc/html/conf_8c-source.html	/^<a name="l00254"><\/a>00254                 <span class="comment">\/* skip leading blank spaces *\/<\/span>$/;"	a
l00255	doc/html/conf_8c-source.html	/^<a name="l00255"><\/a>00255                 <span class="keywordflow">for<\/span> (p1 = line; isblank(*p1); p1++);$/;"	a
l00256	doc/html/conf_8c-source.html	/^<a name="l00256"><\/a>00256 $/;"	a
l00257	doc/html/conf_8c-source.html	/^<a name="l00257"><\/a>00257                 <span class="comment">\/* End at end of line *\/<\/span>$/;"	a
l00258	doc/html/conf_8c-source.html	/^<a name="l00258"><\/a>00258                 <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'#'<\/span>)) != NULL) {$/;"	a
l00259	doc/html/conf_8c-source.html	/^<a name="l00259"><\/a>00259                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00260	doc/html/conf_8c-source.html	/^<a name="l00260"><\/a>00260                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\r'<\/span>)) != NULL) {$/;"	a
l00261	doc/html/conf_8c-source.html	/^<a name="l00261"><\/a>00261                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00262	doc/html/conf_8c-source.html	/^<a name="l00262"><\/a>00262                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\n'<\/span>)) != NULL) {$/;"	a
l00263	doc/html/conf_8c-source.html	/^<a name="l00263"><\/a>00263                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00264	doc/html/conf_8c-source.html	/^<a name="l00264"><\/a>00264                 }$/;"	a
l00265	doc/html/conf_8c-source.html	/^<a name="l00265"><\/a>00265 $/;"	a
l00266	doc/html/conf_8c-source.html	/^<a name="l00266"><\/a>00266                 <span class="comment">\/* next, we coopt the parsing of the regular config *\/<\/span>$/;"	a
l00267	doc/html/conf_8c-source.html	/^<a name="l00267"><\/a>00267                 <span class="keywordflow">if<\/span> (strlen(p1) &gt; 0) {$/;"	a
l00268	doc/html/conf_8c-source.html	/^<a name="l00268"><\/a>00268                         p2 = p1;$/;"	a
l00269	doc/html/conf_8c-source.html	/^<a name="l00269"><\/a>00269                         <span class="comment">\/* keep going until word boundary is found. *\/<\/span>$/;"	a
l00270	doc/html/conf_8c-source.html	/^<a name="l00270"><\/a>00270                         <span class="keywordflow">while<\/span> ((*p2 != <span class="charliteral">'\\0'<\/span>) &amp;&amp; (!isblank(*p2)))$/;"	a
l00271	doc/html/conf_8c-source.html	/^<a name="l00271"><\/a>00271                                 p2++;$/;"	a
l00272	doc/html/conf_8c-source.html	/^<a name="l00272"><\/a>00272 $/;"	a
l00273	doc/html/conf_8c-source.html	/^<a name="l00273"><\/a>00273                         <span class="comment">\/* Terminate first word. *\/<\/span>$/;"	a
l00274	doc/html/conf_8c-source.html	/^<a name="l00274"><\/a>00274                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00275	doc/html/conf_8c-source.html	/^<a name="l00275"><\/a>00275                         p2++;$/;"	a
l00276	doc/html/conf_8c-source.html	/^<a name="l00276"><\/a>00276 $/;"	a
l00277	doc/html/conf_8c-source.html	/^<a name="l00277"><\/a>00277                         <span class="comment">\/* skip all further blanks. *\/<\/span>$/;"	a
l00278	doc/html/conf_8c-source.html	/^<a name="l00278"><\/a>00278                         <span class="keywordflow">while<\/span> (isblank(*p2))$/;"	a
l00279	doc/html/conf_8c-source.html	/^<a name="l00279"><\/a>00279                                 p2++;$/;"	a
l00280	doc/html/conf_8c-source.html	/^<a name="l00280"><\/a>00280                         $/;"	a
l00281	doc/html/conf_8c-source.html	/^<a name="l00281"><\/a>00281                         <span class="comment">\/* Get opcode *\/<\/span>$/;"	a
l00282	doc/html/conf_8c-source.html	/^<a name="l00282"><\/a>00282                         opcode = config_parse_token(p1, filename, *linenum);$/;"	a
l00283	doc/html/conf_8c-source.html	/^<a name="l00283"><\/a>00283                         $/;"	a
l00284	doc/html/conf_8c-source.html	/^<a name="l00284"><\/a>00284                         <span class="keywordflow">switch<\/span> (opcode) {$/;"	a
l00285	doc/html/conf_8c-source.html	/^<a name="l00285"><\/a>00285                                 <span class="keywordflow">case<\/span> oAuthServHostname:$/;"	a
l00286	doc/html/conf_8c-source.html	/^<a name="l00286"><\/a>00286                                         host = safe_strdup(p2);$/;"	a
l00287	doc/html/conf_8c-source.html	/^<a name="l00287"><\/a>00287                                         <span class="keywordflow">break<\/span>;$/;"	a
l00288	doc/html/conf_8c-source.html	/^<a name="l00288"><\/a>00288                                 <span class="keywordflow">case<\/span> oAuthServPath:$/;"	a
l00289	doc/html/conf_8c-source.html	/^<a name="l00289"><\/a>00289                                         free(path);$/;"	a
l00290	doc/html/conf_8c-source.html	/^<a name="l00290"><\/a>00290                                         path = safe_strdup(p2);$/;"	a
l00291	doc/html/conf_8c-source.html	/^<a name="l00291"><\/a>00291                                         <span class="keywordflow">break<\/span>;$/;"	a
l00292	doc/html/conf_8c-source.html	/^<a name="l00292"><\/a>00292                                 <span class="keywordflow">case<\/span> oAuthServLoginScriptPathFragment:$/;"	a
l00293	doc/html/conf_8c-source.html	/^<a name="l00293"><\/a>00293                                         free(loginscriptpathfragment);$/;"	a
l00294	doc/html/conf_8c-source.html	/^<a name="l00294"><\/a>00294                                         loginscriptpathfragment = safe_strdup(p2);$/;"	a
l00295	doc/html/conf_8c-source.html	/^<a name="l00295"><\/a>00295                                         <span class="keywordflow">break<\/span>;                                  $/;"	a
l00296	doc/html/conf_8c-source.html	/^<a name="l00296"><\/a>00296                                 <span class="keywordflow">case<\/span> oAuthServPortalScriptPathFragment:$/;"	a
l00297	doc/html/conf_8c-source.html	/^<a name="l00297"><\/a>00297                                         free(portalscriptpathfragment);$/;"	a
l00298	doc/html/conf_8c-source.html	/^<a name="l00298"><\/a>00298                                         portalscriptpathfragment = safe_strdup(p2);$/;"	a
l00299	doc/html/conf_8c-source.html	/^<a name="l00299"><\/a>00299                                         <span class="keywordflow">break<\/span>;$/;"	a
l00300	doc/html/conf_8c-source.html	/^<a name="l00300"><\/a>00300                                 <span class="keywordflow">case<\/span> oAuthServMsgScriptPathFragment:$/;"	a
l00301	doc/html/conf_8c-source.html	/^<a name="l00301"><\/a>00301                                         free(msgscriptpathfragment);$/;"	a
l00302	doc/html/conf_8c-source.html	/^<a name="l00302"><\/a>00302                                         msgscriptpathfragment = safe_strdup(p2);$/;"	a
l00303	doc/html/conf_8c-source.html	/^<a name="l00303"><\/a>00303                                         <span class="keywordflow">break<\/span>;$/;"	a
l00304	doc/html/conf_8c-source.html	/^<a name="l00304"><\/a>00304                                 <span class="keywordflow">case<\/span> oAuthServPingScriptPathFragment:$/;"	a
l00305	doc/html/conf_8c-source.html	/^<a name="l00305"><\/a>00305                                         free(pingscriptpathfragment);$/;"	a
l00306	doc/html/conf_8c-source.html	/^<a name="l00306"><\/a>00306                                         pingscriptpathfragment = safe_strdup(p2);$/;"	a
l00307	doc/html/conf_8c-source.html	/^<a name="l00307"><\/a>00307                                         <span class="keywordflow">break<\/span>;                                  $/;"	a
l00308	doc/html/conf_8c-source.html	/^<a name="l00308"><\/a>00308                                 <span class="keywordflow">case<\/span> oAuthServAuthScriptPathFragment:$/;"	a
l00309	doc/html/conf_8c-source.html	/^<a name="l00309"><\/a>00309                                         free(authscriptpathfragment);$/;"	a
l00310	doc/html/conf_8c-source.html	/^<a name="l00310"><\/a>00310                                         authscriptpathfragment = safe_strdup(p2);$/;"	a
l00311	doc/html/conf_8c-source.html	/^<a name="l00311"><\/a>00311                                         <span class="keywordflow">break<\/span>;$/;"	a
l00312	doc/html/conf_8c-source.html	/^<a name="l00312"><\/a>00312                                 <span class="keywordflow">case<\/span> oAuthServSSLPort:$/;"	a
l00313	doc/html/conf_8c-source.html	/^<a name="l00313"><\/a>00313                                         ssl_port = atoi(p2);$/;"	a
l00314	doc/html/conf_8c-source.html	/^<a name="l00314"><\/a>00314                                         <span class="keywordflow">break<\/span>;$/;"	a
l00315	doc/html/conf_8c-source.html	/^<a name="l00315"><\/a>00315                                 <span class="keywordflow">case<\/span> oAuthServHTTPPort:$/;"	a
l00316	doc/html/conf_8c-source.html	/^<a name="l00316"><\/a>00316                                         http_port = atoi(p2);$/;"	a
l00317	doc/html/conf_8c-source.html	/^<a name="l00317"><\/a>00317                                         <span class="keywordflow">break<\/span>;$/;"	a
l00318	doc/html/conf_8c-source.html	/^<a name="l00318"><\/a>00318                                 <span class="keywordflow">case<\/span> oAuthServSSLAvailable:$/;"	a
l00319	doc/html/conf_8c-source.html	/^<a name="l00319"><\/a>00319                                         ssl_available = parse_boolean_value(p2);$/;"	a
l00320	doc/html/conf_8c-source.html	/^<a name="l00320"><\/a>00320                                         <span class="keywordflow">if<\/span> (ssl_available &lt; 0)$/;"	a
l00321	doc/html/conf_8c-source.html	/^<a name="l00321"><\/a>00321                                                 ssl_available = 0;$/;"	a
l00322	doc/html/conf_8c-source.html	/^<a name="l00322"><\/a>00322                                         <span class="keywordflow">break<\/span>;$/;"	a
l00323	doc/html/conf_8c-source.html	/^<a name="l00323"><\/a>00323                                 <span class="keywordflow">case<\/span> oBadOption:$/;"	a
l00324	doc/html/conf_8c-source.html	/^<a name="l00324"><\/a>00324                                 <span class="keywordflow">default<\/span>:$/;"	a
l00325	doc/html/conf_8c-source.html	/^<a name="l00325"><\/a>00325                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Bad option on line %d "<\/span>$/;"	a
l00326	doc/html/conf_8c-source.html	/^<a name="l00326"><\/a>00326                                                         <span class="stringliteral">"in %s."<\/span>, *linenum,$/;"	a
l00327	doc/html/conf_8c-source.html	/^<a name="l00327"><\/a>00327                                                         filename);$/;"	a
l00328	doc/html/conf_8c-source.html	/^<a name="l00328"><\/a>00328                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Exiting..."<\/span>);$/;"	a
l00329	doc/html/conf_8c-source.html	/^<a name="l00329"><\/a>00329                                         exit(-1);$/;"	a
l00330	doc/html/conf_8c-source.html	/^<a name="l00330"><\/a>00330                                         <span class="keywordflow">break<\/span>;$/;"	a
l00331	doc/html/conf_8c-source.html	/^<a name="l00331"><\/a>00331                         }$/;"	a
l00332	doc/html/conf_8c-source.html	/^<a name="l00332"><\/a>00332                 }$/;"	a
l00333	doc/html/conf_8c-source.html	/^<a name="l00333"><\/a>00333 $/;"	a
l00334	doc/html/conf_8c-source.html	/^<a name="l00334"><\/a>00334                 <span class="comment">\/* Read next line *\/<\/span>$/;"	a
l00335	doc/html/conf_8c-source.html	/^<a name="l00335"><\/a>00335                 memset(line, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00336	doc/html/conf_8c-source.html	/^<a name="l00336"><\/a>00336                 fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - 1, file);$/;"	a
l00337	doc/html/conf_8c-source.html	/^<a name="l00337"><\/a>00337                 (*linenum)++; <span class="comment">\/* increment line counter. *\/<\/span>$/;"	a
l00338	doc/html/conf_8c-source.html	/^<a name="l00338"><\/a>00338         }$/;"	a
l00339	doc/html/conf_8c-source.html	/^<a name="l00339"><\/a>00339 $/;"	a
l00340	doc/html/conf_8c-source.html	/^<a name="l00340"><\/a>00340         <span class="comment">\/* only proceed if we have an host and a path *\/<\/span>$/;"	a
l00341	doc/html/conf_8c-source.html	/^<a name="l00341"><\/a>00341         <span class="keywordflow">if<\/span> (host == NULL)$/;"	a
l00342	doc/html/conf_8c-source.html	/^<a name="l00342"><\/a>00342                 <span class="keywordflow">return<\/span>;$/;"	a
l00343	doc/html/conf_8c-source.html	/^<a name="l00343"><\/a>00343         $/;"	a
l00344	doc/html/conf_8c-source.html	/^<a name="l00344"><\/a>00344         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Adding %s:%d (SSL: %d) %s to the auth server list"<\/span>,$/;"	a
l00345	doc/html/conf_8c-source.html	/^<a name="l00345"><\/a>00345                         host, http_port, ssl_port, path);$/;"	a
l00346	doc/html/conf_8c-source.html	/^<a name="l00346"><\/a>00346 $/;"	a
l00347	doc/html/conf_8c-source.html	/^<a name="l00347"><\/a>00347         <span class="comment">\/* Allocate memory *\/<\/span>$/;"	a
l00348	doc/html/conf_8c-source.html	/^<a name="l00348"><\/a>00348         <span class="keyword">new<\/span> = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>));$/;"	a
l00349	doc/html/conf_8c-source.html	/^<a name="l00349"><\/a>00349         $/;"	a
l00350	doc/html/conf_8c-source.html	/^<a name="l00350"><\/a>00350         <span class="comment">\/* Fill in struct *\/<\/span>$/;"	a
l00351	doc/html/conf_8c-source.html	/^<a name="l00351"><\/a>00351         memset(<span class="keyword">new<\/span>, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>)); <span class="comment">\/*&lt; Fill all with NULL *\/<\/span>$/;"	a
l00352	doc/html/conf_8c-source.html	/^<a name="l00352"><\/a>00352         <span class="keyword">new<\/span>-&gt;authserv_hostname = host;$/;"	a
l00353	doc/html/conf_8c-source.html	/^<a name="l00353"><\/a>00353         <span class="keyword">new<\/span>-&gt;authserv_use_ssl = ssl_available;$/;"	a
l00354	doc/html/conf_8c-source.html	/^<a name="l00354"><\/a>00354         <span class="keyword">new<\/span>-&gt;authserv_path = path;$/;"	a
l00355	doc/html/conf_8c-source.html	/^<a name="l00355"><\/a>00355         <span class="keyword">new<\/span>-&gt;authserv_login_script_path_fragment = loginscriptpathfragment;$/;"	a
l00356	doc/html/conf_8c-source.html	/^<a name="l00356"><\/a>00356         <span class="keyword">new<\/span>-&gt;authserv_portal_script_path_fragment = portalscriptpathfragment;$/;"	a
l00357	doc/html/conf_8c-source.html	/^<a name="l00357"><\/a>00357         <span class="keyword">new<\/span>-&gt;authserv_msg_script_path_fragment = msgscriptpathfragment;    $/;"	a
l00358	doc/html/conf_8c-source.html	/^<a name="l00358"><\/a>00358         <span class="keyword">new<\/span>-&gt;authserv_ping_script_path_fragment = pingscriptpathfragment;  $/;"	a
l00359	doc/html/conf_8c-source.html	/^<a name="l00359"><\/a>00359         <span class="keyword">new<\/span>-&gt;authserv_auth_script_path_fragment = authscriptpathfragment;  $/;"	a
l00360	doc/html/conf_8c-source.html	/^<a name="l00360"><\/a>00360         <span class="keyword">new<\/span>-&gt;authserv_http_port = http_port;$/;"	a
l00361	doc/html/conf_8c-source.html	/^<a name="l00361"><\/a>00361         <span class="keyword">new<\/span>-&gt;authserv_ssl_port = ssl_port;$/;"	a
l00362	doc/html/conf_8c-source.html	/^<a name="l00362"><\/a>00362         $/;"	a
l00363	doc/html/conf_8c-source.html	/^<a name="l00363"><\/a>00363         <span class="comment">\/* If it's the first, add to config, else append to last server *\/<\/span>$/;"	a
l00364	doc/html/conf_8c-source.html	/^<a name="l00364"><\/a>00364         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> == NULL) {$/;"	a
l00365	doc/html/conf_8c-source.html	/^<a name="l00365"><\/a>00365                 config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> = <span class="keyword">new<\/span>;$/;"	a
l00366	doc/html/conf_8c-source.html	/^<a name="l00366"><\/a>00366         } <span class="keywordflow">else<\/span> {$/;"	a
l00367	doc/html/conf_8c-source.html	/^<a name="l00367"><\/a>00367                 <span class="keywordflow">for<\/span> (tmp = config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> != NULL;$/;"	a
l00368	doc/html/conf_8c-source.html	/^<a name="l00368"><\/a>00368                                 tmp = tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>);$/;"	a
l00369	doc/html/conf_8c-source.html	/^<a name="l00369"><\/a>00369                 tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> = <span class="keyword">new<\/span>;$/;"	a
l00370	doc/html/conf_8c-source.html	/^<a name="l00370"><\/a>00370         }$/;"	a
l00371	doc/html/conf_8c-source.html	/^<a name="l00371"><\/a>00371         $/;"	a
l00372	doc/html/conf_8c-source.html	/^<a name="l00372"><\/a>00372         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Auth server added"<\/span>);$/;"	a
l00373	doc/html/conf_8c-source.html	/^<a name="l00373"><\/a>00373 }$/;"	a
l00374	doc/html/conf_8c-source.html	/^<a name="l00374"><\/a>00374 $/;"	a
l00384	doc/html/conf_8c-source.html	/^<a name="l00384"><\/a><a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">00384<\/a> <span class="preprocessor">#define TO_NEXT_WORD(s, e) do { \\<\/span>$/;"	a
l00385	doc/html/conf_8c-source.html	/^<a name="l00385"><\/a>00385 <span class="preprocessor">        while (*s != '\\0' &amp;&amp; !isblank(*s)) { \\<\/span>$/;"	a
l00386	doc/html/conf_8c-source.html	/^<a name="l00386"><\/a>00386 <span class="preprocessor">                s++; \\<\/span>$/;"	a
l00387	doc/html/conf_8c-source.html	/^<a name="l00387"><\/a>00387 <span class="preprocessor">        } \\<\/span>$/;"	a
l00388	doc/html/conf_8c-source.html	/^<a name="l00388"><\/a>00388 <span class="preprocessor">        if (*s != '\\0') { \\<\/span>$/;"	a
l00389	doc/html/conf_8c-source.html	/^<a name="l00389"><\/a>00389 <span class="preprocessor">                *s = '\\0'; \\<\/span>$/;"	a
l00390	doc/html/conf_8c-source.html	/^<a name="l00390"><\/a>00390 <span class="preprocessor">                s++; \\<\/span>$/;"	a
l00391	doc/html/conf_8c-source.html	/^<a name="l00391"><\/a>00391 <span class="preprocessor">                while (isblank(*s)) \\<\/span>$/;"	a
l00392	doc/html/conf_8c-source.html	/^<a name="l00392"><\/a>00392 <span class="preprocessor">                        s++; \\<\/span>$/;"	a
l00393	doc/html/conf_8c-source.html	/^<a name="l00393"><\/a>00393 <span class="preprocessor">        } else { \\<\/span>$/;"	a
l00394	doc/html/conf_8c-source.html	/^<a name="l00394"><\/a>00394 <span class="preprocessor">                e = 1; \\<\/span>$/;"	a
l00395	doc/html/conf_8c-source.html	/^<a name="l00395"><\/a>00395 <span class="preprocessor">        } \\<\/span>$/;"	a
l00396	doc/html/conf_8c-source.html	/^<a name="l00396"><\/a>00396 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00397	doc/html/conf_8c-source.html	/^<a name="l00397"><\/a>00397 <span class="preprocessor"><\/span>$/;"	a
l00401	doc/html/conf_8c-source.html	/^<a name="l00401"><\/a>00401 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00402	doc/html/conf_8c-source.html	/^<a name="l00402"><\/a>00402 parse_firewall_ruleset(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset, FILE *file, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> *linenum)$/;"	a
l00403	doc/html/conf_8c-source.html	/^<a name="l00403"><\/a>00403 {$/;"	a
l00404	doc/html/conf_8c-source.html	/^<a name="l00404"><\/a>00404         <span class="keywordtype">char<\/span>            line[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>],$/;"	a
l00405	doc/html/conf_8c-source.html	/^<a name="l00405"><\/a>00405                         *p1,$/;"	a
l00406	doc/html/conf_8c-source.html	/^<a name="l00406"><\/a>00406                         *p2;$/;"	a
l00407	doc/html/conf_8c-source.html	/^<a name="l00407"><\/a>00407         <span class="keywordtype">int<\/span>             opcode;$/;"	a
l00408	doc/html/conf_8c-source.html	/^<a name="l00408"><\/a>00408 $/;"	a
l00409	doc/html/conf_8c-source.html	/^<a name="l00409"><\/a>00409         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Adding Firewall Rule Set %s"<\/span>, ruleset);$/;"	a
l00410	doc/html/conf_8c-source.html	/^<a name="l00410"><\/a>00410         $/;"	a
l00411	doc/html/conf_8c-source.html	/^<a name="l00411"><\/a>00411         <span class="comment">\/* Read first line *\/<\/span>   $/;"	a
l00412	doc/html/conf_8c-source.html	/^<a name="l00412"><\/a>00412         memset(line, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00413	doc/html/conf_8c-source.html	/^<a name="l00413"><\/a>00413         fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - 1, file);$/;"	a
l00414	doc/html/conf_8c-source.html	/^<a name="l00414"><\/a>00414         (*linenum)++; <span class="comment">\/* increment line counter. *\/<\/span>$/;"	a
l00415	doc/html/conf_8c-source.html	/^<a name="l00415"><\/a>00415 $/;"	a
l00416	doc/html/conf_8c-source.html	/^<a name="l00416"><\/a>00416         <span class="comment">\/* Parsing loop *\/<\/span>$/;"	a
l00417	doc/html/conf_8c-source.html	/^<a name="l00417"><\/a>00417         <span class="keywordflow">while<\/span> ((line[0] != <span class="charliteral">'\\0'<\/span>) &amp;&amp; (strchr(line, <span class="charliteral">'}'<\/span>) == NULL)) {$/;"	a
l00418	doc/html/conf_8c-source.html	/^<a name="l00418"><\/a>00418                 <span class="comment">\/* skip leading blank spaces *\/<\/span>$/;"	a
l00419	doc/html/conf_8c-source.html	/^<a name="l00419"><\/a>00419                 <span class="keywordflow">for<\/span> (p1 = line; isblank(*p1); p1++);$/;"	a
l00420	doc/html/conf_8c-source.html	/^<a name="l00420"><\/a>00420 $/;"	a
l00421	doc/html/conf_8c-source.html	/^<a name="l00421"><\/a>00421                 <span class="comment">\/* End at end of line *\/<\/span>$/;"	a
l00422	doc/html/conf_8c-source.html	/^<a name="l00422"><\/a>00422                 <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'#'<\/span>)) != NULL) {$/;"	a
l00423	doc/html/conf_8c-source.html	/^<a name="l00423"><\/a>00423                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00424	doc/html/conf_8c-source.html	/^<a name="l00424"><\/a>00424                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\r'<\/span>)) != NULL) {$/;"	a
l00425	doc/html/conf_8c-source.html	/^<a name="l00425"><\/a>00425                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00426	doc/html/conf_8c-source.html	/^<a name="l00426"><\/a>00426                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\n'<\/span>)) != NULL) {$/;"	a
l00427	doc/html/conf_8c-source.html	/^<a name="l00427"><\/a>00427                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00428	doc/html/conf_8c-source.html	/^<a name="l00428"><\/a>00428                 }$/;"	a
l00429	doc/html/conf_8c-source.html	/^<a name="l00429"><\/a>00429 $/;"	a
l00430	doc/html/conf_8c-source.html	/^<a name="l00430"><\/a>00430                 <span class="comment">\/* next, we coopt the parsing of the regular config *\/<\/span>$/;"	a
l00431	doc/html/conf_8c-source.html	/^<a name="l00431"><\/a>00431                 <span class="keywordflow">if<\/span> (strlen(p1) &gt; 0) {$/;"	a
l00432	doc/html/conf_8c-source.html	/^<a name="l00432"><\/a>00432                         p2 = p1;$/;"	a
l00433	doc/html/conf_8c-source.html	/^<a name="l00433"><\/a>00433                         <span class="comment">\/* keep going until word boundary is found. *\/<\/span>$/;"	a
l00434	doc/html/conf_8c-source.html	/^<a name="l00434"><\/a>00434                         <span class="keywordflow">while<\/span> ((*p2 != <span class="charliteral">'\\0'<\/span>) &amp;&amp; (!isblank(*p2)))$/;"	a
l00435	doc/html/conf_8c-source.html	/^<a name="l00435"><\/a>00435                                 p2++;$/;"	a
l00436	doc/html/conf_8c-source.html	/^<a name="l00436"><\/a>00436 $/;"	a
l00437	doc/html/conf_8c-source.html	/^<a name="l00437"><\/a>00437                         <span class="comment">\/* Terminate first word. *\/<\/span>$/;"	a
l00438	doc/html/conf_8c-source.html	/^<a name="l00438"><\/a>00438                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00439	doc/html/conf_8c-source.html	/^<a name="l00439"><\/a>00439                         p2++;$/;"	a
l00440	doc/html/conf_8c-source.html	/^<a name="l00440"><\/a>00440 $/;"	a
l00441	doc/html/conf_8c-source.html	/^<a name="l00441"><\/a>00441                         <span class="comment">\/* skip all further blanks. *\/<\/span>$/;"	a
l00442	doc/html/conf_8c-source.html	/^<a name="l00442"><\/a>00442                         <span class="keywordflow">while<\/span> (isblank(*p2))$/;"	a
l00443	doc/html/conf_8c-source.html	/^<a name="l00443"><\/a>00443                                 p2++;$/;"	a
l00444	doc/html/conf_8c-source.html	/^<a name="l00444"><\/a>00444                         $/;"	a
l00445	doc/html/conf_8c-source.html	/^<a name="l00445"><\/a>00445                         <span class="comment">\/* Get opcode *\/<\/span>$/;"	a
l00446	doc/html/conf_8c-source.html	/^<a name="l00446"><\/a>00446                         opcode = config_parse_token(p1, filename, *linenum);$/;"	a
l00447	doc/html/conf_8c-source.html	/^<a name="l00447"><\/a>00447 $/;"	a
l00448	doc/html/conf_8c-source.html	/^<a name="l00448"><\/a>00448                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"p1 = [%s]; p2 = [%s]"<\/span>, p1, p2);$/;"	a
l00449	doc/html/conf_8c-source.html	/^<a name="l00449"><\/a>00449                         $/;"	a
l00450	doc/html/conf_8c-source.html	/^<a name="l00450"><\/a>00450                         <span class="keywordflow">switch<\/span> (opcode) {$/;"	a
l00451	doc/html/conf_8c-source.html	/^<a name="l00451"><\/a>00451                                 <span class="keywordflow">case<\/span> oFirewallRule:$/;"	a
l00452	doc/html/conf_8c-source.html	/^<a name="l00452"><\/a>00452                                         <a class="code" href="conf_8c.html#c10ca895b5a20b458c1599f8a9766f4d">_parse_firewall_rule<\/a>(ruleset, p2);$/;"	a
l00453	doc/html/conf_8c-source.html	/^<a name="l00453"><\/a>00453                                         <span class="keywordflow">break<\/span>;$/;"	a
l00454	doc/html/conf_8c-source.html	/^<a name="l00454"><\/a>00454 $/;"	a
l00455	doc/html/conf_8c-source.html	/^<a name="l00455"><\/a>00455                                 <span class="keywordflow">case<\/span> oBadOption:$/;"	a
l00456	doc/html/conf_8c-source.html	/^<a name="l00456"><\/a>00456                                 <span class="keywordflow">default<\/span>:$/;"	a
l00457	doc/html/conf_8c-source.html	/^<a name="l00457"><\/a>00457                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Bad option on line %d "<\/span>$/;"	a
l00458	doc/html/conf_8c-source.html	/^<a name="l00458"><\/a>00458                                                         <span class="stringliteral">"in %s."<\/span>, *linenum,$/;"	a
l00459	doc/html/conf_8c-source.html	/^<a name="l00459"><\/a>00459                                                         filename);$/;"	a
l00460	doc/html/conf_8c-source.html	/^<a name="l00460"><\/a>00460                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Exiting..."<\/span>);$/;"	a
l00461	doc/html/conf_8c-source.html	/^<a name="l00461"><\/a>00461                                         exit(-1);$/;"	a
l00462	doc/html/conf_8c-source.html	/^<a name="l00462"><\/a>00462                                         <span class="keywordflow">break<\/span>;$/;"	a
l00463	doc/html/conf_8c-source.html	/^<a name="l00463"><\/a>00463                         }$/;"	a
l00464	doc/html/conf_8c-source.html	/^<a name="l00464"><\/a>00464                 }$/;"	a
l00465	doc/html/conf_8c-source.html	/^<a name="l00465"><\/a>00465 $/;"	a
l00466	doc/html/conf_8c-source.html	/^<a name="l00466"><\/a>00466                 <span class="comment">\/* Read next line *\/<\/span>$/;"	a
l00467	doc/html/conf_8c-source.html	/^<a name="l00467"><\/a>00467                 memset(line, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00468	doc/html/conf_8c-source.html	/^<a name="l00468"><\/a>00468                 fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - 1, file);$/;"	a
l00469	doc/html/conf_8c-source.html	/^<a name="l00469"><\/a>00469                 (*linenum)++; <span class="comment">\/* increment line counter. *\/<\/span>$/;"	a
l00470	doc/html/conf_8c-source.html	/^<a name="l00470"><\/a>00470         }$/;"	a
l00471	doc/html/conf_8c-source.html	/^<a name="l00471"><\/a>00471 $/;"	a
l00472	doc/html/conf_8c-source.html	/^<a name="l00472"><\/a>00472         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Firewall Rule Set %s added."<\/span>, ruleset);$/;"	a
l00473	doc/html/conf_8c-source.html	/^<a name="l00473"><\/a>00473 }$/;"	a
l00474	doc/html/conf_8c-source.html	/^<a name="l00474"><\/a>00474 $/;"	a
l00478	doc/html/conf_8c-source.html	/^<a name="l00478"><\/a>00478 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span>$/;"	a
l00479	doc/html/conf_8c-source.html	/^<a name="l00479"><\/a><a class="code" href="conf_8c.html#c10ca895b5a20b458c1599f8a9766f4d">00479<\/a> <a class="code" href="conf_8c.html#c10ca895b5a20b458c1599f8a9766f4d">_parse_firewall_rule<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset, <span class="keywordtype">char<\/span> *leftover)$/;"	a
l00480	doc/html/conf_8c-source.html	/^<a name="l00480"><\/a>00480 {$/;"	a
l00481	doc/html/conf_8c-source.html	/^<a name="l00481"><\/a>00481         <span class="keywordtype">int<\/span> i;$/;"	a
l00482	doc/html/conf_8c-source.html	/^<a name="l00482"><\/a>00482         <span class="keywordtype">int<\/span> block_allow = 0; $/;"	a
l00483	doc/html/conf_8c-source.html	/^<a name="l00483"><\/a>00483         <span class="keywordtype">int<\/span> all_nums = 1; $/;"	a
l00484	doc/html/conf_8c-source.html	/^<a name="l00484"><\/a>00484         <span class="keywordtype">int<\/span> finished = 0; $/;"	a
l00485	doc/html/conf_8c-source.html	/^<a name="l00485"><\/a>00485         <span class="keywordtype">char<\/span> *token = NULL; $/;"	a
l00486	doc/html/conf_8c-source.html	/^<a name="l00486"><\/a>00486         <span class="keywordtype">char<\/span> *port = NULL; $/;"	a
l00487	doc/html/conf_8c-source.html	/^<a name="l00487"><\/a>00487         <span class="keywordtype">char<\/span> *protocol = NULL; $/;"	a
l00488	doc/html/conf_8c-source.html	/^<a name="l00488"><\/a>00488         <span class="keywordtype">char<\/span> *mask = NULL; $/;"	a
l00489	doc/html/conf_8c-source.html	/^<a name="l00489"><\/a>00489         <span class="keywordtype">char<\/span> *other_kw = NULL; $/;"	a
l00490	doc/html/conf_8c-source.html	/^<a name="l00490"><\/a>00490         <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a> *tmpr;$/;"	a
l00491	doc/html/conf_8c-source.html	/^<a name="l00491"><\/a>00491         <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a> *tmpr2;$/;"	a
l00492	doc/html/conf_8c-source.html	/^<a name="l00492"><\/a>00492         <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *tmp;$/;"	a
l00493	doc/html/conf_8c-source.html	/^<a name="l00493"><\/a>00493         <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *tmp2;$/;"	a
l00494	doc/html/conf_8c-source.html	/^<a name="l00494"><\/a>00494 $/;"	a
l00495	doc/html/conf_8c-source.html	/^<a name="l00495"><\/a>00495         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"leftover: %s"<\/span>, leftover);$/;"	a
l00496	doc/html/conf_8c-source.html	/^<a name="l00496"><\/a>00496 $/;"	a
l00497	doc/html/conf_8c-source.html	/^<a name="l00497"><\/a>00497         <span class="comment">\/* lower case *\/<\/span>$/;"	a
l00498	doc/html/conf_8c-source.html	/^<a name="l00498"><\/a>00498         <span class="keywordflow">for<\/span> (i = 0; *(leftover + i) != <span class="charliteral">'\\0'<\/span>$/;"	a
l00499	doc/html/conf_8c-source.html	/^<a name="l00499"><\/a>00499                         &amp;&amp; (*(leftover + i) = tolower((<span class="keywordtype">unsigned<\/span> <span class="keywordtype">char<\/span>)*(leftover + i))); i++);$/;"	a
l00500	doc/html/conf_8c-source.html	/^<a name="l00500"><\/a>00500         $/;"	a
l00501	doc/html/conf_8c-source.html	/^<a name="l00501"><\/a>00501         token = leftover;$/;"	a
l00502	doc/html/conf_8c-source.html	/^<a name="l00502"><\/a>00502         <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00503	doc/html/conf_8c-source.html	/^<a name="l00503"><\/a>00503         $/;"	a
l00504	doc/html/conf_8c-source.html	/^<a name="l00504"><\/a>00504         <span class="comment">\/* Parse token *\/<\/span>$/;"	a
l00505	doc/html/conf_8c-source.html	/^<a name="l00505"><\/a>00505         <span class="keywordflow">if<\/span> (!strcasecmp(token, <span class="stringliteral">"block"<\/span>) || finished) {$/;"	a
l00506	doc/html/conf_8c-source.html	/^<a name="l00506"><\/a>00506                 block_allow = 0;$/;"	a
l00507	doc/html/conf_8c-source.html	/^<a name="l00507"><\/a>00507         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (!strcasecmp(token, <span class="stringliteral">"allow"<\/span>)) {$/;"	a
l00508	doc/html/conf_8c-source.html	/^<a name="l00508"><\/a>00508                 block_allow = 1;$/;"	a
l00509	doc/html/conf_8c-source.html	/^<a name="l00509"><\/a>00509         } <span class="keywordflow">else<\/span> {$/;"	a
l00510	doc/html/conf_8c-source.html	/^<a name="l00510"><\/a>00510                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid rule type %s, expecting "<\/span>$/;"	a
l00511	doc/html/conf_8c-source.html	/^<a name="l00511"><\/a>00511                                 <span class="stringliteral">"\\"block\\" or \\"allow\\""<\/span>, token);$/;"	a
l00512	doc/html/conf_8c-source.html	/^<a name="l00512"><\/a>00512                 <span class="keywordflow">return<\/span> -1;$/;"	a
l00513	doc/html/conf_8c-source.html	/^<a name="l00513"><\/a>00513         }$/;"	a
l00514	doc/html/conf_8c-source.html	/^<a name="l00514"><\/a>00514 $/;"	a
l00515	doc/html/conf_8c-source.html	/^<a name="l00515"><\/a>00515         <span class="comment">\/* Parse the remainder *\/<\/span>$/;"	a
l00516	doc/html/conf_8c-source.html	/^<a name="l00516"><\/a>00516         <span class="comment">\/* Get the protocol *\/<\/span>$/;"	a
l00517	doc/html/conf_8c-source.html	/^<a name="l00517"><\/a>00517         <span class="keywordflow">if<\/span> (strncmp(leftover, <span class="stringliteral">"tcp"<\/span>, 3) == 0$/;"	a
l00518	doc/html/conf_8c-source.html	/^<a name="l00518"><\/a>00518                         || strncmp(leftover, <span class="stringliteral">"udp"<\/span>, 3) == 0$/;"	a
l00519	doc/html/conf_8c-source.html	/^<a name="l00519"><\/a>00519                         || strncmp(leftover, <span class="stringliteral">"icmp"<\/span>, 4) == 0) {$/;"	a
l00520	doc/html/conf_8c-source.html	/^<a name="l00520"><\/a>00520                 protocol = leftover;$/;"	a
l00521	doc/html/conf_8c-source.html	/^<a name="l00521"><\/a>00521                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00522	doc/html/conf_8c-source.html	/^<a name="l00522"><\/a>00522         }$/;"	a
l00523	doc/html/conf_8c-source.html	/^<a name="l00523"><\/a>00523 $/;"	a
l00524	doc/html/conf_8c-source.html	/^<a name="l00524"><\/a>00524         <span class="comment">\/* should be exactly "port" *\/<\/span>$/;"	a
l00525	doc/html/conf_8c-source.html	/^<a name="l00525"><\/a>00525         <span class="keywordflow">if<\/span> (strncmp(leftover, <span class="stringliteral">"port"<\/span>, 4) == 0) {$/;"	a
l00526	doc/html/conf_8c-source.html	/^<a name="l00526"><\/a>00526                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00527	doc/html/conf_8c-source.html	/^<a name="l00527"><\/a>00527                 <span class="comment">\/* Get port now *\/<\/span>$/;"	a
l00528	doc/html/conf_8c-source.html	/^<a name="l00528"><\/a>00528                 port = leftover;$/;"	a
l00529	doc/html/conf_8c-source.html	/^<a name="l00529"><\/a>00529                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00530	doc/html/conf_8c-source.html	/^<a name="l00530"><\/a>00530                 <span class="keywordflow">for<\/span> (i = 0; *(port + i) != <span class="charliteral">'\\0'<\/span>; i++)$/;"	a
l00531	doc/html/conf_8c-source.html	/^<a name="l00531"><\/a>00531                         <span class="keywordflow">if<\/span> (!isdigit((<span class="keywordtype">unsigned<\/span> <span class="keywordtype">char<\/span>)*(port + i)))$/;"	a
l00532	doc/html/conf_8c-source.html	/^<a name="l00532"><\/a>00532                                 all_nums = 0; <span class="comment">\/*&lt; No longer only digits *\/<\/span>$/;"	a
l00533	doc/html/conf_8c-source.html	/^<a name="l00533"><\/a>00533                 <span class="keywordflow">if<\/span> (!all_nums) {$/;"	a
l00534	doc/html/conf_8c-source.html	/^<a name="l00534"><\/a>00534                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid port %s"<\/span>, port);$/;"	a
l00535	doc/html/conf_8c-source.html	/^<a name="l00535"><\/a>00535                         <span class="keywordflow">return<\/span> -3; <span class="comment">\/*&lt; Fail *\/<\/span>$/;"	a
l00536	doc/html/conf_8c-source.html	/^<a name="l00536"><\/a>00536                 }$/;"	a
l00537	doc/html/conf_8c-source.html	/^<a name="l00537"><\/a>00537         }$/;"	a
l00538	doc/html/conf_8c-source.html	/^<a name="l00538"><\/a>00538 $/;"	a
l00539	doc/html/conf_8c-source.html	/^<a name="l00539"><\/a>00539         <span class="comment">\/* Now, further stuff is optional *\/<\/span>$/;"	a
l00540	doc/html/conf_8c-source.html	/^<a name="l00540"><\/a>00540         <span class="keywordflow">if<\/span> (!finished) {$/;"	a
l00541	doc/html/conf_8c-source.html	/^<a name="l00541"><\/a>00541                 <span class="comment">\/* should be exactly "to" *\/<\/span>$/;"	a
l00542	doc/html/conf_8c-source.html	/^<a name="l00542"><\/a>00542                 other_kw = leftover;$/;"	a
l00543	doc/html/conf_8c-source.html	/^<a name="l00543"><\/a>00543                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00544	doc/html/conf_8c-source.html	/^<a name="l00544"><\/a>00544                 <span class="keywordflow">if<\/span> (strcmp(other_kw, <span class="stringliteral">"to"<\/span>) || finished) {$/;"	a
l00545	doc/html/conf_8c-source.html	/^<a name="l00545"><\/a>00545                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid or unexpected keyword %s, "<\/span>$/;"	a
l00546	doc/html/conf_8c-source.html	/^<a name="l00546"><\/a>00546                                         <span class="stringliteral">"expecting \\"to\\""<\/span>, other_kw);$/;"	a
l00547	doc/html/conf_8c-source.html	/^<a name="l00547"><\/a>00547                         <span class="keywordflow">return<\/span> -4; <span class="comment">\/*&lt; Fail *\/<\/span>$/;"	a
l00548	doc/html/conf_8c-source.html	/^<a name="l00548"><\/a>00548                 }$/;"	a
l00549	doc/html/conf_8c-source.html	/^<a name="l00549"><\/a>00549 $/;"	a
l00550	doc/html/conf_8c-source.html	/^<a name="l00550"><\/a>00550                 <span class="comment">\/* Get port now *\/<\/span>$/;"	a
l00551	doc/html/conf_8c-source.html	/^<a name="l00551"><\/a>00551                 mask = leftover;$/;"	a
l00552	doc/html/conf_8c-source.html	/^<a name="l00552"><\/a>00552                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00553	doc/html/conf_8c-source.html	/^<a name="l00553"><\/a>00553                 all_nums = 1;$/;"	a
l00554	doc/html/conf_8c-source.html	/^<a name="l00554"><\/a>00554                 <span class="keywordflow">for<\/span> (i = 0; *(mask + i) != <span class="charliteral">'\\0'<\/span>; i++)$/;"	a
l00555	doc/html/conf_8c-source.html	/^<a name="l00555"><\/a>00555                         <span class="keywordflow">if<\/span> (!isdigit((<span class="keywordtype">unsigned<\/span> <span class="keywordtype">char<\/span>)*(mask + i)) &amp;&amp; (*(mask + i) != <span class="charliteral">'.'<\/span>)$/;"	a
l00556	doc/html/conf_8c-source.html	/^<a name="l00556"><\/a>00556                                         &amp;&amp; (*(mask + i) != <span class="charliteral">'\/'<\/span>))$/;"	a
l00557	doc/html/conf_8c-source.html	/^<a name="l00557"><\/a>00557                                 all_nums = 0; <span class="comment">\/*&lt; No longer only digits *\/<\/span>$/;"	a
l00558	doc/html/conf_8c-source.html	/^<a name="l00558"><\/a>00558                 <span class="keywordflow">if<\/span> (!all_nums) {$/;"	a
l00559	doc/html/conf_8c-source.html	/^<a name="l00559"><\/a>00559                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid mask %s"<\/span>, mask);$/;"	a
l00560	doc/html/conf_8c-source.html	/^<a name="l00560"><\/a>00560                         <span class="keywordflow">return<\/span> -3; <span class="comment">\/*&lt; Fail *\/<\/span>$/;"	a
l00561	doc/html/conf_8c-source.html	/^<a name="l00561"><\/a>00561                 }$/;"	a
l00562	doc/html/conf_8c-source.html	/^<a name="l00562"><\/a>00562         }$/;"	a
l00563	doc/html/conf_8c-source.html	/^<a name="l00563"><\/a>00563 $/;"	a
l00564	doc/html/conf_8c-source.html	/^<a name="l00564"><\/a>00564         <span class="comment">\/* Generate rule record *\/<\/span>$/;"	a
l00565	doc/html/conf_8c-source.html	/^<a name="l00565"><\/a>00565         tmp = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>));$/;"	a
l00566	doc/html/conf_8c-source.html	/^<a name="l00566"><\/a>00566         memset((<span class="keywordtype">void<\/span> *)tmp, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>));$/;"	a
l00567	doc/html/conf_8c-source.html	/^<a name="l00567"><\/a>00567         tmp-&gt;block_allow = block_allow;$/;"	a
l00568	doc/html/conf_8c-source.html	/^<a name="l00568"><\/a>00568         <span class="keywordflow">if<\/span> (protocol != NULL)$/;"	a
l00569	doc/html/conf_8c-source.html	/^<a name="l00569"><\/a>00569                 tmp-&gt;protocol = safe_strdup(protocol);$/;"	a
l00570	doc/html/conf_8c-source.html	/^<a name="l00570"><\/a>00570         <span class="keywordflow">if<\/span> (port != NULL)$/;"	a
l00571	doc/html/conf_8c-source.html	/^<a name="l00571"><\/a>00571                 tmp-&gt;port = safe_strdup(port);$/;"	a
l00572	doc/html/conf_8c-source.html	/^<a name="l00572"><\/a>00572         <span class="keywordflow">if<\/span> (mask == NULL)$/;"	a
l00573	doc/html/conf_8c-source.html	/^<a name="l00573"><\/a>00573                 tmp-&gt;mask = safe_strdup(<span class="stringliteral">"0.0.0.0\/0"<\/span>);$/;"	a
l00574	doc/html/conf_8c-source.html	/^<a name="l00574"><\/a>00574         <span class="keywordflow">else<\/span>$/;"	a
l00575	doc/html/conf_8c-source.html	/^<a name="l00575"><\/a>00575                 tmp-&gt;mask = safe_strdup(mask);$/;"	a
l00576	doc/html/conf_8c-source.html	/^<a name="l00576"><\/a>00576 $/;"	a
l00577	doc/html/conf_8c-source.html	/^<a name="l00577"><\/a>00577         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Adding Firewall Rule %s %s port %s to %s"<\/span>, token, tmp-&gt;protocol, tmp-&gt;port, tmp-&gt;mask);$/;"	a
l00578	doc/html/conf_8c-source.html	/^<a name="l00578"><\/a>00578         $/;"	a
l00579	doc/html/conf_8c-source.html	/^<a name="l00579"><\/a>00579         <span class="comment">\/* Append the rule record *\/<\/span>$/;"	a
l00580	doc/html/conf_8c-source.html	/^<a name="l00580"><\/a>00580         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a> == NULL) {$/;"	a
l00581	doc/html/conf_8c-source.html	/^<a name="l00581"><\/a>00581                 config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a> = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>));$/;"	a
l00582	doc/html/conf_8c-source.html	/^<a name="l00582"><\/a>00582                 memset(config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>));$/;"	a
l00583	doc/html/conf_8c-source.html	/^<a name="l00583"><\/a>00583                 config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>-&gt;<a class="code" href="struct__firewall__ruleset__t.html#01cf836d509e646ac7fee6d5ac791ead">name<\/a> = safe_strdup(ruleset);$/;"	a
l00584	doc/html/conf_8c-source.html	/^<a name="l00584"><\/a>00584                 tmpr = config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>;$/;"	a
l00585	doc/html/conf_8c-source.html	/^<a name="l00585"><\/a>00585         } <span class="keywordflow">else<\/span> {$/;"	a
l00586	doc/html/conf_8c-source.html	/^<a name="l00586"><\/a>00586                 tmpr2 = tmpr = config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>;$/;"	a
l00587	doc/html/conf_8c-source.html	/^<a name="l00587"><\/a>00587                 <span class="keywordflow">while<\/span> (tmpr != NULL &amp;&amp; (strcmp(tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#01cf836d509e646ac7fee6d5ac791ead">name<\/a>, ruleset) != 0)) {$/;"	a
l00588	doc/html/conf_8c-source.html	/^<a name="l00588"><\/a>00588                         tmpr2 = tmpr;$/;"	a
l00589	doc/html/conf_8c-source.html	/^<a name="l00589"><\/a>00589                         tmpr = tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#51556fca7d717b95a9b53695bfd0c07a">next<\/a>;$/;"	a
l00590	doc/html/conf_8c-source.html	/^<a name="l00590"><\/a>00590                 }$/;"	a
l00591	doc/html/conf_8c-source.html	/^<a name="l00591"><\/a>00591                 <span class="keywordflow">if<\/span> (tmpr == NULL) {$/;"	a
l00592	doc/html/conf_8c-source.html	/^<a name="l00592"><\/a>00592                         <span class="comment">\/* Rule did not exist *\/<\/span>$/;"	a
l00593	doc/html/conf_8c-source.html	/^<a name="l00593"><\/a>00593                         tmpr = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>));$/;"	a
l00594	doc/html/conf_8c-source.html	/^<a name="l00594"><\/a>00594                         memset(tmpr, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>));$/;"	a
l00595	doc/html/conf_8c-source.html	/^<a name="l00595"><\/a>00595                         tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#01cf836d509e646ac7fee6d5ac791ead">name<\/a> = safe_strdup(ruleset);$/;"	a
l00596	doc/html/conf_8c-source.html	/^<a name="l00596"><\/a>00596                         tmpr2-&gt;<a class="code" href="struct__firewall__ruleset__t.html#51556fca7d717b95a9b53695bfd0c07a">next<\/a> = tmpr;$/;"	a
l00597	doc/html/conf_8c-source.html	/^<a name="l00597"><\/a>00597                 }$/;"	a
l00598	doc/html/conf_8c-source.html	/^<a name="l00598"><\/a>00598         }$/;"	a
l00599	doc/html/conf_8c-source.html	/^<a name="l00599"><\/a>00599 $/;"	a
l00600	doc/html/conf_8c-source.html	/^<a name="l00600"><\/a>00600         <span class="comment">\/* At this point, tmpr == current ruleset *\/<\/span>$/;"	a
l00601	doc/html/conf_8c-source.html	/^<a name="l00601"><\/a>00601         <span class="keywordflow">if<\/span> (tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#ee34ad9758267b6ae770681d6017a4a7">rules<\/a> == NULL) {$/;"	a
l00602	doc/html/conf_8c-source.html	/^<a name="l00602"><\/a>00602                 <span class="comment">\/* No rules... *\/<\/span>$/;"	a
l00603	doc/html/conf_8c-source.html	/^<a name="l00603"><\/a>00603                 tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#ee34ad9758267b6ae770681d6017a4a7">rules<\/a> = tmp;$/;"	a
l00604	doc/html/conf_8c-source.html	/^<a name="l00604"><\/a>00604         } <span class="keywordflow">else<\/span> {$/;"	a
l00605	doc/html/conf_8c-source.html	/^<a name="l00605"><\/a>00605                 tmp2 = tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#ee34ad9758267b6ae770681d6017a4a7">rules<\/a>;$/;"	a
l00606	doc/html/conf_8c-source.html	/^<a name="l00606"><\/a>00606                 <span class="keywordflow">while<\/span> (tmp2-&gt;<a class="code" href="struct__firewall__rule__t.html#46cf31ace7a4781cd8f67fbf3c8f75de">next<\/a> != NULL)$/;"	a
l00607	doc/html/conf_8c-source.html	/^<a name="l00607"><\/a>00607                         tmp2 = tmp2-&gt;<a class="code" href="struct__firewall__rule__t.html#46cf31ace7a4781cd8f67fbf3c8f75de">next<\/a>;$/;"	a
l00608	doc/html/conf_8c-source.html	/^<a name="l00608"><\/a>00608                 tmp2-&gt;<a class="code" href="struct__firewall__rule__t.html#46cf31ace7a4781cd8f67fbf3c8f75de">next<\/a> = tmp;$/;"	a
l00609	doc/html/conf_8c-source.html	/^<a name="l00609"><\/a>00609         }$/;"	a
l00610	doc/html/conf_8c-source.html	/^<a name="l00610"><\/a>00610         $/;"	a
l00611	doc/html/conf_8c-source.html	/^<a name="l00611"><\/a>00611         <span class="keywordflow">return<\/span> 1;$/;"	a
l00612	doc/html/conf_8c-source.html	/^<a name="l00612"><\/a>00612 }$/;"	a
l00613	doc/html/conf_8c-source.html	/^<a name="l00613"><\/a>00613 $/;"	a
l00614	doc/html/conf_8c-source.html	/^<a name="l00614"><\/a>00614 <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *$/;"	a
l00615	doc/html/conf_8c-source.html	/^<a name="l00615"><\/a><a class="code" href="conf_8h.html#545ee1dadc18a259ffd0d798f999ddc3">00615<\/a> <a class="code" href="conf_8c.html#617ad9199f2b10b95498f4f15c67c66d" title="Fetch a firewall rule set.">get_ruleset<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset)$/;"	a
l00616	doc/html/conf_8c-source.html	/^<a name="l00616"><\/a>00616 {$/;"	a
l00617	doc/html/conf_8c-source.html	/^<a name="l00617"><\/a>00617         <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>      *tmp;$/;"	a
l00618	doc/html/conf_8c-source.html	/^<a name="l00618"><\/a>00618 $/;"	a
l00619	doc/html/conf_8c-source.html	/^<a name="l00619"><\/a>00619         <span class="keywordflow">for<\/span> (tmp = config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>; tmp != NULL$/;"	a
l00620	doc/html/conf_8c-source.html	/^<a name="l00620"><\/a>00620                         &amp;&amp; strcmp(tmp-&gt;<a class="code" href="struct__firewall__ruleset__t.html#01cf836d509e646ac7fee6d5ac791ead">name<\/a>, ruleset) != 0; tmp = tmp-&gt;<a class="code" href="struct__firewall__ruleset__t.html#51556fca7d717b95a9b53695bfd0c07a">next<\/a>);$/;"	a
l00621	doc/html/conf_8c-source.html	/^<a name="l00621"><\/a>00621 $/;"	a
l00622	doc/html/conf_8c-source.html	/^<a name="l00622"><\/a>00622         <span class="keywordflow">if<\/span> (tmp == NULL)$/;"	a
l00623	doc/html/conf_8c-source.html	/^<a name="l00623"><\/a>00623                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00624	doc/html/conf_8c-source.html	/^<a name="l00624"><\/a>00624 $/;"	a
l00625	doc/html/conf_8c-source.html	/^<a name="l00625"><\/a>00625         <span class="keywordflow">return<\/span>(tmp-&gt;<a class="code" href="struct__firewall__ruleset__t.html#ee34ad9758267b6ae770681d6017a4a7">rules<\/a>);$/;"	a
l00626	doc/html/conf_8c-source.html	/^<a name="l00626"><\/a>00626 }$/;"	a
l00627	doc/html/conf_8c-source.html	/^<a name="l00627"><\/a>00627 $/;"	a
l00631	doc/html/conf_8c-source.html	/^<a name="l00631"><\/a>00631 <span class="keywordtype">void<\/span>$/;"	a
l00632	doc/html/conf_8c-source.html	/^<a name="l00632"><\/a><a class="code" href="conf_8h.html#d3faac0efa0ac4c1032c0c54f7e93711">00632<\/a> <a class="code" href="conf_8c.html#d3faac0efa0ac4c1032c0c54f7e93711" title="Reads the configuration file.">config_read<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename)$/;"	a
l00633	doc/html/conf_8c-source.html	/^<a name="l00633"><\/a>00633 {$/;"	a
l00634	doc/html/conf_8c-source.html	/^<a name="l00634"><\/a>00634         FILE *fd;$/;"	a
l00635	doc/html/conf_8c-source.html	/^<a name="l00635"><\/a>00635         <span class="keywordtype">char<\/span> line[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>], *s, *p1, *p2;$/;"	a
l00636	doc/html/conf_8c-source.html	/^<a name="l00636"><\/a>00636         <span class="keywordtype">int<\/span> linenum = 0, opcode, value;$/;"	a
l00637	doc/html/conf_8c-source.html	/^<a name="l00637"><\/a>00637 $/;"	a
l00638	doc/html/conf_8c-source.html	/^<a name="l00638"><\/a>00638         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Reading configuration file '%s'"<\/span>, filename);$/;"	a
l00639	doc/html/conf_8c-source.html	/^<a name="l00639"><\/a>00639 $/;"	a
l00640	doc/html/conf_8c-source.html	/^<a name="l00640"><\/a>00640         <span class="keywordflow">if<\/span> (!(fd = fopen(filename, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00641	doc/html/conf_8c-source.html	/^<a name="l00641"><\/a>00641                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not open configuration file '%s', "<\/span>$/;"	a
l00642	doc/html/conf_8c-source.html	/^<a name="l00642"><\/a>00642                                 <span class="stringliteral">"exiting..."<\/span>, filename);$/;"	a
l00643	doc/html/conf_8c-source.html	/^<a name="l00643"><\/a>00643                 exit(1);$/;"	a
l00644	doc/html/conf_8c-source.html	/^<a name="l00644"><\/a>00644         }$/;"	a
l00645	doc/html/conf_8c-source.html	/^<a name="l00645"><\/a>00645 $/;"	a
l00646	doc/html/conf_8c-source.html	/^<a name="l00646"><\/a>00646         <span class="keywordflow">while<\/span> (!feof(fd) &amp;&amp; fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>, fd)) {$/;"	a
l00647	doc/html/conf_8c-source.html	/^<a name="l00647"><\/a>00647                 linenum++;$/;"	a
l00648	doc/html/conf_8c-source.html	/^<a name="l00648"><\/a>00648                 s = line;$/;"	a
l00649	doc/html/conf_8c-source.html	/^<a name="l00649"><\/a>00649 $/;"	a
l00650	doc/html/conf_8c-source.html	/^<a name="l00650"><\/a>00650                 <span class="keywordflow">if<\/span> (s[strlen(s) - 1] == <span class="charliteral">'\\n'<\/span>)$/;"	a
l00651	doc/html/conf_8c-source.html	/^<a name="l00651"><\/a>00651                         s[strlen(s) - 1] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00652	doc/html/conf_8c-source.html	/^<a name="l00652"><\/a>00652 $/;"	a
l00653	doc/html/conf_8c-source.html	/^<a name="l00653"><\/a>00653                 <span class="keywordflow">if<\/span> ((p1 = strchr(s, <span class="charliteral">' '<\/span>))) {$/;"	a
l00654	doc/html/conf_8c-source.html	/^<a name="l00654"><\/a>00654                         p1[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00655	doc/html/conf_8c-source.html	/^<a name="l00655"><\/a>00655                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p1 = strchr(s, <span class="charliteral">'\\t'<\/span>))) {$/;"	a
l00656	doc/html/conf_8c-source.html	/^<a name="l00656"><\/a>00656                         p1[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00657	doc/html/conf_8c-source.html	/^<a name="l00657"><\/a>00657                 }$/;"	a
l00658	doc/html/conf_8c-source.html	/^<a name="l00658"><\/a>00658 $/;"	a
l00659	doc/html/conf_8c-source.html	/^<a name="l00659"><\/a>00659                 <span class="keywordflow">if<\/span> (p1) {$/;"	a
l00660	doc/html/conf_8c-source.html	/^<a name="l00660"><\/a>00660                         p1++;$/;"	a
l00661	doc/html/conf_8c-source.html	/^<a name="l00661"><\/a>00661 $/;"	a
l00662	doc/html/conf_8c-source.html	/^<a name="l00662"><\/a>00662                         <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">' '<\/span>))) {$/;"	a
l00663	doc/html/conf_8c-source.html	/^<a name="l00663"><\/a>00663                                 p2[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00664	doc/html/conf_8c-source.html	/^<a name="l00664"><\/a>00664                         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strstr(p1, <span class="stringliteral">"\\r\\n"<\/span>))) {$/;"	a
l00665	doc/html/conf_8c-source.html	/^<a name="l00665"><\/a>00665                                 p2[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00666	doc/html/conf_8c-source.html	/^<a name="l00666"><\/a>00666                         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\n'<\/span>))) {$/;"	a
l00667	doc/html/conf_8c-source.html	/^<a name="l00667"><\/a>00667                                 p2[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00668	doc/html/conf_8c-source.html	/^<a name="l00668"><\/a>00668                         }$/;"	a
l00669	doc/html/conf_8c-source.html	/^<a name="l00669"><\/a>00669                 }$/;"	a
l00670	doc/html/conf_8c-source.html	/^<a name="l00670"><\/a>00670 $/;"	a
l00671	doc/html/conf_8c-source.html	/^<a name="l00671"><\/a>00671                 <span class="keywordflow">if<\/span> (p1 &amp;&amp; p1[0] != <span class="charliteral">'\\0'<\/span>) {$/;"	a
l00672	doc/html/conf_8c-source.html	/^<a name="l00672"><\/a>00672                         <span class="comment">\/* Strip trailing spaces *\/<\/span>$/;"	a
l00673	doc/html/conf_8c-source.html	/^<a name="l00673"><\/a>00673 $/;"	a
l00674	doc/html/conf_8c-source.html	/^<a name="l00674"><\/a>00674                         <span class="keywordflow">if<\/span> ((strncmp(s, <span class="stringliteral">"#"<\/span>, 1)) != 0) {$/;"	a
l00675	doc/html/conf_8c-source.html	/^<a name="l00675"><\/a>00675                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Parsing token: %s, "<\/span>$/;"	a
l00676	doc/html/conf_8c-source.html	/^<a name="l00676"><\/a>00676                                                 <span class="stringliteral">"value: %s"<\/span>, s, p1);$/;"	a
l00677	doc/html/conf_8c-source.html	/^<a name="l00677"><\/a>00677                                 opcode = config_parse_token(s, filename, linenum);$/;"	a
l00678	doc/html/conf_8c-source.html	/^<a name="l00678"><\/a>00678 $/;"	a
l00679	doc/html/conf_8c-source.html	/^<a name="l00679"><\/a>00679                                 <span class="keywordflow">switch<\/span>(opcode) {$/;"	a
l00680	doc/html/conf_8c-source.html	/^<a name="l00680"><\/a>00680                                 <span class="keywordflow">case<\/span> oDaemon:$/;"	a
l00681	doc/html/conf_8c-source.html	/^<a name="l00681"><\/a>00681                                         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> == -1 &amp;&amp; ((value = parse_boolean_value(p1)) != -1)) {$/;"	a
l00682	doc/html/conf_8c-source.html	/^<a name="l00682"><\/a>00682                                                 config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> = value;$/;"	a
l00683	doc/html/conf_8c-source.html	/^<a name="l00683"><\/a>00683                                         }$/;"	a
l00684	doc/html/conf_8c-source.html	/^<a name="l00684"><\/a>00684                                         <span class="keywordflow">break<\/span>;$/;"	a
l00685	doc/html/conf_8c-source.html	/^<a name="l00685"><\/a>00685                                 <span class="keywordflow">case<\/span> oExternalInterface:$/;"	a
l00686	doc/html/conf_8c-source.html	/^<a name="l00686"><\/a>00686                                         config.<a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62" title="External network interface name for firewall rules.">external_interface<\/a> = safe_strdup(p1);$/;"	a
l00687	doc/html/conf_8c-source.html	/^<a name="l00687"><\/a>00687                                         <span class="keywordflow">break<\/span>;$/;"	a
l00688	doc/html/conf_8c-source.html	/^<a name="l00688"><\/a>00688                                 <span class="keywordflow">case<\/span> oGatewayID:$/;"	a
l00689	doc/html/conf_8c-source.html	/^<a name="l00689"><\/a>00689                                         config.<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a> = safe_strdup(p1);$/;"	a
l00690	doc/html/conf_8c-source.html	/^<a name="l00690"><\/a>00690                                         <span class="keywordflow">break<\/span>;$/;"	a
l00691	doc/html/conf_8c-source.html	/^<a name="l00691"><\/a>00691                                 <span class="keywordflow">case<\/span> oGatewayInterface:$/;"	a
l00692	doc/html/conf_8c-source.html	/^<a name="l00692"><\/a>00692                                         config.<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a> = safe_strdup(p1);$/;"	a
l00693	doc/html/conf_8c-source.html	/^<a name="l00693"><\/a>00693                                         <span class="keywordflow">break<\/span>;$/;"	a
l00694	doc/html/conf_8c-source.html	/^<a name="l00694"><\/a>00694                                 <span class="keywordflow">case<\/span> oGatewayAddress:$/;"	a
l00695	doc/html/conf_8c-source.html	/^<a name="l00695"><\/a>00695                                         config.<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a> = safe_strdup(p1);$/;"	a
l00696	doc/html/conf_8c-source.html	/^<a name="l00696"><\/a>00696                                         <span class="keywordflow">break<\/span>;$/;"	a
l00697	doc/html/conf_8c-source.html	/^<a name="l00697"><\/a>00697                                 <span class="keywordflow">case<\/span> oGatewayPort:$/;"	a
l00698	doc/html/conf_8c-source.html	/^<a name="l00698"><\/a>00698                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>);$/;"	a
l00699	doc/html/conf_8c-source.html	/^<a name="l00699"><\/a>00699                                         <span class="keywordflow">break<\/span>;$/;"	a
l00700	doc/html/conf_8c-source.html	/^<a name="l00700"><\/a>00700                                 <span class="keywordflow">case<\/span> oAuthServer:$/;"	a
l00701	doc/html/conf_8c-source.html	/^<a name="l00701"><\/a>00701                                         parse_auth_server(fd, filename,$/;"	a
l00702	doc/html/conf_8c-source.html	/^<a name="l00702"><\/a>00702                                                         &amp;linenum);$/;"	a
l00703	doc/html/conf_8c-source.html	/^<a name="l00703"><\/a>00703                                         <span class="keywordflow">break<\/span>;$/;"	a
l00704	doc/html/conf_8c-source.html	/^<a name="l00704"><\/a>00704                                 <span class="keywordflow">case<\/span> oFirewallRuleSet:$/;"	a
l00705	doc/html/conf_8c-source.html	/^<a name="l00705"><\/a>00705                                         parse_firewall_ruleset(p1, fd, filename, &amp;linenum);$/;"	a
l00706	doc/html/conf_8c-source.html	/^<a name="l00706"><\/a>00706                                         <span class="keywordflow">break<\/span>;$/;"	a
l00707	doc/html/conf_8c-source.html	/^<a name="l00707"><\/a>00707                                 <span class="keywordflow">case<\/span> oTrustedMACList:$/;"	a
l00708	doc/html/conf_8c-source.html	/^<a name="l00708"><\/a>00708                                         parse_trusted_mac_list(p1);$/;"	a
l00709	doc/html/conf_8c-source.html	/^<a name="l00709"><\/a>00709                                         <span class="keywordflow">break<\/span>;$/;"	a
l00710	doc/html/conf_8c-source.html	/^<a name="l00710"><\/a>00710                                 <span class="keywordflow">case<\/span> oHTTPDName:$/;"	a
l00711	doc/html/conf_8c-source.html	/^<a name="l00711"><\/a>00711                                         config.<a class="code" href="structs__config.html#2ed9a59507be060fe0e1deae7fcc077b" title="Name the web server will return when replying to a request.">httpdname<\/a> = safe_strdup(p1);$/;"	a
l00712	doc/html/conf_8c-source.html	/^<a name="l00712"><\/a>00712                                         <span class="keywordflow">break<\/span>;$/;"	a
l00713	doc/html/conf_8c-source.html	/^<a name="l00713"><\/a>00713                                 <span class="keywordflow">case<\/span> oHTTPDMaxConn:$/;"	a
l00714	doc/html/conf_8c-source.html	/^<a name="l00714"><\/a>00714                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#7a24ca5b2cc1ff099bda0af17e654a95" title="Used by libhttpd, not sure what it does.">httpdmaxconn<\/a>);$/;"	a
l00715	doc/html/conf_8c-source.html	/^<a name="l00715"><\/a>00715                                         <span class="keywordflow">break<\/span>;$/;"	a
l00716	doc/html/conf_8c-source.html	/^<a name="l00716"><\/a>00716                                 <span class="keywordflow">case<\/span> oHTTPDRealm:$/;"	a
l00717	doc/html/conf_8c-source.html	/^<a name="l00717"><\/a>00717                                         config.<a class="code" href="structs__config.html#283515007953f307a7b599ee480b743d" title="HTTP Authentication realm.">httpdrealm<\/a> = safe_strdup(p1);$/;"	a
l00718	doc/html/conf_8c-source.html	/^<a name="l00718"><\/a>00718                                         <span class="keywordflow">break<\/span>;$/;"	a
l00719	doc/html/conf_8c-source.html	/^<a name="l00719"><\/a>00719                                 <span class="keywordflow">case<\/span> oHTTPDUsername:$/;"	a
l00720	doc/html/conf_8c-source.html	/^<a name="l00720"><\/a>00720                                         config.<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a> = safe_strdup(p1);$/;"	a
l00721	doc/html/conf_8c-source.html	/^<a name="l00721"><\/a>00721                                         <span class="keywordflow">break<\/span>;$/;"	a
l00722	doc/html/conf_8c-source.html	/^<a name="l00722"><\/a>00722                                 <span class="keywordflow">case<\/span> oHTTPDPassword:$/;"	a
l00723	doc/html/conf_8c-source.html	/^<a name="l00723"><\/a>00723                                         config.<a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5" title="Password for HTTP authentication.">httpdpassword<\/a> = safe_strdup(p1);$/;"	a
l00724	doc/html/conf_8c-source.html	/^<a name="l00724"><\/a>00724                                         <span class="keywordflow">break<\/span>;$/;"	a
l00725	doc/html/conf_8c-source.html	/^<a name="l00725"><\/a>00725                                 <span class="keywordflow">case<\/span> oBadOption:$/;"	a
l00726	doc/html/conf_8c-source.html	/^<a name="l00726"><\/a>00726                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Bad option on line %d "<\/span>$/;"	a
l00727	doc/html/conf_8c-source.html	/^<a name="l00727"><\/a>00727                                                         <span class="stringliteral">"in %s."<\/span>, linenum,$/;"	a
l00728	doc/html/conf_8c-source.html	/^<a name="l00728"><\/a>00728                                                         filename);$/;"	a
l00729	doc/html/conf_8c-source.html	/^<a name="l00729"><\/a>00729                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Exiting..."<\/span>);$/;"	a
l00730	doc/html/conf_8c-source.html	/^<a name="l00730"><\/a>00730                                         exit(-1);$/;"	a
l00731	doc/html/conf_8c-source.html	/^<a name="l00731"><\/a>00731                                         <span class="keywordflow">break<\/span>;$/;"	a
l00732	doc/html/conf_8c-source.html	/^<a name="l00732"><\/a>00732                                 <span class="keywordflow">case<\/span> oCheckInterval:$/;"	a
l00733	doc/html/conf_8c-source.html	/^<a name="l00733"><\/a>00733                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a>);$/;"	a
l00734	doc/html/conf_8c-source.html	/^<a name="l00734"><\/a>00734                                         <span class="keywordflow">break<\/span>;$/;"	a
l00735	doc/html/conf_8c-source.html	/^<a name="l00735"><\/a>00735                                 <span class="keywordflow">case<\/span> oWdctlSocket:$/;"	a
l00736	doc/html/conf_8c-source.html	/^<a name="l00736"><\/a>00736                                         free(config.<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a>);$/;"	a
l00737	doc/html/conf_8c-source.html	/^<a name="l00737"><\/a>00737                                         config.<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a> = safe_strdup(p1);$/;"	a
l00738	doc/html/conf_8c-source.html	/^<a name="l00738"><\/a>00738                                         <span class="keywordflow">break<\/span>;$/;"	a
l00739	doc/html/conf_8c-source.html	/^<a name="l00739"><\/a>00739                                 <span class="keywordflow">case<\/span> oClientTimeout:$/;"	a
l00740	doc/html/conf_8c-source.html	/^<a name="l00740"><\/a>00740                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a>);$/;"	a
l00741	doc/html/conf_8c-source.html	/^<a name="l00741"><\/a>00741                                         <span class="keywordflow">break<\/span>;$/;"	a
l00742	doc/html/conf_8c-source.html	/^<a name="l00742"><\/a>00742                                 <span class="keywordflow">case<\/span> oSyslogFacility:$/;"	a
l00743	doc/html/conf_8c-source.html	/^<a name="l00743"><\/a>00743                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#eaad87f73a87a2f752b111dad813902d" title="facility to use when using syslog for logging">syslog_facility<\/a>);$/;"	a
l00744	doc/html/conf_8c-source.html	/^<a name="l00744"><\/a>00744                                         <span class="keywordflow">break<\/span>;$/;"	a
l00745	doc/html/conf_8c-source.html	/^<a name="l00745"><\/a>00745                                 <span class="keywordflow">case<\/span> oHtmlMessageFile:$/;"	a
l00746	doc/html/conf_8c-source.html	/^<a name="l00746"><\/a>00746                                         config.<a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6" title="name of the HTML file used for messages">htmlmsgfile<\/a> = safe_strdup(p1);$/;"	a
l00747	doc/html/conf_8c-source.html	/^<a name="l00747"><\/a>00747                                         <span class="keywordflow">break<\/span>;$/;"	a
l00748	doc/html/conf_8c-source.html	/^<a name="l00748"><\/a>00748 $/;"	a
l00749	doc/html/conf_8c-source.html	/^<a name="l00749"><\/a>00749                                 }$/;"	a
l00750	doc/html/conf_8c-source.html	/^<a name="l00750"><\/a>00750                         }$/;"	a
l00751	doc/html/conf_8c-source.html	/^<a name="l00751"><\/a>00751                 }$/;"	a
l00752	doc/html/conf_8c-source.html	/^<a name="l00752"><\/a>00752         }$/;"	a
l00753	doc/html/conf_8c-source.html	/^<a name="l00753"><\/a>00753 $/;"	a
l00754	doc/html/conf_8c-source.html	/^<a name="l00754"><\/a>00754         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a> &amp;&amp; !config.<a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5" title="Password for HTTP authentication.">httpdpassword<\/a>) {$/;"	a
l00755	doc/html/conf_8c-source.html	/^<a name="l00755"><\/a>00755                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"HTTPDUserName requires a HTTPDPassword to be set."<\/span>);$/;"	a
l00756	doc/html/conf_8c-source.html	/^<a name="l00756"><\/a>00756                 exit(-1);$/;"	a
l00757	doc/html/conf_8c-source.html	/^<a name="l00757"><\/a>00757         }$/;"	a
l00758	doc/html/conf_8c-source.html	/^<a name="l00758"><\/a>00758 $/;"	a
l00759	doc/html/conf_8c-source.html	/^<a name="l00759"><\/a>00759         fclose(fd);$/;"	a
l00760	doc/html/conf_8c-source.html	/^<a name="l00760"><\/a>00760 }$/;"	a
l00761	doc/html/conf_8c-source.html	/^<a name="l00761"><\/a>00761 $/;"	a
l00765	doc/html/conf_8c-source.html	/^<a name="l00765"><\/a>00765 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span>$/;"	a
l00766	doc/html/conf_8c-source.html	/^<a name="l00766"><\/a>00766 parse_boolean_value(<span class="keywordtype">char<\/span> *line)$/;"	a
l00767	doc/html/conf_8c-source.html	/^<a name="l00767"><\/a>00767 {$/;"	a
l00768	doc/html/conf_8c-source.html	/^<a name="l00768"><\/a>00768         <span class="keywordflow">if<\/span> (strcasecmp(line, <span class="stringliteral">"yes"<\/span>) == 0) {$/;"	a
l00769	doc/html/conf_8c-source.html	/^<a name="l00769"><\/a>00769                 <span class="keywordflow">return<\/span> 1;$/;"	a
l00770	doc/html/conf_8c-source.html	/^<a name="l00770"><\/a>00770         }$/;"	a
l00771	doc/html/conf_8c-source.html	/^<a name="l00771"><\/a>00771         <span class="keywordflow">if<\/span> (strcasecmp(line, <span class="stringliteral">"no"<\/span>) == 0) {$/;"	a
l00772	doc/html/conf_8c-source.html	/^<a name="l00772"><\/a>00772                 <span class="keywordflow">return<\/span> 0;$/;"	a
l00773	doc/html/conf_8c-source.html	/^<a name="l00773"><\/a>00773         }$/;"	a
l00774	doc/html/conf_8c-source.html	/^<a name="l00774"><\/a>00774         <span class="keywordflow">if<\/span> (strcmp(line, <span class="stringliteral">"1"<\/span>) == 0) {$/;"	a
l00775	doc/html/conf_8c-source.html	/^<a name="l00775"><\/a>00775                 <span class="keywordflow">return<\/span> 1;$/;"	a
l00776	doc/html/conf_8c-source.html	/^<a name="l00776"><\/a>00776         }$/;"	a
l00777	doc/html/conf_8c-source.html	/^<a name="l00777"><\/a>00777         <span class="keywordflow">if<\/span> (strcmp(line, <span class="stringliteral">"0"<\/span>) == 0) {$/;"	a
l00778	doc/html/conf_8c-source.html	/^<a name="l00778"><\/a>00778                 <span class="keywordflow">return<\/span> 0;$/;"	a
l00779	doc/html/conf_8c-source.html	/^<a name="l00779"><\/a>00779         }$/;"	a
l00780	doc/html/conf_8c-source.html	/^<a name="l00780"><\/a>00780 $/;"	a
l00781	doc/html/conf_8c-source.html	/^<a name="l00781"><\/a>00781         <span class="keywordflow">return<\/span> -1;$/;"	a
l00782	doc/html/conf_8c-source.html	/^<a name="l00782"><\/a>00782 }$/;"	a
l00783	doc/html/conf_8c-source.html	/^<a name="l00783"><\/a>00783 $/;"	a
l00784	doc/html/conf_8c-source.html	/^<a name="l00784"><\/a>00784 <span class="keywordtype">void<\/span> parse_trusted_mac_list(<span class="keywordtype">char<\/span> *ptr) {$/;"	a
l00785	doc/html/conf_8c-source.html	/^<a name="l00785"><\/a>00785         <span class="keywordtype">char<\/span> *ptrcopy = NULL;$/;"	a
l00786	doc/html/conf_8c-source.html	/^<a name="l00786"><\/a>00786         <span class="keywordtype">char<\/span> *possiblemac = NULL;$/;"	a
l00787	doc/html/conf_8c-source.html	/^<a name="l00787"><\/a>00787         <span class="keywordtype">char<\/span> *mac = NULL;$/;"	a
l00788	doc/html/conf_8c-source.html	/^<a name="l00788"><\/a>00788         <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a> *p = NULL;$/;"	a
l00789	doc/html/conf_8c-source.html	/^<a name="l00789"><\/a>00789 $/;"	a
l00790	doc/html/conf_8c-source.html	/^<a name="l00790"><\/a>00790         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Parsing string [%s] for trusted MAC addresses"<\/span>, ptr);$/;"	a
l00791	doc/html/conf_8c-source.html	/^<a name="l00791"><\/a>00791 $/;"	a
l00792	doc/html/conf_8c-source.html	/^<a name="l00792"><\/a>00792         mac = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(18);$/;"	a
l00793	doc/html/conf_8c-source.html	/^<a name="l00793"><\/a>00793 $/;"	a
l00794	doc/html/conf_8c-source.html	/^<a name="l00794"><\/a>00794         <span class="comment">\/* strsep modifies original, so let's make a copy *\/<\/span>$/;"	a
l00795	doc/html/conf_8c-source.html	/^<a name="l00795"><\/a>00795         ptrcopy = safe_strdup(ptr);$/;"	a
l00796	doc/html/conf_8c-source.html	/^<a name="l00796"><\/a>00796 $/;"	a
l00797	doc/html/conf_8c-source.html	/^<a name="l00797"><\/a>00797         <span class="keywordflow">while<\/span> ((possiblemac = strsep(&amp;ptrcopy, <span class="stringliteral">", "<\/span>))) {$/;"	a
l00798	doc/html/conf_8c-source.html	/^<a name="l00798"><\/a>00798                 <span class="keywordflow">if<\/span> (sscanf(possiblemac, <span class="stringliteral">" %17[A-Fa-f0-9:]"<\/span>, mac) == 1) {$/;"	a
l00799	doc/html/conf_8c-source.html	/^<a name="l00799"><\/a>00799                         <span class="comment">\/* Copy mac to the list *\/<\/span>$/;"	a
l00800	doc/html/conf_8c-source.html	/^<a name="l00800"><\/a>00800 $/;"	a
l00801	doc/html/conf_8c-source.html	/^<a name="l00801"><\/a>00801                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Adding MAC address [%s] to trusted list"<\/span>, mac);$/;"	a
l00802	doc/html/conf_8c-source.html	/^<a name="l00802"><\/a>00802 $/;"	a
l00803	doc/html/conf_8c-source.html	/^<a name="l00803"><\/a>00803                         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a> == NULL) {$/;"	a
l00804	doc/html/conf_8c-source.html	/^<a name="l00804"><\/a>00804                                 config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a> = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a>));$/;"	a
l00805	doc/html/conf_8c-source.html	/^<a name="l00805"><\/a>00805                                 config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>-&gt;<a class="code" href="struct__trusted__mac__t.html#4e4381cfff2bbfbd9455640102b21f14">mac<\/a> = safe_strdup(mac);$/;"	a
l00806	doc/html/conf_8c-source.html	/^<a name="l00806"><\/a>00806                                 config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a> = NULL;$/;"	a
l00807	doc/html/conf_8c-source.html	/^<a name="l00807"><\/a>00807                         }$/;"	a
l00808	doc/html/conf_8c-source.html	/^<a name="l00808"><\/a>00808                         <span class="keywordflow">else<\/span> {$/;"	a
l00809	doc/html/conf_8c-source.html	/^<a name="l00809"><\/a>00809                                 <span class="comment">\/* Advance to the last entry *\/<\/span>$/;"	a
l00810	doc/html/conf_8c-source.html	/^<a name="l00810"><\/a>00810                                 <span class="keywordflow">for<\/span> (p = config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>; p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a> != NULL; p = p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a>);$/;"	a
l00811	doc/html/conf_8c-source.html	/^<a name="l00811"><\/a>00811                                 p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a> = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a>));$/;"	a
l00812	doc/html/conf_8c-source.html	/^<a name="l00812"><\/a>00812                                 p = p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a>;$/;"	a
l00813	doc/html/conf_8c-source.html	/^<a name="l00813"><\/a>00813                                 p-&gt;<a class="code" href="struct__trusted__mac__t.html#4e4381cfff2bbfbd9455640102b21f14">mac<\/a> = safe_strdup(mac);$/;"	a
l00814	doc/html/conf_8c-source.html	/^<a name="l00814"><\/a>00814                                 p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a> = NULL;$/;"	a
l00815	doc/html/conf_8c-source.html	/^<a name="l00815"><\/a>00815                         }$/;"	a
l00816	doc/html/conf_8c-source.html	/^<a name="l00816"><\/a>00816 $/;"	a
l00817	doc/html/conf_8c-source.html	/^<a name="l00817"><\/a>00817                 }$/;"	a
l00818	doc/html/conf_8c-source.html	/^<a name="l00818"><\/a>00818         }$/;"	a
l00819	doc/html/conf_8c-source.html	/^<a name="l00819"><\/a>00819 $/;"	a
l00820	doc/html/conf_8c-source.html	/^<a name="l00820"><\/a>00820         free(ptrcopy);$/;"	a
l00821	doc/html/conf_8c-source.html	/^<a name="l00821"><\/a>00821 $/;"	a
l00822	doc/html/conf_8c-source.html	/^<a name="l00822"><\/a>00822         free(mac);$/;"	a
l00823	doc/html/conf_8c-source.html	/^<a name="l00823"><\/a>00823 $/;"	a
l00824	doc/html/conf_8c-source.html	/^<a name="l00824"><\/a>00824 }$/;"	a
l00825	doc/html/conf_8c-source.html	/^<a name="l00825"><\/a>00825 $/;"	a
l00827	doc/html/conf_8c-source.html	/^<a name="l00827"><\/a>00827 <span class="keywordtype">void<\/span>$/;"	a
l00828	doc/html/conf_8c-source.html	/^<a name="l00828"><\/a><a class="code" href="conf_8h.html#0f9540b3f729ba3b3d31b613d3eca364">00828<\/a> <a class="code" href="conf_8c.html#0f9540b3f729ba3b3d31b613d3eca364" title="Check that the configuration is valid.">config_validate<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00829	doc/html/conf_8c-source.html	/^<a name="l00829"><\/a>00829 {$/;"	a
l00830	doc/html/conf_8c-source.html	/^<a name="l00830"><\/a>00830         config_notnull(config.<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>, <span class="stringliteral">"GatewayInterface"<\/span>);$/;"	a
l00831	doc/html/conf_8c-source.html	/^<a name="l00831"><\/a>00831         config_notnull(config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>, <span class="stringliteral">"AuthServer"<\/span>);$/;"	a
l00832	doc/html/conf_8c-source.html	/^<a name="l00832"><\/a>00832 $/;"	a
l00833	doc/html/conf_8c-source.html	/^<a name="l00833"><\/a>00833         <span class="keywordflow">if<\/span> (missing_parms) {$/;"	a
l00834	doc/html/conf_8c-source.html	/^<a name="l00834"><\/a>00834                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Configuration is not complete, exiting..."<\/span>);$/;"	a
l00835	doc/html/conf_8c-source.html	/^<a name="l00835"><\/a>00835                 exit(-1);$/;"	a
l00836	doc/html/conf_8c-source.html	/^<a name="l00836"><\/a>00836         }$/;"	a
l00837	doc/html/conf_8c-source.html	/^<a name="l00837"><\/a>00837 }$/;"	a
l00838	doc/html/conf_8c-source.html	/^<a name="l00838"><\/a>00838 $/;"	a
l00842	doc/html/conf_8c-source.html	/^<a name="l00842"><\/a>00842 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00843	doc/html/conf_8c-source.html	/^<a name="l00843"><\/a>00843 config_notnull(<span class="keyword">const<\/span> <span class="keywordtype">void<\/span> *parm, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *parmname)$/;"	a
l00844	doc/html/conf_8c-source.html	/^<a name="l00844"><\/a>00844 {$/;"	a
l00845	doc/html/conf_8c-source.html	/^<a name="l00845"><\/a>00845         <span class="keywordflow">if<\/span> (parm == NULL) {$/;"	a
l00846	doc/html/conf_8c-source.html	/^<a name="l00846"><\/a>00846                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"%s is not set"<\/span>, parmname);$/;"	a
l00847	doc/html/conf_8c-source.html	/^<a name="l00847"><\/a>00847                 missing_parms = 1;$/;"	a
l00848	doc/html/conf_8c-source.html	/^<a name="l00848"><\/a>00848         }$/;"	a
l00849	doc/html/conf_8c-source.html	/^<a name="l00849"><\/a>00849 }$/;"	a
l00850	doc/html/conf_8c-source.html	/^<a name="l00850"><\/a>00850 $/;"	a
l00854	doc/html/conf_8c-source.html	/^<a name="l00854"><\/a>00854 <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *$/;"	a
l00855	doc/html/conf_8c-source.html	/^<a name="l00855"><\/a><a class="code" href="conf_8h.html#82ffcd3c683aadc31aca9c53a2d2739a">00855<\/a> <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00856	doc/html/conf_8c-source.html	/^<a name="l00856"><\/a>00856 {$/;"	a
l00857	doc/html/conf_8c-source.html	/^<a name="l00857"><\/a>00857 $/;"	a
l00858	doc/html/conf_8c-source.html	/^<a name="l00858"><\/a>00858         <span class="comment">\/* This is as good as atomic *\/<\/span>$/;"	a
l00859	doc/html/conf_8c-source.html	/^<a name="l00859"><\/a>00859         <span class="keywordflow">return<\/span> config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>;$/;"	a
l00860	doc/html/conf_8c-source.html	/^<a name="l00860"><\/a>00860 }$/;"	a
l00861	doc/html/conf_8c-source.html	/^<a name="l00861"><\/a>00861 $/;"	a
l00866	doc/html/conf_8c-source.html	/^<a name="l00866"><\/a>00866 <span class="keywordtype">void<\/span>$/;"	a
l00867	doc/html/conf_8c-source.html	/^<a name="l00867"><\/a><a class="code" href="conf_8h.html#9d674c58e3d919b7cd55aa12ed52be3c">00867<\/a> <a class="code" href="conf_8c.html#d1e677696fcef826740ca906587af8ac" title="Bump server to bottom of the list.">mark_auth_server_bad<\/a>(<a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *bad_server)$/;"	a
l00868	doc/html/conf_8c-source.html	/^<a name="l00868"><\/a>00868 {$/;"	a
l00869	doc/html/conf_8c-source.html	/^<a name="l00869"><\/a>00869         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *tmp;$/;"	a
l00870	doc/html/conf_8c-source.html	/^<a name="l00870"><\/a>00870 $/;"	a
l00871	doc/html/conf_8c-source.html	/^<a name="l00871"><\/a>00871         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> == bad_server &amp;&amp; bad_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> != NULL) {$/;"	a
l00872	doc/html/conf_8c-source.html	/^<a name="l00872"><\/a>00872                 <span class="comment">\/* Go to the last *\/<\/span>$/;"	a
l00873	doc/html/conf_8c-source.html	/^<a name="l00873"><\/a>00873                 <span class="keywordflow">for<\/span> (tmp = config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> != NULL; tmp = tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>);$/;"	a
l00874	doc/html/conf_8c-source.html	/^<a name="l00874"><\/a>00874                 <span class="comment">\/* Set bad server as last *\/<\/span>$/;"	a
l00875	doc/html/conf_8c-source.html	/^<a name="l00875"><\/a>00875                 tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> = bad_server;$/;"	a
l00876	doc/html/conf_8c-source.html	/^<a name="l00876"><\/a>00876                 <span class="comment">\/* Remove bad server from start of list *\/<\/span>$/;"	a
l00877	doc/html/conf_8c-source.html	/^<a name="l00877"><\/a>00877                 config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> = bad_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>;$/;"	a
l00878	doc/html/conf_8c-source.html	/^<a name="l00878"><\/a>00878                 <span class="comment">\/* Set the next pointe to NULL in the last element *\/<\/span>$/;"	a
l00879	doc/html/conf_8c-source.html	/^<a name="l00879"><\/a>00879                 bad_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> = NULL;$/;"	a
l00880	doc/html/conf_8c-source.html	/^<a name="l00880"><\/a>00880         }$/;"	a
l00881	doc/html/conf_8c-source.html	/^<a name="l00881"><\/a>00881 $/;"	a
l00882	doc/html/conf_8c-source.html	/^<a name="l00882"><\/a>00882 }$/;"	a
0448e8e7c5a3c78addbd7f855e2dbecf	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0448e8e7c5a3c78addbd7f855e2dbecf"><\/a><!-- doxytag: member="conf.c::parse_firewall_ruleset" ref="0448e8e7c5a3c78addbd7f855e2dbecf" args="(const char *, FILE *, const char *, int *)" -->$/;"	a
068a358868c409bbd99d7eef3c988866	doc/html/conf_8c.html	/^<a class="anchor" name="068a358868c409bbd99d7eef3c988866"><\/a><!-- doxytag: member="conf.c::config_init" ref="068a358868c409bbd99d7eef3c988866" args="(void)" -->$/;"	a
0f9540b3f729ba3b3d31b613d3eca364	doc/html/conf_8c.html	/^<a class="anchor" name="0f9540b3f729ba3b3d31b613d3eca364"><\/a><!-- doxytag: member="conf.c::config_validate" ref="0f9540b3f729ba3b3d31b613d3eca364" args="(void)" -->$/;"	a
17b6b425f18de3865e44b534c1f1f1cc	doc/html/conf_8c.html	/^<a class="anchor" name="17b6b425f18de3865e44b534c1f1f1cc"><\/a><!-- doxytag: member="conf.c::config_init_override" ref="17b6b425f18de3865e44b534c1f1f1cc" args="(void)" -->$/;"	a
19f5257e157a21ebe192c121aa8b44fd	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="19f5257e157a21ebe192c121aa8b44fd"><\/a><!-- doxytag: member="conf.c::parse_boolean_value" ref="19f5257e157a21ebe192c121aa8b44fd" args="(char *)" -->$/;"	a
369266c24eacffb87046522897a570d5	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="369266c24eacffb87046522897a570d5"><\/a><!-- doxytag: member="conf.c::_GNU_SOURCE" ref="369266c24eacffb87046522897a570d5" args="" -->$/;"	a
5190981355166bf58be20ad91d979ebd	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5190981355166bf58be20ad91d979ebd"><\/a><!-- doxytag: member="conf.c::config_parse_token" ref="5190981355166bf58be20ad91d979ebd" args="(const char *cp, const char *filename, int linenum)" -->$/;"	a
617ad9199f2b10b95498f4f15c67c66d	doc/html/conf_8c.html	/^<a class="anchor" name="617ad9199f2b10b95498f4f15c67c66d"><\/a><!-- doxytag: member="conf.c::get_ruleset" ref="617ad9199f2b10b95498f4f15c67c66d" args="(const char *ruleset)" -->$/;"	a
64e73012596dd6628c18742c8046069f	doc/html/conf_8c.html	/^<a class="anchor" name="64e73012596dd6628c18742c8046069f"><\/a><!-- doxytag: member="conf.c::config_get_config" ref="64e73012596dd6628c18742c8046069f" args="(void)" -->$/;"	a
7c1094749f55aab015c5c408def95216	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7c1094749f55aab015c5c408def95216"><\/a><!-- doxytag: member="conf.c::missing_parms" ref="7c1094749f55aab015c5c408def95216" args="" -->$/;"	a
82ffcd3c683aadc31aca9c53a2d2739a	doc/html/conf_8c.html	/^<a class="anchor" name="82ffcd3c683aadc31aca9c53a2d2739a"><\/a><!-- doxytag: member="conf.c::get_auth_server" ref="82ffcd3c683aadc31aca9c53a2d2739a" args="(void)" -->$/;"	a
9934c7def687e5ed242049cb2a46eb73	doc/html/conf_8c.html	/^<a class="anchor" name="9934c7def687e5ed242049cb2a46eb73"><\/a><!-- doxytag: member="conf.c::TO_NEXT_WORD" ref="9934c7def687e5ed242049cb2a46eb73" args="(s, e)" -->$/;"	a
_details	doc/html/conf_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a8666c914d96b286c9efe27de4268003	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a8666c914d96b286c9efe27de4268003"><\/a><!-- doxytag: member="conf.c::config_notnull" ref="a8666c914d96b286c9efe27de4268003" args="(const void *parm, const char *parmname)" -->$/;"	a
ade5b00daf915be32d7f6cbf116cd9e6	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ade5b00daf915be32d7f6cbf116cd9e6"><\/a><!-- doxytag: member="conf.c::config" ref="ade5b00daf915be32d7f6cbf116cd9e6" args="" -->$/;"	a
b374ff230d9977e6b952612d61689f39	doc/html/conf_8c.html	/^<a class="anchor" name="b374ff230d9977e6b952612d61689f39"><\/a><!-- doxytag: member="conf.c::config_mutex" ref="b374ff230d9977e6b952612d61689f39" args="" -->$/;"	a
c10ca895b5a20b458c1599f8a9766f4d	doc/html/conf_8c.html	/^<a class="anchor" name="c10ca895b5a20b458c1599f8a9766f4d"><\/a><!-- doxytag: member="conf.c::_parse_firewall_rule" ref="c10ca895b5a20b458c1599f8a9766f4d" args="(const char *ruleset, char *leftover)" -->$/;"	a
c4c300aeb846c6b85325f91e89268af1	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap><a class="anchor" name="c4c300aeb846c6b85325f91e89268af1"><\/a><!-- doxytag: member="conf.c::keywords" ref="c4c300aeb846c6b85325f91e89268af1" args="[]" -->$/;"	a
d1e677696fcef826740ca906587af8ac	doc/html/conf_8c.html	/^<a class="anchor" name="d1e677696fcef826740ca906587af8ac"><\/a><!-- doxytag: member="conf.c::mark_auth_server_bad" ref="d1e677696fcef826740ca906587af8ac" args="(t_auth_serv *bad_server)" -->$/;"	a
d3faac0efa0ac4c1032c0c54f7e93711	doc/html/conf_8c.html	/^<a class="anchor" name="d3faac0efa0ac4c1032c0c54f7e93711"><\/a><!-- doxytag: member="conf.c::config_read" ref="d3faac0efa0ac4c1032c0c54f7e93711" args="(const char *filename)" -->$/;"	a
ec9c053484cb6677e992d3c1511eeb51	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ec9c053484cb6677e992d3c1511eeb51"><\/a><!-- doxytag: member="conf.c::parse_auth_server" ref="ec9c053484cb6677e992d3c1511eeb51" args="(FILE *, const char *, int *)" -->$/;"	a
f692869bbba0cdc3c04480a40af3395e	doc/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f692869bbba0cdc3c04480a40af3395e"><\/a><!-- doxytag: member="conf.c::parse_trusted_mac_list" ref="f692869bbba0cdc3c04480a40af3395e" args="(char *ptr)" -->$/;"	a
l00001	doc/html/conf_8h-source.html	/^<h1>conf.h<\/h1><a href="conf_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/conf_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/conf_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/conf_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/conf_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/conf_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/conf_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/conf_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/conf_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/conf_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/conf_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/conf_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/conf_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/conf_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/conf_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/conf_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/conf_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/conf_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/conf_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/conf_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/conf_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: conf.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/conf_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _CONFIG_H_<\/span>$/;"	a
l00028	doc/html/conf_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _CONFIG_H_<\/span>$/;"	a
l00029	doc/html/conf_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00034	doc/html/conf_8h-source.html	/^<a name="l00034"><\/a><a class="code" href="conf_8h.html#771a6a60dbaa6c7532ab6cd31b397f7d">00034<\/a> <span class="preprocessor">#define NUM_EXT_INTERFACE_DETECT_RETRY 0<\/span>$/;"	a
l00035	doc/html/conf_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor"><\/span>$/;"	a
l00037	doc/html/conf_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="conf_8h.html#b67c119b3d066438d4c3405b518bb289">00037<\/a> <span class="preprocessor">#define EXT_INTERFACE_DETECT_RETRY_INTERVAL 1<\/span>$/;"	a
l00038	doc/html/conf_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor"><\/span>$/;"	a
l00040	doc/html/conf_8h-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#ifndef SYSCONFDIR<\/span>$/;"	a
l00041	doc/html/conf_8h-source.html	/^<a name="l00041"><\/a><a class="code" href="conf_8h.html#0ec3017454ea7a8398d25c8ab83890fd">00041<\/a> <span class="preprocessor"><\/span><span class="preprocessor">        #define DEFAULT_CONFIGFILE "\/etc\/wifidog.conf"<\/span>$/;"	a
l00042	doc/html/conf_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="conf_8h.html#16581929d818bc322bbebce8a7a12117">00042<\/a> <span class="preprocessor"><\/span><span class="preprocessor">        #define DEFAULT_HTMLMSGFILE "\/etc\/wifidog-msg.html"<\/span>$/;"	a
l00043	doc/html/conf_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor"><\/span><span class="preprocessor">#else<\/span>$/;"	a
l00044	doc/html/conf_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor"><\/span><span class="preprocessor">        #define DEFAULT_CONFIGFILE SYSCONFDIR"\/wifidog.conf"<\/span>$/;"	a
l00045	doc/html/conf_8h-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor"><\/span><span class="preprocessor">        #define DEFAULT_HTMLMSGFILE SYSCONFDIR"\/wifidog-msg.html"<\/span>$/;"	a
l00046	doc/html/conf_8h-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor"><\/span><span class="preprocessor">#endif  <\/span>$/;"	a
l00047	doc/html/conf_8h-source.html	/^<a name="l00047"><\/a><a class="code" href="conf_8h.html#c71029bbf7b0ee40ad72b17ff77f7896">00047<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_DAEMON 1<\/span>$/;"	a
l00048	doc/html/conf_8h-source.html	/^<a name="l00048"><\/a><a class="code" href="conf_8h.html#32198b3d9cda9e7ea18d9680f805dc87">00048<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_DEBUGLEVEL LOG_INFO<\/span>$/;"	a
l00049	doc/html/conf_8h-source.html	/^<a name="l00049"><\/a><a class="code" href="conf_8h.html#ca85302a5a857716f3b0275fbbff135f">00049<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_HTTPDMAXCONN 10<\/span>$/;"	a
l00050	doc/html/conf_8h-source.html	/^<a name="l00050"><\/a><a class="code" href="conf_8h.html#e38786151577e46b298b7baf0ca0fe96">00050<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_GATEWAYID NULL<\/span>$/;"	a
l00051	doc/html/conf_8h-source.html	/^<a name="l00051"><\/a><a class="code" href="conf_8h.html#f14cf5aa96a948b2d23a1ff0aeba3e48">00051<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_GATEWAYPORT 2060<\/span>$/;"	a
l00052	doc/html/conf_8h-source.html	/^<a name="l00052"><\/a><a class="code" href="conf_8h.html#af813a168a0bd5a77aa515073950a135">00052<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_HTTPDNAME "WiFiDog"<\/span>$/;"	a
l00053	doc/html/conf_8h-source.html	/^<a name="l00053"><\/a><a class="code" href="conf_8h.html#1ea67d2117d4f50445d1c9428bac5a64">00053<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_CLIENTTIMEOUT 5<\/span>$/;"	a
l00054	doc/html/conf_8h-source.html	/^<a name="l00054"><\/a><a class="code" href="conf_8h.html#9bcb72263ba584b1da18d3b2f2b65e6a">00054<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_CHECKINTERVAL 60<\/span>$/;"	a
l00055	doc/html/conf_8h-source.html	/^<a name="l00055"><\/a><a class="code" href="conf_8h.html#41ce987eea16297a459249b1e4c69ed7">00055<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_LOG_SYSLOG 0<\/span>$/;"	a
l00056	doc/html/conf_8h-source.html	/^<a name="l00056"><\/a><a class="code" href="conf_8h.html#66cff01e093b0b7d5335a7939f839341">00056<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_SYSLOG_FACILITY LOG_DAEMON<\/span>$/;"	a
l00057	doc/html/conf_8h-source.html	/^<a name="l00057"><\/a><a class="code" href="conf_8h.html#cee7c0173f525e29800b87222b407386">00057<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_WDCTL_SOCK "\/tmp\/wdctl.sock"<\/span>$/;"	a
l00058	doc/html/conf_8h-source.html	/^<a name="l00058"><\/a><a class="code" href="conf_8h.html#ea1d1da1ff4c9161109a81a0b1d6fd2c">00058<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_INTERNAL_SOCK "\/tmp\/wifidog.sock"<\/span>$/;"	a
l00059	doc/html/conf_8h-source.html	/^<a name="l00059"><\/a><a class="code" href="conf_8h.html#4468d0b44b441d03ea8270e09de86f65">00059<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVPORT 80<\/span>$/;"	a
l00060	doc/html/conf_8h-source.html	/^<a name="l00060"><\/a><a class="code" href="conf_8h.html#eecec081c6ba90900777bc8db01f774f">00060<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVSSLPORT 443<\/span>$/;"	a
l00061	doc/html/conf_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="preprocessor"><\/span>$/;"	a
l00062	doc/html/conf_8h-source.html	/^<a name="l00062"><\/a><a class="code" href="conf_8h.html#784fe164c1e4d1e62365a2505460592a">00062<\/a> <span class="preprocessor">#define DEFAULT_AUTHSERVSSLAVAILABLE 0<\/span>$/;"	a
l00063	doc/html/conf_8h-source.html	/^<a name="l00063"><\/a>00063 <span class="preprocessor"><\/span>$/;"	a
l00064	doc/html/conf_8h-source.html	/^<a name="l00064"><\/a><a class="code" href="conf_8h.html#d1127f95cef99fe1384a30fca8b9c392">00064<\/a> <span class="preprocessor">#define DEFAULT_AUTHSERVPATH "\/wifidog\/"<\/span>$/;"	a
l00065	doc/html/conf_8h-source.html	/^<a name="l00065"><\/a><a class="code" href="conf_8h.html#12e10b7db61ec0a23264d2a7762c6ef3">00065<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVLOGINPATHFRAGMENT "login\/?"<\/span>$/;"	a
l00066	doc/html/conf_8h-source.html	/^<a name="l00066"><\/a><a class="code" href="conf_8h.html#29ca3acd6665cd70286185f3dd4ab09d">00066<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVPORTALPATHFRAGMENT "portal\/?"<\/span>$/;"	a
l00067	doc/html/conf_8h-source.html	/^<a name="l00067"><\/a><a class="code" href="conf_8h.html#d26385411b1807104fa1504dff7bfb0d">00067<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVMSGPATHFRAGMENT "gw_message.php?"<\/span>$/;"	a
l00068	doc/html/conf_8h-source.html	/^<a name="l00068"><\/a><a class="code" href="conf_8h.html#11ea6dd746ca0526817bdd6515cbcc29">00068<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVPINGPATHFRAGMENT "ping\/?"<\/span>$/;"	a
l00069	doc/html/conf_8h-source.html	/^<a name="l00069"><\/a><a class="code" href="conf_8h.html#f83da39ab6845671d9b1a2bf635951fa">00069<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVAUTHPATHFRAGMENT "auth\/?"<\/span>$/;"	a
l00070	doc/html/conf_8h-source.html	/^<a name="l00070"><\/a>00070 <span class="preprocessor"><\/span>$/;"	a
l00075	doc/html/conf_8h-source.html	/^<a name="l00075"><\/a><a class="code" href="struct__auth__serv__t.html">00075<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__auth__serv__t.html">_auth_serv_t<\/a> {$/;"	a
l00076	doc/html/conf_8h-source.html	/^<a name="l00076"><\/a><a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3">00076<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>;    $/;"	a
l00077	doc/html/conf_8h-source.html	/^<a name="l00077"><\/a><a class="code" href="struct__auth__serv__t.html#ff64f568944bbf0b01bb379b17ae2161">00077<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#ff64f568944bbf0b01bb379b17ae2161" title="Path where wifidog resides.">authserv_path<\/a>;        $/;"	a
l00078	doc/html/conf_8h-source.html	/^<a name="l00078"><\/a><a class="code" href="struct__auth__serv__t.html#0752c3da9e2be08ca6d19449fa4cf425">00078<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#0752c3da9e2be08ca6d19449fa4cf425" title="This is the script the user will be sent to for login.">authserv_login_script_path_fragment<\/a>;  $/;"	a
l00079	doc/html/conf_8h-source.html	/^<a name="l00079"><\/a><a class="code" href="struct__auth__serv__t.html#bcf430ab833dd65830904abf5793e1c6">00079<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#bcf430ab833dd65830904abf5793e1c6" title="This is the script the user will be sent to after a successfull login.">authserv_portal_script_path_fragment<\/a>; $/;"	a
l00080	doc/html/conf_8h-source.html	/^<a name="l00080"><\/a><a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10">00080<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>;    $/;"	a
l00081	doc/html/conf_8h-source.html	/^<a name="l00081"><\/a><a class="code" href="struct__auth__serv__t.html#b33784964244174aef057fa405f76756">00081<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#b33784964244174aef057fa405f76756" title="This is the ping heartbeating script.">authserv_ping_script_path_fragment<\/a>;   $/;"	a
l00082	doc/html/conf_8h-source.html	/^<a name="l00082"><\/a><a class="code" href="struct__auth__serv__t.html#c1144ccb4a8c9418fe1b92a13aa701e8">00082<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#c1144ccb4a8c9418fe1b92a13aa701e8" title="This is the script that talks the wifidog gateway protocol.">authserv_auth_script_path_fragment<\/a>;   $/;"	a
l00083	doc/html/conf_8h-source.html	/^<a name="l00083"><\/a><a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb">00083<\/a>     <span class="keywordtype">int<\/span> <a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>;     $/;"	a
l00085	doc/html/conf_8h-source.html	/^<a name="l00085"><\/a><a class="code" href="struct__auth__serv__t.html#f4d82be7a680c24437a91ed1467f8921">00085<\/a>     <span class="keywordtype">int<\/span> <a class="code" href="struct__auth__serv__t.html#f4d82be7a680c24437a91ed1467f8921" title="Https port the central server listens on.">authserv_ssl_port<\/a>;      $/;"	a
l00087	doc/html/conf_8h-source.html	/^<a name="l00087"><\/a><a class="code" href="struct__auth__serv__t.html#87bde1ef8a18890d18858a360d276098">00087<\/a>     <span class="keywordtype">int<\/span> <a class="code" href="struct__auth__serv__t.html#87bde1ef8a18890d18858a360d276098" title="Use SSL or not.">authserv_use_ssl<\/a>;       $/;"	a
l00088	doc/html/conf_8h-source.html	/^<a name="l00088"><\/a><a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e">00088<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>;      $/;"	a
l00089	doc/html/conf_8h-source.html	/^<a name="l00089"><\/a>00089     <span class="keyword">struct <\/span><a class="code" href="struct__auth__serv__t.html">_auth_serv_t<\/a> *next;$/;"	a
l00090	doc/html/conf_8h-source.html	/^<a name="l00090"><\/a>00090 } <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>;$/;"	a
l00091	doc/html/conf_8h-source.html	/^<a name="l00091"><\/a>00091 $/;"	a
l00095	doc/html/conf_8h-source.html	/^<a name="l00095"><\/a><a class="code" href="struct__firewall__rule__t.html">00095<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__firewall__rule__t.html">_firewall_rule_t<\/a> {$/;"	a
l00096	doc/html/conf_8h-source.html	/^<a name="l00096"><\/a><a class="code" href="struct__firewall__rule__t.html#4319185967c4252ced90b2d440034b47">00096<\/a>     <span class="keywordtype">int<\/span> <a class="code" href="struct__firewall__rule__t.html#4319185967c4252ced90b2d440034b47" title="1 = Allow rule, 0 = Block rule">block_allow<\/a>;            $/;"	a
l00097	doc/html/conf_8h-source.html	/^<a name="l00097"><\/a><a class="code" href="struct__firewall__rule__t.html#de917f67daf277f81767a9ca7cb6ac1e">00097<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__firewall__rule__t.html#de917f67daf277f81767a9ca7cb6ac1e" title="tcp, udp, etc ...">protocol<\/a>;             $/;"	a
l00098	doc/html/conf_8h-source.html	/^<a name="l00098"><\/a><a class="code" href="struct__firewall__rule__t.html#172be165ac52a92dfe57e0911678698d">00098<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__firewall__rule__t.html#172be165ac52a92dfe57e0911678698d" title="Port to block\/allow.">port<\/a>;                 $/;"	a
l00099	doc/html/conf_8h-source.html	/^<a name="l00099"><\/a><a class="code" href="struct__firewall__rule__t.html#71fecaae85673b8c3d00a7c14f528f73">00099<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__firewall__rule__t.html#71fecaae85673b8c3d00a7c14f528f73" title="Mask for the rule *destination*.">mask<\/a>;                 $/;"	a
l00100	doc/html/conf_8h-source.html	/^<a name="l00100"><\/a>00100     <span class="keyword">struct <\/span><a class="code" href="struct__firewall__rule__t.html">_firewall_rule_t<\/a> *next;$/;"	a
l00101	doc/html/conf_8h-source.html	/^<a name="l00101"><\/a>00101 } <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>;$/;"	a
l00102	doc/html/conf_8h-source.html	/^<a name="l00102"><\/a>00102 $/;"	a
l00106	doc/html/conf_8h-source.html	/^<a name="l00106"><\/a><a class="code" href="struct__firewall__ruleset__t.html">00106<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__firewall__ruleset__t.html">_firewall_ruleset_t<\/a> {$/;"	a
l00107	doc/html/conf_8h-source.html	/^<a name="l00107"><\/a>00107     <span class="keywordtype">char<\/span>                        *name;$/;"	a
l00108	doc/html/conf_8h-source.html	/^<a name="l00108"><\/a>00108     <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>             *rules;$/;"	a
l00109	doc/html/conf_8h-source.html	/^<a name="l00109"><\/a>00109     <span class="keyword">struct <\/span><a class="code" href="struct__firewall__ruleset__t.html">_firewall_ruleset_t<\/a>  *next;$/;"	a
l00110	doc/html/conf_8h-source.html	/^<a name="l00110"><\/a>00110 } <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>;$/;"	a
l00111	doc/html/conf_8h-source.html	/^<a name="l00111"><\/a>00111 $/;"	a
l00115	doc/html/conf_8h-source.html	/^<a name="l00115"><\/a><a class="code" href="struct__trusted__mac__t.html">00115<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__trusted__mac__t.html">_trusted_mac_t<\/a> {$/;"	a
l00116	doc/html/conf_8h-source.html	/^<a name="l00116"><\/a>00116     <span class="keywordtype">char<\/span>   *mac;$/;"	a
l00117	doc/html/conf_8h-source.html	/^<a name="l00117"><\/a>00117     <span class="keyword">struct <\/span><a class="code" href="struct__trusted__mac__t.html">_trusted_mac_t<\/a> *next;$/;"	a
l00118	doc/html/conf_8h-source.html	/^<a name="l00118"><\/a>00118 } <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a>;$/;"	a
l00119	doc/html/conf_8h-source.html	/^<a name="l00119"><\/a>00119 $/;"	a
l00123	doc/html/conf_8h-source.html	/^<a name="l00123"><\/a><a class="code" href="structs__config.html">00123<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span>{$/;"	a
l00124	doc/html/conf_8h-source.html	/^<a name="l00124"><\/a><a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81">00124<\/a>     <span class="keywordtype">char<\/span> configfile[255];       $/;"	a
l00125	doc/html/conf_8h-source.html	/^<a name="l00125"><\/a><a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6">00125<\/a>     <span class="keywordtype">char<\/span> *htmlmsgfile;          $/;"	a
l00126	doc/html/conf_8h-source.html	/^<a name="l00126"><\/a><a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d">00126<\/a>     <span class="keywordtype">char<\/span> *wdctl_sock;           $/;"	a
l00127	doc/html/conf_8h-source.html	/^<a name="l00127"><\/a><a class="code" href="structs__config.html#132360d3c982b91fe0cdff6622eee1f1">00127<\/a>     <span class="keywordtype">char<\/span> *internal_sock;                $/;"	a
l00128	doc/html/conf_8h-source.html	/^<a name="l00128"><\/a><a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389">00128<\/a>     <span class="keywordtype">int<\/span> daemon;                 $/;"	a
l00129	doc/html/conf_8h-source.html	/^<a name="l00129"><\/a><a class="code" href="structs__config.html#72a375118114359c8fcf890bba1e77fb">00129<\/a>     <span class="keywordtype">int<\/span> debuglevel;             $/;"	a
l00130	doc/html/conf_8h-source.html	/^<a name="l00130"><\/a><a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62">00130<\/a>     <span class="keywordtype">char<\/span> *external_interface;   $/;"	a
l00132	doc/html/conf_8h-source.html	/^<a name="l00132"><\/a><a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8">00132<\/a>     <span class="keywordtype">char<\/span> *gw_id;                $/;"	a
l00134	doc/html/conf_8h-source.html	/^<a name="l00134"><\/a><a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c">00134<\/a>     <span class="keywordtype">char<\/span> *gw_interface;         $/;"	a
l00135	doc/html/conf_8h-source.html	/^<a name="l00135"><\/a><a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0">00135<\/a>     <span class="keywordtype">char<\/span> *gw_address;           $/;"	a
l00137	doc/html/conf_8h-source.html	/^<a name="l00137"><\/a><a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189">00137<\/a>     <span class="keywordtype">int<\/span> gw_port;                $/;"	a
l00139	doc/html/conf_8h-source.html	/^<a name="l00139"><\/a><a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e">00139<\/a>     <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_servers;  $/;"	a
l00140	doc/html/conf_8h-source.html	/^<a name="l00140"><\/a><a class="code" href="structs__config.html#2ed9a59507be060fe0e1deae7fcc077b">00140<\/a>     <span class="keywordtype">char<\/span> *httpdname;            $/;"	a
l00142	doc/html/conf_8h-source.html	/^<a name="l00142"><\/a><a class="code" href="structs__config.html#7a24ca5b2cc1ff099bda0af17e654a95">00142<\/a>     <span class="keywordtype">int<\/span> httpdmaxconn;           $/;"	a
l00144	doc/html/conf_8h-source.html	/^<a name="l00144"><\/a><a class="code" href="structs__config.html#283515007953f307a7b599ee480b743d">00144<\/a>     <span class="keywordtype">char<\/span> *httpdrealm;           $/;"	a
l00145	doc/html/conf_8h-source.html	/^<a name="l00145"><\/a><a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d">00145<\/a>     <span class="keywordtype">char<\/span> *httpdusername;        $/;"	a
l00146	doc/html/conf_8h-source.html	/^<a name="l00146"><\/a><a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5">00146<\/a>     <span class="keywordtype">char<\/span> *httpdpassword;        $/;"	a
l00147	doc/html/conf_8h-source.html	/^<a name="l00147"><\/a><a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c">00147<\/a>     <span class="keywordtype">int<\/span> clienttimeout;          $/;"	a
l00149	doc/html/conf_8h-source.html	/^<a name="l00149"><\/a><a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7">00149<\/a>     <span class="keywordtype">int<\/span> checkinterval;          $/;"	a
l00151	doc/html/conf_8h-source.html	/^<a name="l00151"><\/a><a class="code" href="structs__config.html#784dd5fa3d27b3d1311b18f23e919362">00151<\/a>     <span class="keywordtype">int<\/span> log_syslog;             $/;"	a
l00152	doc/html/conf_8h-source.html	/^<a name="l00152"><\/a><a class="code" href="structs__config.html#eaad87f73a87a2f752b111dad813902d">00152<\/a>     <span class="keywordtype">int<\/span> syslog_facility;        $/;"	a
l00154	doc/html/conf_8h-source.html	/^<a name="l00154"><\/a><a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4">00154<\/a>     <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>  *rulesets;      $/;"	a
l00155	doc/html/conf_8h-source.html	/^<a name="l00155"><\/a><a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64">00155<\/a>     <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a> *trustedmaclist; $/;"	a
l00156	doc/html/conf_8h-source.html	/^<a name="l00156"><\/a>00156 } <a class="code" href="structs__config.html">s_config<\/a>;$/;"	a
l00157	doc/html/conf_8h-source.html	/^<a name="l00157"><\/a>00157 $/;"	a
l00159	doc/html/conf_8h-source.html	/^<a name="l00159"><\/a>00159 <a class="code" href="structs__config.html">s_config<\/a> *<a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00160	doc/html/conf_8h-source.html	/^<a name="l00160"><\/a>00160 $/;"	a
l00162	doc/html/conf_8h-source.html	/^<a name="l00162"><\/a>00162 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#068a358868c409bbd99d7eef3c988866" title="Initialise the conf system.">config_init<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00163	doc/html/conf_8h-source.html	/^<a name="l00163"><\/a>00163 $/;"	a
l00165	doc/html/conf_8h-source.html	/^<a name="l00165"><\/a>00165 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#17b6b425f18de3865e44b534c1f1f1cc" title="Initialize the variables we override with the command line.">config_init_override<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00166	doc/html/conf_8h-source.html	/^<a name="l00166"><\/a>00166 $/;"	a
l00168	doc/html/conf_8h-source.html	/^<a name="l00168"><\/a>00168 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#d3faac0efa0ac4c1032c0c54f7e93711" title="Reads the configuration file.">config_read<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename);$/;"	a
l00169	doc/html/conf_8h-source.html	/^<a name="l00169"><\/a>00169 $/;"	a
l00171	doc/html/conf_8h-source.html	/^<a name="l00171"><\/a>00171 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#0f9540b3f729ba3b3d31b613d3eca364" title="Check that the configuration is valid.">config_validate<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00172	doc/html/conf_8h-source.html	/^<a name="l00172"><\/a>00172 $/;"	a
l00174	doc/html/conf_8h-source.html	/^<a name="l00174"><\/a>00174 <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *<a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00175	doc/html/conf_8h-source.html	/^<a name="l00175"><\/a>00175 $/;"	a
l00177	doc/html/conf_8h-source.html	/^<a name="l00177"><\/a>00177 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#d1e677696fcef826740ca906587af8ac" title="Bump server to bottom of the list.">mark_auth_server_bad<\/a>(<a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *);$/;"	a
l00178	doc/html/conf_8h-source.html	/^<a name="l00178"><\/a>00178 $/;"	a
l00180	doc/html/conf_8h-source.html	/^<a name="l00180"><\/a>00180 <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *<a class="code" href="conf_8c.html#617ad9199f2b10b95498f4f15c67c66d" title="Fetch a firewall rule set.">get_ruleset<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *);$/;"	a
l00181	doc/html/conf_8h-source.html	/^<a name="l00181"><\/a>00181 $/;"	a
l00182	doc/html/conf_8h-source.html	/^<a name="l00182"><\/a>00182 <span class="keywordtype">void<\/span> parse_trusted_mac_list(<span class="keywordtype">char<\/span> *);$/;"	a
l00183	doc/html/conf_8h-source.html	/^<a name="l00183"><\/a>00183 $/;"	a
l00184	doc/html/conf_8h-source.html	/^<a name="l00184"><\/a>00184 <span class="preprocessor">#define LOCK_CONFIG() do { \\<\/span>$/;"	a
l00185	doc/html/conf_8h-source.html	/^<a name="l00185"><\/a>00185 <span class="preprocessor">        debug(LOG_DEBUG, "Locking config"); \\<\/span>$/;"	a
l00186	doc/html/conf_8h-source.html	/^<a name="l00186"><\/a>00186 <span class="preprocessor">        pthread_mutex_lock(&amp;config_mutex); \\<\/span>$/;"	a
l00187	doc/html/conf_8h-source.html	/^<a name="l00187"><\/a>00187 <span class="preprocessor">        debug(LOG_DEBUG, "Config locked"); \\<\/span>$/;"	a
l00188	doc/html/conf_8h-source.html	/^<a name="l00188"><\/a>00188 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00189	doc/html/conf_8h-source.html	/^<a name="l00189"><\/a>00189 <span class="preprocessor"><\/span>$/;"	a
l00190	doc/html/conf_8h-source.html	/^<a name="l00190"><\/a>00190 <span class="preprocessor">#define UNLOCK_CONFIG() do { \\<\/span>$/;"	a
l00191	doc/html/conf_8h-source.html	/^<a name="l00191"><\/a>00191 <span class="preprocessor">        debug(LOG_DEBUG, "Unlocking config"); \\<\/span>$/;"	a
l00192	doc/html/conf_8h-source.html	/^<a name="l00192"><\/a>00192 <span class="preprocessor">        pthread_mutex_unlock(&amp;config_mutex); \\<\/span>$/;"	a
l00193	doc/html/conf_8h-source.html	/^<a name="l00193"><\/a>00193 <span class="preprocessor">        debug(LOG_DEBUG, "Config unlocked"); \\<\/span>$/;"	a
l00194	doc/html/conf_8h-source.html	/^<a name="l00194"><\/a>00194 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00195	doc/html/conf_8h-source.html	/^<a name="l00195"><\/a>00195 <span class="preprocessor"><\/span>$/;"	a
l00196	doc/html/conf_8h-source.html	/^<a name="l00196"><\/a>00196 <span class="preprocessor">#endif <\/span><span class="comment">\/* _CONFIG_H_ *\/<\/span>$/;"	a
068a358868c409bbd99d7eef3c988866	doc/html/conf_8h.html	/^<a class="anchor" name="068a358868c409bbd99d7eef3c988866"><\/a><!-- doxytag: member="conf.h::config_init" ref="068a358868c409bbd99d7eef3c988866" args="(void)" -->$/;"	a
0ec3017454ea7a8398d25c8ab83890fd	doc/html/conf_8h.html	/^<a class="anchor" name="0ec3017454ea7a8398d25c8ab83890fd"><\/a><!-- doxytag: member="conf.h::DEFAULT_CONFIGFILE" ref="0ec3017454ea7a8398d25c8ab83890fd" args="" -->$/;"	a
0f9540b3f729ba3b3d31b613d3eca364	doc/html/conf_8h.html	/^<a class="anchor" name="0f9540b3f729ba3b3d31b613d3eca364"><\/a><!-- doxytag: member="conf.h::config_validate" ref="0f9540b3f729ba3b3d31b613d3eca364" args="(void)" -->$/;"	a
0fd56151aad780327b8968df38695580	doc/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0fd56151aad780327b8968df38695580"><\/a><!-- doxytag: member="conf.h::t_firewall_ruleset" ref="0fd56151aad780327b8968df38695580" args="" -->$/;"	a
11ea6dd746ca0526817bdd6515cbcc29	doc/html/conf_8h.html	/^<a class="anchor" name="11ea6dd746ca0526817bdd6515cbcc29"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVPINGPATHFRAGMENT" ref="11ea6dd746ca0526817bdd6515cbcc29" args="" -->$/;"	a
12e10b7db61ec0a23264d2a7762c6ef3	doc/html/conf_8h.html	/^<a class="anchor" name="12e10b7db61ec0a23264d2a7762c6ef3"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVLOGINPATHFRAGMENT" ref="12e10b7db61ec0a23264d2a7762c6ef3" args="" -->$/;"	a
16581929d818bc322bbebce8a7a12117	doc/html/conf_8h.html	/^<a class="anchor" name="16581929d818bc322bbebce8a7a12117"><\/a><!-- doxytag: member="conf.h::DEFAULT_HTMLMSGFILE" ref="16581929d818bc322bbebce8a7a12117" args="" -->$/;"	a
17b6b425f18de3865e44b534c1f1f1cc	doc/html/conf_8h.html	/^<a class="anchor" name="17b6b425f18de3865e44b534c1f1f1cc"><\/a><!-- doxytag: member="conf.h::config_init_override" ref="17b6b425f18de3865e44b534c1f1f1cc" args="(void)" -->$/;"	a
1ea67d2117d4f50445d1c9428bac5a64	doc/html/conf_8h.html	/^<a class="anchor" name="1ea67d2117d4f50445d1c9428bac5a64"><\/a><!-- doxytag: member="conf.h::DEFAULT_CLIENTTIMEOUT" ref="1ea67d2117d4f50445d1c9428bac5a64" args="" -->$/;"	a
29ca3acd6665cd70286185f3dd4ab09d	doc/html/conf_8h.html	/^<a class="anchor" name="29ca3acd6665cd70286185f3dd4ab09d"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVPORTALPATHFRAGMENT" ref="29ca3acd6665cd70286185f3dd4ab09d" args="" -->$/;"	a
32198b3d9cda9e7ea18d9680f805dc87	doc/html/conf_8h.html	/^<a class="anchor" name="32198b3d9cda9e7ea18d9680f805dc87"><\/a><!-- doxytag: member="conf.h::DEFAULT_DEBUGLEVEL" ref="32198b3d9cda9e7ea18d9680f805dc87" args="" -->$/;"	a
41ce987eea16297a459249b1e4c69ed7	doc/html/conf_8h.html	/^<a class="anchor" name="41ce987eea16297a459249b1e4c69ed7"><\/a><!-- doxytag: member="conf.h::DEFAULT_LOG_SYSLOG" ref="41ce987eea16297a459249b1e4c69ed7" args="" -->$/;"	a
4468d0b44b441d03ea8270e09de86f65	doc/html/conf_8h.html	/^<a class="anchor" name="4468d0b44b441d03ea8270e09de86f65"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVPORT" ref="4468d0b44b441d03ea8270e09de86f65" args="" -->$/;"	a
545ee1dadc18a259ffd0d798f999ddc3	doc/html/conf_8h.html	/^<a class="anchor" name="545ee1dadc18a259ffd0d798f999ddc3"><\/a><!-- doxytag: member="conf.h::get_ruleset" ref="545ee1dadc18a259ffd0d798f999ddc3" args="(const char *)" -->$/;"	a
64e73012596dd6628c18742c8046069f	doc/html/conf_8h.html	/^<a class="anchor" name="64e73012596dd6628c18742c8046069f"><\/a><!-- doxytag: member="conf.h::config_get_config" ref="64e73012596dd6628c18742c8046069f" args="(void)" -->$/;"	a
66cff01e093b0b7d5335a7939f839341	doc/html/conf_8h.html	/^<a class="anchor" name="66cff01e093b0b7d5335a7939f839341"><\/a><!-- doxytag: member="conf.h::DEFAULT_SYSLOG_FACILITY" ref="66cff01e093b0b7d5335a7939f839341" args="" -->$/;"	a
771a6a60dbaa6c7532ab6cd31b397f7d	doc/html/conf_8h.html	/^<a class="anchor" name="771a6a60dbaa6c7532ab6cd31b397f7d"><\/a><!-- doxytag: member="conf.h::NUM_EXT_INTERFACE_DETECT_RETRY" ref="771a6a60dbaa6c7532ab6cd31b397f7d" args="" -->$/;"	a
784fe164c1e4d1e62365a2505460592a	doc/html/conf_8h.html	/^<a class="anchor" name="784fe164c1e4d1e62365a2505460592a"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVSSLAVAILABLE" ref="784fe164c1e4d1e62365a2505460592a" args="" -->$/;"	a
82ffcd3c683aadc31aca9c53a2d2739a	doc/html/conf_8h.html	/^<a class="anchor" name="82ffcd3c683aadc31aca9c53a2d2739a"><\/a><!-- doxytag: member="conf.h::get_auth_server" ref="82ffcd3c683aadc31aca9c53a2d2739a" args="(void)" -->$/;"	a
90dfc8bedb1f49c67ee6aa006b73843b	doc/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="90dfc8bedb1f49c67ee6aa006b73843b"><\/a><!-- doxytag: member="conf.h::t_firewall_rule" ref="90dfc8bedb1f49c67ee6aa006b73843b" args="" -->$/;"	a
9bcb72263ba584b1da18d3b2f2b65e6a	doc/html/conf_8h.html	/^<a class="anchor" name="9bcb72263ba584b1da18d3b2f2b65e6a"><\/a><!-- doxytag: member="conf.h::DEFAULT_CHECKINTERVAL" ref="9bcb72263ba584b1da18d3b2f2b65e6a" args="" -->$/;"	a
9d674c58e3d919b7cd55aa12ed52be3c	doc/html/conf_8h.html	/^<a class="anchor" name="9d674c58e3d919b7cd55aa12ed52be3c"><\/a><!-- doxytag: member="conf.h::mark_auth_server_bad" ref="9d674c58e3d919b7cd55aa12ed52be3c" args="(t_auth_serv *)" -->$/;"	a
_details	doc/html/conf_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
af3b14d87ff5b04067f3f0911905c560	doc/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="af3b14d87ff5b04067f3f0911905c560"><\/a><!-- doxytag: member="conf.h::parse_trusted_mac_list" ref="af3b14d87ff5b04067f3f0911905c560" args="(char *)" -->$/;"	a
af813a168a0bd5a77aa515073950a135	doc/html/conf_8h.html	/^<a class="anchor" name="af813a168a0bd5a77aa515073950a135"><\/a><!-- doxytag: member="conf.h::DEFAULT_HTTPDNAME" ref="af813a168a0bd5a77aa515073950a135" args="" -->$/;"	a
b67c119b3d066438d4c3405b518bb289	doc/html/conf_8h.html	/^<a class="anchor" name="b67c119b3d066438d4c3405b518bb289"><\/a><!-- doxytag: member="conf.h::EXT_INTERFACE_DETECT_RETRY_INTERVAL" ref="b67c119b3d066438d4c3405b518bb289" args="" -->$/;"	a
c71029bbf7b0ee40ad72b17ff77f7896	doc/html/conf_8h.html	/^<a class="anchor" name="c71029bbf7b0ee40ad72b17ff77f7896"><\/a><!-- doxytag: member="conf.h::DEFAULT_DAEMON" ref="c71029bbf7b0ee40ad72b17ff77f7896" args="" -->$/;"	a
ca85302a5a857716f3b0275fbbff135f	doc/html/conf_8h.html	/^<a class="anchor" name="ca85302a5a857716f3b0275fbbff135f"><\/a><!-- doxytag: member="conf.h::DEFAULT_HTTPDMAXCONN" ref="ca85302a5a857716f3b0275fbbff135f" args="" -->$/;"	a
cc46f3e3f6b7dbbf1f4e7a31553d9797	doc/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cc46f3e3f6b7dbbf1f4e7a31553d9797"><\/a><!-- doxytag: member="conf.h::t_trusted_mac" ref="cc46f3e3f6b7dbbf1f4e7a31553d9797" args="" -->$/;"	a
cee7c0173f525e29800b87222b407386	doc/html/conf_8h.html	/^<a class="anchor" name="cee7c0173f525e29800b87222b407386"><\/a><!-- doxytag: member="conf.h::DEFAULT_WDCTL_SOCK" ref="cee7c0173f525e29800b87222b407386" args="" -->$/;"	a
d1127f95cef99fe1384a30fca8b9c392	doc/html/conf_8h.html	/^<a class="anchor" name="d1127f95cef99fe1384a30fca8b9c392"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVPATH" ref="d1127f95cef99fe1384a30fca8b9c392" args="" -->$/;"	a
d26385411b1807104fa1504dff7bfb0d	doc/html/conf_8h.html	/^<a class="anchor" name="d26385411b1807104fa1504dff7bfb0d"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVMSGPATHFRAGMENT" ref="d26385411b1807104fa1504dff7bfb0d" args="" -->$/;"	a
d3faac0efa0ac4c1032c0c54f7e93711	doc/html/conf_8h.html	/^<a class="anchor" name="d3faac0efa0ac4c1032c0c54f7e93711"><\/a><!-- doxytag: member="conf.h::config_read" ref="d3faac0efa0ac4c1032c0c54f7e93711" args="(const char *filename)" -->$/;"	a
d76ac64532ff817e332a6361a59231cb	doc/html/conf_8h.html	/^<a class="anchor" name="d76ac64532ff817e332a6361a59231cb"><\/a><!-- doxytag: member="conf.h::LOCK_CONFIG" ref="d76ac64532ff817e332a6361a59231cb" args="()" -->$/;"	a
dd3fb3e4a4d675d452c3c7926f60fac2	doc/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dd3fb3e4a4d675d452c3c7926f60fac2"><\/a><!-- doxytag: member="conf.h::t_auth_serv" ref="dd3fb3e4a4d675d452c3c7926f60fac2" args="" -->$/;"	a
e38786151577e46b298b7baf0ca0fe96	doc/html/conf_8h.html	/^<a class="anchor" name="e38786151577e46b298b7baf0ca0fe96"><\/a><!-- doxytag: member="conf.h::DEFAULT_GATEWAYID" ref="e38786151577e46b298b7baf0ca0fe96" args="" -->$/;"	a
ea1d1da1ff4c9161109a81a0b1d6fd2c	doc/html/conf_8h.html	/^<a class="anchor" name="ea1d1da1ff4c9161109a81a0b1d6fd2c"><\/a><!-- doxytag: member="conf.h::DEFAULT_INTERNAL_SOCK" ref="ea1d1da1ff4c9161109a81a0b1d6fd2c" args="" -->$/;"	a
eecec081c6ba90900777bc8db01f774f	doc/html/conf_8h.html	/^<a class="anchor" name="eecec081c6ba90900777bc8db01f774f"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVSSLPORT" ref="eecec081c6ba90900777bc8db01f774f" args="" -->$/;"	a
f14cf5aa96a948b2d23a1ff0aeba3e48	doc/html/conf_8h.html	/^<a class="anchor" name="f14cf5aa96a948b2d23a1ff0aeba3e48"><\/a><!-- doxytag: member="conf.h::DEFAULT_GATEWAYPORT" ref="f14cf5aa96a948b2d23a1ff0aeba3e48" args="" -->$/;"	a
f83da39ab6845671d9b1a2bf635951fa	doc/html/conf_8h.html	/^<a class="anchor" name="f83da39ab6845671d9b1a2bf635951fa"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVAUTHPATHFRAGMENT" ref="f83da39ab6845671d9b1a2bf635951fa" args="" -->$/;"	a
fac07fdf02de5cace1687c411ee42d56	doc/html/conf_8h.html	/^<a class="anchor" name="fac07fdf02de5cace1687c411ee42d56"><\/a><!-- doxytag: member="conf.h::UNLOCK_CONFIG" ref="fac07fdf02de5cace1687c411ee42d56" args="()" -->$/;"	a
l00001	doc/html/debug_8c-source.html	/^<h1>debug.c<\/h1><a href="debug_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/debug_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/debug_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/debug_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/debug_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/debug_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/debug_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/debug_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/debug_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/debug_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/debug_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/debug_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/debug_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/debug_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/debug_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/debug_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/debug_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/debug_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/debug_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/debug_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/debug_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: debug.c 1305 2007-11-01 20:04:20Z benoitg $ *\/<\/span>$/;"	a
l00027	doc/html/debug_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00028	doc/html/debug_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00029	doc/html/debug_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00030	doc/html/debug_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00031	doc/html/debug_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;time.h&gt;<\/span>$/;"	a
l00032	doc/html/debug_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00033	doc/html/debug_8c-source.html	/^<a name="l00033"><\/a>00033 $/;"	a
l00034	doc/html/debug_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00035	doc/html/debug_8c-source.html	/^<a name="l00035"><\/a>00035 $/;"	a
l00038	doc/html/debug_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="keywordtype">void<\/span>$/;"	a
l00039	doc/html/debug_8c-source.html	/^<a name="l00039"><\/a>00039 _debug(<span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> line, <span class="keywordtype">int<\/span> level, <span class="keywordtype">char<\/span> *format, ...)$/;"	a
l00040	doc/html/debug_8c-source.html	/^<a name="l00040"><\/a>00040 {$/;"	a
l00041	doc/html/debug_8c-source.html	/^<a name="l00041"><\/a>00041     <span class="keywordtype">char<\/span> buf[28];$/;"	a
l00042	doc/html/debug_8c-source.html	/^<a name="l00042"><\/a>00042     va_list vlist;$/;"	a
l00043	doc/html/debug_8c-source.html	/^<a name="l00043"><\/a>00043     <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00044	doc/html/debug_8c-source.html	/^<a name="l00044"><\/a>00044     time_t ts;$/;"	a
l00045	doc/html/debug_8c-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	doc/html/debug_8c-source.html	/^<a name="l00046"><\/a>00046     time(&amp;ts);$/;"	a
l00047	doc/html/debug_8c-source.html	/^<a name="l00047"><\/a>00047 $/;"	a
l00048	doc/html/debug_8c-source.html	/^<a name="l00048"><\/a>00048     <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#72a375118114359c8fcf890bba1e77fb" title="Debug information verbosity.">debuglevel<\/a> &gt;= level) {$/;"	a
l00049	doc/html/debug_8c-source.html	/^<a name="l00049"><\/a>00049         va_start(vlist, format);$/;"	a
l00050	doc/html/debug_8c-source.html	/^<a name="l00050"><\/a>00050 $/;"	a
l00051	doc/html/debug_8c-source.html	/^<a name="l00051"><\/a>00051         <span class="keywordflow">if<\/span> (level &lt;= LOG_WARNING) {$/;"	a
l00052	doc/html/debug_8c-source.html	/^<a name="l00052"><\/a>00052             fprintf(stderr, <span class="stringliteral">"[%d][%.24s][%u](%s:%d) "<\/span>, level, ctime_r(&amp;ts, buf), getpid(),$/;"	a
l00053	doc/html/debug_8c-source.html	/^<a name="l00053"><\/a>00053                             filename, line);$/;"	a
l00054	doc/html/debug_8c-source.html	/^<a name="l00054"><\/a>00054             vfprintf(stderr, format, vlist);$/;"	a
l00055	doc/html/debug_8c-source.html	/^<a name="l00055"><\/a>00055             fputc(<span class="charliteral">'\\n'<\/span>, stderr);$/;"	a
l00056	doc/html/debug_8c-source.html	/^<a name="l00056"><\/a>00056         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (!config-&gt;<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a>) {$/;"	a
l00057	doc/html/debug_8c-source.html	/^<a name="l00057"><\/a>00057             fprintf(stdout, <span class="stringliteral">"[%d][%.24s][%u](%s:%d) "<\/span>, level, ctime_r(&amp;ts, buf), getpid(),$/;"	a
l00058	doc/html/debug_8c-source.html	/^<a name="l00058"><\/a>00058                             filename, line);$/;"	a
l00059	doc/html/debug_8c-source.html	/^<a name="l00059"><\/a>00059             vfprintf(stdout, format, vlist);$/;"	a
l00060	doc/html/debug_8c-source.html	/^<a name="l00060"><\/a>00060             fputc(<span class="charliteral">'\\n'<\/span>, stdout);$/;"	a
l00061	doc/html/debug_8c-source.html	/^<a name="l00061"><\/a>00061             fflush(stdout);$/;"	a
l00062	doc/html/debug_8c-source.html	/^<a name="l00062"><\/a>00062         }$/;"	a
l00063	doc/html/debug_8c-source.html	/^<a name="l00063"><\/a>00063 $/;"	a
l00064	doc/html/debug_8c-source.html	/^<a name="l00064"><\/a>00064         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#784dd5fa3d27b3d1311b18f23e919362" title="boolean, wether to log to syslog">log_syslog<\/a>) {$/;"	a
l00065	doc/html/debug_8c-source.html	/^<a name="l00065"><\/a>00065             openlog(<span class="stringliteral">"wifidog"<\/span>, LOG_PID, config-&gt;<a class="code" href="structs__config.html#eaad87f73a87a2f752b111dad813902d" title="facility to use when using syslog for logging">syslog_facility<\/a>);$/;"	a
l00066	doc/html/debug_8c-source.html	/^<a name="l00066"><\/a>00066             vsyslog(level, format, vlist);$/;"	a
l00067	doc/html/debug_8c-source.html	/^<a name="l00067"><\/a>00067             closelog();$/;"	a
l00068	doc/html/debug_8c-source.html	/^<a name="l00068"><\/a>00068         }$/;"	a
l00069	doc/html/debug_8c-source.html	/^<a name="l00069"><\/a>00069     }$/;"	a
l00070	doc/html/debug_8c-source.html	/^<a name="l00070"><\/a>00070 }$/;"	a
l00071	doc/html/debug_8c-source.html	/^<a name="l00071"><\/a>00071 $/;"	a
_details	doc/html/debug_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a7c17e74bfc56c95b5eb2a9f45b289e7	doc/html/debug_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a7c17e74bfc56c95b5eb2a9f45b289e7"><\/a><!-- doxytag: member="debug.c::_debug" ref="a7c17e74bfc56c95b5eb2a9f45b289e7" args="(char *filename, int line, int level, char *format,...)" -->$/;"	a
l00001	doc/html/debug_8h-source.html	/^<h1>debug.h<\/h1><a href="debug_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/debug_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/debug_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/debug_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/debug_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/debug_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/debug_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/debug_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/debug_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/debug_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/debug_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/debug_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/debug_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/debug_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/debug_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/debug_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/debug_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/debug_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/debug_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/debug_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/debug_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: debug.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	doc/html/debug_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _DEBUG_H_<\/span>$/;"	a
l00028	doc/html/debug_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _DEBUG_H_<\/span>$/;"	a
l00029	doc/html/debug_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00033	doc/html/debug_8h-source.html	/^<a name="l00033"><\/a><a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a">00033<\/a> <span class="preprocessor">#define debug(level, format...) _debug(__FILE__, __LINE__, level, format)<\/span>$/;"	a
l00034	doc/html/debug_8h-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor"><\/span>$/;"	a
l00036	doc/html/debug_8h-source.html	/^<a name="l00036"><\/a>00036 <span class="keywordtype">void<\/span> _debug(<span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> line, <span class="keywordtype">int<\/span> level, <span class="keywordtype">char<\/span> *format, ...);$/;"	a
l00037	doc/html/debug_8h-source.html	/^<a name="l00037"><\/a>00037 $/;"	a
l00038	doc/html/debug_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#endif <\/span><span class="comment">\/* _DEBUG_H_ *\/<\/span>$/;"	a
522ebc0c3c064e7ddf37eda0ee8c3f8a	doc/html/debug_8h.html	/^<a class="anchor" name="522ebc0c3c064e7ddf37eda0ee8c3f8a"><\/a><!-- doxytag: member="debug.h::debug" ref="522ebc0c3c064e7ddf37eda0ee8c3f8a" args="(level, format...)" -->$/;"	a
_details	doc/html/debug_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a7c17e74bfc56c95b5eb2a9f45b289e7	doc/html/debug_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a7c17e74bfc56c95b5eb2a9f45b289e7"><\/a><!-- doxytag: member="debug.h::_debug" ref="a7c17e74bfc56c95b5eb2a9f45b289e7" args="(char *filename, int line, int level, char *format,...)" -->$/;"	a
l00001	doc/html/firewall_8c-source.html	/^<h1>firewall.c<\/h1><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/firewall_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/firewall_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/firewall_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/firewall_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/firewall_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/firewall_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/firewall_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/firewall_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/firewall_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/firewall_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/firewall_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/firewall_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/firewall_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/firewall_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/firewall_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/firewall_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/firewall_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/firewall_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/firewall_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/firewall_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/*<\/span>$/;"	a
l00022	doc/html/firewall_8c-source.html	/^<a name="l00022"><\/a>00022 <span class="comment"> * $Id: firewall.c 1389 2009-02-27 17:39:30Z benoitg $<\/span>$/;"	a
l00023	doc/html/firewall_8c-source.html	/^<a name="l00023"><\/a>00023 <span class="comment"> *\/<\/span>$/;"	a
l00031	doc/html/firewall_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00032	doc/html/firewall_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor"><\/span>$/;"	a
l00033	doc/html/firewall_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00034	doc/html/firewall_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00035	doc/html/firewall_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00036	doc/html/firewall_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00037	doc/html/firewall_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00038	doc/html/firewall_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;sys\/wait.h&gt;<\/span>$/;"	a
l00039	doc/html/firewall_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00040	doc/html/firewall_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;sys\/unistd.h&gt;<\/span>$/;"	a
l00041	doc/html/firewall_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	doc/html/firewall_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00043	doc/html/firewall_8c-source.html	/^<a name="l00043"><\/a>00043 $/;"	a
l00044	doc/html/firewall_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00045	doc/html/firewall_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00046	doc/html/firewall_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00047	doc/html/firewall_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00048	doc/html/firewall_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include &lt;sys\/uio.h&gt;<\/span>$/;"	a
l00049	doc/html/firewall_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include &lt;fcntl.h&gt;<\/span>$/;"	a
l00050	doc/html/firewall_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include &lt;netdb.h&gt;<\/span>$/;"	a
l00051	doc/html/firewall_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include &lt;sys\/time.h&gt;<\/span>$/;"	a
l00052	doc/html/firewall_8c-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00053	doc/html/firewall_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#ifdef __linux__<\/span>$/;"	a
l00054	doc/html/firewall_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor"><\/span><span class="preprocessor">#include &lt;net\/ethernet.h&gt;<\/span>$/;"	a
l00055	doc/html/firewall_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="preprocessor">#include &lt;netinet\/ip.h&gt;<\/span>$/;"	a
l00056	doc/html/firewall_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="preprocessor">#include &lt;netinet\/ip_icmp.h&gt;<\/span>$/;"	a
l00057	doc/html/firewall_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="preprocessor">#include &lt;netpacket\/packet.h&gt;<\/span>$/;"	a
l00058	doc/html/firewall_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="preprocessor">#endif<\/span>$/;"	a
l00059	doc/html/firewall_8c-source.html	/^<a name="l00059"><\/a>00059 <span class="preprocessor"><\/span>$/;"	a
l00060	doc/html/firewall_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="preprocessor">#if defined(__NetBSD__)<\/span>$/;"	a
l00061	doc/html/firewall_8c-source.html	/^<a name="l00061"><\/a>00061 <span class="preprocessor"><\/span><span class="preprocessor">#include &lt;netinet\/in_systm.h&gt;<\/span>$/;"	a
l00062	doc/html/firewall_8c-source.html	/^<a name="l00062"><\/a>00062 <span class="preprocessor">#include &lt;netinet\/ip.h&gt;<\/span>$/;"	a
l00063	doc/html/firewall_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="preprocessor">#include &lt;netinet\/ip_icmp.h&gt;<\/span>$/;"	a
l00064	doc/html/firewall_8c-source.html	/^<a name="l00064"><\/a>00064 <span class="preprocessor">#endif<\/span>$/;"	a
l00065	doc/html/firewall_8c-source.html	/^<a name="l00065"><\/a>00065 <span class="preprocessor"><\/span>$/;"	a
l00066	doc/html/firewall_8c-source.html	/^<a name="l00066"><\/a>00066 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00067	doc/html/firewall_8c-source.html	/^<a name="l00067"><\/a>00067 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00068	doc/html/firewall_8c-source.html	/^<a name="l00068"><\/a>00068 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00069	doc/html/firewall_8c-source.html	/^<a name="l00069"><\/a>00069 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00070	doc/html/firewall_8c-source.html	/^<a name="l00070"><\/a>00070 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00071	doc/html/firewall_8c-source.html	/^<a name="l00071"><\/a>00071 <span class="preprocessor">#include "<a class="code" href="fw__iptables_8h.html" title="Firewall iptables functions.">fw_iptables.h<\/a>"<\/span>$/;"	a
l00072	doc/html/firewall_8c-source.html	/^<a name="l00072"><\/a>00072 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00073	doc/html/firewall_8c-source.html	/^<a name="l00073"><\/a>00073 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00074	doc/html/firewall_8c-source.html	/^<a name="l00074"><\/a>00074 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00075	doc/html/firewall_8c-source.html	/^<a name="l00075"><\/a>00075 $/;"	a
l00076	doc/html/firewall_8c-source.html	/^<a name="l00076"><\/a>00076 <span class="keyword">extern<\/span> pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00077	doc/html/firewall_8c-source.html	/^<a name="l00077"><\/a>00077 $/;"	a
l00078	doc/html/firewall_8c-source.html	/^<a name="l00078"><\/a>00078 <span class="comment">\/* from commandline.c *\/<\/span>$/;"	a
l00079	doc/html/firewall_8c-source.html	/^<a name="l00079"><\/a>00079 <span class="keyword">extern<\/span> pid_t restart_orig_pid;$/;"	a
l00080	doc/html/firewall_8c-source.html	/^<a name="l00080"><\/a>00080 $/;"	a
l00081	doc/html/firewall_8c-source.html	/^<a name="l00081"><\/a>00081 $/;"	a
l00082	doc/html/firewall_8c-source.html	/^<a name="l00082"><\/a>00082 $/;"	a
l00091	doc/html/firewall_8c-source.html	/^<a name="l00091"><\/a>00091 <span class="keywordtype">int<\/span>$/;"	a
l00092	doc/html/firewall_8c-source.html	/^<a name="l00092"><\/a><a class="code" href="firewall_8h.html#fa99884d38b776bf412e4b5f4cdce1ea">00092<\/a> fw_allow(<span class="keywordtype">char<\/span> *ip, <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> fw_connection_state)$/;"	a
l00093	doc/html/firewall_8c-source.html	/^<a name="l00093"><\/a>00093 {$/;"	a
l00094	doc/html/firewall_8c-source.html	/^<a name="l00094"><\/a>00094     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Allowing %s %s with fw_connection_state %d"<\/span>, ip, mac, fw_connection_state);$/;"	a
l00095	doc/html/firewall_8c-source.html	/^<a name="l00095"><\/a>00095 $/;"	a
l00096	doc/html/firewall_8c-source.html	/^<a name="l00096"><\/a>00096     <span class="keywordflow">return<\/span> iptables_fw_access(FW_ACCESS_ALLOW, ip, mac, fw_connection_state);$/;"	a
l00097	doc/html/firewall_8c-source.html	/^<a name="l00097"><\/a>00097 }$/;"	a
l00098	doc/html/firewall_8c-source.html	/^<a name="l00098"><\/a>00098 $/;"	a
l00106	doc/html/firewall_8c-source.html	/^<a name="l00106"><\/a>00106 <span class="keywordtype">int<\/span>$/;"	a
l00107	doc/html/firewall_8c-source.html	/^<a name="l00107"><\/a><a class="code" href="firewall_8h.html#642fc7cfa3f52cf80d63c704030c2119">00107<\/a> fw_deny(<span class="keywordtype">char<\/span> *ip, <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> fw_connection_state)$/;"	a
l00108	doc/html/firewall_8c-source.html	/^<a name="l00108"><\/a>00108 {$/;"	a
l00109	doc/html/firewall_8c-source.html	/^<a name="l00109"><\/a>00109     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Denying %s %s with fw_connection_state %d"<\/span>, ip, mac, fw_connection_state);$/;"	a
l00110	doc/html/firewall_8c-source.html	/^<a name="l00110"><\/a>00110 $/;"	a
l00111	doc/html/firewall_8c-source.html	/^<a name="l00111"><\/a>00111     <span class="keywordflow">return<\/span> iptables_fw_access(FW_ACCESS_DENY, ip, mac, fw_connection_state);$/;"	a
l00112	doc/html/firewall_8c-source.html	/^<a name="l00112"><\/a>00112 }$/;"	a
l00113	doc/html/firewall_8c-source.html	/^<a name="l00113"><\/a>00113 $/;"	a
l00114	doc/html/firewall_8c-source.html	/^<a name="l00114"><\/a>00114 <span class="comment">\/* XXX DCY *\/<\/span>$/;"	a
l00121	doc/html/firewall_8c-source.html	/^<a name="l00121"><\/a>00121 <span class="keywordtype">char<\/span>           *$/;"	a
l00122	doc/html/firewall_8c-source.html	/^<a name="l00122"><\/a><a class="code" href="firewall_8h.html#9870ce36f7e300bf9930a77a69a9bf1a">00122<\/a> arp_get(<span class="keywordtype">char<\/span> *req_ip)$/;"	a
l00123	doc/html/firewall_8c-source.html	/^<a name="l00123"><\/a>00123 {$/;"	a
l00124	doc/html/firewall_8c-source.html	/^<a name="l00124"><\/a>00124     FILE           *proc;$/;"	a
l00125	doc/html/firewall_8c-source.html	/^<a name="l00125"><\/a>00125          <span class="keywordtype">char<\/span> ip[16];$/;"	a
l00126	doc/html/firewall_8c-source.html	/^<a name="l00126"><\/a>00126          <span class="keywordtype">char<\/span> mac[18];$/;"	a
l00127	doc/html/firewall_8c-source.html	/^<a name="l00127"><\/a>00127          <span class="keywordtype">char<\/span> * reply = NULL;$/;"	a
l00128	doc/html/firewall_8c-source.html	/^<a name="l00128"><\/a>00128 $/;"	a
l00129	doc/html/firewall_8c-source.html	/^<a name="l00129"><\/a>00129     <span class="keywordflow">if<\/span> (!(proc = fopen(<span class="stringliteral">"\/proc\/net\/arp"<\/span>, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00130	doc/html/firewall_8c-source.html	/^<a name="l00130"><\/a>00130         <span class="keywordflow">return<\/span> NULL;$/;"	a
l00131	doc/html/firewall_8c-source.html	/^<a name="l00131"><\/a>00131     }$/;"	a
l00132	doc/html/firewall_8c-source.html	/^<a name="l00132"><\/a>00132 $/;"	a
l00133	doc/html/firewall_8c-source.html	/^<a name="l00133"><\/a>00133     <span class="comment">\/* Skip first line *\/<\/span>$/;"	a
l00134	doc/html/firewall_8c-source.html	/^<a name="l00134"><\/a>00134          <span class="keywordflow">while<\/span> (!feof(proc) &amp;&amp; fgetc(proc) != <span class="charliteral">'\\n'<\/span>);$/;"	a
l00135	doc/html/firewall_8c-source.html	/^<a name="l00135"><\/a>00135 $/;"	a
l00136	doc/html/firewall_8c-source.html	/^<a name="l00136"><\/a>00136          <span class="comment">\/* Find ip, copy mac in reply *\/<\/span>$/;"	a
l00137	doc/html/firewall_8c-source.html	/^<a name="l00137"><\/a>00137          reply = NULL;$/;"	a
l00138	doc/html/firewall_8c-source.html	/^<a name="l00138"><\/a>00138     <span class="keywordflow">while<\/span> (!feof(proc) &amp;&amp; (fscanf(proc, <span class="stringliteral">" %15[0-9.] %*s %*s %17[A-Fa-f0-9:] %*s %*s"<\/span>, ip, mac) == 2)) {$/;"	a
l00139	doc/html/firewall_8c-source.html	/^<a name="l00139"><\/a>00139                   <span class="keywordflow">if<\/span> (strcmp(ip, req_ip) == 0) {$/;"	a
l00140	doc/html/firewall_8c-source.html	/^<a name="l00140"><\/a>00140                                 reply = safe_strdup(mac);$/;"	a
l00141	doc/html/firewall_8c-source.html	/^<a name="l00141"><\/a>00141                                 <span class="keywordflow">break<\/span>;$/;"	a
l00142	doc/html/firewall_8c-source.html	/^<a name="l00142"><\/a>00142                   }$/;"	a
l00143	doc/html/firewall_8c-source.html	/^<a name="l00143"><\/a>00143     }$/;"	a
l00144	doc/html/firewall_8c-source.html	/^<a name="l00144"><\/a>00144 $/;"	a
l00145	doc/html/firewall_8c-source.html	/^<a name="l00145"><\/a>00145     fclose(proc);$/;"	a
l00146	doc/html/firewall_8c-source.html	/^<a name="l00146"><\/a>00146 $/;"	a
l00147	doc/html/firewall_8c-source.html	/^<a name="l00147"><\/a>00147     <span class="keywordflow">return<\/span> reply;$/;"	a
l00148	doc/html/firewall_8c-source.html	/^<a name="l00148"><\/a>00148 }$/;"	a
l00149	doc/html/firewall_8c-source.html	/^<a name="l00149"><\/a>00149 $/;"	a
l00152	doc/html/firewall_8c-source.html	/^<a name="l00152"><\/a>00152 <span class="keywordtype">int<\/span>$/;"	a
l00153	doc/html/firewall_8c-source.html	/^<a name="l00153"><\/a><a class="code" href="firewall_8h.html#e30eaa22b5a8ae0e8915d398743db211">00153<\/a> fw_init(<span class="keywordtype">void<\/span>)$/;"	a
l00154	doc/html/firewall_8c-source.html	/^<a name="l00154"><\/a>00154 {$/;"	a
l00155	doc/html/firewall_8c-source.html	/^<a name="l00155"><\/a>00155     <span class="keywordtype">int<\/span> flags, oneopt = 1, zeroopt = 0;$/;"	a
l00156	doc/html/firewall_8c-source.html	/^<a name="l00156"><\/a>00156          <span class="keywordtype">int<\/span> result = 0;$/;"	a
l00157	doc/html/firewall_8c-source.html	/^<a name="l00157"><\/a>00157          <a class="code" href="struct__t__client.html">t_client<\/a> * client = NULL;$/;"	a
l00158	doc/html/firewall_8c-source.html	/^<a name="l00158"><\/a>00158 $/;"	a
l00159	doc/html/firewall_8c-source.html	/^<a name="l00159"><\/a>00159     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Creating ICMP socket"<\/span>);$/;"	a
l00160	doc/html/firewall_8c-source.html	/^<a name="l00160"><\/a>00160     <span class="keywordflow">if<\/span> ((icmp_fd = socket (AF_INET, SOCK_RAW, IPPROTO_ICMP)) == -1 ||$/;"	a
l00161	doc/html/firewall_8c-source.html	/^<a name="l00161"><\/a>00161             (flags = fcntl(icmp_fd, F_GETFL, 0)) == -1 ||$/;"	a
l00162	doc/html/firewall_8c-source.html	/^<a name="l00162"><\/a>00162              fcntl(icmp_fd, F_SETFL, flags | O_NONBLOCK) == -1 ||$/;"	a
l00163	doc/html/firewall_8c-source.html	/^<a name="l00163"><\/a>00163              setsockopt(icmp_fd, SOL_SOCKET, SO_RCVBUF, &amp;oneopt, <span class="keyword">sizeof<\/span>(oneopt)) ||$/;"	a
l00164	doc/html/firewall_8c-source.html	/^<a name="l00164"><\/a>00164              setsockopt(icmp_fd, SOL_SOCKET, SO_DONTROUTE, &amp;zeroopt, <span class="keyword">sizeof<\/span>(zeroopt)) == -1) {$/;"	a
l00165	doc/html/firewall_8c-source.html	/^<a name="l00165"><\/a>00165         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Cannot create ICMP raw socket."<\/span>);$/;"	a
l00166	doc/html/firewall_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordflow">return<\/span> 0;$/;"	a
l00167	doc/html/firewall_8c-source.html	/^<a name="l00167"><\/a>00167     }$/;"	a
l00168	doc/html/firewall_8c-source.html	/^<a name="l00168"><\/a>00168 $/;"	a
l00169	doc/html/firewall_8c-source.html	/^<a name="l00169"><\/a>00169     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Initializing Firewall"<\/span>);$/;"	a
l00170	doc/html/firewall_8c-source.html	/^<a name="l00170"><\/a>00170     result = iptables_fw_init();$/;"	a
l00171	doc/html/firewall_8c-source.html	/^<a name="l00171"><\/a>00171 $/;"	a
l00172	doc/html/firewall_8c-source.html	/^<a name="l00172"><\/a>00172          <span class="keywordflow">if<\/span> (restart_orig_pid) {$/;"	a
l00173	doc/html/firewall_8c-source.html	/^<a name="l00173"><\/a>00173                  <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Restoring firewall rules for clients inherited from parent"<\/span>);$/;"	a
l00174	doc/html/firewall_8c-source.html	/^<a name="l00174"><\/a>00174                  LOCK_CLIENT_LIST();$/;"	a
l00175	doc/html/firewall_8c-source.html	/^<a name="l00175"><\/a>00175                  client = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>();$/;"	a
l00176	doc/html/firewall_8c-source.html	/^<a name="l00176"><\/a>00176                  <span class="keywordflow">while<\/span> (client) {$/;"	a
l00177	doc/html/firewall_8c-source.html	/^<a name="l00177"><\/a>00177                          fw_allow(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00178	doc/html/firewall_8c-source.html	/^<a name="l00178"><\/a>00178                          client = client-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00179	doc/html/firewall_8c-source.html	/^<a name="l00179"><\/a>00179                  }$/;"	a
l00180	doc/html/firewall_8c-source.html	/^<a name="l00180"><\/a>00180                  UNLOCK_CLIENT_LIST();$/;"	a
l00181	doc/html/firewall_8c-source.html	/^<a name="l00181"><\/a>00181          }$/;"	a
l00182	doc/html/firewall_8c-source.html	/^<a name="l00182"><\/a>00182 $/;"	a
l00183	doc/html/firewall_8c-source.html	/^<a name="l00183"><\/a>00183          <span class="keywordflow">return<\/span> result;$/;"	a
l00184	doc/html/firewall_8c-source.html	/^<a name="l00184"><\/a>00184 }$/;"	a
l00185	doc/html/firewall_8c-source.html	/^<a name="l00185"><\/a>00185 $/;"	a
l00188	doc/html/firewall_8c-source.html	/^<a name="l00188"><\/a>00188 <span class="keywordtype">void<\/span>$/;"	a
l00189	doc/html/firewall_8c-source.html	/^<a name="l00189"><\/a><a class="code" href="firewall_8h.html#a8905d925b83283cdbf028243c6ed026">00189<\/a> fw_clear_authservers(<span class="keywordtype">void<\/span>)$/;"	a
l00190	doc/html/firewall_8c-source.html	/^<a name="l00190"><\/a>00190 {$/;"	a
l00191	doc/html/firewall_8c-source.html	/^<a name="l00191"><\/a>00191         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Clearing the authservers list"<\/span>);$/;"	a
l00192	doc/html/firewall_8c-source.html	/^<a name="l00192"><\/a>00192         iptables_fw_clear_authservers();$/;"	a
l00193	doc/html/firewall_8c-source.html	/^<a name="l00193"><\/a>00193 }$/;"	a
l00194	doc/html/firewall_8c-source.html	/^<a name="l00194"><\/a>00194 $/;"	a
l00197	doc/html/firewall_8c-source.html	/^<a name="l00197"><\/a>00197 <span class="keywordtype">void<\/span>$/;"	a
l00198	doc/html/firewall_8c-source.html	/^<a name="l00198"><\/a><a class="code" href="firewall_8h.html#b1fc844e7144f2bc3d6672db0964a31c">00198<\/a> fw_set_authservers(<span class="keywordtype">void<\/span>)$/;"	a
l00199	doc/html/firewall_8c-source.html	/^<a name="l00199"><\/a>00199 {$/;"	a
l00200	doc/html/firewall_8c-source.html	/^<a name="l00200"><\/a>00200         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Setting the authservers list"<\/span>);$/;"	a
l00201	doc/html/firewall_8c-source.html	/^<a name="l00201"><\/a>00201         iptables_fw_set_authservers();$/;"	a
l00202	doc/html/firewall_8c-source.html	/^<a name="l00202"><\/a>00202 }$/;"	a
l00203	doc/html/firewall_8c-source.html	/^<a name="l00203"><\/a>00203 $/;"	a
l00208	doc/html/firewall_8c-source.html	/^<a name="l00208"><\/a>00208 <span class="keywordtype">int<\/span>$/;"	a
l00209	doc/html/firewall_8c-source.html	/^<a name="l00209"><\/a><a class="code" href="firewall_8h.html#7202b7d511de9238c91d8d68ef78815f">00209<\/a> fw_destroy(<span class="keywordtype">void<\/span>)$/;"	a
l00210	doc/html/firewall_8c-source.html	/^<a name="l00210"><\/a>00210 {$/;"	a
l00211	doc/html/firewall_8c-source.html	/^<a name="l00211"><\/a>00211     <span class="keywordflow">if<\/span> (icmp_fd != 0) {$/;"	a
l00212	doc/html/firewall_8c-source.html	/^<a name="l00212"><\/a>00212         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Closing ICMP socket"<\/span>);$/;"	a
l00213	doc/html/firewall_8c-source.html	/^<a name="l00213"><\/a>00213         close(icmp_fd);$/;"	a
l00214	doc/html/firewall_8c-source.html	/^<a name="l00214"><\/a>00214     }$/;"	a
l00215	doc/html/firewall_8c-source.html	/^<a name="l00215"><\/a>00215 $/;"	a
l00216	doc/html/firewall_8c-source.html	/^<a name="l00216"><\/a>00216     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Removing Firewall rules"<\/span>);$/;"	a
l00217	doc/html/firewall_8c-source.html	/^<a name="l00217"><\/a>00217     <span class="keywordflow">return<\/span> iptables_fw_destroy();$/;"	a
l00218	doc/html/firewall_8c-source.html	/^<a name="l00218"><\/a>00218 }$/;"	a
l00219	doc/html/firewall_8c-source.html	/^<a name="l00219"><\/a>00219 $/;"	a
l00223	doc/html/firewall_8c-source.html	/^<a name="l00223"><\/a>00223 <span class="keywordtype">void<\/span>$/;"	a
l00224	doc/html/firewall_8c-source.html	/^<a name="l00224"><\/a><a class="code" href="firewall_8h.html#f9c7aefe796696e20e52955a80fff57f">00224<\/a> fw_sync_with_authserver(<span class="keywordtype">void<\/span>)$/;"	a
l00225	doc/html/firewall_8c-source.html	/^<a name="l00225"><\/a>00225 {$/;"	a
l00226	doc/html/firewall_8c-source.html	/^<a name="l00226"><\/a>00226     <a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a>  authresponse;$/;"	a
l00227	doc/html/firewall_8c-source.html	/^<a name="l00227"><\/a>00227     <span class="keywordtype">char<\/span>            *token, *ip, *mac;$/;"	a
l00228	doc/html/firewall_8c-source.html	/^<a name="l00228"><\/a>00228     <a class="code" href="struct__t__client.html">t_client<\/a>        *p1, *p2;$/;"	a
l00229	doc/html/firewall_8c-source.html	/^<a name="l00229"><\/a>00229     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>      incoming, outgoing;$/;"	a
l00230	doc/html/firewall_8c-source.html	/^<a name="l00230"><\/a>00230     <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00231	doc/html/firewall_8c-source.html	/^<a name="l00231"><\/a>00231 $/;"	a
l00232	doc/html/firewall_8c-source.html	/^<a name="l00232"><\/a>00232     <span class="keywordflow">if<\/span> (-1 == iptables_fw_counters_update()) {$/;"	a
l00233	doc/html/firewall_8c-source.html	/^<a name="l00233"><\/a>00233         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not get counters from firewall!"<\/span>);$/;"	a
l00234	doc/html/firewall_8c-source.html	/^<a name="l00234"><\/a>00234         <span class="keywordflow">return<\/span>;$/;"	a
l00235	doc/html/firewall_8c-source.html	/^<a name="l00235"><\/a>00235     }$/;"	a
l00236	doc/html/firewall_8c-source.html	/^<a name="l00236"><\/a>00236 $/;"	a
l00237	doc/html/firewall_8c-source.html	/^<a name="l00237"><\/a>00237     LOCK_CLIENT_LIST();$/;"	a
l00238	doc/html/firewall_8c-source.html	/^<a name="l00238"><\/a>00238 $/;"	a
l00239	doc/html/firewall_8c-source.html	/^<a name="l00239"><\/a>00239     <span class="keywordflow">for<\/span> (p1 = p2 = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>(); NULL != p1; p1 = p2) {$/;"	a
l00240	doc/html/firewall_8c-source.html	/^<a name="l00240"><\/a>00240         p2 = p1-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00241	doc/html/firewall_8c-source.html	/^<a name="l00241"><\/a>00241 $/;"	a
l00242	doc/html/firewall_8c-source.html	/^<a name="l00242"><\/a>00242         ip = safe_strdup(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00243	doc/html/firewall_8c-source.html	/^<a name="l00243"><\/a>00243         token = safe_strdup(p1-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00244	doc/html/firewall_8c-source.html	/^<a name="l00244"><\/a>00244         mac = safe_strdup(p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00245	doc/html/firewall_8c-source.html	/^<a name="l00245"><\/a>00245             outgoing = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>;$/;"	a
l00246	doc/html/firewall_8c-source.html	/^<a name="l00246"><\/a>00246             incoming = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>;$/;"	a
l00247	doc/html/firewall_8c-source.html	/^<a name="l00247"><\/a>00247 $/;"	a
l00248	doc/html/firewall_8c-source.html	/^<a name="l00248"><\/a>00248             UNLOCK_CLIENT_LIST();$/;"	a
l00249	doc/html/firewall_8c-source.html	/^<a name="l00249"><\/a>00249         <span class="comment">\/* Ping the client, if he responds it'll keep activity on the link.<\/span>$/;"	a
l00250	doc/html/firewall_8c-source.html	/^<a name="l00250"><\/a>00250 <span class="comment">         * However, if the firewall blocks it, it will not help.  The suggested<\/span>$/;"	a
l00251	doc/html/firewall_8c-source.html	/^<a name="l00251"><\/a>00251 <span class="comment">         * way to deal witht his is to keep the DHCP lease time extremely<\/span>$/;"	a
l00252	doc/html/firewall_8c-source.html	/^<a name="l00252"><\/a>00252 <span class="comment">         * short:  Shorter than config-&gt;checkinterval * config-&gt;clienttimeout *\/<\/span>$/;"	a
l00253	doc/html/firewall_8c-source.html	/^<a name="l00253"><\/a>00253         icmp_ping(ip);$/;"	a
l00254	doc/html/firewall_8c-source.html	/^<a name="l00254"><\/a>00254         <span class="comment">\/* Update the counters on the remote server only if we have an auth server *\/<\/span>$/;"	a
l00255	doc/html/firewall_8c-source.html	/^<a name="l00255"><\/a>00255         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> != NULL) {$/;"	a
l00256	doc/html/firewall_8c-source.html	/^<a name="l00256"><\/a>00256             <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(&amp;authresponse, <a class="code" href="centralserver_8h.html#3ebb2c04a3ef087a8956e171068759f7" title="Update the central server&amp;#39;s traffic counters.">REQUEST_TYPE_COUNTERS<\/a>, ip, mac, token, incoming, outgoing);$/;"	a
l00257	doc/html/firewall_8c-source.html	/^<a name="l00257"><\/a>00257         }$/;"	a
l00258	doc/html/firewall_8c-source.html	/^<a name="l00258"><\/a>00258             LOCK_CLIENT_LIST();$/;"	a
l00259	doc/html/firewall_8c-source.html	/^<a name="l00259"><\/a>00259 $/;"	a
l00260	doc/html/firewall_8c-source.html	/^<a name="l00260"><\/a>00260         <span class="keywordflow">if<\/span> (!(p1 = <a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(ip, mac))) {$/;"	a
l00261	doc/html/firewall_8c-source.html	/^<a name="l00261"><\/a>00261             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Node %s was freed while being re-validated!"<\/span>, ip);$/;"	a
l00262	doc/html/firewall_8c-source.html	/^<a name="l00262"><\/a>00262         } <span class="keywordflow">else<\/span> {$/;"	a
l00263	doc/html/firewall_8c-source.html	/^<a name="l00263"><\/a>00263                 time_t  current_time=time(NULL);$/;"	a
l00264	doc/html/firewall_8c-source.html	/^<a name="l00264"><\/a>00264                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Checking client %s for timeout:  Last updated %ld (%ld seconds ago), timeout delay %ld seconds, current time %ld, "<\/span>,$/;"	a
l00265	doc/html/firewall_8c-source.html	/^<a name="l00265"><\/a>00265                         p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>, current_time-p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>, config-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a> * config-&gt;<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a>, current_time);$/;"	a
l00266	doc/html/firewall_8c-source.html	/^<a name="l00266"><\/a>00266             <span class="keywordflow">if<\/span> (p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a> +$/;"	a
l00267	doc/html/firewall_8c-source.html	/^<a name="l00267"><\/a>00267                                 (config-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a> * config-&gt;<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a>)$/;"	a
l00268	doc/html/firewall_8c-source.html	/^<a name="l00268"><\/a>00268                                 &lt;= current_time) {$/;"	a
l00269	doc/html/firewall_8c-source.html	/^<a name="l00269"><\/a>00269                 <span class="comment">\/* Timing out user *\/<\/span>$/;"	a
l00270	doc/html/firewall_8c-source.html	/^<a name="l00270"><\/a>00270                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"%s - Inactive for more than %ld seconds, removing client and denying in firewall"<\/span>,$/;"	a
l00271	doc/html/firewall_8c-source.html	/^<a name="l00271"><\/a>00271                         p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, config-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a> * config-&gt;<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a>);$/;"	a
l00272	doc/html/firewall_8c-source.html	/^<a name="l00272"><\/a>00272                 fw_deny(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00273	doc/html/firewall_8c-source.html	/^<a name="l00273"><\/a>00273                 <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(p1);$/;"	a
l00274	doc/html/firewall_8c-source.html	/^<a name="l00274"><\/a>00274 $/;"	a
l00275	doc/html/firewall_8c-source.html	/^<a name="l00275"><\/a>00275                 <span class="comment">\/* Advertise the logout if we have an auth server *\/<\/span>$/;"	a
l00276	doc/html/firewall_8c-source.html	/^<a name="l00276"><\/a>00276                 <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> != NULL) {$/;"	a
l00277	doc/html/firewall_8c-source.html	/^<a name="l00277"><\/a>00277                                         UNLOCK_CLIENT_LIST();$/;"	a
l00278	doc/html/firewall_8c-source.html	/^<a name="l00278"><\/a>00278                                         <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(&amp;authresponse, <a class="code" href="centralserver_8h.html#b262747ac931a0a8c357448e7a2cf301" title="Notify the the central server of a client logout.">REQUEST_TYPE_LOGOUT<\/a>, ip, mac, token, 0, 0);$/;"	a
l00279	doc/html/firewall_8c-source.html	/^<a name="l00279"><\/a>00279                                         LOCK_CLIENT_LIST();$/;"	a
l00280	doc/html/firewall_8c-source.html	/^<a name="l00280"><\/a>00280                 }$/;"	a
l00281	doc/html/firewall_8c-source.html	/^<a name="l00281"><\/a>00281             } <span class="keywordflow">else<\/span> {$/;"	a
l00282	doc/html/firewall_8c-source.html	/^<a name="l00282"><\/a>00282                 <span class="comment">\/*<\/span>$/;"	a
l00283	doc/html/firewall_8c-source.html	/^<a name="l00283"><\/a>00283 <span class="comment">                 * This handles any change in<\/span>$/;"	a
l00284	doc/html/firewall_8c-source.html	/^<a name="l00284"><\/a>00284 <span class="comment">                 * the status this allows us<\/span>$/;"	a
l00285	doc/html/firewall_8c-source.html	/^<a name="l00285"><\/a>00285 <span class="comment">                 * to change the status of a<\/span>$/;"	a
l00286	doc/html/firewall_8c-source.html	/^<a name="l00286"><\/a>00286 <span class="comment">                 * user while he's connected<\/span>$/;"	a
l00287	doc/html/firewall_8c-source.html	/^<a name="l00287"><\/a>00287 <span class="comment">                 *<\/span>$/;"	a
l00288	doc/html/firewall_8c-source.html	/^<a name="l00288"><\/a>00288 <span class="comment">                 * Only run if we have an auth server<\/span>$/;"	a
l00289	doc/html/firewall_8c-source.html	/^<a name="l00289"><\/a>00289 <span class="comment">                 * configured!<\/span>$/;"	a
l00290	doc/html/firewall_8c-source.html	/^<a name="l00290"><\/a>00290 <span class="comment">                 *\/<\/span>$/;"	a
l00291	doc/html/firewall_8c-source.html	/^<a name="l00291"><\/a>00291                 <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> != NULL) {$/;"	a
l00292	doc/html/firewall_8c-source.html	/^<a name="l00292"><\/a>00292                     <span class="keywordflow">switch<\/span> (authresponse.<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>) {$/;"	a
l00293	doc/html/firewall_8c-source.html	/^<a name="l00293"><\/a>00293                         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75">AUTH_DENIED<\/a>:$/;"	a
l00294	doc/html/firewall_8c-source.html	/^<a name="l00294"><\/a>00294                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"%s - Denied. Removing client and firewall rules"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00295	doc/html/firewall_8c-source.html	/^<a name="l00295"><\/a>00295                             fw_deny(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00296	doc/html/firewall_8c-source.html	/^<a name="l00296"><\/a>00296                             <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(p1);$/;"	a
l00297	doc/html/firewall_8c-source.html	/^<a name="l00297"><\/a>00297                             <span class="keywordflow">break<\/span>;$/;"	a
l00298	doc/html/firewall_8c-source.html	/^<a name="l00298"><\/a>00298 $/;"	a
l00299	doc/html/firewall_8c-source.html	/^<a name="l00299"><\/a>00299                         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb">AUTH_VALIDATION_FAILED<\/a>:$/;"	a
l00300	doc/html/firewall_8c-source.html	/^<a name="l00300"><\/a>00300                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"%s - Validation timeout, now denied. Removing client and firewall rules"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00301	doc/html/firewall_8c-source.html	/^<a name="l00301"><\/a>00301                             fw_deny(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00302	doc/html/firewall_8c-source.html	/^<a name="l00302"><\/a>00302                             <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(p1);$/;"	a
l00303	doc/html/firewall_8c-source.html	/^<a name="l00303"><\/a>00303                             <span class="keywordflow">break<\/span>;$/;"	a
l00304	doc/html/firewall_8c-source.html	/^<a name="l00304"><\/a>00304 $/;"	a
l00305	doc/html/firewall_8c-source.html	/^<a name="l00305"><\/a>00305                         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926">AUTH_ALLOWED<\/a>:$/;"	a
l00306	doc/html/firewall_8c-source.html	/^<a name="l00306"><\/a>00306                             <span class="keywordflow">if<\/span> (p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> != <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>) {$/;"	a
l00307	doc/html/firewall_8c-source.html	/^<a name="l00307"><\/a>00307                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"%s - Access has changed to allowed, refreshing firewall and clearing counters"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00308	doc/html/firewall_8c-source.html	/^<a name="l00308"><\/a>00308                                 <span class="comment">\/\/WHY did we deny, then allow!?!? benoitg 2007-06-21<\/span>$/;"	a
l00309	doc/html/firewall_8c-source.html	/^<a name="l00309"><\/a>00309                                 <span class="comment">\/\/fw_deny(p1-&gt;ip, p1-&gt;mac, p1-&gt;fw_connection_state);<\/span>$/;"	a
l00310	doc/html/firewall_8c-source.html	/^<a name="l00310"><\/a>00310 $/;"	a
l00311	doc/html/firewall_8c-source.html	/^<a name="l00311"><\/a>00311                                 <span class="keywordflow">if<\/span> (p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> != <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>) {$/;"	a
l00312	doc/html/firewall_8c-source.html	/^<a name="l00312"><\/a>00312      p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> = 0;$/;"	a
l00313	doc/html/firewall_8c-source.html	/^<a name="l00313"><\/a>00313                                 }$/;"	a
l00314	doc/html/firewall_8c-source.html	/^<a name="l00314"><\/a>00314                                 <span class="keywordflow">else<\/span> {$/;"	a
l00315	doc/html/firewall_8c-source.html	/^<a name="l00315"><\/a>00315                                         <span class="comment">\/\/We don't want to clear counters if the user was in validation, it probably already transmitted data..<\/span>$/;"	a
l00316	doc/html/firewall_8c-source.html	/^<a name="l00316"><\/a>00316                                     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"%s - Skipped clearing counters after all, the user was previously in validation"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00317	doc/html/firewall_8c-source.html	/^<a name="l00317"><\/a>00317                                 }$/;"	a
l00318	doc/html/firewall_8c-source.html	/^<a name="l00318"><\/a>00318                                 p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> = <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>;$/;"	a
l00319	doc/html/firewall_8c-source.html	/^<a name="l00319"><\/a>00319                                 fw_allow(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00320	doc/html/firewall_8c-source.html	/^<a name="l00320"><\/a>00320                             }$/;"	a
l00321	doc/html/firewall_8c-source.html	/^<a name="l00321"><\/a>00321                             <span class="keywordflow">break<\/span>;$/;"	a
l00322	doc/html/firewall_8c-source.html	/^<a name="l00322"><\/a>00322 $/;"	a
l00323	doc/html/firewall_8c-source.html	/^<a name="l00323"><\/a>00323                         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae">AUTH_VALIDATION<\/a>:$/;"	a
l00324	doc/html/firewall_8c-source.html	/^<a name="l00324"><\/a>00324                             <span class="comment">\/*<\/span>$/;"	a
l00325	doc/html/firewall_8c-source.html	/^<a name="l00325"><\/a>00325 <span class="comment">                             * Do nothing, user<\/span>$/;"	a
l00326	doc/html/firewall_8c-source.html	/^<a name="l00326"><\/a>00326 <span class="comment">                             * is in validation<\/span>$/;"	a
l00327	doc/html/firewall_8c-source.html	/^<a name="l00327"><\/a>00327 <span class="comment">                             * period<\/span>$/;"	a
l00328	doc/html/firewall_8c-source.html	/^<a name="l00328"><\/a>00328 <span class="comment">                             *\/<\/span>$/;"	a
l00329	doc/html/firewall_8c-source.html	/^<a name="l00329"><\/a>00329                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"%s - User in validation period"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00330	doc/html/firewall_8c-source.html	/^<a name="l00330"><\/a>00330                             <span class="keywordflow">break<\/span>;$/;"	a
l00331	doc/html/firewall_8c-source.html	/^<a name="l00331"><\/a>00331 $/;"	a
l00332	doc/html/firewall_8c-source.html	/^<a name="l00332"><\/a>00332                               <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>:$/;"	a
l00333	doc/html/firewall_8c-source.html	/^<a name="l00333"><\/a>00333                                     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"Error communicating with auth server - leaving %s as-is for now"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00334	doc/html/firewall_8c-source.html	/^<a name="l00334"><\/a>00334                                     <span class="keywordflow">break<\/span>;$/;"	a
l00335	doc/html/firewall_8c-source.html	/^<a name="l00335"><\/a>00335 $/;"	a
l00336	doc/html/firewall_8c-source.html	/^<a name="l00336"><\/a>00336                         <span class="keywordflow">default<\/span>:$/;"	a
l00337	doc/html/firewall_8c-source.html	/^<a name="l00337"><\/a>00337                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"I do not know about authentication code %d"<\/span>, authresponse.<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>);$/;"	a
l00338	doc/html/firewall_8c-source.html	/^<a name="l00338"><\/a>00338                             <span class="keywordflow">break<\/span>;$/;"	a
l00339	doc/html/firewall_8c-source.html	/^<a name="l00339"><\/a>00339                     }$/;"	a
l00340	doc/html/firewall_8c-source.html	/^<a name="l00340"><\/a>00340                 }$/;"	a
l00341	doc/html/firewall_8c-source.html	/^<a name="l00341"><\/a>00341             }$/;"	a
l00342	doc/html/firewall_8c-source.html	/^<a name="l00342"><\/a>00342         }$/;"	a
l00343	doc/html/firewall_8c-source.html	/^<a name="l00343"><\/a>00343 $/;"	a
l00344	doc/html/firewall_8c-source.html	/^<a name="l00344"><\/a>00344         free(token);$/;"	a
l00345	doc/html/firewall_8c-source.html	/^<a name="l00345"><\/a>00345         free(ip);$/;"	a
l00346	doc/html/firewall_8c-source.html	/^<a name="l00346"><\/a>00346         free(mac);$/;"	a
l00347	doc/html/firewall_8c-source.html	/^<a name="l00347"><\/a>00347     }$/;"	a
l00348	doc/html/firewall_8c-source.html	/^<a name="l00348"><\/a>00348     UNLOCK_CLIENT_LIST();$/;"	a
l00349	doc/html/firewall_8c-source.html	/^<a name="l00349"><\/a>00349 }$/;"	a
l00350	doc/html/firewall_8c-source.html	/^<a name="l00350"><\/a>00350 $/;"	a
l00351	doc/html/firewall_8c-source.html	/^<a name="l00351"><\/a>00351 <span class="keywordtype">void<\/span>$/;"	a
l00352	doc/html/firewall_8c-source.html	/^<a name="l00352"><\/a><a class="code" href="firewall_8h.html#de29ced5c802fe07c4228d5a0f6c9592">00352<\/a> icmp_ping(<span class="keywordtype">char<\/span> *host)$/;"	a
l00353	doc/html/firewall_8c-source.html	/^<a name="l00353"><\/a>00353 {$/;"	a
l00354	doc/html/firewall_8c-source.html	/^<a name="l00354"><\/a>00354         <span class="keyword">struct <\/span>sockaddr_in saddr;$/;"	a
l00355	doc/html/firewall_8c-source.html	/^<a name="l00355"><\/a>00355 <span class="preprocessor">#if defined(__linux__) || defined(__NetBSD__)<\/span>$/;"	a
l00356	doc/html/firewall_8c-source.html	/^<a name="l00356"><\/a>00356 <span class="preprocessor"><\/span>        <span class="keyword">struct <\/span>{$/;"	a
l00357	doc/html/firewall_8c-source.html	/^<a name="l00357"><\/a>00357                 <span class="keyword">struct <\/span>ip ip;$/;"	a
l00358	doc/html/firewall_8c-source.html	/^<a name="l00358"><\/a>00358                 <span class="keyword">struct <\/span>icmp icmp;$/;"	a
l00359	doc/html/firewall_8c-source.html	/^<a name="l00359"><\/a>00359         } packet;$/;"	a
l00360	doc/html/firewall_8c-source.html	/^<a name="l00360"><\/a>00360 <span class="preprocessor">#endif<\/span>$/;"	a
l00361	doc/html/firewall_8c-source.html	/^<a name="l00361"><\/a>00361 <span class="preprocessor"><\/span>        <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span> i, j;$/;"	a
l00362	doc/html/firewall_8c-source.html	/^<a name="l00362"><\/a>00362         <span class="keywordtype">int<\/span> opt = 2000;$/;"	a
l00363	doc/html/firewall_8c-source.html	/^<a name="l00363"><\/a>00363         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span> <span class="keywordtype">id<\/span> = rand16();$/;"	a
l00364	doc/html/firewall_8c-source.html	/^<a name="l00364"><\/a>00364 $/;"	a
l00365	doc/html/firewall_8c-source.html	/^<a name="l00365"><\/a>00365         memset(&amp;saddr, 0, <span class="keyword">sizeof<\/span>(saddr));$/;"	a
l00366	doc/html/firewall_8c-source.html	/^<a name="l00366"><\/a>00366         saddr.sin_family = AF_INET;$/;"	a
l00367	doc/html/firewall_8c-source.html	/^<a name="l00367"><\/a>00367         inet_aton(host, &amp;saddr.sin_addr);$/;"	a
l00368	doc/html/firewall_8c-source.html	/^<a name="l00368"><\/a>00368 <span class="preprocessor">#if defined(HAVE_SOCKADDR_SA_LEN) || defined(__NetBSD__)<\/span>$/;"	a
l00369	doc/html/firewall_8c-source.html	/^<a name="l00369"><\/a>00369 <span class="preprocessor"><\/span>        saddr.sin_len = <span class="keyword">sizeof<\/span>(<span class="keyword">struct <\/span>sockaddr_in);$/;"	a
l00370	doc/html/firewall_8c-source.html	/^<a name="l00370"><\/a>00370 <span class="preprocessor">#endif<\/span>$/;"	a
l00371	doc/html/firewall_8c-source.html	/^<a name="l00371"><\/a>00371 <span class="preprocessor"><\/span>$/;"	a
l00372	doc/html/firewall_8c-source.html	/^<a name="l00372"><\/a>00372 <span class="preprocessor">#if defined(__linux__) || defined(__NetBSD__)<\/span>$/;"	a
l00373	doc/html/firewall_8c-source.html	/^<a name="l00373"><\/a>00373 <span class="preprocessor"><\/span>        memset(&amp;packet.icmp, 0, <span class="keyword">sizeof<\/span>(packet.icmp));$/;"	a
l00374	doc/html/firewall_8c-source.html	/^<a name="l00374"><\/a>00374         packet.icmp.icmp_type = ICMP_ECHO;$/;"	a
l00375	doc/html/firewall_8c-source.html	/^<a name="l00375"><\/a>00375         packet.icmp.icmp_id = id;$/;"	a
l00376	doc/html/firewall_8c-source.html	/^<a name="l00376"><\/a>00376 $/;"	a
l00377	doc/html/firewall_8c-source.html	/^<a name="l00377"><\/a>00377         <span class="keywordflow">for<\/span> (j = 0, i = 0; i &lt; <span class="keyword">sizeof<\/span>(<span class="keyword">struct <\/span>icmp) \/ 2; i++)$/;"	a
l00378	doc/html/firewall_8c-source.html	/^<a name="l00378"><\/a>00378                 j += ((<span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span> *)&amp;packet.icmp)[i];$/;"	a
l00379	doc/html/firewall_8c-source.html	/^<a name="l00379"><\/a>00379 $/;"	a
l00380	doc/html/firewall_8c-source.html	/^<a name="l00380"><\/a>00380         <span class="keywordflow">while<\/span> (j &gt;&gt; 16)$/;"	a
l00381	doc/html/firewall_8c-source.html	/^<a name="l00381"><\/a>00381                 j = (j &amp; 0xffff) + (j &gt;&gt; 16);$/;"	a
l00382	doc/html/firewall_8c-source.html	/^<a name="l00382"><\/a>00382 $/;"	a
l00383	doc/html/firewall_8c-source.html	/^<a name="l00383"><\/a>00383         packet.icmp.icmp_cksum = (j == 0xffff) ? j : ~j;$/;"	a
l00384	doc/html/firewall_8c-source.html	/^<a name="l00384"><\/a>00384 $/;"	a
l00385	doc/html/firewall_8c-source.html	/^<a name="l00385"><\/a>00385         <span class="keywordflow">if<\/span> (setsockopt(icmp_fd, SOL_SOCKET, SO_RCVBUF, &amp;opt, <span class="keyword">sizeof<\/span>(opt)) == -1)$/;"	a
l00386	doc/html/firewall_8c-source.html	/^<a name="l00386"><\/a>00386                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"setsockopt(): %s"<\/span>, strerror(errno));$/;"	a
l00387	doc/html/firewall_8c-source.html	/^<a name="l00387"><\/a>00387 $/;"	a
l00388	doc/html/firewall_8c-source.html	/^<a name="l00388"><\/a>00388         <span class="keywordflow">if<\/span> (sendto(icmp_fd, (<span class="keywordtype">char<\/span> *)&amp;packet.icmp, <span class="keyword">sizeof<\/span>(<span class="keyword">struct<\/span> icmp), 0,$/;"	a
l00389	doc/html/firewall_8c-source.html	/^<a name="l00389"><\/a>00389                    (<span class="keyword">const<\/span> <span class="keyword">struct<\/span> sockaddr *)&amp;saddr, <span class="keyword">sizeof<\/span>(saddr)) == -1)$/;"	a
l00390	doc/html/firewall_8c-source.html	/^<a name="l00390"><\/a>00390                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sendto(): %s"<\/span>, strerror(errno));$/;"	a
l00391	doc/html/firewall_8c-source.html	/^<a name="l00391"><\/a>00391 $/;"	a
l00392	doc/html/firewall_8c-source.html	/^<a name="l00392"><\/a>00392         opt = 1;$/;"	a
l00393	doc/html/firewall_8c-source.html	/^<a name="l00393"><\/a>00393         <span class="keywordflow">if<\/span> (setsockopt(icmp_fd, SOL_SOCKET, SO_RCVBUF, &amp;opt, <span class="keyword">sizeof<\/span>(opt)) == -1)$/;"	a
l00394	doc/html/firewall_8c-source.html	/^<a name="l00394"><\/a>00394                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"setsockopt(): %s"<\/span>, strerror(errno));$/;"	a
l00395	doc/html/firewall_8c-source.html	/^<a name="l00395"><\/a>00395 <span class="preprocessor">#endif<\/span>$/;"	a
l00396	doc/html/firewall_8c-source.html	/^<a name="l00396"><\/a>00396 <span class="preprocessor"><\/span>$/;"	a
l00397	doc/html/firewall_8c-source.html	/^<a name="l00397"><\/a>00397         <span class="keywordflow">return<\/span>;$/;"	a
l00398	doc/html/firewall_8c-source.html	/^<a name="l00398"><\/a>00398 }$/;"	a
l00399	doc/html/firewall_8c-source.html	/^<a name="l00399"><\/a>00399 $/;"	a
l00400	doc/html/firewall_8c-source.html	/^<a name="l00400"><\/a><a class="code" href="firewall_8h.html#8dc0b2fd2982b6b043d9ba7502736e05">00400<\/a> <span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span> rand16(<span class="keywordtype">void<\/span>) {$/;"	a
l00401	doc/html/firewall_8c-source.html	/^<a name="l00401"><\/a>00401   <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> been_seeded = 0;$/;"	a
l00402	doc/html/firewall_8c-source.html	/^<a name="l00402"><\/a>00402 $/;"	a
l00403	doc/html/firewall_8c-source.html	/^<a name="l00403"><\/a>00403   <span class="keywordflow">if<\/span> (!been_seeded) {$/;"	a
l00404	doc/html/firewall_8c-source.html	/^<a name="l00404"><\/a>00404     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span> seed = 0;$/;"	a
l00405	doc/html/firewall_8c-source.html	/^<a name="l00405"><\/a>00405     <span class="keyword">struct <\/span>timeval now;$/;"	a
l00406	doc/html/firewall_8c-source.html	/^<a name="l00406"><\/a>00406 $/;"	a
l00407	doc/html/firewall_8c-source.html	/^<a name="l00407"><\/a>00407     <span class="comment">\/* not a very good seed but what the heck, it needs to be quickly acquired *\/<\/span>$/;"	a
l00408	doc/html/firewall_8c-source.html	/^<a name="l00408"><\/a>00408     gettimeofday(&amp;now, NULL);$/;"	a
l00409	doc/html/firewall_8c-source.html	/^<a name="l00409"><\/a>00409     seed = now.tv_sec ^ now.tv_usec ^ (getpid() &lt;&lt; 16);$/;"	a
l00410	doc/html/firewall_8c-source.html	/^<a name="l00410"><\/a>00410 $/;"	a
l00411	doc/html/firewall_8c-source.html	/^<a name="l00411"><\/a>00411     srand(seed);$/;"	a
l00412	doc/html/firewall_8c-source.html	/^<a name="l00412"><\/a>00412     been_seeded = 1;$/;"	a
l00413	doc/html/firewall_8c-source.html	/^<a name="l00413"><\/a>00413     }$/;"	a
l00414	doc/html/firewall_8c-source.html	/^<a name="l00414"><\/a>00414 $/;"	a
l00415	doc/html/firewall_8c-source.html	/^<a name="l00415"><\/a>00415     <span class="comment">\/* Some rand() implementations have less randomness in low bits<\/span>$/;"	a
l00416	doc/html/firewall_8c-source.html	/^<a name="l00416"><\/a>00416 <span class="comment">     * than in high bits, so we only pay attention to the high ones.<\/span>$/;"	a
l00417	doc/html/firewall_8c-source.html	/^<a name="l00417"><\/a>00417 <span class="comment">     * But most implementations don't touch the high bit, so we<\/span>$/;"	a
l00418	doc/html/firewall_8c-source.html	/^<a name="l00418"><\/a>00418 <span class="comment">     * ignore that one.<\/span>$/;"	a
l00419	doc/html/firewall_8c-source.html	/^<a name="l00419"><\/a>00419 <span class="comment">     **\/<\/span>$/;"	a
l00420	doc/html/firewall_8c-source.html	/^<a name="l00420"><\/a>00420       <span class="keywordflow">return<\/span>( (<span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span>) (rand() &gt;&gt; 15) );$/;"	a
l00421	doc/html/firewall_8c-source.html	/^<a name="l00421"><\/a>00421 }$/;"	a
l00001	doc/html/firewall_8h-source.html	/^<h1>firewall.h<\/h1><a href="firewall_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/firewall_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/firewall_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/firewall_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/firewall_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/firewall_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/firewall_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/firewall_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/firewall_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/firewall_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/firewall_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/firewall_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/firewall_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/firewall_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/firewall_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/firewall_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/firewall_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/firewall_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/firewall_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/firewall_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/firewall_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: firewall.h 1241 2007-06-24 04:13:13Z benoitg $ *\/<\/span>$/;"	a
l00027	doc/html/firewall_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _FIREWALL_H_<\/span>$/;"	a
l00028	doc/html/firewall_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _FIREWALL_H_<\/span>$/;"	a
l00029	doc/html/firewall_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/firewall_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="keywordtype">int<\/span> icmp_fd;$/;"	a
l00031	doc/html/firewall_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00033	doc/html/firewall_8h-source.html	/^<a name="l00033"><\/a><a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a">00033<\/a> <span class="keyword">typedef<\/span> <span class="keyword">enum<\/span> <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a">_t_fw_marks<\/a> {$/;"	a
l00034	doc/html/firewall_8h-source.html	/^<a name="l00034"><\/a><a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b">00034<\/a>     <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a> = 1, $/;"	a
l00036	doc/html/firewall_8h-source.html	/^<a name="l00036"><\/a><a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75">00036<\/a>     <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a> = 2,  $/;"	a
l00037	doc/html/firewall_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc">00037<\/a>     <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc" title="The client has been locked out.">FW_MARK_LOCKED<\/a> = 254 $/;"	a
l00038	doc/html/firewall_8h-source.html	/^<a name="l00038"><\/a>00038 } t_fw_marks;$/;"	a
l00039	doc/html/firewall_8h-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00041	doc/html/firewall_8h-source.html	/^<a name="l00041"><\/a>00041 <span class="keywordtype">int<\/span> fw_init(<span class="keywordtype">void<\/span>);$/;"	a
l00042	doc/html/firewall_8h-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00044	doc/html/firewall_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="keywordtype">void<\/span> fw_clear_authservers(<span class="keywordtype">void<\/span>);$/;"	a
l00045	doc/html/firewall_8h-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00047	doc/html/firewall_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="keywordtype">void<\/span> fw_set_authservers(<span class="keywordtype">void<\/span>);$/;"	a
l00048	doc/html/firewall_8h-source.html	/^<a name="l00048"><\/a>00048 $/;"	a
l00050	doc/html/firewall_8h-source.html	/^<a name="l00050"><\/a>00050 <span class="keywordtype">int<\/span> fw_destroy(<span class="keywordtype">void<\/span>);$/;"	a
l00051	doc/html/firewall_8h-source.html	/^<a name="l00051"><\/a>00051 $/;"	a
l00053	doc/html/firewall_8h-source.html	/^<a name="l00053"><\/a>00053 <span class="keywordtype">int<\/span> fw_allow(<span class="keywordtype">char<\/span> *ip, <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> profile);$/;"	a
l00054	doc/html/firewall_8h-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00056	doc/html/firewall_8h-source.html	/^<a name="l00056"><\/a>00056 <span class="keywordtype">int<\/span> fw_deny(<span class="keywordtype">char<\/span> *ip, <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> profile);$/;"	a
l00057	doc/html/firewall_8h-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00059	doc/html/firewall_8h-source.html	/^<a name="l00059"><\/a>00059 <span class="keywordtype">void<\/span> fw_sync_with_authserver(<span class="keywordtype">void<\/span>);$/;"	a
l00060	doc/html/firewall_8h-source.html	/^<a name="l00060"><\/a>00060 $/;"	a
l00062	doc/html/firewall_8h-source.html	/^<a name="l00062"><\/a>00062 <span class="keywordtype">char<\/span> *arp_get(<span class="keywordtype">char<\/span> *req_ip);$/;"	a
l00063	doc/html/firewall_8h-source.html	/^<a name="l00063"><\/a>00063 $/;"	a
l00065	doc/html/firewall_8h-source.html	/^<a name="l00065"><\/a>00065 <span class="keywordtype">void<\/span> icmp_ping(<span class="keywordtype">char<\/span> *host);$/;"	a
l00066	doc/html/firewall_8h-source.html	/^<a name="l00066"><\/a>00066 $/;"	a
l00068	doc/html/firewall_8h-source.html	/^<a name="l00068"><\/a>00068 <span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span> rand16(<span class="keywordtype">void<\/span>);$/;"	a
l00069	doc/html/firewall_8h-source.html	/^<a name="l00069"><\/a>00069 $/;"	a
l00070	doc/html/firewall_8h-source.html	/^<a name="l00070"><\/a>00070 <span class="preprocessor">#endif <\/span><span class="comment">\/* _FIREWALL_H_ *\/<\/span>$/;"	a
1c9252d557956b2e501ee6e55a0cb4be	doc/html/firewall_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1c9252d557956b2e501ee6e55a0cb4be"><\/a><!-- doxytag: member="firewall.h::t_fw_marks" ref="1c9252d557956b2e501ee6e55a0cb4be" args="" -->$/;"	a
642fc7cfa3f52cf80d63c704030c2119	doc/html/firewall_8h.html	/^<a class="anchor" name="642fc7cfa3f52cf80d63c704030c2119"><\/a><!-- doxytag: member="firewall.h::fw_deny" ref="642fc7cfa3f52cf80d63c704030c2119" args="(char *ip, char *mac, int profile)" -->$/;"	a
7202b7d511de9238c91d8d68ef78815f	doc/html/firewall_8h.html	/^<a class="anchor" name="7202b7d511de9238c91d8d68ef78815f"><\/a><!-- doxytag: member="firewall.h::fw_destroy" ref="7202b7d511de9238c91d8d68ef78815f" args="(void)" -->$/;"	a
8dc0b2fd2982b6b043d9ba7502736e05	doc/html/firewall_8h.html	/^<a class="anchor" name="8dc0b2fd2982b6b043d9ba7502736e05"><\/a><!-- doxytag: member="firewall.h::rand16" ref="8dc0b2fd2982b6b043d9ba7502736e05" args="(void)" -->$/;"	a
9870ce36f7e300bf9930a77a69a9bf1a	doc/html/firewall_8h.html	/^<a class="anchor" name="9870ce36f7e300bf9930a77a69a9bf1a"><\/a><!-- doxytag: member="firewall.h::arp_get" ref="9870ce36f7e300bf9930a77a69a9bf1a" args="(char *req_ip)" -->$/;"	a
_details	doc/html/firewall_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a8905d925b83283cdbf028243c6ed026	doc/html/firewall_8h.html	/^<a class="anchor" name="a8905d925b83283cdbf028243c6ed026"><\/a><!-- doxytag: member="firewall.h::fw_clear_authservers" ref="a8905d925b83283cdbf028243c6ed026" args="(void)" -->$/;"	a
ab3ed3199bc18936386acca307bf5d5c	doc/html/firewall_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ab3ed3199bc18936386acca307bf5d5c"><\/a><!-- doxytag: member="firewall.h::icmp_fd" ref="ab3ed3199bc18936386acca307bf5d5c" args="" -->$/;"	a
b1fc844e7144f2bc3d6672db0964a31c	doc/html/firewall_8h.html	/^<a class="anchor" name="b1fc844e7144f2bc3d6672db0964a31c"><\/a><!-- doxytag: member="firewall.h::fw_set_authservers" ref="b1fc844e7144f2bc3d6672db0964a31c" args="(void)" -->$/;"	a
de29ced5c802fe07c4228d5a0f6c9592	doc/html/firewall_8h.html	/^<a class="anchor" name="de29ced5c802fe07c4228d5a0f6c9592"><\/a><!-- doxytag: member="firewall.h::icmp_ping" ref="de29ced5c802fe07c4228d5a0f6c9592" args="(char *host)" -->$/;"	a
e2749226d9b01da3a682ae1803e2530a	doc/html/firewall_8h.html	/^<a class="anchor" name="e2749226d9b01da3a682ae1803e2530a"><\/a><!-- doxytag: member="firewall.h::_t_fw_marks" ref="e2749226d9b01da3a682ae1803e2530a" args="" -->$/;"	a
e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc	doc/html/firewall_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc"><\/a><!-- doxytag: member="FW_MARK_LOCKED" ref="e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc" args="" -->FW_MARK_LOCKED<\/em>&nbsp;<\/td><td>$/;"	a
e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75	doc/html/firewall_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75"><\/a><!-- doxytag: member="FW_MARK_KNOWN" ref="e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" args="" -->FW_MARK_KNOWN<\/em>&nbsp;<\/td><td>$/;"	a
e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b	doc/html/firewall_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b"><\/a><!-- doxytag: member="FW_MARK_PROBATION" ref="e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" args="" -->FW_MARK_PROBATION<\/em>&nbsp;<\/td><td>$/;"	a
e30eaa22b5a8ae0e8915d398743db211	doc/html/firewall_8h.html	/^<a class="anchor" name="e30eaa22b5a8ae0e8915d398743db211"><\/a><!-- doxytag: member="firewall.h::fw_init" ref="e30eaa22b5a8ae0e8915d398743db211" args="(void)" -->$/;"	a
f9c7aefe796696e20e52955a80fff57f	doc/html/firewall_8h.html	/^<a class="anchor" name="f9c7aefe796696e20e52955a80fff57f"><\/a><!-- doxytag: member="firewall.h::fw_sync_with_authserver" ref="f9c7aefe796696e20e52955a80fff57f" args="(void)" -->$/;"	a
fa99884d38b776bf412e4b5f4cdce1ea	doc/html/firewall_8h.html	/^<a class="anchor" name="fa99884d38b776bf412e4b5f4cdce1ea"><\/a><!-- doxytag: member="firewall.h::fw_allow" ref="fa99884d38b776bf412e4b5f4cdce1ea" args="(char *ip, char *mac, int profile)" -->$/;"	a
index_a	doc/html/functions.html	/^<h3><a class="anchor" name="index_a">- a -<\/a><\/h3><ul>$/;"	a
index_b	doc/html/functions.html	/^<h3><a class="anchor" name="index_b">- b -<\/a><\/h3><ul>$/;"	a
index_c	doc/html/functions.html	/^<h3><a class="anchor" name="index_c">- c -<\/a><\/h3><ul>$/;"	a
index_d	doc/html/functions.html	/^<h3><a class="anchor" name="index_d">- d -<\/a><\/h3><ul>$/;"	a
index_e	doc/html/functions.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_f	doc/html/functions.html	/^<h3><a class="anchor" name="index_f">- f -<\/a><\/h3><ul>$/;"	a
index_g	doc/html/functions.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_h	doc/html/functions.html	/^<h3><a class="anchor" name="index_h">- h -<\/a><\/h3><ul>$/;"	a
index_i	doc/html/functions.html	/^<h3><a class="anchor" name="index_i">- i -<\/a><\/h3><ul>$/;"	a
index_l	doc/html/functions.html	/^<h3><a class="anchor" name="index_l">- l -<\/a><\/h3><ul>$/;"	a
index_m	doc/html/functions.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_n	doc/html/functions.html	/^<h3><a class="anchor" name="index_n">- n -<\/a><\/h3><ul>$/;"	a
index_o	doc/html/functions.html	/^<h3><a class="anchor" name="index_o">- o -<\/a><\/h3><ul>$/;"	a
index_p	doc/html/functions.html	/^<h3><a class="anchor" name="index_p">- p -<\/a><\/h3><ul>$/;"	a
index_r	doc/html/functions.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_s	doc/html/functions.html	/^<h3><a class="anchor" name="index_s">- s -<\/a><\/h3><ul>$/;"	a
index_t	doc/html/functions.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index_w	doc/html/functions.html	/^<h3><a class="anchor" name="index_w">- w -<\/a><\/h3><ul>$/;"	a
index_a	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_a">- a -<\/a><\/h3><ul>$/;"	a
index_b	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_b">- b -<\/a><\/h3><ul>$/;"	a
index_c	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_c">- c -<\/a><\/h3><ul>$/;"	a
index_d	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_d">- d -<\/a><\/h3><ul>$/;"	a
index_e	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_f	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_f">- f -<\/a><\/h3><ul>$/;"	a
index_g	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_h	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_h">- h -<\/a><\/h3><ul>$/;"	a
index_i	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_i">- i -<\/a><\/h3><ul>$/;"	a
index_l	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_l">- l -<\/a><\/h3><ul>$/;"	a
index_m	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_n	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_n">- n -<\/a><\/h3><ul>$/;"	a
index_o	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_o">- o -<\/a><\/h3><ul>$/;"	a
index_p	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_p">- p -<\/a><\/h3><ul>$/;"	a
index_r	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_s	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_s">- s -<\/a><\/h3><ul>$/;"	a
index_t	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index_w	doc/html/functions_vars.html	/^<h3><a class="anchor" name="index_w">- w -<\/a><\/h3><ul>$/;"	a
l00001	doc/html/fw__iptables_8c-source.html	/^<h1>fw_iptables.c<\/h1><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/fw__iptables_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/fw__iptables_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/fw__iptables_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/fw__iptables_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/fw__iptables_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/fw__iptables_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/fw__iptables_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/fw__iptables_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/fw__iptables_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/fw__iptables_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/fw__iptables_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/fw__iptables_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/fw__iptables_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/fw__iptables_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/fw__iptables_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/fw__iptables_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/fw__iptables_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/fw__iptables_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/fw__iptables_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/fw__iptables_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: fw_iptables.c 1420 2009-09-18 23:01:57Z gbastien $ *\/<\/span>$/;"	a
l00028	doc/html/fw__iptables_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00029	doc/html/fw__iptables_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/fw__iptables_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00031	doc/html/fw__iptables_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00032	doc/html/fw__iptables_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00033	doc/html/fw__iptables_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00034	doc/html/fw__iptables_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00035	doc/html/fw__iptables_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00036	doc/html/fw__iptables_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00037	doc/html/fw__iptables_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00038	doc/html/fw__iptables_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00039	doc/html/fw__iptables_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00040	doc/html/fw__iptables_8c-source.html	/^<a name="l00040"><\/a>00040 $/;"	a
l00041	doc/html/fw__iptables_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00042	doc/html/fw__iptables_8c-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	doc/html/fw__iptables_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00044	doc/html/fw__iptables_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00045	doc/html/fw__iptables_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="fw__iptables_8h.html" title="Firewall iptables functions.">fw_iptables.h<\/a>"<\/span>$/;"	a
l00046	doc/html/fw__iptables_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00047	doc/html/fw__iptables_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00048	doc/html/fw__iptables_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00049	doc/html/fw__iptables_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00050	doc/html/fw__iptables_8c-source.html	/^<a name="l00050"><\/a>00050 $/;"	a
l00051	doc/html/fw__iptables_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> iptables_do_command(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *format, ...);$/;"	a
l00052	doc/html/fw__iptables_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="keyword">static<\/span> <span class="keywordtype">char<\/span> *iptables_compile(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keyword">const<\/span> <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *);$/;"	a
l00053	doc/html/fw__iptables_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> iptables_load_ruleset(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *);$/;"	a
l00054	doc/html/fw__iptables_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00055	doc/html/fw__iptables_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="keyword">extern<\/span> pthread_mutex_t  <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00056	doc/html/fw__iptables_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="keyword">extern<\/span> pthread_mutex_t  <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a>;$/;"	a
l00057	doc/html/fw__iptables_8c-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00060	doc/html/fw__iptables_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> fw_quiet = 0;$/;"	a
l00061	doc/html/fw__iptables_8c-source.html	/^<a name="l00061"><\/a>00061 $/;"	a
l00070	doc/html/fw__iptables_8c-source.html	/^<a name="l00070"><\/a>00070 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00071	doc/html/fw__iptables_8c-source.html	/^<a name="l00071"><\/a>00071 iptables_insert_gateway_id(<span class="keywordtype">char<\/span> **input)$/;"	a
l00072	doc/html/fw__iptables_8c-source.html	/^<a name="l00072"><\/a>00072 {$/;"	a
l00073	doc/html/fw__iptables_8c-source.html	/^<a name="l00073"><\/a>00073         <span class="keywordtype">char<\/span> *token;$/;"	a
l00074	doc/html/fw__iptables_8c-source.html	/^<a name="l00074"><\/a>00074         <span class="keyword">const<\/span> <a class="code" href="structs__config.html">s_config<\/a> *config;$/;"	a
l00075	doc/html/fw__iptables_8c-source.html	/^<a name="l00075"><\/a>00075         <span class="keywordtype">char<\/span> *buffer;$/;"	a
l00076	doc/html/fw__iptables_8c-source.html	/^<a name="l00076"><\/a>00076 $/;"	a
l00077	doc/html/fw__iptables_8c-source.html	/^<a name="l00077"><\/a>00077         <span class="keywordflow">if<\/span> (strstr(*input, <span class="stringliteral">"$ID$"<\/span>)==NULL)$/;"	a
l00078	doc/html/fw__iptables_8c-source.html	/^<a name="l00078"><\/a>00078                 <span class="keywordflow">return<\/span>;$/;"	a
l00079	doc/html/fw__iptables_8c-source.html	/^<a name="l00079"><\/a>00079 $/;"	a
l00080	doc/html/fw__iptables_8c-source.html	/^<a name="l00080"><\/a>00080 $/;"	a
l00081	doc/html/fw__iptables_8c-source.html	/^<a name="l00081"><\/a>00081         <span class="keywordflow">while<\/span> ((token=strstr(*input, <span class="stringliteral">"$ID$"<\/span>))!=NULL)$/;"	a
l00082	doc/html/fw__iptables_8c-source.html	/^<a name="l00082"><\/a>00082                 <span class="comment">\/* This string may look odd but it's standard POSIX and ISO C *\/<\/span>$/;"	a
l00083	doc/html/fw__iptables_8c-source.html	/^<a name="l00083"><\/a>00083                 memcpy(token, <span class="stringliteral">"%1$s"<\/span>, 4);$/;"	a
l00084	doc/html/fw__iptables_8c-source.html	/^<a name="l00084"><\/a>00084 $/;"	a
l00085	doc/html/fw__iptables_8c-source.html	/^<a name="l00085"><\/a>00085         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00086	doc/html/fw__iptables_8c-source.html	/^<a name="l00086"><\/a>00086         safe_asprintf(&amp;buffer, *input, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00087	doc/html/fw__iptables_8c-source.html	/^<a name="l00087"><\/a>00087 $/;"	a
l00088	doc/html/fw__iptables_8c-source.html	/^<a name="l00088"><\/a>00088         free(*input);$/;"	a
l00089	doc/html/fw__iptables_8c-source.html	/^<a name="l00089"><\/a>00089         *input=buffer;$/;"	a
l00090	doc/html/fw__iptables_8c-source.html	/^<a name="l00090"><\/a>00090 }$/;"	a
l00091	doc/html/fw__iptables_8c-source.html	/^<a name="l00091"><\/a>00091 $/;"	a
l00094	doc/html/fw__iptables_8c-source.html	/^<a name="l00094"><\/a>00094 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span>$/;"	a
l00095	doc/html/fw__iptables_8c-source.html	/^<a name="l00095"><\/a>00095 iptables_do_command(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *format, ...)$/;"	a
l00096	doc/html/fw__iptables_8c-source.html	/^<a name="l00096"><\/a>00096 {$/;"	a
l00097	doc/html/fw__iptables_8c-source.html	/^<a name="l00097"><\/a>00097         va_list vlist;$/;"	a
l00098	doc/html/fw__iptables_8c-source.html	/^<a name="l00098"><\/a>00098         <span class="keywordtype">char<\/span> *fmt_cmd;$/;"	a
l00099	doc/html/fw__iptables_8c-source.html	/^<a name="l00099"><\/a>00099         <span class="keywordtype">char<\/span> *cmd;$/;"	a
l00100	doc/html/fw__iptables_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="keywordtype">int<\/span> rc;$/;"	a
l00101	doc/html/fw__iptables_8c-source.html	/^<a name="l00101"><\/a>00101 $/;"	a
l00102	doc/html/fw__iptables_8c-source.html	/^<a name="l00102"><\/a>00102         va_start(vlist, format);$/;"	a
l00103	doc/html/fw__iptables_8c-source.html	/^<a name="l00103"><\/a>00103         safe_vasprintf(&amp;fmt_cmd, format, vlist);$/;"	a
l00104	doc/html/fw__iptables_8c-source.html	/^<a name="l00104"><\/a>00104         va_end(vlist);$/;"	a
l00105	doc/html/fw__iptables_8c-source.html	/^<a name="l00105"><\/a>00105 $/;"	a
l00106	doc/html/fw__iptables_8c-source.html	/^<a name="l00106"><\/a>00106         safe_asprintf(&amp;cmd, <span class="stringliteral">"iptables %s"<\/span>, fmt_cmd);$/;"	a
l00107	doc/html/fw__iptables_8c-source.html	/^<a name="l00107"><\/a>00107         free(fmt_cmd);$/;"	a
l00108	doc/html/fw__iptables_8c-source.html	/^<a name="l00108"><\/a>00108 $/;"	a
l00109	doc/html/fw__iptables_8c-source.html	/^<a name="l00109"><\/a>00109         iptables_insert_gateway_id(&amp;cmd);$/;"	a
l00110	doc/html/fw__iptables_8c-source.html	/^<a name="l00110"><\/a>00110 $/;"	a
l00111	doc/html/fw__iptables_8c-source.html	/^<a name="l00111"><\/a>00111         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Executing command: %s"<\/span>, cmd);$/;"	a
l00112	doc/html/fw__iptables_8c-source.html	/^<a name="l00112"><\/a>00112 $/;"	a
l00113	doc/html/fw__iptables_8c-source.html	/^<a name="l00113"><\/a>00113         rc = <a class="code" href="util_8c.html#d3c0ab429f95535fa08bc6a4fb884bab" title="Execute a shell command.">execute<\/a>(cmd, fw_quiet);$/;"	a
l00114	doc/html/fw__iptables_8c-source.html	/^<a name="l00114"><\/a>00114 $/;"	a
l00115	doc/html/fw__iptables_8c-source.html	/^<a name="l00115"><\/a>00115         <span class="keywordflow">if<\/span> (rc!=0)$/;"	a
l00116	doc/html/fw__iptables_8c-source.html	/^<a name="l00116"><\/a>00116                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"iptables command failed(%d): %s"<\/span>, rc, cmd);$/;"	a
l00117	doc/html/fw__iptables_8c-source.html	/^<a name="l00117"><\/a>00117 $/;"	a
l00118	doc/html/fw__iptables_8c-source.html	/^<a name="l00118"><\/a>00118         free(cmd);$/;"	a
l00119	doc/html/fw__iptables_8c-source.html	/^<a name="l00119"><\/a>00119 $/;"	a
l00120	doc/html/fw__iptables_8c-source.html	/^<a name="l00120"><\/a>00120         <span class="keywordflow">return<\/span> rc;$/;"	a
l00121	doc/html/fw__iptables_8c-source.html	/^<a name="l00121"><\/a>00121 }$/;"	a
l00122	doc/html/fw__iptables_8c-source.html	/^<a name="l00122"><\/a>00122 $/;"	a
l00131	doc/html/fw__iptables_8c-source.html	/^<a name="l00131"><\/a>00131         <span class="keyword">static<\/span> <span class="keywordtype">char<\/span> *$/;"	a
l00132	doc/html/fw__iptables_8c-source.html	/^<a name="l00132"><\/a>00132 iptables_compile(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * table, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *chain, <span class="keyword">const<\/span> <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *rule)$/;"	a
l00133	doc/html/fw__iptables_8c-source.html	/^<a name="l00133"><\/a>00133 {$/;"	a
l00134	doc/html/fw__iptables_8c-source.html	/^<a name="l00134"><\/a>00134         <span class="keywordtype">char<\/span>    command[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>],$/;"	a
l00135	doc/html/fw__iptables_8c-source.html	/^<a name="l00135"><\/a>00135                 *mode;$/;"	a
l00136	doc/html/fw__iptables_8c-source.html	/^<a name="l00136"><\/a>00136 $/;"	a
l00137	doc/html/fw__iptables_8c-source.html	/^<a name="l00137"><\/a>00137         memset(command, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00138	doc/html/fw__iptables_8c-source.html	/^<a name="l00138"><\/a>00138 $/;"	a
l00139	doc/html/fw__iptables_8c-source.html	/^<a name="l00139"><\/a>00139         <span class="keywordflow">if<\/span> (rule-&gt;<a class="code" href="struct__firewall__rule__t.html#4319185967c4252ced90b2d440034b47" title="1 = Allow rule, 0 = Block rule">block_allow<\/a> == 1) {$/;"	a
l00140	doc/html/fw__iptables_8c-source.html	/^<a name="l00140"><\/a>00140                 mode = safe_strdup(<span class="stringliteral">"ACCEPT"<\/span>);$/;"	a
l00141	doc/html/fw__iptables_8c-source.html	/^<a name="l00141"><\/a>00141         } <span class="keywordflow">else<\/span> {$/;"	a
l00142	doc/html/fw__iptables_8c-source.html	/^<a name="l00142"><\/a>00142                 mode = safe_strdup(<span class="stringliteral">"REJECT"<\/span>);$/;"	a
l00143	doc/html/fw__iptables_8c-source.html	/^<a name="l00143"><\/a>00143         }$/;"	a
l00144	doc/html/fw__iptables_8c-source.html	/^<a name="l00144"><\/a>00144 $/;"	a
l00145	doc/html/fw__iptables_8c-source.html	/^<a name="l00145"><\/a>00145         snprintf(command, <span class="keyword">sizeof<\/span>(command),  <span class="stringliteral">"-t %s -A %s "<\/span>,table, chain);$/;"	a
l00146	doc/html/fw__iptables_8c-source.html	/^<a name="l00146"><\/a>00146         <span class="keywordflow">if<\/span> (rule-&gt;<a class="code" href="struct__firewall__rule__t.html#71fecaae85673b8c3d00a7c14f528f73" title="Mask for the rule *destination*.">mask<\/a> != NULL) {$/;"	a
l00147	doc/html/fw__iptables_8c-source.html	/^<a name="l00147"><\/a>00147                 snprintf((command + strlen(command)), (<span class="keyword">sizeof<\/span>(command) - $/;"	a
l00148	doc/html/fw__iptables_8c-source.html	/^<a name="l00148"><\/a>00148                                         strlen(command)), <span class="stringliteral">"-d %s "<\/span>, rule-&gt;<a class="code" href="struct__firewall__rule__t.html#71fecaae85673b8c3d00a7c14f528f73" title="Mask for the rule *destination*.">mask<\/a>);$/;"	a
l00149	doc/html/fw__iptables_8c-source.html	/^<a name="l00149"><\/a>00149         }$/;"	a
l00150	doc/html/fw__iptables_8c-source.html	/^<a name="l00150"><\/a>00150         <span class="keywordflow">if<\/span> (rule-&gt;<a class="code" href="struct__firewall__rule__t.html#de917f67daf277f81767a9ca7cb6ac1e" title="tcp, udp, etc ...">protocol<\/a> != NULL) {$/;"	a
l00151	doc/html/fw__iptables_8c-source.html	/^<a name="l00151"><\/a>00151                 snprintf((command + strlen(command)), (<span class="keyword">sizeof<\/span>(command) -$/;"	a
l00152	doc/html/fw__iptables_8c-source.html	/^<a name="l00152"><\/a>00152                                         strlen(command)), <span class="stringliteral">"-p %s "<\/span>, rule-&gt;<a class="code" href="struct__firewall__rule__t.html#de917f67daf277f81767a9ca7cb6ac1e" title="tcp, udp, etc ...">protocol<\/a>);$/;"	a
l00153	doc/html/fw__iptables_8c-source.html	/^<a name="l00153"><\/a>00153         }$/;"	a
l00154	doc/html/fw__iptables_8c-source.html	/^<a name="l00154"><\/a>00154         <span class="keywordflow">if<\/span> (rule-&gt;<a class="code" href="struct__firewall__rule__t.html#172be165ac52a92dfe57e0911678698d" title="Port to block\/allow.">port<\/a> != NULL) {$/;"	a
l00155	doc/html/fw__iptables_8c-source.html	/^<a name="l00155"><\/a>00155                 snprintf((command + strlen(command)), (<span class="keyword">sizeof<\/span>(command) -$/;"	a
l00156	doc/html/fw__iptables_8c-source.html	/^<a name="l00156"><\/a>00156                                         strlen(command)), <span class="stringliteral">"--dport %s "<\/span>, rule-&gt;<a class="code" href="struct__firewall__rule__t.html#172be165ac52a92dfe57e0911678698d" title="Port to block\/allow.">port<\/a>);$/;"	a
l00157	doc/html/fw__iptables_8c-source.html	/^<a name="l00157"><\/a>00157         }$/;"	a
l00158	doc/html/fw__iptables_8c-source.html	/^<a name="l00158"><\/a>00158         snprintf((command + strlen(command)), (<span class="keyword">sizeof<\/span>(command) - $/;"	a
l00159	doc/html/fw__iptables_8c-source.html	/^<a name="l00159"><\/a>00159                                 strlen(command)), <span class="stringliteral">"-j %s"<\/span>, mode);$/;"	a
l00160	doc/html/fw__iptables_8c-source.html	/^<a name="l00160"><\/a>00160 $/;"	a
l00161	doc/html/fw__iptables_8c-source.html	/^<a name="l00161"><\/a>00161         free(mode);$/;"	a
l00162	doc/html/fw__iptables_8c-source.html	/^<a name="l00162"><\/a>00162 $/;"	a
l00163	doc/html/fw__iptables_8c-source.html	/^<a name="l00163"><\/a>00163         <span class="comment">\/* XXX The buffer command, an automatic variable, will get cleaned<\/span>$/;"	a
l00164	doc/html/fw__iptables_8c-source.html	/^<a name="l00164"><\/a>00164 <span class="comment">         * off of the stack when we return, so we strdup() it. *\/<\/span>$/;"	a
l00165	doc/html/fw__iptables_8c-source.html	/^<a name="l00165"><\/a>00165         <span class="keywordflow">return<\/span>(safe_strdup(command));$/;"	a
l00166	doc/html/fw__iptables_8c-source.html	/^<a name="l00166"><\/a>00166 }$/;"	a
l00167	doc/html/fw__iptables_8c-source.html	/^<a name="l00167"><\/a>00167 $/;"	a
l00175	doc/html/fw__iptables_8c-source.html	/^<a name="l00175"><\/a>00175         <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00176	doc/html/fw__iptables_8c-source.html	/^<a name="l00176"><\/a>00176 iptables_load_ruleset(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * table, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *chain)$/;"	a
l00177	doc/html/fw__iptables_8c-source.html	/^<a name="l00177"><\/a>00177 {$/;"	a
l00178	doc/html/fw__iptables_8c-source.html	/^<a name="l00178"><\/a>00178         <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>         *rule;$/;"	a
l00179	doc/html/fw__iptables_8c-source.html	/^<a name="l00179"><\/a>00179         <span class="keywordtype">char<\/span>                    *cmd;$/;"	a
l00180	doc/html/fw__iptables_8c-source.html	/^<a name="l00180"><\/a>00180 $/;"	a
l00181	doc/html/fw__iptables_8c-source.html	/^<a name="l00181"><\/a>00181         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Load ruleset %s into table %s, chain %s"<\/span>, ruleset, table, chain);$/;"	a
l00182	doc/html/fw__iptables_8c-source.html	/^<a name="l00182"><\/a>00182 $/;"	a
l00183	doc/html/fw__iptables_8c-source.html	/^<a name="l00183"><\/a>00183         <span class="keywordflow">for<\/span> (rule = <a class="code" href="conf_8c.html#617ad9199f2b10b95498f4f15c67c66d" title="Fetch a firewall rule set.">get_ruleset<\/a>(ruleset); rule != NULL; rule = rule-&gt;<a class="code" href="struct__firewall__rule__t.html#46cf31ace7a4781cd8f67fbf3c8f75de">next<\/a>) {$/;"	a
l00184	doc/html/fw__iptables_8c-source.html	/^<a name="l00184"><\/a>00184                 cmd = iptables_compile(table, chain, rule);$/;"	a
l00185	doc/html/fw__iptables_8c-source.html	/^<a name="l00185"><\/a>00185                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Loading rule \\"%s\\" into table %s, chain %s"<\/span>, cmd, table, chain);$/;"	a
l00186	doc/html/fw__iptables_8c-source.html	/^<a name="l00186"><\/a>00186                 iptables_do_command(cmd);$/;"	a
l00187	doc/html/fw__iptables_8c-source.html	/^<a name="l00187"><\/a>00187                 free(cmd);$/;"	a
l00188	doc/html/fw__iptables_8c-source.html	/^<a name="l00188"><\/a>00188         }$/;"	a
l00189	doc/html/fw__iptables_8c-source.html	/^<a name="l00189"><\/a>00189 $/;"	a
l00190	doc/html/fw__iptables_8c-source.html	/^<a name="l00190"><\/a>00190         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Ruleset %s loaded into table %s, chain %s"<\/span>, ruleset, table, chain);$/;"	a
l00191	doc/html/fw__iptables_8c-source.html	/^<a name="l00191"><\/a>00191 }$/;"	a
l00192	doc/html/fw__iptables_8c-source.html	/^<a name="l00192"><\/a>00192 $/;"	a
l00193	doc/html/fw__iptables_8c-source.html	/^<a name="l00193"><\/a>00193         <span class="keywordtype">void<\/span>$/;"	a
l00194	doc/html/fw__iptables_8c-source.html	/^<a name="l00194"><\/a><a class="code" href="fw__iptables_8h.html#2946cb91dee0c8a25d0489f4d49946b9">00194<\/a> iptables_fw_clear_authservers(<span class="keywordtype">void<\/span>)$/;"	a
l00195	doc/html/fw__iptables_8c-source.html	/^<a name="l00195"><\/a>00195 {$/;"	a
l00196	doc/html/fw__iptables_8c-source.html	/^<a name="l00196"><\/a>00196         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00197	doc/html/fw__iptables_8c-source.html	/^<a name="l00197"><\/a>00197         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00198	doc/html/fw__iptables_8c-source.html	/^<a name="l00198"><\/a>00198 }$/;"	a
l00199	doc/html/fw__iptables_8c-source.html	/^<a name="l00199"><\/a>00199 $/;"	a
l00200	doc/html/fw__iptables_8c-source.html	/^<a name="l00200"><\/a>00200         <span class="keywordtype">void<\/span>$/;"	a
l00201	doc/html/fw__iptables_8c-source.html	/^<a name="l00201"><\/a><a class="code" href="fw__iptables_8h.html#cd205e30639a80845248822e2e1e7eba">00201<\/a> iptables_fw_set_authservers(<span class="keywordtype">void<\/span>)$/;"	a
l00202	doc/html/fw__iptables_8c-source.html	/^<a name="l00202"><\/a>00202 {$/;"	a
l00203	doc/html/fw__iptables_8c-source.html	/^<a name="l00203"><\/a>00203         <span class="keyword">const<\/span> <a class="code" href="structs__config.html">s_config<\/a> *config;$/;"	a
l00204	doc/html/fw__iptables_8c-source.html	/^<a name="l00204"><\/a>00204         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_server;$/;"	a
l00205	doc/html/fw__iptables_8c-source.html	/^<a name="l00205"><\/a>00205 $/;"	a
l00206	doc/html/fw__iptables_8c-source.html	/^<a name="l00206"><\/a>00206         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00207	doc/html/fw__iptables_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	doc/html/fw__iptables_8c-source.html	/^<a name="l00208"><\/a>00208         <span class="keywordflow">for<\/span> (auth_server = config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; auth_server != NULL; auth_server = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>) {$/;"	a
l00209	doc/html/fw__iptables_8c-source.html	/^<a name="l00209"><\/a>00209                 <span class="keywordflow">if<\/span> (auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a> &amp;&amp; strcmp(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>, <span class="stringliteral">"0.0.0.0"<\/span>) != 0) {$/;"	a
l00210	doc/html/fw__iptables_8c-source.html	/^<a name="l00210"><\/a>00210                         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a> <span class="stringliteral">" -d %s -j ACCEPT"<\/span>, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00211	doc/html/fw__iptables_8c-source.html	/^<a name="l00211"><\/a>00211                         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a> <span class="stringliteral">" -d %s -j ACCEPT"<\/span>, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00212	doc/html/fw__iptables_8c-source.html	/^<a name="l00212"><\/a>00212                 }$/;"	a
l00213	doc/html/fw__iptables_8c-source.html	/^<a name="l00213"><\/a>00213         }$/;"	a
l00214	doc/html/fw__iptables_8c-source.html	/^<a name="l00214"><\/a>00214 $/;"	a
l00215	doc/html/fw__iptables_8c-source.html	/^<a name="l00215"><\/a>00215 }$/;"	a
l00216	doc/html/fw__iptables_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00219	doc/html/fw__iptables_8c-source.html	/^<a name="l00219"><\/a>00219         <span class="keywordtype">int<\/span>$/;"	a
l00220	doc/html/fw__iptables_8c-source.html	/^<a name="l00220"><\/a><a class="code" href="fw__iptables_8h.html#94d41bcb1c985732a51ce171b7e858b1">00220<\/a> iptables_fw_init(<span class="keywordtype">void<\/span>)$/;"	a
l00221	doc/html/fw__iptables_8c-source.html	/^<a name="l00221"><\/a>00221 {$/;"	a
l00222	doc/html/fw__iptables_8c-source.html	/^<a name="l00222"><\/a>00222         <span class="keyword">const<\/span> <a class="code" href="structs__config.html">s_config<\/a> *config;$/;"	a
l00223	doc/html/fw__iptables_8c-source.html	/^<a name="l00223"><\/a>00223         <span class="keywordtype">char<\/span> * ext_interface = NULL;$/;"	a
l00224	doc/html/fw__iptables_8c-source.html	/^<a name="l00224"><\/a>00224         <span class="keywordtype">int<\/span> gw_port = 0;$/;"	a
l00225	doc/html/fw__iptables_8c-source.html	/^<a name="l00225"><\/a>00225         <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a> *p;$/;"	a
l00226	doc/html/fw__iptables_8c-source.html	/^<a name="l00226"><\/a>00226 $/;"	a
l00227	doc/html/fw__iptables_8c-source.html	/^<a name="l00227"><\/a>00227         fw_quiet = 0;$/;"	a
l00228	doc/html/fw__iptables_8c-source.html	/^<a name="l00228"><\/a>00228 $/;"	a
l00229	doc/html/fw__iptables_8c-source.html	/^<a name="l00229"><\/a>00229         LOCK_CONFIG();$/;"	a
l00230	doc/html/fw__iptables_8c-source.html	/^<a name="l00230"><\/a>00230         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00231	doc/html/fw__iptables_8c-source.html	/^<a name="l00231"><\/a>00231         gw_port = config-&gt;<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>;$/;"	a
l00232	doc/html/fw__iptables_8c-source.html	/^<a name="l00232"><\/a>00232         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62" title="External network interface name for firewall rules.">external_interface<\/a>) {$/;"	a
l00233	doc/html/fw__iptables_8c-source.html	/^<a name="l00233"><\/a>00233                 ext_interface = safe_strdup(config-&gt;<a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62" title="External network interface name for firewall rules.">external_interface<\/a>);$/;"	a
l00234	doc/html/fw__iptables_8c-source.html	/^<a name="l00234"><\/a>00234         } <span class="keywordflow">else<\/span> {$/;"	a
l00235	doc/html/fw__iptables_8c-source.html	/^<a name="l00235"><\/a>00235                 ext_interface = get_ext_iface();$/;"	a
l00236	doc/html/fw__iptables_8c-source.html	/^<a name="l00236"><\/a>00236         }$/;"	a
l00237	doc/html/fw__iptables_8c-source.html	/^<a name="l00237"><\/a>00237 $/;"	a
l00238	doc/html/fw__iptables_8c-source.html	/^<a name="l00238"><\/a>00238         <span class="keywordflow">if<\/span> (ext_interface == NULL) {$/;"	a
l00239	doc/html/fw__iptables_8c-source.html	/^<a name="l00239"><\/a>00239                 UNLOCK_CONFIG();$/;"	a
l00240	doc/html/fw__iptables_8c-source.html	/^<a name="l00240"><\/a>00240                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: no external interface"<\/span>);$/;"	a
l00241	doc/html/fw__iptables_8c-source.html	/^<a name="l00241"><\/a>00241                 <span class="keywordflow">return<\/span> 0;$/;"	a
l00242	doc/html/fw__iptables_8c-source.html	/^<a name="l00242"><\/a>00242         }$/;"	a
l00243	doc/html/fw__iptables_8c-source.html	/^<a name="l00243"><\/a>00243         <span class="comment">\/*<\/span>$/;"	a
l00244	doc/html/fw__iptables_8c-source.html	/^<a name="l00244"><\/a>00244 <span class="comment">         *<\/span>$/;"	a
l00245	doc/html/fw__iptables_8c-source.html	/^<a name="l00245"><\/a>00245 <span class="comment">         * Everything in the MANGLE table<\/span>$/;"	a
l00246	doc/html/fw__iptables_8c-source.html	/^<a name="l00246"><\/a>00246 <span class="comment">         *<\/span>$/;"	a
l00247	doc/html/fw__iptables_8c-source.html	/^<a name="l00247"><\/a>00247 <span class="comment">         *\/<\/span>$/;"	a
l00248	doc/html/fw__iptables_8c-source.html	/^<a name="l00248"><\/a>00248 $/;"	a
l00249	doc/html/fw__iptables_8c-source.html	/^<a name="l00249"><\/a>00249         <span class="comment">\/* Create new chains *\/<\/span>$/;"	a
l00250	doc/html/fw__iptables_8c-source.html	/^<a name="l00250"><\/a>00250         iptables_do_command(<span class="stringliteral">"-t mangle -N "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>);$/;"	a
l00251	doc/html/fw__iptables_8c-source.html	/^<a name="l00251"><\/a>00251         iptables_do_command(<span class="stringliteral">"-t mangle -N "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00252	doc/html/fw__iptables_8c-source.html	/^<a name="l00252"><\/a>00252         iptables_do_command(<span class="stringliteral">"-t mangle -N "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00253	doc/html/fw__iptables_8c-source.html	/^<a name="l00253"><\/a>00253 $/;"	a
l00254	doc/html/fw__iptables_8c-source.html	/^<a name="l00254"><\/a>00254         <span class="comment">\/* Assign links and rules to these new chains *\/<\/span>$/;"	a
l00255	doc/html/fw__iptables_8c-source.html	/^<a name="l00255"><\/a>00255         iptables_do_command(<span class="stringliteral">"-t mangle -I PREROUTING 1 -i %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00256	doc/html/fw__iptables_8c-source.html	/^<a name="l00256"><\/a>00256         iptables_do_command(<span class="stringliteral">"-t mangle -I PREROUTING 1 -i %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);<span class="comment">\/\/this rule will be inserted before the prior one<\/span>$/;"	a
l00257	doc/html/fw__iptables_8c-source.html	/^<a name="l00257"><\/a>00257         iptables_do_command(<span class="stringliteral">"-t mangle -I POSTROUTING 1 -o %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00258	doc/html/fw__iptables_8c-source.html	/^<a name="l00258"><\/a>00258 $/;"	a
l00259	doc/html/fw__iptables_8c-source.html	/^<a name="l00259"><\/a>00259         <span class="keywordflow">for<\/span> (p = config-&gt;<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>; p != NULL; p = p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a>)$/;"	a
l00260	doc/html/fw__iptables_8c-source.html	/^<a name="l00260"><\/a>00260                 iptables_do_command(<span class="stringliteral">"-t mangle -A "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a> <span class="stringliteral">" -m mac --mac-source %s -j MARK --set-mark %d"<\/span>, p-&gt;<a class="code" href="struct__trusted__mac__t.html#4e4381cfff2bbfbd9455640102b21f14">mac<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>);$/;"	a
l00261	doc/html/fw__iptables_8c-source.html	/^<a name="l00261"><\/a>00261 $/;"	a
l00262	doc/html/fw__iptables_8c-source.html	/^<a name="l00262"><\/a>00262         <span class="comment">\/*<\/span>$/;"	a
l00263	doc/html/fw__iptables_8c-source.html	/^<a name="l00263"><\/a>00263 <span class="comment">         *<\/span>$/;"	a
l00264	doc/html/fw__iptables_8c-source.html	/^<a name="l00264"><\/a>00264 <span class="comment">         * Everything in the NAT table<\/span>$/;"	a
l00265	doc/html/fw__iptables_8c-source.html	/^<a name="l00265"><\/a>00265 <span class="comment">         *<\/span>$/;"	a
l00266	doc/html/fw__iptables_8c-source.html	/^<a name="l00266"><\/a>00266 <span class="comment">         *\/<\/span>$/;"	a
l00267	doc/html/fw__iptables_8c-source.html	/^<a name="l00267"><\/a>00267 $/;"	a
l00268	doc/html/fw__iptables_8c-source.html	/^<a name="l00268"><\/a>00268         <span class="comment">\/* Create new chains *\/<\/span>$/;"	a
l00269	doc/html/fw__iptables_8c-source.html	/^<a name="l00269"><\/a>00269         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00270	doc/html/fw__iptables_8c-source.html	/^<a name="l00270"><\/a>00270         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">TABLE_WIFIDOG_WIFI_TO_ROUTER<\/a>);$/;"	a
l00271	doc/html/fw__iptables_8c-source.html	/^<a name="l00271"><\/a>00271         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00272	doc/html/fw__iptables_8c-source.html	/^<a name="l00272"><\/a>00272         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00273	doc/html/fw__iptables_8c-source.html	/^<a name="l00273"><\/a>00273         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00274	doc/html/fw__iptables_8c-source.html	/^<a name="l00274"><\/a>00274         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00275	doc/html/fw__iptables_8c-source.html	/^<a name="l00275"><\/a>00275 $/;"	a
l00276	doc/html/fw__iptables_8c-source.html	/^<a name="l00276"><\/a>00276         <span class="comment">\/* Assign links and rules to these new chains *\/<\/span>$/;"	a
l00277	doc/html/fw__iptables_8c-source.html	/^<a name="l00277"><\/a>00277         iptables_do_command(<span class="stringliteral">"-t nat -A PREROUTING -i %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00278	doc/html/fw__iptables_8c-source.html	/^<a name="l00278"><\/a>00278 $/;"	a
l00279	doc/html/fw__iptables_8c-source.html	/^<a name="l00279"><\/a>00279         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a> <span class="stringliteral">" -d %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">TABLE_WIFIDOG_WIFI_TO_ROUTER<\/a>, config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>);$/;"	a
l00280	doc/html/fw__iptables_8c-source.html	/^<a name="l00280"><\/a>00280         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_WIFI_TO_ROUTER <span class="stringliteral">" -j ACCEPT"<\/span>);$/;"	a
l00281	doc/html/fw__iptables_8c-source.html	/^<a name="l00281"><\/a>00281 $/;"	a
l00282	doc/html/fw__iptables_8c-source.html	/^<a name="l00282"><\/a>00282         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a> <span class="stringliteral">" -j "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00283	doc/html/fw__iptables_8c-source.html	/^<a name="l00283"><\/a>00283         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j ACCEPT"<\/span>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>);$/;"	a
l00284	doc/html/fw__iptables_8c-source.html	/^<a name="l00284"><\/a>00284         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j ACCEPT"<\/span>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>);$/;"	a
l00285	doc/html/fw__iptables_8c-source.html	/^<a name="l00285"><\/a>00285         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -j "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00286	doc/html/fw__iptables_8c-source.html	/^<a name="l00286"><\/a>00286 $/;"	a
l00287	doc/html/fw__iptables_8c-source.html	/^<a name="l00287"><\/a>00287         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_UNKNOWN <span class="stringliteral">" -j "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00288	doc/html/fw__iptables_8c-source.html	/^<a name="l00288"><\/a>00288         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_UNKNOWN <span class="stringliteral">" -j "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00289	doc/html/fw__iptables_8c-source.html	/^<a name="l00289"><\/a>00289         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_UNKNOWN <span class="stringliteral">" -p tcp --dport 80 -j REDIRECT --to-ports %d"<\/span>, gw_port);$/;"	a
l00290	doc/html/fw__iptables_8c-source.html	/^<a name="l00290"><\/a>00290 $/;"	a
l00291	doc/html/fw__iptables_8c-source.html	/^<a name="l00291"><\/a>00291 $/;"	a
l00292	doc/html/fw__iptables_8c-source.html	/^<a name="l00292"><\/a>00292         <span class="comment">\/*<\/span>$/;"	a
l00293	doc/html/fw__iptables_8c-source.html	/^<a name="l00293"><\/a>00293 <span class="comment">         *<\/span>$/;"	a
l00294	doc/html/fw__iptables_8c-source.html	/^<a name="l00294"><\/a>00294 <span class="comment">         * Everything in the FILTER table<\/span>$/;"	a
l00295	doc/html/fw__iptables_8c-source.html	/^<a name="l00295"><\/a>00295 <span class="comment">         *<\/span>$/;"	a
l00296	doc/html/fw__iptables_8c-source.html	/^<a name="l00296"><\/a>00296 <span class="comment">         *\/<\/span>$/;"	a
l00297	doc/html/fw__iptables_8c-source.html	/^<a name="l00297"><\/a>00297 $/;"	a
l00298	doc/html/fw__iptables_8c-source.html	/^<a name="l00298"><\/a>00298         <span class="comment">\/* Create new chains *\/<\/span>$/;"	a
l00299	doc/html/fw__iptables_8c-source.html	/^<a name="l00299"><\/a>00299         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET);$/;"	a
l00300	doc/html/fw__iptables_8c-source.html	/^<a name="l00300"><\/a>00300         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> TABLE_WIFIDOG_AUTHSERVERS);$/;"	a
l00301	doc/html/fw__iptables_8c-source.html	/^<a name="l00301"><\/a>00301         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> <a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">TABLE_WIFIDOG_LOCKED<\/a>);$/;"	a
l00302	doc/html/fw__iptables_8c-source.html	/^<a name="l00302"><\/a>00302         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> TABLE_WIFIDOG_GLOBAL);$/;"	a
l00303	doc/html/fw__iptables_8c-source.html	/^<a name="l00303"><\/a>00303         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> <a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">TABLE_WIFIDOG_VALIDATE<\/a>);$/;"	a
l00304	doc/html/fw__iptables_8c-source.html	/^<a name="l00304"><\/a>00304         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> <a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">TABLE_WIFIDOG_KNOWN<\/a>);$/;"	a
l00305	doc/html/fw__iptables_8c-source.html	/^<a name="l00305"><\/a>00305         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> TABLE_WIFIDOG_UNKNOWN);$/;"	a
l00306	doc/html/fw__iptables_8c-source.html	/^<a name="l00306"><\/a>00306 $/;"	a
l00307	doc/html/fw__iptables_8c-source.html	/^<a name="l00307"><\/a>00307         <span class="comment">\/* Assign links and rules to these new chains *\/<\/span>$/;"	a
l00308	doc/html/fw__iptables_8c-source.html	/^<a name="l00308"><\/a>00308 $/;"	a
l00309	doc/html/fw__iptables_8c-source.html	/^<a name="l00309"><\/a>00309         <span class="comment">\/* Insert at the beginning *\/<\/span>$/;"	a
l00310	doc/html/fw__iptables_8c-source.html	/^<a name="l00310"><\/a>00310         iptables_do_command(<span class="stringliteral">"-t filter -I FORWARD -i %s -j "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00311	doc/html/fw__iptables_8c-source.html	/^<a name="l00311"><\/a>00311 $/;"	a
l00312	doc/html/fw__iptables_8c-source.html	/^<a name="l00312"><\/a>00312 $/;"	a
l00313	doc/html/fw__iptables_8c-source.html	/^<a name="l00313"><\/a>00313         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m state --state INVALID -j DROP"<\/span>);$/;"	a
l00314	doc/html/fw__iptables_8c-source.html	/^<a name="l00314"><\/a>00314 $/;"	a
l00315	doc/html/fw__iptables_8c-source.html	/^<a name="l00315"><\/a>00315         <span class="comment">\/* XXX: Why this? it means that connections setup after authentication<\/span>$/;"	a
l00316	doc/html/fw__iptables_8c-source.html	/^<a name="l00316"><\/a>00316 <span class="comment">           stay open even after the connection is done... <\/span>$/;"	a
l00317	doc/html/fw__iptables_8c-source.html	/^<a name="l00317"><\/a>00317 <span class="comment">           iptables_do_command("-t filter -A " TABLE_WIFIDOG_WIFI_TO_INTERNET " -m state --state RELATED,ESTABLISHED -j ACCEPT");*\/<\/span>$/;"	a
l00318	doc/html/fw__iptables_8c-source.html	/^<a name="l00318"><\/a>00318 $/;"	a
l00319	doc/html/fw__iptables_8c-source.html	/^<a name="l00319"><\/a>00319         <span class="comment">\/\/Won't this rule NEVER match anyway?!?!? benoitg, 2007-06-23<\/span>$/;"	a
l00320	doc/html/fw__iptables_8c-source.html	/^<a name="l00320"><\/a>00320         <span class="comment">\/\/iptables_do_command("-t filter -A " TABLE_WIFIDOG_WIFI_TO_INTERNET " -i %s -m state --state NEW -j DROP", ext_interface);<\/span>$/;"	a
l00321	doc/html/fw__iptables_8c-source.html	/^<a name="l00321"><\/a>00321 $/;"	a
l00322	doc/html/fw__iptables_8c-source.html	/^<a name="l00322"><\/a>00322         <span class="comment">\/* TCPMSS rule for PPPoE *\/<\/span>$/;"	a
l00323	doc/html/fw__iptables_8c-source.html	/^<a name="l00323"><\/a>00323         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -o %s -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu"<\/span>, ext_interface);$/;"	a
l00324	doc/html/fw__iptables_8c-source.html	/^<a name="l00324"><\/a>00324 $/;"	a
l00325	doc/html/fw__iptables_8c-source.html	/^<a name="l00325"><\/a>00325         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -j "<\/span> TABLE_WIFIDOG_AUTHSERVERS);$/;"	a
l00326	doc/html/fw__iptables_8c-source.html	/^<a name="l00326"><\/a>00326         iptables_fw_set_authservers();$/;"	a
l00327	doc/html/fw__iptables_8c-source.html	/^<a name="l00327"><\/a>00327 $/;"	a
l00328	doc/html/fw__iptables_8c-source.html	/^<a name="l00328"><\/a>00328         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j "<\/span> <a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">TABLE_WIFIDOG_LOCKED<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc" title="The client has been locked out.">FW_MARK_LOCKED<\/a>);$/;"	a
l00329	doc/html/fw__iptables_8c-source.html	/^<a name="l00329"><\/a>00329         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"locked-users"<\/span>, TABLE_WIFIDOG_LOCKED);$/;"	a
l00330	doc/html/fw__iptables_8c-source.html	/^<a name="l00330"><\/a>00330 $/;"	a
l00331	doc/html/fw__iptables_8c-source.html	/^<a name="l00331"><\/a>00331         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -j "<\/span> TABLE_WIFIDOG_GLOBAL);$/;"	a
l00332	doc/html/fw__iptables_8c-source.html	/^<a name="l00332"><\/a>00332         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"global"<\/span>, TABLE_WIFIDOG_GLOBAL);$/;"	a
l00333	doc/html/fw__iptables_8c-source.html	/^<a name="l00333"><\/a>00333         iptables_load_ruleset(<span class="stringliteral">"nat"<\/span>, <span class="stringliteral">"global"<\/span>, TABLE_WIFIDOG_GLOBAL);$/;"	a
l00334	doc/html/fw__iptables_8c-source.html	/^<a name="l00334"><\/a>00334 $/;"	a
l00335	doc/html/fw__iptables_8c-source.html	/^<a name="l00335"><\/a>00335         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j "<\/span> <a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">TABLE_WIFIDOG_VALIDATE<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>);$/;"	a
l00336	doc/html/fw__iptables_8c-source.html	/^<a name="l00336"><\/a>00336         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"validating-users"<\/span>, TABLE_WIFIDOG_VALIDATE);$/;"	a
l00337	doc/html/fw__iptables_8c-source.html	/^<a name="l00337"><\/a>00337 $/;"	a
l00338	doc/html/fw__iptables_8c-source.html	/^<a name="l00338"><\/a>00338         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j "<\/span> <a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">TABLE_WIFIDOG_KNOWN<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>);$/;"	a
l00339	doc/html/fw__iptables_8c-source.html	/^<a name="l00339"><\/a>00339         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"known-users"<\/span>, TABLE_WIFIDOG_KNOWN);$/;"	a
l00340	doc/html/fw__iptables_8c-source.html	/^<a name="l00340"><\/a>00340 $/;"	a
l00341	doc/html/fw__iptables_8c-source.html	/^<a name="l00341"><\/a>00341         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -j "<\/span> TABLE_WIFIDOG_UNKNOWN);$/;"	a
l00342	doc/html/fw__iptables_8c-source.html	/^<a name="l00342"><\/a>00342         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"unknown-users"<\/span>, TABLE_WIFIDOG_UNKNOWN);$/;"	a
l00343	doc/html/fw__iptables_8c-source.html	/^<a name="l00343"><\/a>00343         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_UNKNOWN <span class="stringliteral">" -j REJECT --reject-with icmp-port-unreachable"<\/span>);$/;"	a
l00344	doc/html/fw__iptables_8c-source.html	/^<a name="l00344"><\/a>00344 $/;"	a
l00345	doc/html/fw__iptables_8c-source.html	/^<a name="l00345"><\/a>00345         UNLOCK_CONFIG();$/;"	a
l00346	doc/html/fw__iptables_8c-source.html	/^<a name="l00346"><\/a>00346         <span class="keywordflow">return<\/span> 1;$/;"	a
l00347	doc/html/fw__iptables_8c-source.html	/^<a name="l00347"><\/a>00347 }$/;"	a
l00348	doc/html/fw__iptables_8c-source.html	/^<a name="l00348"><\/a>00348 $/;"	a
l00353	doc/html/fw__iptables_8c-source.html	/^<a name="l00353"><\/a>00353         <span class="keywordtype">int<\/span>$/;"	a
l00354	doc/html/fw__iptables_8c-source.html	/^<a name="l00354"><\/a><a class="code" href="fw__iptables_8h.html#feabe4a819a5e16d2d2df56bdfa2ca58">00354<\/a> iptables_fw_destroy(<span class="keywordtype">void<\/span>)$/;"	a
l00355	doc/html/fw__iptables_8c-source.html	/^<a name="l00355"><\/a>00355 {$/;"	a
l00356	doc/html/fw__iptables_8c-source.html	/^<a name="l00356"><\/a>00356         fw_quiet = 1;$/;"	a
l00357	doc/html/fw__iptables_8c-source.html	/^<a name="l00357"><\/a>00357 $/;"	a
l00358	doc/html/fw__iptables_8c-source.html	/^<a name="l00358"><\/a>00358         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Destroying our iptables entries"<\/span>);$/;"	a
l00359	doc/html/fw__iptables_8c-source.html	/^<a name="l00359"><\/a>00359 $/;"	a
l00360	doc/html/fw__iptables_8c-source.html	/^<a name="l00360"><\/a>00360         <span class="comment">\/*<\/span>$/;"	a
l00361	doc/html/fw__iptables_8c-source.html	/^<a name="l00361"><\/a>00361 <span class="comment">         *<\/span>$/;"	a
l00362	doc/html/fw__iptables_8c-source.html	/^<a name="l00362"><\/a>00362 <span class="comment">         * Everything in the MANGLE table<\/span>$/;"	a
l00363	doc/html/fw__iptables_8c-source.html	/^<a name="l00363"><\/a>00363 <span class="comment">         *<\/span>$/;"	a
l00364	doc/html/fw__iptables_8c-source.html	/^<a name="l00364"><\/a>00364 <span class="comment">         *\/<\/span>$/;"	a
l00365	doc/html/fw__iptables_8c-source.html	/^<a name="l00365"><\/a>00365         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Destroying chains in the MANGLE table"<\/span>);$/;"	a
l00366	doc/html/fw__iptables_8c-source.html	/^<a name="l00366"><\/a>00366         iptables_fw_destroy_mention(<span class="stringliteral">"mangle"<\/span>, <span class="stringliteral">"PREROUTING"<\/span>, <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>);$/;"	a
l00367	doc/html/fw__iptables_8c-source.html	/^<a name="l00367"><\/a>00367         iptables_fw_destroy_mention(<span class="stringliteral">"mangle"<\/span>, <span class="stringliteral">"PREROUTING"<\/span>, <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00368	doc/html/fw__iptables_8c-source.html	/^<a name="l00368"><\/a>00368         iptables_fw_destroy_mention(<span class="stringliteral">"mangle"<\/span>, <span class="stringliteral">"POSTROUTING"<\/span>, <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00369	doc/html/fw__iptables_8c-source.html	/^<a name="l00369"><\/a>00369         iptables_do_command(<span class="stringliteral">"-t mangle -F "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>);$/;"	a
l00370	doc/html/fw__iptables_8c-source.html	/^<a name="l00370"><\/a>00370         iptables_do_command(<span class="stringliteral">"-t mangle -F "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00371	doc/html/fw__iptables_8c-source.html	/^<a name="l00371"><\/a>00371         iptables_do_command(<span class="stringliteral">"-t mangle -F "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00372	doc/html/fw__iptables_8c-source.html	/^<a name="l00372"><\/a>00372         iptables_do_command(<span class="stringliteral">"-t mangle -X "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>);$/;"	a
l00373	doc/html/fw__iptables_8c-source.html	/^<a name="l00373"><\/a>00373         iptables_do_command(<span class="stringliteral">"-t mangle -X "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00374	doc/html/fw__iptables_8c-source.html	/^<a name="l00374"><\/a>00374         iptables_do_command(<span class="stringliteral">"-t mangle -X "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00375	doc/html/fw__iptables_8c-source.html	/^<a name="l00375"><\/a>00375 $/;"	a
l00376	doc/html/fw__iptables_8c-source.html	/^<a name="l00376"><\/a>00376         <span class="comment">\/*<\/span>$/;"	a
l00377	doc/html/fw__iptables_8c-source.html	/^<a name="l00377"><\/a>00377 <span class="comment">         *<\/span>$/;"	a
l00378	doc/html/fw__iptables_8c-source.html	/^<a name="l00378"><\/a>00378 <span class="comment">         * Everything in the NAT table<\/span>$/;"	a
l00379	doc/html/fw__iptables_8c-source.html	/^<a name="l00379"><\/a>00379 <span class="comment">         *<\/span>$/;"	a
l00380	doc/html/fw__iptables_8c-source.html	/^<a name="l00380"><\/a>00380 <span class="comment">         *\/<\/span>$/;"	a
l00381	doc/html/fw__iptables_8c-source.html	/^<a name="l00381"><\/a>00381         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Destroying chains in the NAT table"<\/span>);$/;"	a
l00382	doc/html/fw__iptables_8c-source.html	/^<a name="l00382"><\/a>00382         iptables_fw_destroy_mention(<span class="stringliteral">"nat"<\/span>, <span class="stringliteral">"PREROUTING"<\/span>, <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00383	doc/html/fw__iptables_8c-source.html	/^<a name="l00383"><\/a>00383         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00384	doc/html/fw__iptables_8c-source.html	/^<a name="l00384"><\/a>00384         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00385	doc/html/fw__iptables_8c-source.html	/^<a name="l00385"><\/a>00385         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">TABLE_WIFIDOG_WIFI_TO_ROUTER<\/a>);$/;"	a
l00386	doc/html/fw__iptables_8c-source.html	/^<a name="l00386"><\/a>00386         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00387	doc/html/fw__iptables_8c-source.html	/^<a name="l00387"><\/a>00387         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00388	doc/html/fw__iptables_8c-source.html	/^<a name="l00388"><\/a>00388         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00389	doc/html/fw__iptables_8c-source.html	/^<a name="l00389"><\/a>00389         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00390	doc/html/fw__iptables_8c-source.html	/^<a name="l00390"><\/a>00390         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00391	doc/html/fw__iptables_8c-source.html	/^<a name="l00391"><\/a>00391         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">TABLE_WIFIDOG_WIFI_TO_ROUTER<\/a>);$/;"	a
l00392	doc/html/fw__iptables_8c-source.html	/^<a name="l00392"><\/a>00392         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00393	doc/html/fw__iptables_8c-source.html	/^<a name="l00393"><\/a>00393         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00394	doc/html/fw__iptables_8c-source.html	/^<a name="l00394"><\/a>00394         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00395	doc/html/fw__iptables_8c-source.html	/^<a name="l00395"><\/a>00395 $/;"	a
l00396	doc/html/fw__iptables_8c-source.html	/^<a name="l00396"><\/a>00396         <span class="comment">\/*<\/span>$/;"	a
l00397	doc/html/fw__iptables_8c-source.html	/^<a name="l00397"><\/a>00397 <span class="comment">         *<\/span>$/;"	a
l00398	doc/html/fw__iptables_8c-source.html	/^<a name="l00398"><\/a>00398 <span class="comment">         * Everything in the FILTER table<\/span>$/;"	a
l00399	doc/html/fw__iptables_8c-source.html	/^<a name="l00399"><\/a>00399 <span class="comment">         *<\/span>$/;"	a
l00400	doc/html/fw__iptables_8c-source.html	/^<a name="l00400"><\/a>00400 <span class="comment">         *\/<\/span>$/;"	a
l00401	doc/html/fw__iptables_8c-source.html	/^<a name="l00401"><\/a>00401         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Destroying chains in the FILTER table"<\/span>);$/;"	a
l00402	doc/html/fw__iptables_8c-source.html	/^<a name="l00402"><\/a>00402         iptables_fw_destroy_mention(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"FORWARD"<\/span>, <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00403	doc/html/fw__iptables_8c-source.html	/^<a name="l00403"><\/a>00403         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00404	doc/html/fw__iptables_8c-source.html	/^<a name="l00404"><\/a>00404         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00405	doc/html/fw__iptables_8c-source.html	/^<a name="l00405"><\/a>00405         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">TABLE_WIFIDOG_LOCKED<\/a>);$/;"	a
l00406	doc/html/fw__iptables_8c-source.html	/^<a name="l00406"><\/a>00406         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00407	doc/html/fw__iptables_8c-source.html	/^<a name="l00407"><\/a>00407         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">TABLE_WIFIDOG_VALIDATE<\/a>);$/;"	a
l00408	doc/html/fw__iptables_8c-source.html	/^<a name="l00408"><\/a>00408         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">TABLE_WIFIDOG_KNOWN<\/a>);$/;"	a
l00409	doc/html/fw__iptables_8c-source.html	/^<a name="l00409"><\/a>00409         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00410	doc/html/fw__iptables_8c-source.html	/^<a name="l00410"><\/a>00410         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00411	doc/html/fw__iptables_8c-source.html	/^<a name="l00411"><\/a>00411         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00412	doc/html/fw__iptables_8c-source.html	/^<a name="l00412"><\/a>00412         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">TABLE_WIFIDOG_LOCKED<\/a>);$/;"	a
l00413	doc/html/fw__iptables_8c-source.html	/^<a name="l00413"><\/a>00413         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00414	doc/html/fw__iptables_8c-source.html	/^<a name="l00414"><\/a>00414         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">TABLE_WIFIDOG_VALIDATE<\/a>);$/;"	a
l00415	doc/html/fw__iptables_8c-source.html	/^<a name="l00415"><\/a>00415         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">TABLE_WIFIDOG_KNOWN<\/a>);$/;"	a
l00416	doc/html/fw__iptables_8c-source.html	/^<a name="l00416"><\/a>00416         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00417	doc/html/fw__iptables_8c-source.html	/^<a name="l00417"><\/a>00417 $/;"	a
l00418	doc/html/fw__iptables_8c-source.html	/^<a name="l00418"><\/a>00418         <span class="keywordflow">return<\/span> 1;$/;"	a
l00419	doc/html/fw__iptables_8c-source.html	/^<a name="l00419"><\/a>00419 }$/;"	a
l00420	doc/html/fw__iptables_8c-source.html	/^<a name="l00420"><\/a>00420 $/;"	a
l00421	doc/html/fw__iptables_8c-source.html	/^<a name="l00421"><\/a>00421 <span class="comment">\/*<\/span>$/;"	a
l00422	doc/html/fw__iptables_8c-source.html	/^<a name="l00422"><\/a>00422 <span class="comment"> * Helper for iptables_fw_destroy<\/span>$/;"	a
l00423	doc/html/fw__iptables_8c-source.html	/^<a name="l00423"><\/a>00423 <span class="comment"> * @param table The table to search<\/span>$/;"	a
l00424	doc/html/fw__iptables_8c-source.html	/^<a name="l00424"><\/a>00424 <span class="comment"> * @param chain The chain in that table to search<\/span>$/;"	a
l00425	doc/html/fw__iptables_8c-source.html	/^<a name="l00425"><\/a>00425 <span class="comment"> * @param mention A word to find and delete in rules in the given table+chain<\/span>$/;"	a
l00426	doc/html/fw__iptables_8c-source.html	/^<a name="l00426"><\/a>00426 <span class="comment"> *\/<\/span>$/;"	a
l00427	doc/html/fw__iptables_8c-source.html	/^<a name="l00427"><\/a>00427 <span class="keywordtype">int<\/span>$/;"	a
l00428	doc/html/fw__iptables_8c-source.html	/^<a name="l00428"><\/a><a class="code" href="fw__iptables_8h.html#99cee9643f6caf090c134e7651289233">00428<\/a> iptables_fw_destroy_mention($/;"	a
l00429	doc/html/fw__iptables_8c-source.html	/^<a name="l00429"><\/a>00429                 <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * table,$/;"	a
l00430	doc/html/fw__iptables_8c-source.html	/^<a name="l00430"><\/a>00430                 <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * chain,$/;"	a
l00431	doc/html/fw__iptables_8c-source.html	/^<a name="l00431"><\/a>00431                 <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * mention$/;"	a
l00432	doc/html/fw__iptables_8c-source.html	/^<a name="l00432"><\/a>00432                 ) {$/;"	a
l00433	doc/html/fw__iptables_8c-source.html	/^<a name="l00433"><\/a>00433         FILE *p = NULL;$/;"	a
l00434	doc/html/fw__iptables_8c-source.html	/^<a name="l00434"><\/a>00434         <span class="keywordtype">char<\/span> *command = NULL;$/;"	a
l00435	doc/html/fw__iptables_8c-source.html	/^<a name="l00435"><\/a>00435         <span class="keywordtype">char<\/span> *command2 = NULL;$/;"	a
l00436	doc/html/fw__iptables_8c-source.html	/^<a name="l00436"><\/a>00436         <span class="keywordtype">char<\/span> line[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00437	doc/html/fw__iptables_8c-source.html	/^<a name="l00437"><\/a>00437         <span class="keywordtype">char<\/span> rulenum[10];$/;"	a
l00438	doc/html/fw__iptables_8c-source.html	/^<a name="l00438"><\/a>00438         <span class="keywordtype">char<\/span> *victim = safe_strdup(mention);$/;"	a
l00439	doc/html/fw__iptables_8c-source.html	/^<a name="l00439"><\/a>00439         <span class="keywordtype">int<\/span> deleted = 0;$/;"	a
l00440	doc/html/fw__iptables_8c-source.html	/^<a name="l00440"><\/a>00440 $/;"	a
l00441	doc/html/fw__iptables_8c-source.html	/^<a name="l00441"><\/a>00441         iptables_insert_gateway_id(&amp;victim);$/;"	a
l00442	doc/html/fw__iptables_8c-source.html	/^<a name="l00442"><\/a>00442 $/;"	a
l00443	doc/html/fw__iptables_8c-source.html	/^<a name="l00443"><\/a>00443         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Attempting to destroy all mention of %s from %s.%s"<\/span>, victim, table, chain);$/;"	a
l00444	doc/html/fw__iptables_8c-source.html	/^<a name="l00444"><\/a>00444 $/;"	a
l00445	doc/html/fw__iptables_8c-source.html	/^<a name="l00445"><\/a>00445         safe_asprintf(&amp;command, <span class="stringliteral">"iptables -t %s -L %s -n --line-numbers -v"<\/span>, table, chain);$/;"	a
l00446	doc/html/fw__iptables_8c-source.html	/^<a name="l00446"><\/a>00446         iptables_insert_gateway_id(&amp;command);$/;"	a
l00447	doc/html/fw__iptables_8c-source.html	/^<a name="l00447"><\/a>00447 $/;"	a
l00448	doc/html/fw__iptables_8c-source.html	/^<a name="l00448"><\/a>00448         <span class="keywordflow">if<\/span> ((p = popen(command, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00449	doc/html/fw__iptables_8c-source.html	/^<a name="l00449"><\/a>00449                 <span class="comment">\/* Skip first 2 lines *\/<\/span>$/;"	a
l00450	doc/html/fw__iptables_8c-source.html	/^<a name="l00450"><\/a>00450                 <span class="keywordflow">while<\/span> (!feof(p) &amp;&amp; fgetc(p) != <span class="charliteral">'\\n'<\/span>);$/;"	a
l00451	doc/html/fw__iptables_8c-source.html	/^<a name="l00451"><\/a>00451                 <span class="keywordflow">while<\/span> (!feof(p) &amp;&amp; fgetc(p) != <span class="charliteral">'\\n'<\/span>);$/;"	a
l00452	doc/html/fw__iptables_8c-source.html	/^<a name="l00452"><\/a>00452                 <span class="comment">\/* Loop over entries *\/<\/span>$/;"	a
l00453	doc/html/fw__iptables_8c-source.html	/^<a name="l00453"><\/a>00453                 <span class="keywordflow">while<\/span> (fgets(line, <span class="keyword">sizeof<\/span>(line), p)) {$/;"	a
l00454	doc/html/fw__iptables_8c-source.html	/^<a name="l00454"><\/a>00454                         <span class="comment">\/* Look for victim *\/<\/span>$/;"	a
l00455	doc/html/fw__iptables_8c-source.html	/^<a name="l00455"><\/a>00455                         <span class="keywordflow">if<\/span> (strstr(line, victim)) {$/;"	a
l00456	doc/html/fw__iptables_8c-source.html	/^<a name="l00456"><\/a>00456                                 <span class="comment">\/* Found victim - Get the rule number into rulenum*\/<\/span>$/;"	a
l00457	doc/html/fw__iptables_8c-source.html	/^<a name="l00457"><\/a>00457                                 <span class="keywordflow">if<\/span> (sscanf(line, <span class="stringliteral">"%9[0-9]"<\/span>, rulenum) == 1) {$/;"	a
l00458	doc/html/fw__iptables_8c-source.html	/^<a name="l00458"><\/a>00458                                         <span class="comment">\/* Delete the rule: *\/<\/span>$/;"	a
l00459	doc/html/fw__iptables_8c-source.html	/^<a name="l00459"><\/a>00459                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Deleting rule %s from %s.%s because it mentions %s"<\/span>, rulenum, table, chain, victim);$/;"	a
l00460	doc/html/fw__iptables_8c-source.html	/^<a name="l00460"><\/a>00460                                         safe_asprintf(&amp;command2, <span class="stringliteral">"-t %s -D %s %s"<\/span>, table, chain, rulenum);$/;"	a
l00461	doc/html/fw__iptables_8c-source.html	/^<a name="l00461"><\/a>00461                                         iptables_do_command(command2);$/;"	a
l00462	doc/html/fw__iptables_8c-source.html	/^<a name="l00462"><\/a>00462                                         free(command2);$/;"	a
l00463	doc/html/fw__iptables_8c-source.html	/^<a name="l00463"><\/a>00463                                         deleted = 1;$/;"	a
l00464	doc/html/fw__iptables_8c-source.html	/^<a name="l00464"><\/a>00464                                         <span class="comment">\/* Do not keep looping - the captured rulenums will no longer be accurate *\/<\/span>$/;"	a
l00465	doc/html/fw__iptables_8c-source.html	/^<a name="l00465"><\/a>00465                                         <span class="keywordflow">break<\/span>;$/;"	a
l00466	doc/html/fw__iptables_8c-source.html	/^<a name="l00466"><\/a>00466                                 }$/;"	a
l00467	doc/html/fw__iptables_8c-source.html	/^<a name="l00467"><\/a>00467                         }$/;"	a
l00468	doc/html/fw__iptables_8c-source.html	/^<a name="l00468"><\/a>00468                 }$/;"	a
l00469	doc/html/fw__iptables_8c-source.html	/^<a name="l00469"><\/a>00469                 pclose(p);$/;"	a
l00470	doc/html/fw__iptables_8c-source.html	/^<a name="l00470"><\/a>00470         }$/;"	a
l00471	doc/html/fw__iptables_8c-source.html	/^<a name="l00471"><\/a>00471 $/;"	a
l00472	doc/html/fw__iptables_8c-source.html	/^<a name="l00472"><\/a>00472         free(command);$/;"	a
l00473	doc/html/fw__iptables_8c-source.html	/^<a name="l00473"><\/a>00473         free(victim);$/;"	a
l00474	doc/html/fw__iptables_8c-source.html	/^<a name="l00474"><\/a>00474 $/;"	a
l00475	doc/html/fw__iptables_8c-source.html	/^<a name="l00475"><\/a>00475         <span class="keywordflow">if<\/span> (deleted) {$/;"	a
l00476	doc/html/fw__iptables_8c-source.html	/^<a name="l00476"><\/a>00476                 <span class="comment">\/* Recurse just in case there are more in the same table+chain *\/<\/span>$/;"	a
l00477	doc/html/fw__iptables_8c-source.html	/^<a name="l00477"><\/a>00477                 iptables_fw_destroy_mention(table, chain, mention);$/;"	a
l00478	doc/html/fw__iptables_8c-source.html	/^<a name="l00478"><\/a>00478         }$/;"	a
l00479	doc/html/fw__iptables_8c-source.html	/^<a name="l00479"><\/a>00479 $/;"	a
l00480	doc/html/fw__iptables_8c-source.html	/^<a name="l00480"><\/a>00480         <span class="keywordflow">return<\/span> (deleted);$/;"	a
l00481	doc/html/fw__iptables_8c-source.html	/^<a name="l00481"><\/a>00481 }$/;"	a
l00482	doc/html/fw__iptables_8c-source.html	/^<a name="l00482"><\/a>00482 $/;"	a
l00484	doc/html/fw__iptables_8c-source.html	/^<a name="l00484"><\/a>00484         <span class="keywordtype">int<\/span>$/;"	a
l00485	doc/html/fw__iptables_8c-source.html	/^<a name="l00485"><\/a><a class="code" href="fw__iptables_8h.html#215e1186b8a50b3b4c0402007872e3fc">00485<\/a> iptables_fw_access(fw_access_t type, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> tag)$/;"	a
l00486	doc/html/fw__iptables_8c-source.html	/^<a name="l00486"><\/a>00486 {$/;"	a
l00487	doc/html/fw__iptables_8c-source.html	/^<a name="l00487"><\/a>00487         <span class="keywordtype">int<\/span> rc;$/;"	a
l00488	doc/html/fw__iptables_8c-source.html	/^<a name="l00488"><\/a>00488 $/;"	a
l00489	doc/html/fw__iptables_8c-source.html	/^<a name="l00489"><\/a>00489         fw_quiet = 0;$/;"	a
l00490	doc/html/fw__iptables_8c-source.html	/^<a name="l00490"><\/a>00490 $/;"	a
l00491	doc/html/fw__iptables_8c-source.html	/^<a name="l00491"><\/a>00491         <span class="keywordflow">switch<\/span>(type) {$/;"	a
l00492	doc/html/fw__iptables_8c-source.html	/^<a name="l00492"><\/a>00492                 <span class="keywordflow">case<\/span> FW_ACCESS_ALLOW:$/;"	a
l00493	doc/html/fw__iptables_8c-source.html	/^<a name="l00493"><\/a>00493                         iptables_do_command(<span class="stringliteral">"-t mangle -A "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a> <span class="stringliteral">" -s %s -m mac --mac-source %s -j MARK --set-mark %d"<\/span>, ip, mac, tag);$/;"	a
l00494	doc/html/fw__iptables_8c-source.html	/^<a name="l00494"><\/a>00494                         rc = iptables_do_command(<span class="stringliteral">"-t mangle -A "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a> <span class="stringliteral">" -d %s -j ACCEPT"<\/span>, ip);$/;"	a
l00495	doc/html/fw__iptables_8c-source.html	/^<a name="l00495"><\/a>00495                         <span class="keywordflow">break<\/span>;$/;"	a
l00496	doc/html/fw__iptables_8c-source.html	/^<a name="l00496"><\/a>00496                 <span class="keywordflow">case<\/span> FW_ACCESS_DENY:$/;"	a
l00497	doc/html/fw__iptables_8c-source.html	/^<a name="l00497"><\/a>00497                         iptables_do_command(<span class="stringliteral">"-t mangle -D "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a> <span class="stringliteral">" -s %s -m mac --mac-source %s -j MARK --set-mark %d"<\/span>, ip, mac, tag);$/;"	a
l00498	doc/html/fw__iptables_8c-source.html	/^<a name="l00498"><\/a>00498                         rc = iptables_do_command(<span class="stringliteral">"-t mangle -D "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a> <span class="stringliteral">" -d %s -j ACCEPT"<\/span>, ip);$/;"	a
l00499	doc/html/fw__iptables_8c-source.html	/^<a name="l00499"><\/a>00499                         <span class="keywordflow">break<\/span>;$/;"	a
l00500	doc/html/fw__iptables_8c-source.html	/^<a name="l00500"><\/a>00500                 <span class="keywordflow">default<\/span>:$/;"	a
l00501	doc/html/fw__iptables_8c-source.html	/^<a name="l00501"><\/a>00501                         rc = -1;$/;"	a
l00502	doc/html/fw__iptables_8c-source.html	/^<a name="l00502"><\/a>00502                         <span class="keywordflow">break<\/span>;$/;"	a
l00503	doc/html/fw__iptables_8c-source.html	/^<a name="l00503"><\/a>00503         }$/;"	a
l00504	doc/html/fw__iptables_8c-source.html	/^<a name="l00504"><\/a>00504 $/;"	a
l00505	doc/html/fw__iptables_8c-source.html	/^<a name="l00505"><\/a>00505         <span class="keywordflow">return<\/span> rc;$/;"	a
l00506	doc/html/fw__iptables_8c-source.html	/^<a name="l00506"><\/a>00506 }$/;"	a
l00507	doc/html/fw__iptables_8c-source.html	/^<a name="l00507"><\/a>00507 $/;"	a
l00509	doc/html/fw__iptables_8c-source.html	/^<a name="l00509"><\/a>00509         <span class="keywordtype">int<\/span>$/;"	a
l00510	doc/html/fw__iptables_8c-source.html	/^<a name="l00510"><\/a><a class="code" href="fw__iptables_8h.html#bfd8ac7489174a3c172d2f12eaba704a">00510<\/a> iptables_fw_counters_update(<span class="keywordtype">void<\/span>)$/;"	a
l00511	doc/html/fw__iptables_8c-source.html	/^<a name="l00511"><\/a>00511 {$/;"	a
l00512	doc/html/fw__iptables_8c-source.html	/^<a name="l00512"><\/a>00512         FILE *output;$/;"	a
l00513	doc/html/fw__iptables_8c-source.html	/^<a name="l00513"><\/a>00513         <span class="keywordtype">char<\/span> *script,$/;"	a
l00514	doc/html/fw__iptables_8c-source.html	/^<a name="l00514"><\/a>00514              ip[16],$/;"	a
l00515	doc/html/fw__iptables_8c-source.html	/^<a name="l00515"><\/a>00515              rc;$/;"	a
l00516	doc/html/fw__iptables_8c-source.html	/^<a name="l00516"><\/a>00516         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> counter;$/;"	a
l00517	doc/html/fw__iptables_8c-source.html	/^<a name="l00517"><\/a>00517         <a class="code" href="struct__t__client.html">t_client<\/a> *p1;$/;"	a
l00518	doc/html/fw__iptables_8c-source.html	/^<a name="l00518"><\/a>00518         <span class="keyword">struct <\/span>in_addr tempaddr;$/;"	a
l00519	doc/html/fw__iptables_8c-source.html	/^<a name="l00519"><\/a>00519 $/;"	a
l00520	doc/html/fw__iptables_8c-source.html	/^<a name="l00520"><\/a>00520         <span class="comment">\/* Look for outgoing traffic *\/<\/span>$/;"	a
l00521	doc/html/fw__iptables_8c-source.html	/^<a name="l00521"><\/a>00521         safe_asprintf(&amp;script, <span class="stringliteral">"%s %s"<\/span>, <span class="stringliteral">"iptables"<\/span>, <span class="stringliteral">"-v -n -x -t mangle -L "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00522	doc/html/fw__iptables_8c-source.html	/^<a name="l00522"><\/a>00522         iptables_insert_gateway_id(&amp;script);$/;"	a
l00523	doc/html/fw__iptables_8c-source.html	/^<a name="l00523"><\/a>00523         output = popen(script, <span class="stringliteral">"r"<\/span>);$/;"	a
l00524	doc/html/fw__iptables_8c-source.html	/^<a name="l00524"><\/a>00524         free(script);$/;"	a
l00525	doc/html/fw__iptables_8c-source.html	/^<a name="l00525"><\/a>00525         <span class="keywordflow">if<\/span> (!output) {$/;"	a
l00526	doc/html/fw__iptables_8c-source.html	/^<a name="l00526"><\/a>00526                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"popen(): %s"<\/span>, strerror(errno));$/;"	a
l00527	doc/html/fw__iptables_8c-source.html	/^<a name="l00527"><\/a>00527                 <span class="keywordflow">return<\/span> -1;$/;"	a
l00528	doc/html/fw__iptables_8c-source.html	/^<a name="l00528"><\/a>00528         }$/;"	a
l00529	doc/html/fw__iptables_8c-source.html	/^<a name="l00529"><\/a>00529 $/;"	a
l00530	doc/html/fw__iptables_8c-source.html	/^<a name="l00530"><\/a>00530         <span class="comment">\/* skip the first two lines *\/<\/span>$/;"	a
l00531	doc/html/fw__iptables_8c-source.html	/^<a name="l00531"><\/a>00531         <span class="keywordflow">while<\/span> ((<span class="charliteral">'\\n'<\/span> != fgetc(output)) &amp;&amp; !feof(output))$/;"	a
l00532	doc/html/fw__iptables_8c-source.html	/^<a name="l00532"><\/a>00532                 ;$/;"	a
l00533	doc/html/fw__iptables_8c-source.html	/^<a name="l00533"><\/a>00533         <span class="keywordflow">while<\/span> ((<span class="charliteral">'\\n'<\/span> != fgetc(output)) &amp;&amp; !feof(output))$/;"	a
l00534	doc/html/fw__iptables_8c-source.html	/^<a name="l00534"><\/a>00534                 ;$/;"	a
l00535	doc/html/fw__iptables_8c-source.html	/^<a name="l00535"><\/a>00535         <span class="keywordflow">while<\/span> (output &amp;&amp; !(feof(output))) {$/;"	a
l00536	doc/html/fw__iptables_8c-source.html	/^<a name="l00536"><\/a>00536                 rc = fscanf(output, <span class="stringliteral">"%*s %llu %*s %*s %*s %*s %*s %15[0-9.] %*s %*s %*s %*s %*s %*s"<\/span>, &amp;counter, ip);$/;"	a
l00537	doc/html/fw__iptables_8c-source.html	/^<a name="l00537"><\/a>00537                 <span class="comment">\/\/rc = fscanf(output, "%*s %llu %*s %*s %*s %*s %*s %15[0-9.] %*s %*s %*s %*s %*s 0x%*u", &amp;counter, ip);<\/span>$/;"	a
l00538	doc/html/fw__iptables_8c-source.html	/^<a name="l00538"><\/a>00538                 <span class="keywordflow">if<\/span> (2 == rc &amp;&amp; EOF != rc) {$/;"	a
l00539	doc/html/fw__iptables_8c-source.html	/^<a name="l00539"><\/a>00539                         <span class="comment">\/* Sanity*\/<\/span>$/;"	a
l00540	doc/html/fw__iptables_8c-source.html	/^<a name="l00540"><\/a>00540                         <span class="keywordflow">if<\/span> (!inet_aton(ip, &amp;tempaddr)) {$/;"	a
l00541	doc/html/fw__iptables_8c-source.html	/^<a name="l00541"><\/a>00541                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"I was supposed to read an IP address but instead got [%s] - ignoring it"<\/span>, ip);$/;"	a
l00542	doc/html/fw__iptables_8c-source.html	/^<a name="l00542"><\/a>00542                                 <span class="keywordflow">continue<\/span>;$/;"	a
l00543	doc/html/fw__iptables_8c-source.html	/^<a name="l00543"><\/a>00543                         }$/;"	a
l00544	doc/html/fw__iptables_8c-source.html	/^<a name="l00544"><\/a>00544                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read outgoing traffic for %s: Bytes=%llu"<\/span>, ip, counter);$/;"	a
l00545	doc/html/fw__iptables_8c-source.html	/^<a name="l00545"><\/a>00545                         LOCK_CLIENT_LIST();$/;"	a
l00546	doc/html/fw__iptables_8c-source.html	/^<a name="l00546"><\/a>00546                         <span class="keywordflow">if<\/span> ((p1 = <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(ip))) {$/;"	a
l00547	doc/html/fw__iptables_8c-source.html	/^<a name="l00547"><\/a>00547                                 <span class="keywordflow">if<\/span> ((p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> - p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a>) &lt; counter) {$/;"	a
l00548	doc/html/fw__iptables_8c-source.html	/^<a name="l00548"><\/a>00548                                         p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a> + counter;$/;"	a
l00549	doc/html/fw__iptables_8c-source.html	/^<a name="l00549"><\/a>00549                                         p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a> = time(NULL);$/;"	a
l00550	doc/html/fw__iptables_8c-source.html	/^<a name="l00550"><\/a>00550                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"%s - Updated counter.outgoing to %llu bytes.  Updated last_updated to %d"<\/span>, ip, counter, p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>);$/;"	a
l00551	doc/html/fw__iptables_8c-source.html	/^<a name="l00551"><\/a>00551                                 }$/;"	a
l00552	doc/html/fw__iptables_8c-source.html	/^<a name="l00552"><\/a>00552                         } <span class="keywordflow">else<\/span> {$/;"	a
l00553	doc/html/fw__iptables_8c-source.html	/^<a name="l00553"><\/a>00553                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not find %s in client list"<\/span>, ip);$/;"	a
l00554	doc/html/fw__iptables_8c-source.html	/^<a name="l00554"><\/a>00554                         }$/;"	a
l00555	doc/html/fw__iptables_8c-source.html	/^<a name="l00555"><\/a>00555                         UNLOCK_CLIENT_LIST();$/;"	a
l00556	doc/html/fw__iptables_8c-source.html	/^<a name="l00556"><\/a>00556                 }$/;"	a
l00557	doc/html/fw__iptables_8c-source.html	/^<a name="l00557"><\/a>00557         }$/;"	a
l00558	doc/html/fw__iptables_8c-source.html	/^<a name="l00558"><\/a>00558         pclose(output);$/;"	a
l00559	doc/html/fw__iptables_8c-source.html	/^<a name="l00559"><\/a>00559 $/;"	a
l00560	doc/html/fw__iptables_8c-source.html	/^<a name="l00560"><\/a>00560         <span class="comment">\/* Look for incoming traffic *\/<\/span>$/;"	a
l00561	doc/html/fw__iptables_8c-source.html	/^<a name="l00561"><\/a>00561         safe_asprintf(&amp;script, <span class="stringliteral">"%s %s"<\/span>, <span class="stringliteral">"iptables"<\/span>, <span class="stringliteral">"-v -n -x -t mangle -L "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00562	doc/html/fw__iptables_8c-source.html	/^<a name="l00562"><\/a>00562         iptables_insert_gateway_id(&amp;script);$/;"	a
l00563	doc/html/fw__iptables_8c-source.html	/^<a name="l00563"><\/a>00563         output = popen(script, <span class="stringliteral">"r"<\/span>);$/;"	a
l00564	doc/html/fw__iptables_8c-source.html	/^<a name="l00564"><\/a>00564         free(script);$/;"	a
l00565	doc/html/fw__iptables_8c-source.html	/^<a name="l00565"><\/a>00565         <span class="keywordflow">if<\/span> (!output) {$/;"	a
l00566	doc/html/fw__iptables_8c-source.html	/^<a name="l00566"><\/a>00566                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"popen(): %s"<\/span>, strerror(errno));$/;"	a
l00567	doc/html/fw__iptables_8c-source.html	/^<a name="l00567"><\/a>00567                 <span class="keywordflow">return<\/span> -1;$/;"	a
l00568	doc/html/fw__iptables_8c-source.html	/^<a name="l00568"><\/a>00568         }$/;"	a
l00569	doc/html/fw__iptables_8c-source.html	/^<a name="l00569"><\/a>00569 $/;"	a
l00570	doc/html/fw__iptables_8c-source.html	/^<a name="l00570"><\/a>00570         <span class="comment">\/* skip the first two lines *\/<\/span>$/;"	a
l00571	doc/html/fw__iptables_8c-source.html	/^<a name="l00571"><\/a>00571         <span class="keywordflow">while<\/span> ((<span class="charliteral">'\\n'<\/span> != fgetc(output)) &amp;&amp; !feof(output))$/;"	a
l00572	doc/html/fw__iptables_8c-source.html	/^<a name="l00572"><\/a>00572                 ;$/;"	a
l00573	doc/html/fw__iptables_8c-source.html	/^<a name="l00573"><\/a>00573         <span class="keywordflow">while<\/span> ((<span class="charliteral">'\\n'<\/span> != fgetc(output)) &amp;&amp; !feof(output))$/;"	a
l00574	doc/html/fw__iptables_8c-source.html	/^<a name="l00574"><\/a>00574                 ;$/;"	a
l00575	doc/html/fw__iptables_8c-source.html	/^<a name="l00575"><\/a>00575         <span class="keywordflow">while<\/span> (output &amp;&amp; !(feof(output))) {$/;"	a
l00576	doc/html/fw__iptables_8c-source.html	/^<a name="l00576"><\/a>00576                 rc = fscanf(output, <span class="stringliteral">"%*s %llu %*s %*s %*s %*s %*s %*s %15[0-9.]"<\/span>, &amp;counter, ip);$/;"	a
l00577	doc/html/fw__iptables_8c-source.html	/^<a name="l00577"><\/a>00577                 <span class="keywordflow">if<\/span> (2 == rc &amp;&amp; EOF != rc) {$/;"	a
l00578	doc/html/fw__iptables_8c-source.html	/^<a name="l00578"><\/a>00578                         <span class="comment">\/* Sanity*\/<\/span>$/;"	a
l00579	doc/html/fw__iptables_8c-source.html	/^<a name="l00579"><\/a>00579                         <span class="keywordflow">if<\/span> (!inet_aton(ip, &amp;tempaddr)) {$/;"	a
l00580	doc/html/fw__iptables_8c-source.html	/^<a name="l00580"><\/a>00580                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"I was supposed to read an IP address but instead got [%s] - ignoring it"<\/span>, ip);$/;"	a
l00581	doc/html/fw__iptables_8c-source.html	/^<a name="l00581"><\/a>00581                                 <span class="keywordflow">continue<\/span>;$/;"	a
l00582	doc/html/fw__iptables_8c-source.html	/^<a name="l00582"><\/a>00582                         }$/;"	a
l00583	doc/html/fw__iptables_8c-source.html	/^<a name="l00583"><\/a>00583                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read incoming traffic for %s: Bytes=%llu"<\/span>, ip, counter);$/;"	a
l00584	doc/html/fw__iptables_8c-source.html	/^<a name="l00584"><\/a>00584                         LOCK_CLIENT_LIST();$/;"	a
l00585	doc/html/fw__iptables_8c-source.html	/^<a name="l00585"><\/a>00585                         <span class="keywordflow">if<\/span> ((p1 = <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(ip))) {$/;"	a
l00586	doc/html/fw__iptables_8c-source.html	/^<a name="l00586"><\/a>00586                                 <span class="keywordflow">if<\/span> ((p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> - p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a>) &lt; counter) {$/;"	a
l00587	doc/html/fw__iptables_8c-source.html	/^<a name="l00587"><\/a>00587                                         p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a> + counter;$/;"	a
l00588	doc/html/fw__iptables_8c-source.html	/^<a name="l00588"><\/a>00588                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"%s - Updated counter.incoming to %llu bytes"<\/span>, ip, counter);$/;"	a
l00589	doc/html/fw__iptables_8c-source.html	/^<a name="l00589"><\/a>00589                                 }$/;"	a
l00590	doc/html/fw__iptables_8c-source.html	/^<a name="l00590"><\/a>00590                         } <span class="keywordflow">else<\/span> {$/;"	a
l00591	doc/html/fw__iptables_8c-source.html	/^<a name="l00591"><\/a>00591                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not find %s in client list"<\/span>, ip);$/;"	a
l00592	doc/html/fw__iptables_8c-source.html	/^<a name="l00592"><\/a>00592                         }$/;"	a
l00593	doc/html/fw__iptables_8c-source.html	/^<a name="l00593"><\/a>00593                         UNLOCK_CLIENT_LIST();$/;"	a
l00594	doc/html/fw__iptables_8c-source.html	/^<a name="l00594"><\/a>00594                 }$/;"	a
l00595	doc/html/fw__iptables_8c-source.html	/^<a name="l00595"><\/a>00595         }$/;"	a
l00596	doc/html/fw__iptables_8c-source.html	/^<a name="l00596"><\/a>00596         pclose(output);$/;"	a
l00597	doc/html/fw__iptables_8c-source.html	/^<a name="l00597"><\/a>00597 $/;"	a
l00598	doc/html/fw__iptables_8c-source.html	/^<a name="l00598"><\/a>00598         <span class="keywordflow">return<\/span> 1;$/;"	a
l00599	doc/html/fw__iptables_8c-source.html	/^<a name="l00599"><\/a>00599 }$/;"	a
l00001	doc/html/fw__iptables_8h-source.html	/^<h1>fw_iptables.h<\/h1><a href="fw__iptables_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/fw__iptables_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/fw__iptables_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/fw__iptables_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/fw__iptables_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/fw__iptables_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/fw__iptables_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/fw__iptables_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/fw__iptables_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/fw__iptables_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/fw__iptables_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/fw__iptables_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/fw__iptables_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/fw__iptables_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/fw__iptables_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/fw__iptables_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/fw__iptables_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/fw__iptables_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/fw__iptables_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/fw__iptables_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/fw__iptables_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: fw_iptables.h 1375 2008-09-30 10:20:06Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/fw__iptables_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _FW_IPTABLES_H_<\/span>$/;"	a
l00028	doc/html/fw__iptables_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _FW_IPTABLES_H_<\/span>$/;"	a
l00029	doc/html/fw__iptables_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/fw__iptables_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00031	doc/html/fw__iptables_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00034	doc/html/fw__iptables_8h-source.html	/^<a name="l00034"><\/a><a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">00034<\/a> <span class="preprocessor">#define TABLE_WIFIDOG_OUTGOING  "WiFiDog_$ID$_Outgoing"<\/span>$/;"	a
l00035	doc/html/fw__iptables_8h-source.html	/^<a name="l00035"><\/a><a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">00035<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_WIFI_TO_INTERNET "WiFiDog_$ID$_WIFI2Internet"<\/span>$/;"	a
l00036	doc/html/fw__iptables_8h-source.html	/^<a name="l00036"><\/a><a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">00036<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_WIFI_TO_ROUTER "WiFiDog_$ID$_WIFI2Router"<\/span>$/;"	a
l00037	doc/html/fw__iptables_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">00037<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_INCOMING  "WiFiDog_$ID$_Incoming"<\/span>$/;"	a
l00038	doc/html/fw__iptables_8h-source.html	/^<a name="l00038"><\/a><a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">00038<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_AUTHSERVERS "WiFiDog_$ID$_AuthServers"<\/span>$/;"	a
l00039	doc/html/fw__iptables_8h-source.html	/^<a name="l00039"><\/a><a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">00039<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_GLOBAL  "WiFiDog_$ID$_Global"<\/span>$/;"	a
l00040	doc/html/fw__iptables_8h-source.html	/^<a name="l00040"><\/a><a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">00040<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_VALIDATE  "WiFiDog_$ID$_Validate"<\/span>$/;"	a
l00041	doc/html/fw__iptables_8h-source.html	/^<a name="l00041"><\/a><a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">00041<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_KNOWN     "WiFiDog_$ID$_Known"<\/span>$/;"	a
l00042	doc/html/fw__iptables_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">00042<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_UNKNOWN   "WiFiDog_$ID$_Unknown"<\/span>$/;"	a
l00043	doc/html/fw__iptables_8h-source.html	/^<a name="l00043"><\/a><a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">00043<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_LOCKED    "WiFiDog_$ID$_Locked"<\/span>$/;"	a
l00044	doc/html/fw__iptables_8h-source.html	/^<a name="l00044"><\/a><a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">00044<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_TRUSTED    "WiFiDog_$ID$_Trusted"<\/span>$/;"	a
l00045	doc/html/fw__iptables_8h-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor"><\/span>$/;"	a
l00048	doc/html/fw__iptables_8h-source.html	/^<a name="l00048"><\/a><a class="code" href="fw__iptables_8h.html#77e1252d7a42ff110b4cd807cc43822e">00048<\/a> <span class="keyword">typedef<\/span> <span class="keyword">enum<\/span> <a class="code" href="fw__iptables_8h.html#77e1252d7a42ff110b4cd807cc43822e">fw_access_t_<\/a> {$/;"	a
l00049	doc/html/fw__iptables_8h-source.html	/^<a name="l00049"><\/a>00049     FW_ACCESS_ALLOW,$/;"	a
l00050	doc/html/fw__iptables_8h-source.html	/^<a name="l00050"><\/a>00050     FW_ACCESS_DENY$/;"	a
l00051	doc/html/fw__iptables_8h-source.html	/^<a name="l00051"><\/a>00051 } fw_access_t;$/;"	a
l00052	doc/html/fw__iptables_8h-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00054	doc/html/fw__iptables_8h-source.html	/^<a name="l00054"><\/a>00054 <span class="keywordtype">int<\/span> iptables_fw_init(<span class="keywordtype">void<\/span>);$/;"	a
l00055	doc/html/fw__iptables_8h-source.html	/^<a name="l00055"><\/a>00055 $/;"	a
l00057	doc/html/fw__iptables_8h-source.html	/^<a name="l00057"><\/a>00057 <span class="keywordtype">void<\/span> iptables_fw_set_authservers(<span class="keywordtype">void<\/span>);$/;"	a
l00058	doc/html/fw__iptables_8h-source.html	/^<a name="l00058"><\/a>00058 $/;"	a
l00060	doc/html/fw__iptables_8h-source.html	/^<a name="l00060"><\/a>00060 <span class="keywordtype">void<\/span> iptables_fw_clear_authservers(<span class="keywordtype">void<\/span>);$/;"	a
l00061	doc/html/fw__iptables_8h-source.html	/^<a name="l00061"><\/a>00061 $/;"	a
l00063	doc/html/fw__iptables_8h-source.html	/^<a name="l00063"><\/a>00063 <span class="keywordtype">int<\/span> iptables_fw_destroy(<span class="keywordtype">void<\/span>);$/;"	a
l00064	doc/html/fw__iptables_8h-source.html	/^<a name="l00064"><\/a>00064 $/;"	a
l00066	doc/html/fw__iptables_8h-source.html	/^<a name="l00066"><\/a>00066 <span class="keywordtype">int<\/span> iptables_fw_destroy_mention( <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * table, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * chain, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * mention);$/;"	a
l00067	doc/html/fw__iptables_8h-source.html	/^<a name="l00067"><\/a>00067 $/;"	a
l00069	doc/html/fw__iptables_8h-source.html	/^<a name="l00069"><\/a>00069 <span class="keywordtype">int<\/span> iptables_fw_access(fw_access_t type, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> tag);$/;"	a
l00070	doc/html/fw__iptables_8h-source.html	/^<a name="l00070"><\/a>00070 $/;"	a
l00072	doc/html/fw__iptables_8h-source.html	/^<a name="l00072"><\/a>00072 <span class="keywordtype">int<\/span> iptables_fw_counters_update(<span class="keywordtype">void<\/span>);$/;"	a
l00073	doc/html/fw__iptables_8h-source.html	/^<a name="l00073"><\/a>00073 $/;"	a
l00074	doc/html/fw__iptables_8h-source.html	/^<a name="l00074"><\/a>00074 <span class="preprocessor">#endif <\/span><span class="comment">\/* _IPTABLES_H_ *\/<\/span>$/;"	a
027862016be5b3115529b464530ac459	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="027862016be5b3115529b464530ac459"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_OUTGOING" ref="027862016be5b3115529b464530ac459" args="" -->$/;"	a
03bcbe41a673ef44e0fd15ae0a33dda9	doc/html/fw__iptables_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="03bcbe41a673ef44e0fd15ae0a33dda9"><\/a><!-- doxytag: member="fw_iptables.h::fw_access_t" ref="03bcbe41a673ef44e0fd15ae0a33dda9" args="" -->$/;"	a
0a6d436e2e948628cf122be4deea019c	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="0a6d436e2e948628cf122be4deea019c"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_AUTHSERVERS" ref="0a6d436e2e948628cf122be4deea019c" args="" -->$/;"	a
19e9c5d4e0fafe8f01f111887972986d	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="19e9c5d4e0fafe8f01f111887972986d"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_LOCKED" ref="19e9c5d4e0fafe8f01f111887972986d" args="" -->$/;"	a
215e1186b8a50b3b4c0402007872e3fc	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="215e1186b8a50b3b4c0402007872e3fc"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_access" ref="215e1186b8a50b3b4c0402007872e3fc" args="(fw_access_t type, const char *ip, const char *mac, int tag)" -->$/;"	a
2946cb91dee0c8a25d0489f4d49946b9	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="2946cb91dee0c8a25d0489f4d49946b9"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_clear_authservers" ref="2946cb91dee0c8a25d0489f4d49946b9" args="(void)" -->$/;"	a
446be8def54af1d1b05d7419fe750324	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="446be8def54af1d1b05d7419fe750324"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_WIFI_TO_INTERNET" ref="446be8def54af1d1b05d7419fe750324" args="" -->$/;"	a
4b2a4d965d85a7290dfeea913a514fa0	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="4b2a4d965d85a7290dfeea913a514fa0"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_GLOBAL" ref="4b2a4d965d85a7290dfeea913a514fa0" args="" -->$/;"	a
5aa196e45103e9883689ac8778f16cbc	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="5aa196e45103e9883689ac8778f16cbc"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_KNOWN" ref="5aa196e45103e9883689ac8778f16cbc" args="" -->$/;"	a
5dadbef5146e4671a507934684dffce3	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="5dadbef5146e4671a507934684dffce3"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_UNKNOWN" ref="5dadbef5146e4671a507934684dffce3" args="" -->$/;"	a
7002adcab76a23ef8cc99b36407e251b	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="7002adcab76a23ef8cc99b36407e251b"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_INCOMING" ref="7002adcab76a23ef8cc99b36407e251b" args="" -->$/;"	a
77e1252d7a42ff110b4cd807cc43822e	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="77e1252d7a42ff110b4cd807cc43822e"><\/a><!-- doxytag: member="fw_iptables.h::fw_access_t_" ref="77e1252d7a42ff110b4cd807cc43822e" args="" -->$/;"	a
94d41bcb1c985732a51ce171b7e858b1	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="94d41bcb1c985732a51ce171b7e858b1"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_init" ref="94d41bcb1c985732a51ce171b7e858b1" args="(void)" -->$/;"	a
99cee9643f6caf090c134e7651289233	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="99cee9643f6caf090c134e7651289233"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_destroy_mention" ref="99cee9643f6caf090c134e7651289233" args="(const char *table, const char *chain, const char *mention)" -->$/;"	a
_details	doc/html/fw__iptables_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b3e4ef404402dc4287b3c945eeca7232	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="b3e4ef404402dc4287b3c945eeca7232"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_WIFI_TO_ROUTER" ref="b3e4ef404402dc4287b3c945eeca7232" args="" -->$/;"	a
bfd8ac7489174a3c172d2f12eaba704a	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="bfd8ac7489174a3c172d2f12eaba704a"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_counters_update" ref="bfd8ac7489174a3c172d2f12eaba704a" args="(void)" -->$/;"	a
cd205e30639a80845248822e2e1e7eba	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="cd205e30639a80845248822e2e1e7eba"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_set_authservers" ref="cd205e30639a80845248822e2e1e7eba" args="(void)" -->$/;"	a
e07c57ef1dc33ad9a0ca99d03d7f6b66	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="e07c57ef1dc33ad9a0ca99d03d7f6b66"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_VALIDATE" ref="e07c57ef1dc33ad9a0ca99d03d7f6b66" args="" -->$/;"	a
f6c0a007717822481b0d8b3a1d7ce270	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="f6c0a007717822481b0d8b3a1d7ce270"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_TRUSTED" ref="f6c0a007717822481b0d8b3a1d7ce270" args="" -->$/;"	a
feabe4a819a5e16d2d2df56bdfa2ca58	doc/html/fw__iptables_8h.html	/^<a class="anchor" name="feabe4a819a5e16d2d2df56bdfa2ca58"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_destroy" ref="feabe4a819a5e16d2d2df56bdfa2ca58" args="(void)" -->$/;"	a
l00001	doc/html/gateway_8c-source.html	/^<h1>gateway.c<\/h1><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/gateway_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/gateway_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/gateway_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free:Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/gateway_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/gateway_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/gateway_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/gateway_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/gateway_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/gateway_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/gateway_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/gateway_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/gateway_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/gateway_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/gateway_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/gateway_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/gateway_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/gateway_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/gateway_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/gateway_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/gateway_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: gateway.c 1305 2007-11-01 20:04:20Z benoitg $ *\/<\/span>$/;"	a
l00029	doc/html/gateway_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00030	doc/html/gateway_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00031	doc/html/gateway_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00032	doc/html/gateway_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00033	doc/html/gateway_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;signal.h&gt;<\/span>$/;"	a
l00034	doc/html/gateway_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00035	doc/html/gateway_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;time.h&gt;<\/span>$/;"	a
l00036	doc/html/gateway_8c-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	doc/html/gateway_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="comment">\/* for strerror() *\/<\/span>$/;"	a
l00038	doc/html/gateway_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00039	doc/html/gateway_8c-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00040	doc/html/gateway_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="comment">\/* for wait() *\/<\/span>$/;"	a
l00041	doc/html/gateway_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include &lt;sys\/wait.h&gt;<\/span>$/;"	a
l00042	doc/html/gateway_8c-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	doc/html/gateway_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="comment">\/* for unix socket communication*\/<\/span>$/;"	a
l00044	doc/html/gateway_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00045	doc/html/gateway_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include &lt;sys\/un.h&gt;<\/span>$/;"	a
l00046	doc/html/gateway_8c-source.html	/^<a name="l00046"><\/a>00046 $/;"	a
l00047	doc/html/gateway_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00048	doc/html/gateway_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00049	doc/html/gateway_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00050	doc/html/gateway_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00051	doc/html/gateway_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00052	doc/html/gateway_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor">#include "<a class="code" href="gateway_8h.html" title="Main loop.">gateway.h<\/a>"<\/span>$/;"	a
l00053	doc/html/gateway_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00054	doc/html/gateway_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor">#include "<a class="code" href="commandline_8h.html" title="Command line argument handling.">commandline.h<\/a>"<\/span>$/;"	a
l00055	doc/html/gateway_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00056	doc/html/gateway_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="preprocessor">#include "<a class="code" href="http_8h.html" title="HTTP IO functions.">http.h<\/a>"<\/span>$/;"	a
l00057	doc/html/gateway_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00058	doc/html/gateway_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="preprocessor">#include "<a class="code" href="wdctl__thread_8h.html" title="WiFiDog monitoring thread.">wdctl_thread.h<\/a>"<\/span>$/;"	a
l00059	doc/html/gateway_8c-source.html	/^<a name="l00059"><\/a>00059 <span class="preprocessor">#include "<a class="code" href="ping__thread_8h.html" title="WiFiDog heartbeat thread.">ping_thread.h<\/a>"<\/span>$/;"	a
l00060	doc/html/gateway_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="preprocessor">#include "<a class="code" href="httpd__thread_8h.html" title="WiFiDog httpd worker thread.">httpd_thread.h<\/a>"<\/span>$/;"	a
l00061	doc/html/gateway_8c-source.html	/^<a name="l00061"><\/a>00061 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00062	doc/html/gateway_8c-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00067	doc/html/gateway_8c-source.html	/^<a name="l00067"><\/a>00067 <span class="keyword">static<\/span> pthread_t tid_fw_counter = 0;$/;"	a
l00068	doc/html/gateway_8c-source.html	/^<a name="l00068"><\/a>00068 <span class="keyword">static<\/span> pthread_t tid_ping = 0; $/;"	a
l00069	doc/html/gateway_8c-source.html	/^<a name="l00069"><\/a>00069 $/;"	a
l00070	doc/html/gateway_8c-source.html	/^<a name="l00070"><\/a>00070 <span class="comment">\/* The internal web server *\/<\/span>$/;"	a
l00071	doc/html/gateway_8c-source.html	/^<a name="l00071"><\/a>00071 httpd * webserver = NULL;$/;"	a
l00072	doc/html/gateway_8c-source.html	/^<a name="l00072"><\/a>00072 $/;"	a
l00073	doc/html/gateway_8c-source.html	/^<a name="l00073"><\/a>00073 <span class="comment">\/* from commandline.c *\/<\/span>$/;"	a
l00074	doc/html/gateway_8c-source.html	/^<a name="l00074"><\/a>00074 <span class="keyword">extern<\/span> <span class="keywordtype">char<\/span> ** restartargv;$/;"	a
l00075	doc/html/gateway_8c-source.html	/^<a name="l00075"><\/a>00075 <span class="keyword">extern<\/span> pid_t restart_orig_pid;$/;"	a
l00076	doc/html/gateway_8c-source.html	/^<a name="l00076"><\/a>00076 <a class="code" href="struct__t__client.html">t_client<\/a> *firstclient;$/;"	a
l00077	doc/html/gateway_8c-source.html	/^<a name="l00077"><\/a>00077 $/;"	a
l00078	doc/html/gateway_8c-source.html	/^<a name="l00078"><\/a>00078 <span class="comment">\/* from client_list.c *\/<\/span>$/;"	a
l00079	doc/html/gateway_8c-source.html	/^<a name="l00079"><\/a>00079 <span class="keyword">extern<\/span> pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00080	doc/html/gateway_8c-source.html	/^<a name="l00080"><\/a>00080 $/;"	a
l00081	doc/html/gateway_8c-source.html	/^<a name="l00081"><\/a>00081 <span class="comment">\/* Time when wifidog started  *\/<\/span>$/;"	a
l00082	doc/html/gateway_8c-source.html	/^<a name="l00082"><\/a>00082 time_t started_time = 0;$/;"	a
l00083	doc/html/gateway_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	doc/html/gateway_8c-source.html	/^<a name="l00084"><\/a>00084 <span class="comment">\/* Appends -x, the current PID, and NULL to restartargv<\/span>$/;"	a
l00085	doc/html/gateway_8c-source.html	/^<a name="l00085"><\/a>00085 <span class="comment"> * see parse_commandline in commandline.c for details<\/span>$/;"	a
l00086	doc/html/gateway_8c-source.html	/^<a name="l00086"><\/a>00086 <span class="comment"> *<\/span>$/;"	a
l00087	doc/html/gateway_8c-source.html	/^<a name="l00087"><\/a>00087 <span class="comment"> * Why is restartargv global? Shouldn't it be at most static to commandline.c<\/span>$/;"	a
l00088	doc/html/gateway_8c-source.html	/^<a name="l00088"><\/a>00088 <span class="comment"> * and this function static there? -Alex @ 8oct2006<\/span>$/;"	a
l00089	doc/html/gateway_8c-source.html	/^<a name="l00089"><\/a>00089 <span class="comment"> *\/<\/span>$/;"	a
l00090	doc/html/gateway_8c-source.html	/^<a name="l00090"><\/a>00090 <span class="keywordtype">void<\/span> append_x_restartargv(<span class="keywordtype">void<\/span>) {$/;"	a
l00091	doc/html/gateway_8c-source.html	/^<a name="l00091"><\/a>00091         <span class="keywordtype">int<\/span> i;$/;"	a
l00092	doc/html/gateway_8c-source.html	/^<a name="l00092"><\/a>00092 $/;"	a
l00093	doc/html/gateway_8c-source.html	/^<a name="l00093"><\/a>00093         <span class="keywordflow">for<\/span> (i=0; restartargv[i]; i++);$/;"	a
l00094	doc/html/gateway_8c-source.html	/^<a name="l00094"><\/a>00094 $/;"	a
l00095	doc/html/gateway_8c-source.html	/^<a name="l00095"><\/a>00095         restartargv[i++] = safe_strdup(<span class="stringliteral">"-x"<\/span>);$/;"	a
l00096	doc/html/gateway_8c-source.html	/^<a name="l00096"><\/a>00096         safe_asprintf(&amp;(restartargv[i++]), <span class="stringliteral">"%d"<\/span>, getpid());$/;"	a
l00097	doc/html/gateway_8c-source.html	/^<a name="l00097"><\/a>00097 }$/;"	a
l00098	doc/html/gateway_8c-source.html	/^<a name="l00098"><\/a>00098 $/;"	a
l00099	doc/html/gateway_8c-source.html	/^<a name="l00099"><\/a>00099 <span class="comment">\/* @internal<\/span>$/;"	a
l00100	doc/html/gateway_8c-source.html	/^<a name="l00100"><\/a>00100 <span class="comment"> * @brief During gateway restart, connects to the parent process via the internal socket<\/span>$/;"	a
l00101	doc/html/gateway_8c-source.html	/^<a name="l00101"><\/a>00101 <span class="comment"> * Downloads from it the active client list<\/span>$/;"	a
l00102	doc/html/gateway_8c-source.html	/^<a name="l00102"><\/a>00102 <span class="comment"> *\/<\/span>$/;"	a
l00103	doc/html/gateway_8c-source.html	/^<a name="l00103"><\/a>00103 <span class="keywordtype">void<\/span> get_clients_from_parent(<span class="keywordtype">void<\/span>) {$/;"	a
l00104	doc/html/gateway_8c-source.html	/^<a name="l00104"><\/a>00104         <span class="keywordtype">int<\/span> sock;$/;"	a
l00105	doc/html/gateway_8c-source.html	/^<a name="l00105"><\/a>00105         <span class="keyword">struct <\/span>sockaddr_un      sa_un;$/;"	a
l00106	doc/html/gateway_8c-source.html	/^<a name="l00106"><\/a>00106         <a class="code" href="structs__config.html">s_config<\/a> * config = NULL;$/;"	a
l00107	doc/html/gateway_8c-source.html	/^<a name="l00107"><\/a>00107         <span class="keywordtype">char<\/span> linebuffer[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00108	doc/html/gateway_8c-source.html	/^<a name="l00108"><\/a>00108         <span class="keywordtype">int<\/span> len = 0;$/;"	a
l00109	doc/html/gateway_8c-source.html	/^<a name="l00109"><\/a>00109         <span class="keywordtype">char<\/span> *running1 = NULL;$/;"	a
l00110	doc/html/gateway_8c-source.html	/^<a name="l00110"><\/a>00110         <span class="keywordtype">char<\/span> *running2 = NULL;$/;"	a
l00111	doc/html/gateway_8c-source.html	/^<a name="l00111"><\/a>00111         <span class="keywordtype">char<\/span> *token1 = NULL;$/;"	a
l00112	doc/html/gateway_8c-source.html	/^<a name="l00112"><\/a>00112         <span class="keywordtype">char<\/span> *token2 = NULL;$/;"	a
l00113	doc/html/gateway_8c-source.html	/^<a name="l00113"><\/a>00113         <span class="keywordtype">char<\/span> onechar;$/;"	a
l00114	doc/html/gateway_8c-source.html	/^<a name="l00114"><\/a>00114         <span class="keywordtype">char<\/span> *command = NULL;$/;"	a
l00115	doc/html/gateway_8c-source.html	/^<a name="l00115"><\/a>00115         <span class="keywordtype">char<\/span> *key = NULL;$/;"	a
l00116	doc/html/gateway_8c-source.html	/^<a name="l00116"><\/a>00116         <span class="keywordtype">char<\/span> *value = NULL;$/;"	a
l00117	doc/html/gateway_8c-source.html	/^<a name="l00117"><\/a>00117         <a class="code" href="struct__t__client.html">t_client<\/a> * client = NULL;$/;"	a
l00118	doc/html/gateway_8c-source.html	/^<a name="l00118"><\/a>00118         <a class="code" href="struct__t__client.html">t_client<\/a> * lastclient = NULL;$/;"	a
l00119	doc/html/gateway_8c-source.html	/^<a name="l00119"><\/a>00119 $/;"	a
l00120	doc/html/gateway_8c-source.html	/^<a name="l00120"><\/a>00120         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00121	doc/html/gateway_8c-source.html	/^<a name="l00121"><\/a>00121         $/;"	a
l00122	doc/html/gateway_8c-source.html	/^<a name="l00122"><\/a>00122         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Connecting to parent to download clients"<\/span>);$/;"	a
l00123	doc/html/gateway_8c-source.html	/^<a name="l00123"><\/a>00123 $/;"	a
l00124	doc/html/gateway_8c-source.html	/^<a name="l00124"><\/a>00124         <span class="comment">\/* Connect to socket *\/<\/span>$/;"	a
l00125	doc/html/gateway_8c-source.html	/^<a name="l00125"><\/a>00125         sock = socket(AF_UNIX, SOCK_STREAM, 0);$/;"	a
l00126	doc/html/gateway_8c-source.html	/^<a name="l00126"><\/a>00126         memset(&amp;sa_un, 0, <span class="keyword">sizeof<\/span>(sa_un));$/;"	a
l00127	doc/html/gateway_8c-source.html	/^<a name="l00127"><\/a>00127         sa_un.sun_family = AF_UNIX;$/;"	a
l00128	doc/html/gateway_8c-source.html	/^<a name="l00128"><\/a>00128         strncpy(sa_un.sun_path, config-&gt;internal_sock, (<span class="keyword">sizeof<\/span>(sa_un.sun_path) - 1));$/;"	a
l00129	doc/html/gateway_8c-source.html	/^<a name="l00129"><\/a>00129 $/;"	a
l00130	doc/html/gateway_8c-source.html	/^<a name="l00130"><\/a>00130         <span class="keywordflow">if<\/span> (connect(sock, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, strlen(sa_un.sun_path) + <span class="keyword">sizeof<\/span>(sa_un.sun_family))) {$/;"	a
l00131	doc/html/gateway_8c-source.html	/^<a name="l00131"><\/a>00131                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Failed to connect to parent (%s) - client list not downloaded"<\/span>, strerror(errno));$/;"	a
l00132	doc/html/gateway_8c-source.html	/^<a name="l00132"><\/a>00132                 <span class="keywordflow">return<\/span>;$/;"	a
l00133	doc/html/gateway_8c-source.html	/^<a name="l00133"><\/a>00133         }$/;"	a
l00134	doc/html/gateway_8c-source.html	/^<a name="l00134"><\/a>00134 $/;"	a
l00135	doc/html/gateway_8c-source.html	/^<a name="l00135"><\/a>00135         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Connected to parent.  Downloading clients"<\/span>);$/;"	a
l00136	doc/html/gateway_8c-source.html	/^<a name="l00136"><\/a>00136 $/;"	a
l00137	doc/html/gateway_8c-source.html	/^<a name="l00137"><\/a>00137         LOCK_CLIENT_LIST();$/;"	a
l00138	doc/html/gateway_8c-source.html	/^<a name="l00138"><\/a>00138 $/;"	a
l00139	doc/html/gateway_8c-source.html	/^<a name="l00139"><\/a>00139         command = NULL;$/;"	a
l00140	doc/html/gateway_8c-source.html	/^<a name="l00140"><\/a>00140         memset(linebuffer, 0, <span class="keyword">sizeof<\/span>(linebuffer));$/;"	a
l00141	doc/html/gateway_8c-source.html	/^<a name="l00141"><\/a>00141         len = 0;$/;"	a
l00142	doc/html/gateway_8c-source.html	/^<a name="l00142"><\/a>00142         client = NULL;$/;"	a
l00143	doc/html/gateway_8c-source.html	/^<a name="l00143"><\/a>00143         <span class="comment">\/* Get line by line *\/<\/span>$/;"	a
l00144	doc/html/gateway_8c-source.html	/^<a name="l00144"><\/a>00144         <span class="keywordflow">while<\/span> (read(sock, &amp;onechar, 1) == 1) {$/;"	a
l00145	doc/html/gateway_8c-source.html	/^<a name="l00145"><\/a>00145                 <span class="keywordflow">if<\/span> (onechar == <span class="charliteral">'\\n'<\/span>) {$/;"	a
l00146	doc/html/gateway_8c-source.html	/^<a name="l00146"><\/a>00146                         <span class="comment">\/* End of line *\/<\/span>$/;"	a
l00147	doc/html/gateway_8c-source.html	/^<a name="l00147"><\/a>00147                         onechar = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00148	doc/html/gateway_8c-source.html	/^<a name="l00148"><\/a>00148                 }$/;"	a
l00149	doc/html/gateway_8c-source.html	/^<a name="l00149"><\/a>00149                 linebuffer[len++] = onechar;$/;"	a
l00150	doc/html/gateway_8c-source.html	/^<a name="l00150"><\/a>00150 $/;"	a
l00151	doc/html/gateway_8c-source.html	/^<a name="l00151"><\/a>00151                 <span class="keywordflow">if<\/span> (!onechar) {$/;"	a
l00152	doc/html/gateway_8c-source.html	/^<a name="l00152"><\/a>00152                         <span class="comment">\/* We have a complete entry in linebuffer - parse it *\/<\/span>$/;"	a
l00153	doc/html/gateway_8c-source.html	/^<a name="l00153"><\/a>00153                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Received from parent: [%s]"<\/span>, linebuffer);$/;"	a
l00154	doc/html/gateway_8c-source.html	/^<a name="l00154"><\/a>00154                         running1 = linebuffer;$/;"	a
l00155	doc/html/gateway_8c-source.html	/^<a name="l00155"><\/a>00155                         <span class="keywordflow">while<\/span> ((token1 = strsep(&amp;running1, <span class="stringliteral">"|"<\/span>)) != NULL) {$/;"	a
l00156	doc/html/gateway_8c-source.html	/^<a name="l00156"><\/a>00156                                 <span class="keywordflow">if<\/span> (!command) {$/;"	a
l00157	doc/html/gateway_8c-source.html	/^<a name="l00157"><\/a>00157                                         <span class="comment">\/* The first token is the command *\/<\/span>$/;"	a
l00158	doc/html/gateway_8c-source.html	/^<a name="l00158"><\/a>00158                                         command = token1;$/;"	a
l00159	doc/html/gateway_8c-source.html	/^<a name="l00159"><\/a>00159                                 }$/;"	a
l00160	doc/html/gateway_8c-source.html	/^<a name="l00160"><\/a>00160                                 <span class="keywordflow">else<\/span> {$/;"	a
l00161	doc/html/gateway_8c-source.html	/^<a name="l00161"><\/a>00161                                 <span class="comment">\/* Token1 has something like "foo=bar" *\/<\/span>$/;"	a
l00162	doc/html/gateway_8c-source.html	/^<a name="l00162"><\/a>00162                                         running2 = token1;$/;"	a
l00163	doc/html/gateway_8c-source.html	/^<a name="l00163"><\/a>00163                                         key = value = NULL;$/;"	a
l00164	doc/html/gateway_8c-source.html	/^<a name="l00164"><\/a>00164                                         <span class="keywordflow">while<\/span> ((token2 = strsep(&amp;running2, <span class="stringliteral">"="<\/span>)) != NULL) {$/;"	a
l00165	doc/html/gateway_8c-source.html	/^<a name="l00165"><\/a>00165                                                 <span class="keywordflow">if<\/span> (!key) {$/;"	a
l00166	doc/html/gateway_8c-source.html	/^<a name="l00166"><\/a>00166                                                         key = token2;$/;"	a
l00167	doc/html/gateway_8c-source.html	/^<a name="l00167"><\/a>00167                                                 }$/;"	a
l00168	doc/html/gateway_8c-source.html	/^<a name="l00168"><\/a>00168                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (!value) {$/;"	a
l00169	doc/html/gateway_8c-source.html	/^<a name="l00169"><\/a>00169                                                         value = token2;$/;"	a
l00170	doc/html/gateway_8c-source.html	/^<a name="l00170"><\/a>00170                                                 }$/;"	a
l00171	doc/html/gateway_8c-source.html	/^<a name="l00171"><\/a>00171                                         }$/;"	a
l00172	doc/html/gateway_8c-source.html	/^<a name="l00172"><\/a>00172                                 }$/;"	a
l00173	doc/html/gateway_8c-source.html	/^<a name="l00173"><\/a>00173 $/;"	a
l00174	doc/html/gateway_8c-source.html	/^<a name="l00174"><\/a>00174                                 <span class="keywordflow">if<\/span> (strcmp(command, <span class="stringliteral">"CLIENT"<\/span>) == 0) {$/;"	a
l00175	doc/html/gateway_8c-source.html	/^<a name="l00175"><\/a>00175                                         <span class="comment">\/* This line has info about a client in the client list *\/<\/span>$/;"	a
l00176	doc/html/gateway_8c-source.html	/^<a name="l00176"><\/a>00176                                         <span class="keywordflow">if<\/span> (!client) {$/;"	a
l00177	doc/html/gateway_8c-source.html	/^<a name="l00177"><\/a>00177                                                 <span class="comment">\/* Create a new client struct *\/<\/span>$/;"	a
l00178	doc/html/gateway_8c-source.html	/^<a name="l00178"><\/a>00178                                                 client = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__t__client.html">t_client<\/a>));$/;"	a
l00179	doc/html/gateway_8c-source.html	/^<a name="l00179"><\/a>00179                                                 memset(client, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__t__client.html">t_client<\/a>));$/;"	a
l00180	doc/html/gateway_8c-source.html	/^<a name="l00180"><\/a>00180                                         }$/;"	a
l00181	doc/html/gateway_8c-source.html	/^<a name="l00181"><\/a>00181                                 }$/;"	a
l00182	doc/html/gateway_8c-source.html	/^<a name="l00182"><\/a>00182 $/;"	a
l00183	doc/html/gateway_8c-source.html	/^<a name="l00183"><\/a>00183                                 <span class="keywordflow">if<\/span> (key &amp;&amp; value) {$/;"	a
l00184	doc/html/gateway_8c-source.html	/^<a name="l00184"><\/a>00184                                         <span class="keywordflow">if<\/span> (strcmp(command, <span class="stringliteral">"CLIENT"<\/span>) == 0) {$/;"	a
l00185	doc/html/gateway_8c-source.html	/^<a name="l00185"><\/a>00185                                                 <span class="comment">\/* Assign the key into the appropriate slot in the connection structure *\/<\/span>$/;"	a
l00186	doc/html/gateway_8c-source.html	/^<a name="l00186"><\/a>00186                                                 <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"ip"<\/span>) == 0) {$/;"	a
l00187	doc/html/gateway_8c-source.html	/^<a name="l00187"><\/a>00187                                                         client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a> = safe_strdup(value);$/;"	a
l00188	doc/html/gateway_8c-source.html	/^<a name="l00188"><\/a>00188                                                 }$/;"	a
l00189	doc/html/gateway_8c-source.html	/^<a name="l00189"><\/a>00189                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"mac"<\/span>) == 0) {$/;"	a
l00190	doc/html/gateway_8c-source.html	/^<a name="l00190"><\/a>00190                                                         client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a> = safe_strdup(value);$/;"	a
l00191	doc/html/gateway_8c-source.html	/^<a name="l00191"><\/a>00191                                                 }$/;"	a
l00192	doc/html/gateway_8c-source.html	/^<a name="l00192"><\/a>00192                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"token"<\/span>) == 0) {$/;"	a
l00193	doc/html/gateway_8c-source.html	/^<a name="l00193"><\/a>00193                                                         client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a> = safe_strdup(value);$/;"	a
l00194	doc/html/gateway_8c-source.html	/^<a name="l00194"><\/a>00194                                                 }$/;"	a
l00195	doc/html/gateway_8c-source.html	/^<a name="l00195"><\/a>00195                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"fw_connection_state"<\/span>) == 0) {$/;"	a
l00196	doc/html/gateway_8c-source.html	/^<a name="l00196"><\/a>00196                                                         client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> = atoi(value);$/;"	a
l00197	doc/html/gateway_8c-source.html	/^<a name="l00197"><\/a>00197                                                 }$/;"	a
l00198	doc/html/gateway_8c-source.html	/^<a name="l00198"><\/a>00198                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"fd"<\/span>) == 0) {$/;"	a
l00199	doc/html/gateway_8c-source.html	/^<a name="l00199"><\/a>00199                                                         client-&gt;<a class="code" href="struct__t__client.html#495baef8f1dc90c94c24561ebd61140d" title="Client HTTP socket (valid only during login before one of the _http_* function is...">fd<\/a> = atoi(value);$/;"	a
l00200	doc/html/gateway_8c-source.html	/^<a name="l00200"><\/a>00200                                                 }$/;"	a
l00201	doc/html/gateway_8c-source.html	/^<a name="l00201"><\/a>00201                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"counters_incoming"<\/span>) == 0) {$/;"	a
l00202	doc/html/gateway_8c-source.html	/^<a name="l00202"><\/a>00202                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a> = atoll(value);$/;"	a
l00203	doc/html/gateway_8c-source.html	/^<a name="l00203"><\/a>00203                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> = client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a>;$/;"	a
l00204	doc/html/gateway_8c-source.html	/^<a name="l00204"><\/a>00204                                                 }$/;"	a
l00205	doc/html/gateway_8c-source.html	/^<a name="l00205"><\/a>00205                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"counters_outgoing"<\/span>) == 0) {$/;"	a
l00206	doc/html/gateway_8c-source.html	/^<a name="l00206"><\/a>00206                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a> = atoll(value);$/;"	a
l00207	doc/html/gateway_8c-source.html	/^<a name="l00207"><\/a>00207                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> = client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a>;$/;"	a
l00208	doc/html/gateway_8c-source.html	/^<a name="l00208"><\/a>00208                                                 }$/;"	a
l00209	doc/html/gateway_8c-source.html	/^<a name="l00209"><\/a>00209                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"counters_last_updated"<\/span>) == 0) {$/;"	a
l00210	doc/html/gateway_8c-source.html	/^<a name="l00210"><\/a>00210                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a> = atol(value);$/;"	a
l00211	doc/html/gateway_8c-source.html	/^<a name="l00211"><\/a>00211                                                 }$/;"	a
l00212	doc/html/gateway_8c-source.html	/^<a name="l00212"><\/a>00212                                                 <span class="keywordflow">else<\/span> {$/;"	a
l00213	doc/html/gateway_8c-source.html	/^<a name="l00213"><\/a>00213                                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"I don't know how to inherit key [%s] value [%s] from parent"<\/span>, key, value);$/;"	a
l00214	doc/html/gateway_8c-source.html	/^<a name="l00214"><\/a>00214                                                 }$/;"	a
l00215	doc/html/gateway_8c-source.html	/^<a name="l00215"><\/a>00215                                         }$/;"	a
l00216	doc/html/gateway_8c-source.html	/^<a name="l00216"><\/a>00216                                 }$/;"	a
l00217	doc/html/gateway_8c-source.html	/^<a name="l00217"><\/a>00217                         }$/;"	a
l00218	doc/html/gateway_8c-source.html	/^<a name="l00218"><\/a>00218 $/;"	a
l00219	doc/html/gateway_8c-source.html	/^<a name="l00219"><\/a>00219                         <span class="comment">\/* End of parsing this command *\/<\/span>$/;"	a
l00220	doc/html/gateway_8c-source.html	/^<a name="l00220"><\/a>00220                         <span class="keywordflow">if<\/span> (client) {$/;"	a
l00221	doc/html/gateway_8c-source.html	/^<a name="l00221"><\/a>00221                                 <span class="comment">\/* Add this client to the client list *\/<\/span>$/;"	a
l00222	doc/html/gateway_8c-source.html	/^<a name="l00222"><\/a>00222                                 <span class="keywordflow">if<\/span> (!firstclient) {$/;"	a
l00223	doc/html/gateway_8c-source.html	/^<a name="l00223"><\/a>00223                                         firstclient = client;$/;"	a
l00224	doc/html/gateway_8c-source.html	/^<a name="l00224"><\/a>00224                                         lastclient = firstclient;$/;"	a
l00225	doc/html/gateway_8c-source.html	/^<a name="l00225"><\/a>00225                                 }$/;"	a
l00226	doc/html/gateway_8c-source.html	/^<a name="l00226"><\/a>00226                                 <span class="keywordflow">else<\/span> {$/;"	a
l00227	doc/html/gateway_8c-source.html	/^<a name="l00227"><\/a>00227                                         lastclient-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> = client;$/;"	a
l00228	doc/html/gateway_8c-source.html	/^<a name="l00228"><\/a>00228                                         lastclient = client;$/;"	a
l00229	doc/html/gateway_8c-source.html	/^<a name="l00229"><\/a>00229                                 }$/;"	a
l00230	doc/html/gateway_8c-source.html	/^<a name="l00230"><\/a>00230                         }$/;"	a
l00231	doc/html/gateway_8c-source.html	/^<a name="l00231"><\/a>00231 $/;"	a
l00232	doc/html/gateway_8c-source.html	/^<a name="l00232"><\/a>00232                         <span class="comment">\/* Clean up *\/<\/span>$/;"	a
l00233	doc/html/gateway_8c-source.html	/^<a name="l00233"><\/a>00233                         command = NULL;$/;"	a
l00234	doc/html/gateway_8c-source.html	/^<a name="l00234"><\/a>00234                         memset(linebuffer, 0, <span class="keyword">sizeof<\/span>(linebuffer));$/;"	a
l00235	doc/html/gateway_8c-source.html	/^<a name="l00235"><\/a>00235                         len = 0;$/;"	a
l00236	doc/html/gateway_8c-source.html	/^<a name="l00236"><\/a>00236                         client = NULL;$/;"	a
l00237	doc/html/gateway_8c-source.html	/^<a name="l00237"><\/a>00237                 }$/;"	a
l00238	doc/html/gateway_8c-source.html	/^<a name="l00238"><\/a>00238         }$/;"	a
l00239	doc/html/gateway_8c-source.html	/^<a name="l00239"><\/a>00239 $/;"	a
l00240	doc/html/gateway_8c-source.html	/^<a name="l00240"><\/a>00240         UNLOCK_CLIENT_LIST();$/;"	a
l00241	doc/html/gateway_8c-source.html	/^<a name="l00241"><\/a>00241         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Client list downloaded successfully from parent"<\/span>);$/;"	a
l00242	doc/html/gateway_8c-source.html	/^<a name="l00242"><\/a>00242 $/;"	a
l00243	doc/html/gateway_8c-source.html	/^<a name="l00243"><\/a>00243         close(sock);$/;"	a
l00244	doc/html/gateway_8c-source.html	/^<a name="l00244"><\/a>00244 }$/;"	a
l00245	doc/html/gateway_8c-source.html	/^<a name="l00245"><\/a>00245 $/;"	a
l00253	doc/html/gateway_8c-source.html	/^<a name="l00253"><\/a>00253 <span class="keywordtype">void<\/span>$/;"	a
l00254	doc/html/gateway_8c-source.html	/^<a name="l00254"><\/a>00254 sigchld_handler(<span class="keywordtype">int<\/span> s)$/;"	a
l00255	doc/html/gateway_8c-source.html	/^<a name="l00255"><\/a>00255 {$/;"	a
l00256	doc/html/gateway_8c-source.html	/^<a name="l00256"><\/a>00256         <span class="keywordtype">int<\/span>     status;$/;"	a
l00257	doc/html/gateway_8c-source.html	/^<a name="l00257"><\/a>00257         pid_t rc;$/;"	a
l00258	doc/html/gateway_8c-source.html	/^<a name="l00258"><\/a>00258         $/;"	a
l00259	doc/html/gateway_8c-source.html	/^<a name="l00259"><\/a>00259         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Handler for SIGCHLD called. Trying to reap a child"<\/span>);$/;"	a
l00260	doc/html/gateway_8c-source.html	/^<a name="l00260"><\/a>00260 $/;"	a
l00261	doc/html/gateway_8c-source.html	/^<a name="l00261"><\/a>00261         rc = waitpid(-1, &amp;status, WNOHANG);$/;"	a
l00262	doc/html/gateway_8c-source.html	/^<a name="l00262"><\/a>00262 $/;"	a
l00263	doc/html/gateway_8c-source.html	/^<a name="l00263"><\/a>00263         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Handler for SIGCHLD reaped child PID %d"<\/span>, rc);$/;"	a
l00264	doc/html/gateway_8c-source.html	/^<a name="l00264"><\/a>00264 }$/;"	a
l00265	doc/html/gateway_8c-source.html	/^<a name="l00265"><\/a>00265 $/;"	a
l00268	doc/html/gateway_8c-source.html	/^<a name="l00268"><\/a>00268 <span class="keywordtype">void<\/span>$/;"	a
l00269	doc/html/gateway_8c-source.html	/^<a name="l00269"><\/a><a class="code" href="gateway_8h.html#d850f6ceb76de4be944cdedca2420db5">00269<\/a> termination_handler(<span class="keywordtype">int<\/span> s)$/;"	a
l00270	doc/html/gateway_8c-source.html	/^<a name="l00270"><\/a>00270 {$/;"	a
l00271	doc/html/gateway_8c-source.html	/^<a name="l00271"><\/a>00271         <span class="keyword">static<\/span>  pthread_mutex_t sigterm_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00272	doc/html/gateway_8c-source.html	/^<a name="l00272"><\/a>00272 $/;"	a
l00273	doc/html/gateway_8c-source.html	/^<a name="l00273"><\/a>00273         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Handler for termination caught signal %d"<\/span>, s);$/;"	a
l00274	doc/html/gateway_8c-source.html	/^<a name="l00274"><\/a>00274 $/;"	a
l00275	doc/html/gateway_8c-source.html	/^<a name="l00275"><\/a>00275         <span class="comment">\/* Makes sure we only call fw_destroy() once. *\/<\/span>$/;"	a
l00276	doc/html/gateway_8c-source.html	/^<a name="l00276"><\/a>00276         <span class="keywordflow">if<\/span> (pthread_mutex_trylock(&amp;sigterm_mutex)) {$/;"	a
l00277	doc/html/gateway_8c-source.html	/^<a name="l00277"><\/a>00277                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Another thread already began global termination handler. I'm exiting"<\/span>);$/;"	a
l00278	doc/html/gateway_8c-source.html	/^<a name="l00278"><\/a>00278                 pthread_exit(NULL);$/;"	a
l00279	doc/html/gateway_8c-source.html	/^<a name="l00279"><\/a>00279         }$/;"	a
l00280	doc/html/gateway_8c-source.html	/^<a name="l00280"><\/a>00280         <span class="keywordflow">else<\/span> {$/;"	a
l00281	doc/html/gateway_8c-source.html	/^<a name="l00281"><\/a>00281                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Cleaning up and exiting"<\/span>);$/;"	a
l00282	doc/html/gateway_8c-source.html	/^<a name="l00282"><\/a>00282         }$/;"	a
l00283	doc/html/gateway_8c-source.html	/^<a name="l00283"><\/a>00283 $/;"	a
l00284	doc/html/gateway_8c-source.html	/^<a name="l00284"><\/a>00284         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Flushing firewall rules..."<\/span>);$/;"	a
l00285	doc/html/gateway_8c-source.html	/^<a name="l00285"><\/a>00285         fw_destroy();$/;"	a
l00286	doc/html/gateway_8c-source.html	/^<a name="l00286"><\/a>00286 $/;"	a
l00287	doc/html/gateway_8c-source.html	/^<a name="l00287"><\/a>00287         <span class="comment">\/* XXX Hack<\/span>$/;"	a
l00288	doc/html/gateway_8c-source.html	/^<a name="l00288"><\/a>00288 <span class="comment">         * Aparently pthread_cond_timedwait under openwrt prevents signals (and therefore<\/span>$/;"	a
l00289	doc/html/gateway_8c-source.html	/^<a name="l00289"><\/a>00289 <span class="comment">         * termination handler) from happening so we need to explicitly kill the threads <\/span>$/;"	a
l00290	doc/html/gateway_8c-source.html	/^<a name="l00290"><\/a>00290 <span class="comment">         * that use that<\/span>$/;"	a
l00291	doc/html/gateway_8c-source.html	/^<a name="l00291"><\/a>00291 <span class="comment">         *\/<\/span>$/;"	a
l00292	doc/html/gateway_8c-source.html	/^<a name="l00292"><\/a>00292         <span class="keywordflow">if<\/span> (tid_fw_counter) {$/;"	a
l00293	doc/html/gateway_8c-source.html	/^<a name="l00293"><\/a>00293                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Explicitly killing the fw_counter thread"<\/span>);$/;"	a
l00294	doc/html/gateway_8c-source.html	/^<a name="l00294"><\/a>00294                 pthread_kill(tid_fw_counter, SIGKILL);$/;"	a
l00295	doc/html/gateway_8c-source.html	/^<a name="l00295"><\/a>00295         }$/;"	a
l00296	doc/html/gateway_8c-source.html	/^<a name="l00296"><\/a>00296         <span class="keywordflow">if<\/span> (tid_ping) {$/;"	a
l00297	doc/html/gateway_8c-source.html	/^<a name="l00297"><\/a>00297                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Explicitly killing the ping thread"<\/span>);$/;"	a
l00298	doc/html/gateway_8c-source.html	/^<a name="l00298"><\/a>00298                 pthread_kill(tid_ping, SIGKILL);$/;"	a
l00299	doc/html/gateway_8c-source.html	/^<a name="l00299"><\/a>00299         }$/;"	a
l00300	doc/html/gateway_8c-source.html	/^<a name="l00300"><\/a>00300 $/;"	a
l00301	doc/html/gateway_8c-source.html	/^<a name="l00301"><\/a>00301         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Exiting..."<\/span>);$/;"	a
l00302	doc/html/gateway_8c-source.html	/^<a name="l00302"><\/a>00302         exit(s == 0 ? 1 : 0);$/;"	a
l00303	doc/html/gateway_8c-source.html	/^<a name="l00303"><\/a>00303 }$/;"	a
l00304	doc/html/gateway_8c-source.html	/^<a name="l00304"><\/a>00304 $/;"	a
l00308	doc/html/gateway_8c-source.html	/^<a name="l00308"><\/a>00308 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00309	doc/html/gateway_8c-source.html	/^<a name="l00309"><\/a>00309 init_signals(<span class="keywordtype">void<\/span>)$/;"	a
l00310	doc/html/gateway_8c-source.html	/^<a name="l00310"><\/a>00310 {$/;"	a
l00311	doc/html/gateway_8c-source.html	/^<a name="l00311"><\/a>00311         <span class="keyword">struct <\/span>sigaction sa;$/;"	a
l00312	doc/html/gateway_8c-source.html	/^<a name="l00312"><\/a>00312 $/;"	a
l00313	doc/html/gateway_8c-source.html	/^<a name="l00313"><\/a>00313         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Initializing signal handlers"<\/span>);$/;"	a
l00314	doc/html/gateway_8c-source.html	/^<a name="l00314"><\/a>00314         $/;"	a
l00315	doc/html/gateway_8c-source.html	/^<a name="l00315"><\/a>00315         sa.sa_handler = sigchld_handler;$/;"	a
l00316	doc/html/gateway_8c-source.html	/^<a name="l00316"><\/a>00316         sigemptyset(&amp;sa.sa_mask);$/;"	a
l00317	doc/html/gateway_8c-source.html	/^<a name="l00317"><\/a>00317         sa.sa_flags = SA_RESTART;$/;"	a
l00318	doc/html/gateway_8c-source.html	/^<a name="l00318"><\/a>00318         <span class="keywordflow">if<\/span> (sigaction(SIGCHLD, &amp;sa, NULL) == -1) {$/;"	a
l00319	doc/html/gateway_8c-source.html	/^<a name="l00319"><\/a>00319                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00320	doc/html/gateway_8c-source.html	/^<a name="l00320"><\/a>00320                 exit(1);$/;"	a
l00321	doc/html/gateway_8c-source.html	/^<a name="l00321"><\/a>00321         }$/;"	a
l00322	doc/html/gateway_8c-source.html	/^<a name="l00322"><\/a>00322 $/;"	a
l00323	doc/html/gateway_8c-source.html	/^<a name="l00323"><\/a>00323         <span class="comment">\/* Trap SIGPIPE *\/<\/span>$/;"	a
l00324	doc/html/gateway_8c-source.html	/^<a name="l00324"><\/a>00324         <span class="comment">\/* This is done so that when libhttpd does a socket operation on<\/span>$/;"	a
l00325	doc/html/gateway_8c-source.html	/^<a name="l00325"><\/a>00325 <span class="comment">         * a disconnected socket (i.e.: Broken Pipes) we catch the signal<\/span>$/;"	a
l00326	doc/html/gateway_8c-source.html	/^<a name="l00326"><\/a>00326 <span class="comment">         * and do nothing. The alternative is to exit. SIGPIPE are harmless<\/span>$/;"	a
l00327	doc/html/gateway_8c-source.html	/^<a name="l00327"><\/a>00327 <span class="comment">         * if not desirable.<\/span>$/;"	a
l00328	doc/html/gateway_8c-source.html	/^<a name="l00328"><\/a>00328 <span class="comment">         *\/<\/span>$/;"	a
l00329	doc/html/gateway_8c-source.html	/^<a name="l00329"><\/a>00329         sa.sa_handler = SIG_IGN;$/;"	a
l00330	doc/html/gateway_8c-source.html	/^<a name="l00330"><\/a>00330         <span class="keywordflow">if<\/span> (sigaction(SIGPIPE, &amp;sa, NULL) == -1) {$/;"	a
l00331	doc/html/gateway_8c-source.html	/^<a name="l00331"><\/a>00331                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00332	doc/html/gateway_8c-source.html	/^<a name="l00332"><\/a>00332                 exit(1);$/;"	a
l00333	doc/html/gateway_8c-source.html	/^<a name="l00333"><\/a>00333         }$/;"	a
l00334	doc/html/gateway_8c-source.html	/^<a name="l00334"><\/a>00334 $/;"	a
l00335	doc/html/gateway_8c-source.html	/^<a name="l00335"><\/a>00335         sa.sa_handler = termination_handler;$/;"	a
l00336	doc/html/gateway_8c-source.html	/^<a name="l00336"><\/a>00336         sigemptyset(&amp;sa.sa_mask);$/;"	a
l00337	doc/html/gateway_8c-source.html	/^<a name="l00337"><\/a>00337         sa.sa_flags = SA_RESTART;$/;"	a
l00338	doc/html/gateway_8c-source.html	/^<a name="l00338"><\/a>00338 $/;"	a
l00339	doc/html/gateway_8c-source.html	/^<a name="l00339"><\/a>00339         <span class="comment">\/* Trap SIGTERM *\/<\/span>$/;"	a
l00340	doc/html/gateway_8c-source.html	/^<a name="l00340"><\/a>00340         <span class="keywordflow">if<\/span> (sigaction(SIGTERM, &amp;sa, NULL) == -1) {$/;"	a
l00341	doc/html/gateway_8c-source.html	/^<a name="l00341"><\/a>00341                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00342	doc/html/gateway_8c-source.html	/^<a name="l00342"><\/a>00342                 exit(1);$/;"	a
l00343	doc/html/gateway_8c-source.html	/^<a name="l00343"><\/a>00343         }$/;"	a
l00344	doc/html/gateway_8c-source.html	/^<a name="l00344"><\/a>00344 $/;"	a
l00345	doc/html/gateway_8c-source.html	/^<a name="l00345"><\/a>00345         <span class="comment">\/* Trap SIGQUIT *\/<\/span>$/;"	a
l00346	doc/html/gateway_8c-source.html	/^<a name="l00346"><\/a>00346         <span class="keywordflow">if<\/span> (sigaction(SIGQUIT, &amp;sa, NULL) == -1) {$/;"	a
l00347	doc/html/gateway_8c-source.html	/^<a name="l00347"><\/a>00347                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00348	doc/html/gateway_8c-source.html	/^<a name="l00348"><\/a>00348                 exit(1);$/;"	a
l00349	doc/html/gateway_8c-source.html	/^<a name="l00349"><\/a>00349         }$/;"	a
l00350	doc/html/gateway_8c-source.html	/^<a name="l00350"><\/a>00350 $/;"	a
l00351	doc/html/gateway_8c-source.html	/^<a name="l00351"><\/a>00351         <span class="comment">\/* Trap SIGINT *\/<\/span>$/;"	a
l00352	doc/html/gateway_8c-source.html	/^<a name="l00352"><\/a>00352         <span class="keywordflow">if<\/span> (sigaction(SIGINT, &amp;sa, NULL) == -1) {$/;"	a
l00353	doc/html/gateway_8c-source.html	/^<a name="l00353"><\/a>00353                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00354	doc/html/gateway_8c-source.html	/^<a name="l00354"><\/a>00354                 exit(1);$/;"	a
l00355	doc/html/gateway_8c-source.html	/^<a name="l00355"><\/a>00355         }$/;"	a
l00356	doc/html/gateway_8c-source.html	/^<a name="l00356"><\/a>00356 }$/;"	a
l00357	doc/html/gateway_8c-source.html	/^<a name="l00357"><\/a>00357 $/;"	a
l00361	doc/html/gateway_8c-source.html	/^<a name="l00361"><\/a>00361 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00362	doc/html/gateway_8c-source.html	/^<a name="l00362"><\/a>00362 main_loop(<span class="keywordtype">void<\/span>)$/;"	a
l00363	doc/html/gateway_8c-source.html	/^<a name="l00363"><\/a>00363 {$/;"	a
l00364	doc/html/gateway_8c-source.html	/^<a name="l00364"><\/a>00364         <span class="keywordtype">int<\/span> result;$/;"	a
l00365	doc/html/gateway_8c-source.html	/^<a name="l00365"><\/a>00365         pthread_t       tid;$/;"	a
l00366	doc/html/gateway_8c-source.html	/^<a name="l00366"><\/a>00366         <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00367	doc/html/gateway_8c-source.html	/^<a name="l00367"><\/a>00367         request *r;$/;"	a
l00368	doc/html/gateway_8c-source.html	/^<a name="l00368"><\/a>00368         <span class="keywordtype">void<\/span> **params;$/;"	a
l00369	doc/html/gateway_8c-source.html	/^<a name="l00369"><\/a>00369 $/;"	a
l00370	doc/html/gateway_8c-source.html	/^<a name="l00370"><\/a>00370     <span class="comment">\/* Set the time when wifidog started *\/<\/span>$/;"	a
l00371	doc/html/gateway_8c-source.html	/^<a name="l00371"><\/a>00371         <span class="keywordflow">if<\/span> (!started_time) {$/;"	a
l00372	doc/html/gateway_8c-source.html	/^<a name="l00372"><\/a>00372                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Setting started_time"<\/span>);$/;"	a
l00373	doc/html/gateway_8c-source.html	/^<a name="l00373"><\/a>00373                 started_time = time(NULL);$/;"	a
l00374	doc/html/gateway_8c-source.html	/^<a name="l00374"><\/a>00374         }$/;"	a
l00375	doc/html/gateway_8c-source.html	/^<a name="l00375"><\/a>00375         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (started_time &lt; MINIMUM_STARTED_TIME) {$/;"	a
l00376	doc/html/gateway_8c-source.html	/^<a name="l00376"><\/a>00376                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"Detected possible clock skew - re-setting started_time"<\/span>);$/;"	a
l00377	doc/html/gateway_8c-source.html	/^<a name="l00377"><\/a>00377                 started_time = time(NULL);$/;"	a
l00378	doc/html/gateway_8c-source.html	/^<a name="l00378"><\/a>00378         }$/;"	a
l00379	doc/html/gateway_8c-source.html	/^<a name="l00379"><\/a>00379 $/;"	a
l00380	doc/html/gateway_8c-source.html	/^<a name="l00380"><\/a>00380         <span class="comment">\/* If we don't have the Gateway IP address, get it. Can't fail. *\/<\/span>$/;"	a
l00381	doc/html/gateway_8c-source.html	/^<a name="l00381"><\/a>00381         <span class="keywordflow">if<\/span> (!config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>) {$/;"	a
l00382	doc/html/gateway_8c-source.html	/^<a name="l00382"><\/a>00382                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Finding IP address of %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00383	doc/html/gateway_8c-source.html	/^<a name="l00383"><\/a>00383                 <span class="keywordflow">if<\/span> ((config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a> = get_iface_ip(config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>)) == NULL) {$/;"	a
l00384	doc/html/gateway_8c-source.html	/^<a name="l00384"><\/a>00384                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not get IP address information of %s, exiting..."<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00385	doc/html/gateway_8c-source.html	/^<a name="l00385"><\/a>00385                         exit(1);$/;"	a
l00386	doc/html/gateway_8c-source.html	/^<a name="l00386"><\/a>00386                 }$/;"	a
l00387	doc/html/gateway_8c-source.html	/^<a name="l00387"><\/a>00387                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"%s = %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>, config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>);$/;"	a
l00388	doc/html/gateway_8c-source.html	/^<a name="l00388"><\/a>00388         }$/;"	a
l00389	doc/html/gateway_8c-source.html	/^<a name="l00389"><\/a>00389 $/;"	a
l00390	doc/html/gateway_8c-source.html	/^<a name="l00390"><\/a>00390         <span class="comment">\/* If we don't have the Gateway ID, construct it from the internal MAC address.<\/span>$/;"	a
l00391	doc/html/gateway_8c-source.html	/^<a name="l00391"><\/a>00391 <span class="comment">         * "Can't fail" so exit() if the impossible happens. *\/<\/span>$/;"	a
l00392	doc/html/gateway_8c-source.html	/^<a name="l00392"><\/a>00392         <span class="keywordflow">if<\/span> (!config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>) {$/;"	a
l00393	doc/html/gateway_8c-source.html	/^<a name="l00393"><\/a>00393         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Finding MAC address of %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00394	doc/html/gateway_8c-source.html	/^<a name="l00394"><\/a>00394         <span class="keywordflow">if<\/span> ((config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a> = get_iface_mac(config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>)) == NULL) {$/;"	a
l00395	doc/html/gateway_8c-source.html	/^<a name="l00395"><\/a>00395                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not get MAC address information of %s, exiting..."<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00396	doc/html/gateway_8c-source.html	/^<a name="l00396"><\/a>00396                         exit(1);$/;"	a
l00397	doc/html/gateway_8c-source.html	/^<a name="l00397"><\/a>00397                 }$/;"	a
l00398	doc/html/gateway_8c-source.html	/^<a name="l00398"><\/a>00398                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"%s = %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>, config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>);$/;"	a
l00399	doc/html/gateway_8c-source.html	/^<a name="l00399"><\/a>00399         }$/;"	a
l00400	doc/html/gateway_8c-source.html	/^<a name="l00400"><\/a>00400 $/;"	a
l00401	doc/html/gateway_8c-source.html	/^<a name="l00401"><\/a>00401         <span class="comment">\/* Initializes the web server *\/<\/span>$/;"	a
l00402	doc/html/gateway_8c-source.html	/^<a name="l00402"><\/a>00402         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Creating web server on %s:%d"<\/span>, config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>, config-&gt;<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>);$/;"	a
l00403	doc/html/gateway_8c-source.html	/^<a name="l00403"><\/a>00403         <span class="keywordflow">if<\/span> ((webserver = httpdCreate(config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>, config-&gt;<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>)) == NULL) {$/;"	a
l00404	doc/html/gateway_8c-source.html	/^<a name="l00404"><\/a>00404                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not create web server: %s"<\/span>, strerror(errno));$/;"	a
l00405	doc/html/gateway_8c-source.html	/^<a name="l00405"><\/a>00405                 exit(1);$/;"	a
l00406	doc/html/gateway_8c-source.html	/^<a name="l00406"><\/a>00406         }$/;"	a
l00407	doc/html/gateway_8c-source.html	/^<a name="l00407"><\/a>00407 $/;"	a
l00408	doc/html/gateway_8c-source.html	/^<a name="l00408"><\/a>00408         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Assigning callbacks to web server"<\/span>);$/;"	a
l00409	doc/html/gateway_8c-source.html	/^<a name="l00409"><\/a>00409         httpdAddCContent(webserver, <span class="stringliteral">"\/"<\/span>, <span class="stringliteral">"wifidog"<\/span>, 0, NULL, <a class="code" href="http_8c.html#a61e9e265a1529e600dd83ef91cd0d14" title="Callback for libhttpd.">http_callback_wifidog<\/a>);$/;"	a
l00410	doc/html/gateway_8c-source.html	/^<a name="l00410"><\/a>00410         httpdAddCContent(webserver, <span class="stringliteral">"\/wifidog"<\/span>, <span class="stringliteral">""<\/span>, 0, NULL, <a class="code" href="http_8c.html#a61e9e265a1529e600dd83ef91cd0d14" title="Callback for libhttpd.">http_callback_wifidog<\/a>);$/;"	a
l00411	doc/html/gateway_8c-source.html	/^<a name="l00411"><\/a>00411         httpdAddCContent(webserver, <span class="stringliteral">"\/wifidog"<\/span>, <span class="stringliteral">"about"<\/span>, 0, NULL, <a class="code" href="http_8c.html#f306222145f5e2699ed19e716df0fb35" title="Callback for libhttpd.">http_callback_about<\/a>);$/;"	a
l00412	doc/html/gateway_8c-source.html	/^<a name="l00412"><\/a>00412         httpdAddCContent(webserver, <span class="stringliteral">"\/wifidog"<\/span>, <span class="stringliteral">"status"<\/span>, 0, NULL, <a class="code" href="http_8c.html#676d4eaab18f4187387db5c1236b55b8" title="Callback for libhttpd.">http_callback_status<\/a>);$/;"	a
l00413	doc/html/gateway_8c-source.html	/^<a name="l00413"><\/a>00413         httpdAddCContent(webserver, <span class="stringliteral">"\/wifidog"<\/span>, <span class="stringliteral">"auth"<\/span>, 0, NULL, <a class="code" href="http_8c.html#f5d4744903ff7f32bd96a8cb85af299e" title="Callback for libhttpd, main entry point post login for auth confirmation.">http_callback_auth<\/a>);$/;"	a
l00414	doc/html/gateway_8c-source.html	/^<a name="l00414"><\/a>00414 $/;"	a
l00415	doc/html/gateway_8c-source.html	/^<a name="l00415"><\/a>00415         httpdAddC404Content(webserver, <a class="code" href="http_8c.html#7164c2c972bb0668cf8a7ac5c5f2a0a6" title="Callback for libhttpd, main entry point for captive portal.">http_callback_404<\/a>);$/;"	a
l00416	doc/html/gateway_8c-source.html	/^<a name="l00416"><\/a>00416 $/;"	a
l00417	doc/html/gateway_8c-source.html	/^<a name="l00417"><\/a>00417         <span class="comment">\/* Reset the firewall (if WiFiDog crashed) *\/<\/span>$/;"	a
l00418	doc/html/gateway_8c-source.html	/^<a name="l00418"><\/a>00418         fw_destroy();$/;"	a
l00419	doc/html/gateway_8c-source.html	/^<a name="l00419"><\/a>00419         <span class="comment">\/* Then initialize it *\/<\/span>$/;"	a
l00420	doc/html/gateway_8c-source.html	/^<a name="l00420"><\/a>00420         <span class="keywordflow">if<\/span> (!fw_init()) {$/;"	a
l00421	doc/html/gateway_8c-source.html	/^<a name="l00421"><\/a>00421                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to initialize firewall"<\/span>);$/;"	a
l00422	doc/html/gateway_8c-source.html	/^<a name="l00422"><\/a>00422                 exit(1);$/;"	a
l00423	doc/html/gateway_8c-source.html	/^<a name="l00423"><\/a>00423         }$/;"	a
l00424	doc/html/gateway_8c-source.html	/^<a name="l00424"><\/a>00424 $/;"	a
l00425	doc/html/gateway_8c-source.html	/^<a name="l00425"><\/a>00425         <span class="comment">\/* Start clean up thread *\/<\/span>$/;"	a
l00426	doc/html/gateway_8c-source.html	/^<a name="l00426"><\/a>00426         result = pthread_create(&amp;tid_fw_counter, NULL, (<span class="keywordtype">void<\/span> *)<a class="code" href="auth_8c.html#0d343be361ec134828fe457a4d4b94e7" title="Periodically check if connections expired.">thread_client_timeout_check<\/a>, NULL);$/;"	a
l00427	doc/html/gateway_8c-source.html	/^<a name="l00427"><\/a>00427         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00428	doc/html/gateway_8c-source.html	/^<a name="l00428"><\/a>00428             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (fw_counter) - exiting"<\/span>);$/;"	a
l00429	doc/html/gateway_8c-source.html	/^<a name="l00429"><\/a>00429             termination_handler(0);$/;"	a
l00430	doc/html/gateway_8c-source.html	/^<a name="l00430"><\/a>00430         }$/;"	a
l00431	doc/html/gateway_8c-source.html	/^<a name="l00431"><\/a>00431         pthread_detach(tid_fw_counter);$/;"	a
l00432	doc/html/gateway_8c-source.html	/^<a name="l00432"><\/a>00432 $/;"	a
l00433	doc/html/gateway_8c-source.html	/^<a name="l00433"><\/a>00433         <span class="comment">\/* Start control thread *\/<\/span>$/;"	a
l00434	doc/html/gateway_8c-source.html	/^<a name="l00434"><\/a>00434         result = pthread_create(&amp;tid, NULL, (<span class="keywordtype">void<\/span> *)<a class="code" href="wdctl__thread_8c.html#620bac3ec925a104631e817432f8a04e" title="Listen for WiFiDog control messages on a unix domain socket.">thread_wdctl<\/a>, (<span class="keywordtype">void<\/span> *)safe_strdup(config-&gt;<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a>));$/;"	a
l00435	doc/html/gateway_8c-source.html	/^<a name="l00435"><\/a>00435         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00436	doc/html/gateway_8c-source.html	/^<a name="l00436"><\/a>00436                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (wdctl) - exiting"<\/span>);$/;"	a
l00437	doc/html/gateway_8c-source.html	/^<a name="l00437"><\/a>00437                 termination_handler(0);$/;"	a
l00438	doc/html/gateway_8c-source.html	/^<a name="l00438"><\/a>00438         }$/;"	a
l00439	doc/html/gateway_8c-source.html	/^<a name="l00439"><\/a>00439         pthread_detach(tid);$/;"	a
l00440	doc/html/gateway_8c-source.html	/^<a name="l00440"><\/a>00440         $/;"	a
l00441	doc/html/gateway_8c-source.html	/^<a name="l00441"><\/a>00441         <span class="comment">\/* Start heartbeat thread *\/<\/span>$/;"	a
l00442	doc/html/gateway_8c-source.html	/^<a name="l00442"><\/a>00442         result = pthread_create(&amp;tid_ping, NULL, (<span class="keywordtype">void<\/span> *)<a class="code" href="ping__thread_8c.html#3b019c5b71e02b8f475285a22222b296" title="Periodically checks on the auth server to see if it&amp;#39;s alive.">thread_ping<\/a>, NULL);$/;"	a
l00443	doc/html/gateway_8c-source.html	/^<a name="l00443"><\/a>00443         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00444	doc/html/gateway_8c-source.html	/^<a name="l00444"><\/a>00444             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (ping) - exiting"<\/span>);$/;"	a
l00445	doc/html/gateway_8c-source.html	/^<a name="l00445"><\/a>00445                 termination_handler(0);$/;"	a
l00446	doc/html/gateway_8c-source.html	/^<a name="l00446"><\/a>00446         }$/;"	a
l00447	doc/html/gateway_8c-source.html	/^<a name="l00447"><\/a>00447         pthread_detach(tid_ping);$/;"	a
l00448	doc/html/gateway_8c-source.html	/^<a name="l00448"><\/a>00448         $/;"	a
l00449	doc/html/gateway_8c-source.html	/^<a name="l00449"><\/a>00449         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Waiting for connections"<\/span>);$/;"	a
l00450	doc/html/gateway_8c-source.html	/^<a name="l00450"><\/a>00450         <span class="keywordflow">while<\/span>(1) {$/;"	a
l00451	doc/html/gateway_8c-source.html	/^<a name="l00451"><\/a>00451                 r = httpdGetConnection(webserver, NULL);$/;"	a
l00452	doc/html/gateway_8c-source.html	/^<a name="l00452"><\/a>00452 $/;"	a
l00453	doc/html/gateway_8c-source.html	/^<a name="l00453"><\/a>00453                 <span class="comment">\/* We can't convert this to a switch because there might be<\/span>$/;"	a
l00454	doc/html/gateway_8c-source.html	/^<a name="l00454"><\/a>00454 <span class="comment">                 * values that are not -1, 0 or 1. *\/<\/span>$/;"	a
l00455	doc/html/gateway_8c-source.html	/^<a name="l00455"><\/a>00455                 <span class="keywordflow">if<\/span> (webserver-&gt;lastError == -1) {$/;"	a
l00456	doc/html/gateway_8c-source.html	/^<a name="l00456"><\/a>00456                         <span class="comment">\/* Interrupted system call *\/<\/span>$/;"	a
l00457	doc/html/gateway_8c-source.html	/^<a name="l00457"><\/a>00457                         <span class="keywordflow">continue<\/span>; <span class="comment">\/* restart loop *\/<\/span>$/;"	a
l00458	doc/html/gateway_8c-source.html	/^<a name="l00458"><\/a>00458                 }$/;"	a
l00459	doc/html/gateway_8c-source.html	/^<a name="l00459"><\/a>00459                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (webserver-&gt;lastError &lt; -1) {$/;"	a
l00460	doc/html/gateway_8c-source.html	/^<a name="l00460"><\/a>00460                         <span class="comment">\/*<\/span>$/;"	a
l00461	doc/html/gateway_8c-source.html	/^<a name="l00461"><\/a>00461 <span class="comment">                         * FIXME<\/span>$/;"	a
l00462	doc/html/gateway_8c-source.html	/^<a name="l00462"><\/a>00462 <span class="comment">                         * An error occurred - should we abort?<\/span>$/;"	a
l00463	doc/html/gateway_8c-source.html	/^<a name="l00463"><\/a>00463 <span class="comment">                         * reboot the device ?<\/span>$/;"	a
l00464	doc/html/gateway_8c-source.html	/^<a name="l00464"><\/a>00464 <span class="comment">                         *\/<\/span>$/;"	a
l00465	doc/html/gateway_8c-source.html	/^<a name="l00465"><\/a>00465                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: httpdGetConnection returned unexpected value %d, exiting."<\/span>, webserver-&gt;lastError);$/;"	a
l00466	doc/html/gateway_8c-source.html	/^<a name="l00466"><\/a>00466                         termination_handler(0);$/;"	a
l00467	doc/html/gateway_8c-source.html	/^<a name="l00467"><\/a>00467                 }$/;"	a
l00468	doc/html/gateway_8c-source.html	/^<a name="l00468"><\/a>00468                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (r != NULL) {$/;"	a
l00469	doc/html/gateway_8c-source.html	/^<a name="l00469"><\/a>00469                         <span class="comment">\/*<\/span>$/;"	a
l00470	doc/html/gateway_8c-source.html	/^<a name="l00470"><\/a>00470 <span class="comment">                         * We got a connection<\/span>$/;"	a
l00471	doc/html/gateway_8c-source.html	/^<a name="l00471"><\/a>00471 <span class="comment">                         *<\/span>$/;"	a
l00472	doc/html/gateway_8c-source.html	/^<a name="l00472"><\/a>00472 <span class="comment">                         * We should create another thread<\/span>$/;"	a
l00473	doc/html/gateway_8c-source.html	/^<a name="l00473"><\/a>00473 <span class="comment">                         *\/<\/span>$/;"	a
l00474	doc/html/gateway_8c-source.html	/^<a name="l00474"><\/a>00474                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Received connection from %s, spawning worker thread"<\/span>, r-&gt;clientAddr);$/;"	a
l00475	doc/html/gateway_8c-source.html	/^<a name="l00475"><\/a>00475                         <span class="comment">\/* The void**'s are a simulation of the normal C<\/span>$/;"	a
l00476	doc/html/gateway_8c-source.html	/^<a name="l00476"><\/a>00476 <span class="comment">                         * function calling sequence. *\/<\/span>$/;"	a
l00477	doc/html/gateway_8c-source.html	/^<a name="l00477"><\/a>00477                         params = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(2 * <span class="keyword">sizeof<\/span>(<span class="keywordtype">void<\/span> *));$/;"	a
l00478	doc/html/gateway_8c-source.html	/^<a name="l00478"><\/a>00478                         *params = webserver;$/;"	a
l00479	doc/html/gateway_8c-source.html	/^<a name="l00479"><\/a>00479                         *(params + 1) = r;$/;"	a
l00480	doc/html/gateway_8c-source.html	/^<a name="l00480"><\/a>00480 $/;"	a
l00481	doc/html/gateway_8c-source.html	/^<a name="l00481"><\/a>00481                         result = pthread_create(&amp;tid, NULL, (<span class="keywordtype">void<\/span> *)<a class="code" href="httpd__thread_8c.html#2925feb4c55460a80bd30f6ef363779d" title="Handle a web request.">thread_httpd<\/a>, (<span class="keywordtype">void<\/span> *)params);$/;"	a
l00482	doc/html/gateway_8c-source.html	/^<a name="l00482"><\/a>00482                         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00483	doc/html/gateway_8c-source.html	/^<a name="l00483"><\/a>00483                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (httpd) - exiting"<\/span>);$/;"	a
l00484	doc/html/gateway_8c-source.html	/^<a name="l00484"><\/a>00484                                 termination_handler(0);$/;"	a
l00485	doc/html/gateway_8c-source.html	/^<a name="l00485"><\/a>00485                         }$/;"	a
l00486	doc/html/gateway_8c-source.html	/^<a name="l00486"><\/a>00486                         pthread_detach(tid);$/;"	a
l00487	doc/html/gateway_8c-source.html	/^<a name="l00487"><\/a>00487                 }$/;"	a
l00488	doc/html/gateway_8c-source.html	/^<a name="l00488"><\/a>00488                 <span class="keywordflow">else<\/span> {$/;"	a
l00489	doc/html/gateway_8c-source.html	/^<a name="l00489"><\/a>00489                         <span class="comment">\/* webserver-&gt;lastError should be 2 *\/<\/span>$/;"	a
l00490	doc/html/gateway_8c-source.html	/^<a name="l00490"><\/a>00490                         <span class="comment">\/* XXX We failed an ACL.... No handling because<\/span>$/;"	a
l00491	doc/html/gateway_8c-source.html	/^<a name="l00491"><\/a>00491 <span class="comment">                         * we don't set any... *\/<\/span>$/;"	a
l00492	doc/html/gateway_8c-source.html	/^<a name="l00492"><\/a>00492                 }$/;"	a
l00493	doc/html/gateway_8c-source.html	/^<a name="l00493"><\/a>00493         }$/;"	a
l00494	doc/html/gateway_8c-source.html	/^<a name="l00494"><\/a>00494 $/;"	a
l00495	doc/html/gateway_8c-source.html	/^<a name="l00495"><\/a>00495         <span class="comment">\/* never reached *\/<\/span>$/;"	a
l00496	doc/html/gateway_8c-source.html	/^<a name="l00496"><\/a>00496 }$/;"	a
l00497	doc/html/gateway_8c-source.html	/^<a name="l00497"><\/a>00497 $/;"	a
l00499	doc/html/gateway_8c-source.html	/^<a name="l00499"><\/a>00499 <span class="keywordtype">int<\/span> main(<span class="keywordtype">int<\/span> argc, <span class="keywordtype">char<\/span> **argv) {$/;"	a
l00500	doc/html/gateway_8c-source.html	/^<a name="l00500"><\/a>00500 $/;"	a
l00501	doc/html/gateway_8c-source.html	/^<a name="l00501"><\/a>00501         <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00502	doc/html/gateway_8c-source.html	/^<a name="l00502"><\/a>00502         <a class="code" href="conf_8c.html#068a358868c409bbd99d7eef3c988866" title="Initialise the conf system.">config_init<\/a>();$/;"	a
l00503	doc/html/gateway_8c-source.html	/^<a name="l00503"><\/a>00503 $/;"	a
l00504	doc/html/gateway_8c-source.html	/^<a name="l00504"><\/a>00504         <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(argc, argv);$/;"	a
l00505	doc/html/gateway_8c-source.html	/^<a name="l00505"><\/a>00505 $/;"	a
l00506	doc/html/gateway_8c-source.html	/^<a name="l00506"><\/a>00506         <span class="comment">\/* Initialize the config *\/<\/span>$/;"	a
l00507	doc/html/gateway_8c-source.html	/^<a name="l00507"><\/a>00507         <a class="code" href="conf_8c.html#d3faac0efa0ac4c1032c0c54f7e93711" title="Reads the configuration file.">config_read<\/a>(config-&gt;<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>);$/;"	a
l00508	doc/html/gateway_8c-source.html	/^<a name="l00508"><\/a>00508         <a class="code" href="conf_8c.html#0f9540b3f729ba3b3d31b613d3eca364" title="Check that the configuration is valid.">config_validate<\/a>();$/;"	a
l00509	doc/html/gateway_8c-source.html	/^<a name="l00509"><\/a>00509 $/;"	a
l00510	doc/html/gateway_8c-source.html	/^<a name="l00510"><\/a>00510         <span class="comment">\/* Initializes the linked list of connected clients *\/<\/span>$/;"	a
l00511	doc/html/gateway_8c-source.html	/^<a name="l00511"><\/a>00511         <a class="code" href="client__list_8c.html#d624b5c33e086131f3af7b52589f5fd1" title="Initializes the client list.">client_list_init<\/a>();$/;"	a
l00512	doc/html/gateway_8c-source.html	/^<a name="l00512"><\/a>00512 $/;"	a
l00513	doc/html/gateway_8c-source.html	/^<a name="l00513"><\/a>00513         <span class="comment">\/* Init the signals to catch chld\/quit\/etc *\/<\/span>$/;"	a
l00514	doc/html/gateway_8c-source.html	/^<a name="l00514"><\/a>00514         init_signals();$/;"	a
l00515	doc/html/gateway_8c-source.html	/^<a name="l00515"><\/a>00515 $/;"	a
l00516	doc/html/gateway_8c-source.html	/^<a name="l00516"><\/a>00516         <span class="keywordflow">if<\/span> (restart_orig_pid) {$/;"	a
l00517	doc/html/gateway_8c-source.html	/^<a name="l00517"><\/a>00517                 <span class="comment">\/*<\/span>$/;"	a
l00518	doc/html/gateway_8c-source.html	/^<a name="l00518"><\/a>00518 <span class="comment">                 * We were restarted and our parent is waiting for us to talk to it over the socket<\/span>$/;"	a
l00519	doc/html/gateway_8c-source.html	/^<a name="l00519"><\/a>00519 <span class="comment">                 *\/<\/span>$/;"	a
l00520	doc/html/gateway_8c-source.html	/^<a name="l00520"><\/a>00520                 get_clients_from_parent();$/;"	a
l00521	doc/html/gateway_8c-source.html	/^<a name="l00521"><\/a>00521 $/;"	a
l00522	doc/html/gateway_8c-source.html	/^<a name="l00522"><\/a>00522                 <span class="comment">\/*<\/span>$/;"	a
l00523	doc/html/gateway_8c-source.html	/^<a name="l00523"><\/a>00523 <span class="comment">                 * At this point the parent will start destroying itself and the firewall. Let it finish it's job before we continue<\/span>$/;"	a
l00524	doc/html/gateway_8c-source.html	/^<a name="l00524"><\/a>00524 <span class="comment">                 *\/<\/span>$/;"	a
l00525	doc/html/gateway_8c-source.html	/^<a name="l00525"><\/a>00525                 <span class="keywordflow">while<\/span> (kill(restart_orig_pid, 0) != -1) {$/;"	a
l00526	doc/html/gateway_8c-source.html	/^<a name="l00526"><\/a>00526                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Waiting for parent PID %d to die before continuing loading"<\/span>, restart_orig_pid);$/;"	a
l00527	doc/html/gateway_8c-source.html	/^<a name="l00527"><\/a>00527                         sleep(1);$/;"	a
l00528	doc/html/gateway_8c-source.html	/^<a name="l00528"><\/a>00528                 }$/;"	a
l00529	doc/html/gateway_8c-source.html	/^<a name="l00529"><\/a>00529 $/;"	a
l00530	doc/html/gateway_8c-source.html	/^<a name="l00530"><\/a>00530                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Parent PID %d seems to be dead. Continuing loading."<\/span>);$/;"	a
l00531	doc/html/gateway_8c-source.html	/^<a name="l00531"><\/a>00531         }$/;"	a
l00532	doc/html/gateway_8c-source.html	/^<a name="l00532"><\/a>00532 $/;"	a
l00533	doc/html/gateway_8c-source.html	/^<a name="l00533"><\/a>00533         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a>) {$/;"	a
l00534	doc/html/gateway_8c-source.html	/^<a name="l00534"><\/a>00534 $/;"	a
l00535	doc/html/gateway_8c-source.html	/^<a name="l00535"><\/a>00535                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Forking into background"<\/span>);$/;"	a
l00536	doc/html/gateway_8c-source.html	/^<a name="l00536"><\/a>00536 $/;"	a
l00537	doc/html/gateway_8c-source.html	/^<a name="l00537"><\/a>00537                 <span class="keywordflow">switch<\/span>(safe_fork()) {$/;"	a
l00538	doc/html/gateway_8c-source.html	/^<a name="l00538"><\/a>00538                         <span class="keywordflow">case<\/span> 0: <span class="comment">\/* child *\/<\/span>$/;"	a
l00539	doc/html/gateway_8c-source.html	/^<a name="l00539"><\/a>00539                                 setsid();$/;"	a
l00540	doc/html/gateway_8c-source.html	/^<a name="l00540"><\/a>00540                                 append_x_restartargv();$/;"	a
l00541	doc/html/gateway_8c-source.html	/^<a name="l00541"><\/a>00541                                 main_loop();$/;"	a
l00542	doc/html/gateway_8c-source.html	/^<a name="l00542"><\/a>00542                                 <span class="keywordflow">break<\/span>;$/;"	a
l00543	doc/html/gateway_8c-source.html	/^<a name="l00543"><\/a>00543 $/;"	a
l00544	doc/html/gateway_8c-source.html	/^<a name="l00544"><\/a>00544                         <span class="keywordflow">default<\/span>: <span class="comment">\/* parent *\/<\/span>$/;"	a
l00545	doc/html/gateway_8c-source.html	/^<a name="l00545"><\/a>00545                                 exit(0);$/;"	a
l00546	doc/html/gateway_8c-source.html	/^<a name="l00546"><\/a>00546                                 <span class="keywordflow">break<\/span>;$/;"	a
l00547	doc/html/gateway_8c-source.html	/^<a name="l00547"><\/a>00547                 }$/;"	a
l00548	doc/html/gateway_8c-source.html	/^<a name="l00548"><\/a>00548         }$/;"	a
l00549	doc/html/gateway_8c-source.html	/^<a name="l00549"><\/a>00549         <span class="keywordflow">else<\/span> {$/;"	a
l00550	doc/html/gateway_8c-source.html	/^<a name="l00550"><\/a>00550                 append_x_restartargv();$/;"	a
l00551	doc/html/gateway_8c-source.html	/^<a name="l00551"><\/a>00551                 main_loop();$/;"	a
l00552	doc/html/gateway_8c-source.html	/^<a name="l00552"><\/a>00552         }$/;"	a
l00553	doc/html/gateway_8c-source.html	/^<a name="l00553"><\/a>00553 $/;"	a
l00554	doc/html/gateway_8c-source.html	/^<a name="l00554"><\/a>00554         <span class="keywordflow">return<\/span>(0); <span class="comment">\/* never reached *\/<\/span>$/;"	a
l00555	doc/html/gateway_8c-source.html	/^<a name="l00555"><\/a>00555 }$/;"	a
l00001	doc/html/gateway_8h-source.html	/^<h1>gateway.h<\/h1><a href="gateway_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/gateway_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/gateway_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/gateway_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/gateway_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/gateway_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/gateway_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/gateway_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/gateway_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/gateway_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/gateway_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/gateway_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/gateway_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/gateway_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/gateway_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/gateway_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/gateway_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/gateway_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/gateway_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/gateway_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/gateway_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: gateway.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	doc/html/gateway_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _GATEWAY_H_<\/span>$/;"	a
l00028	doc/html/gateway_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _GATEWAY_H_<\/span>$/;"	a
l00029	doc/html/gateway_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span> $/;"	a
l00031	doc/html/gateway_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="keywordtype">void<\/span> termination_handler(<span class="keywordtype">int<\/span> s);$/;"	a
l00032	doc/html/gateway_8h-source.html	/^<a name="l00032"><\/a>00032 $/;"	a
l00033	doc/html/gateway_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#endif <\/span><span class="comment">\/* _GATEWAY_H_ *\/<\/span>$/;"	a
_details	doc/html/gateway_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
d850f6ceb76de4be944cdedca2420db5	doc/html/gateway_8h.html	/^<a class="anchor" name="d850f6ceb76de4be944cdedca2420db5"><\/a><!-- doxytag: member="gateway.h::termination_handler" ref="d850f6ceb76de4be944cdedca2420db5" args="(int s)" -->$/;"	a
index__	doc/html/globals.html	/^<h3><a class="anchor" name="index__">- _ -<\/a><\/h3><ul>$/;"	a
index_a	doc/html/globals.html	/^<h3><a class="anchor" name="index_a">- a -<\/a><\/h3><ul>$/;"	a
index_c	doc/html/globals.html	/^<h3><a class="anchor" name="index_c">- c -<\/a><\/h3><ul>$/;"	a
index_d	doc/html/globals.html	/^<h3><a class="anchor" name="index_d">- d -<\/a><\/h3><ul>$/;"	a
index_e	doc/html/globals.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_f	doc/html/globals.html	/^<h3><a class="anchor" name="index_f">- f -<\/a><\/h3><ul>$/;"	a
index_g	doc/html/globals.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_h	doc/html/globals.html	/^<h3><a class="anchor" name="index_h">- h -<\/a><\/h3><ul>$/;"	a
index_i	doc/html/globals.html	/^<h3><a class="anchor" name="index_i">- i -<\/a><\/h3><ul>$/;"	a
index_m	doc/html/globals.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_n	doc/html/globals.html	/^<h3><a class="anchor" name="index_n">- n -<\/a><\/h3><ul>$/;"	a
index_p	doc/html/globals.html	/^<h3><a class="anchor" name="index_p">- p -<\/a><\/h3><ul>$/;"	a
index_r	doc/html/globals.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_s	doc/html/globals.html	/^<h3><a class="anchor" name="index_s">- s -<\/a><\/h3><ul>$/;"	a
index_t	doc/html/globals.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index_w	doc/html/globals.html	/^<h3><a class="anchor" name="index_w">- w -<\/a><\/h3><ul>$/;"	a
index_d	doc/html/globals_defs.html	/^<h3><a class="anchor" name="index_d">- d -<\/a><\/h3><ul>$/;"	a
index_e	doc/html/globals_defs.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_g	doc/html/globals_defs.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_m	doc/html/globals_defs.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_n	doc/html/globals_defs.html	/^<h3><a class="anchor" name="index_n">- n -<\/a><\/h3><ul>$/;"	a
index_r	doc/html/globals_defs.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_t	doc/html/globals_defs.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index__	doc/html/globals_func.html	/^<h3><a class="anchor" name="index__">- _ -<\/a><\/h3><ul>$/;"	a
index_a	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_a">- a -<\/a><\/h3><ul>$/;"	a
index_c	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_c">- c -<\/a><\/h3><ul>$/;"	a
index_e	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_f	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_f">- f -<\/a><\/h3><ul>$/;"	a
index_g	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_h	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_h">- h -<\/a><\/h3><ul>$/;"	a
index_i	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_i">- i -<\/a><\/h3><ul>$/;"	a
index_m	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_p	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_p">- p -<\/a><\/h3><ul>$/;"	a
index_r	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_s	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_s">- s -<\/a><\/h3><ul>$/;"	a
index_t	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index_w	doc/html/globals_func.html	/^<h3><a class="anchor" name="index_w">- w -<\/a><\/h3><ul>$/;"	a
l00001	doc/html/http_8c-source.html	/^<h1>http.c<\/h1><a href="http_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/http_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/http_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/http_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/http_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/http_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/http_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/http_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/http_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/http_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/http_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/http_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/http_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/http_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/http_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/http_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/http_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/http_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/http_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/http_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/http_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: http.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00030	doc/html/http_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00031	doc/html/http_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor"><\/span>$/;"	a
l00032	doc/html/http_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00033	doc/html/http_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00034	doc/html/http_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00035	doc/html/http_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00036	doc/html/http_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00037	doc/html/http_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00038	doc/html/http_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00039	doc/html/http_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;sys\/stat.h&gt;<\/span>$/;"	a
l00040	doc/html/http_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;fcntl.h&gt;<\/span>$/;"	a
l00041	doc/html/http_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00042	doc/html/http_8c-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	doc/html/http_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00044	doc/html/http_8c-source.html	/^<a name="l00044"><\/a>00044 $/;"	a
l00045	doc/html/http_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00046	doc/html/http_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00047	doc/html/http_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00048	doc/html/http_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00049	doc/html/http_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00050	doc/html/http_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "<a class="code" href="http_8h.html" title="HTTP IO functions.">http.h<\/a>"<\/span>$/;"	a
l00051	doc/html/http_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00052	doc/html/http_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00053	doc/html/http_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00054	doc/html/http_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00055	doc/html/http_8c-source.html	/^<a name="l00055"><\/a>00055 $/;"	a
l00056	doc/html/http_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00057	doc/html/http_8c-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00058	doc/html/http_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00059	doc/html/http_8c-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00060	doc/html/http_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="keyword">extern<\/span> pthread_mutex_t  <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00061	doc/html/http_8c-source.html	/^<a name="l00061"><\/a>00061 $/;"	a
l00063	doc/html/http_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="keywordtype">void<\/span>$/;"	a
l00064	doc/html/http_8c-source.html	/^<a name="l00064"><\/a><a class="code" href="http_8h.html#7164c2c972bb0668cf8a7ac5c5f2a0a6">00064<\/a> <a class="code" href="http_8c.html#7164c2c972bb0668cf8a7ac5c5f2a0a6" title="Callback for libhttpd, main entry point for captive portal.">http_callback_404<\/a>(httpd *webserver, request *r)$/;"	a
l00065	doc/html/http_8c-source.html	/^<a name="l00065"><\/a>00065 {$/;"	a
l00066	doc/html/http_8c-source.html	/^<a name="l00066"><\/a>00066         <span class="keywordtype">char<\/span>            tmp_url[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>],$/;"	a
l00067	doc/html/http_8c-source.html	/^<a name="l00067"><\/a>00067                         *url;$/;"	a
l00068	doc/html/http_8c-source.html	/^<a name="l00068"><\/a>00068         <a class="code" href="structs__config.html">s_config<\/a>        *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00069	doc/html/http_8c-source.html	/^<a name="l00069"><\/a>00069         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00070	doc/html/http_8c-source.html	/^<a name="l00070"><\/a>00070 $/;"	a
l00071	doc/html/http_8c-source.html	/^<a name="l00071"><\/a>00071         memset(tmp_url, 0, <span class="keyword">sizeof<\/span>(tmp_url));$/;"	a
l00072	doc/html/http_8c-source.html	/^<a name="l00072"><\/a>00072         <span class="comment">\/* <\/span>$/;"	a
l00073	doc/html/http_8c-source.html	/^<a name="l00073"><\/a>00073 <span class="comment">         * XXX Note the code below assumes that the client's request is a plain<\/span>$/;"	a
l00074	doc/html/http_8c-source.html	/^<a name="l00074"><\/a>00074 <span class="comment">         * http request to a standard port. At any rate, this handler is called only<\/span>$/;"	a
l00075	doc/html/http_8c-source.html	/^<a name="l00075"><\/a>00075 <span class="comment">         * if the internet\/auth server is down so it's not a huge loss, but still.<\/span>$/;"	a
l00076	doc/html/http_8c-source.html	/^<a name="l00076"><\/a>00076 <span class="comment">         *\/<\/span>$/;"	a
l00077	doc/html/http_8c-source.html	/^<a name="l00077"><\/a>00077         snprintf(tmp_url, (<span class="keyword">sizeof<\/span>(tmp_url) - 1), <span class="stringliteral">"http:\/\/%s%s%s%s"<\/span>,$/;"	a
l00078	doc/html/http_8c-source.html	/^<a name="l00078"><\/a>00078                         r-&gt;request.host,$/;"	a
l00079	doc/html/http_8c-source.html	/^<a name="l00079"><\/a>00079                         r-&gt;request.path,$/;"	a
l00080	doc/html/http_8c-source.html	/^<a name="l00080"><\/a>00080                         r-&gt;request.query[0] ? <span class="stringliteral">"?"<\/span> : <span class="stringliteral">""<\/span>,$/;"	a
l00081	doc/html/http_8c-source.html	/^<a name="l00081"><\/a>00081                         r-&gt;request.query);$/;"	a
l00082	doc/html/http_8c-source.html	/^<a name="l00082"><\/a>00082         url = httpdUrlEncode(tmp_url);$/;"	a
l00083	doc/html/http_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	doc/html/http_8c-source.html	/^<a name="l00084"><\/a>00084         <span class="keywordflow">if<\/span> (!is_online()) {$/;"	a
l00085	doc/html/http_8c-source.html	/^<a name="l00085"><\/a>00085                 <span class="comment">\/* The internet connection is down at the moment  - apologize and do not redirect anywhere *\/<\/span>$/;"	a
l00086	doc/html/http_8c-source.html	/^<a name="l00086"><\/a>00086                 <span class="keywordtype">char<\/span> * buf;$/;"	a
l00087	doc/html/http_8c-source.html	/^<a name="l00087"><\/a>00087                 safe_asprintf(&amp;buf, $/;"	a
l00088	doc/html/http_8c-source.html	/^<a name="l00088"><\/a>00088                         <span class="stringliteral">"&lt;p&gt;We apologize, but it seems that the internet connection that powers this hotspot is temporarily unavailable.&lt;\/p&gt;"<\/span>$/;"	a
l00089	doc/html/http_8c-source.html	/^<a name="l00089"><\/a>00089                         <span class="stringliteral">"&lt;p&gt;If at all possible, please notify the owners of this hotspot that the internet connection is out of service.&lt;\/p&gt;"<\/span>$/;"	a
l00090	doc/html/http_8c-source.html	/^<a name="l00090"><\/a>00090                         <span class="stringliteral">"&lt;p&gt;The maintainers of this network are aware of this disruption.  We hope that this situation will be resolved soon.&lt;\/p&gt;"<\/span>$/;"	a
l00091	doc/html/http_8c-source.html	/^<a name="l00091"><\/a>00091                         <span class="stringliteral">"&lt;p&gt;In a while please &lt;a href='%s'&gt;click here&lt;\/a&gt; to try your request again.&lt;\/p&gt;"<\/span>, tmp_url);$/;"	a
l00092	doc/html/http_8c-source.html	/^<a name="l00092"><\/a>00092 $/;"	a
l00093	doc/html/http_8c-source.html	/^<a name="l00093"><\/a>00093                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"Uh oh! Internet access unavailable!"<\/span>, buf);$/;"	a
l00094	doc/html/http_8c-source.html	/^<a name="l00094"><\/a>00094                 free(buf);$/;"	a
l00095	doc/html/http_8c-source.html	/^<a name="l00095"><\/a>00095                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Sent %s an apology since I am not online - no point sending them to auth server"<\/span>, r-&gt;clientAddr);$/;"	a
l00096	doc/html/http_8c-source.html	/^<a name="l00096"><\/a>00096         }$/;"	a
l00097	doc/html/http_8c-source.html	/^<a name="l00097"><\/a>00097         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (!is_auth_online()) {$/;"	a
l00098	doc/html/http_8c-source.html	/^<a name="l00098"><\/a>00098                 <span class="comment">\/* The auth server is down at the moment - apologize and do not redirect anywhere *\/<\/span>$/;"	a
l00099	doc/html/http_8c-source.html	/^<a name="l00099"><\/a>00099                 <span class="keywordtype">char<\/span> * buf;$/;"	a
l00100	doc/html/http_8c-source.html	/^<a name="l00100"><\/a>00100                 safe_asprintf(&amp;buf, $/;"	a
l00101	doc/html/http_8c-source.html	/^<a name="l00101"><\/a>00101                         <span class="stringliteral">"&lt;p&gt;We apologize, but it seems that we are currently unable to re-direct you to the login screen.&lt;\/p&gt;"<\/span>$/;"	a
l00102	doc/html/http_8c-source.html	/^<a name="l00102"><\/a>00102                         <span class="stringliteral">"&lt;p&gt;The maintainers of this network are aware of this disruption.  We hope that this situation will be resolved soon.&lt;\/p&gt;"<\/span>$/;"	a
l00103	doc/html/http_8c-source.html	/^<a name="l00103"><\/a>00103                         <span class="stringliteral">"&lt;p&gt;In a couple of minutes please &lt;a href='%s'&gt;click here&lt;\/a&gt; to try your request again.&lt;\/p&gt;"<\/span>, tmp_url);$/;"	a
l00104	doc/html/http_8c-source.html	/^<a name="l00104"><\/a>00104 $/;"	a
l00105	doc/html/http_8c-source.html	/^<a name="l00105"><\/a>00105                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"Uh oh! Login screen unavailable!"<\/span>, buf);$/;"	a
l00106	doc/html/http_8c-source.html	/^<a name="l00106"><\/a>00106                 free(buf);$/;"	a
l00107	doc/html/http_8c-source.html	/^<a name="l00107"><\/a>00107                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Sent %s an apology since auth server not online - no point sending them to auth server"<\/span>, r-&gt;clientAddr);$/;"	a
l00108	doc/html/http_8c-source.html	/^<a name="l00108"><\/a>00108         }$/;"	a
l00109	doc/html/http_8c-source.html	/^<a name="l00109"><\/a>00109         <span class="keywordflow">else<\/span> {$/;"	a
l00110	doc/html/http_8c-source.html	/^<a name="l00110"><\/a>00110                 <span class="comment">\/* Re-direct them to auth server *\/<\/span>$/;"	a
l00111	doc/html/http_8c-source.html	/^<a name="l00111"><\/a>00111                 <span class="keywordtype">char<\/span> *urlFragment;$/;"	a
l00112	doc/html/http_8c-source.html	/^<a name="l00112"><\/a>00112                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%sgw_address=%s&amp;gw_port=%d&amp;gw_id=%s&amp;url=%s"<\/span>,$/;"	a
l00113	doc/html/http_8c-source.html	/^<a name="l00113"><\/a>00113                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#0752c3da9e2be08ca6d19449fa4cf425" title="This is the script the user will be sent to for login.">authserv_login_script_path_fragment<\/a>,$/;"	a
l00114	doc/html/http_8c-source.html	/^<a name="l00114"><\/a>00114                         config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>,$/;"	a
l00115	doc/html/http_8c-source.html	/^<a name="l00115"><\/a>00115                         config-&gt;<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>, $/;"	a
l00116	doc/html/http_8c-source.html	/^<a name="l00116"><\/a>00116                         config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>,$/;"	a
l00117	doc/html/http_8c-source.html	/^<a name="l00117"><\/a>00117                         url);$/;"	a
l00118	doc/html/http_8c-source.html	/^<a name="l00118"><\/a>00118                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Captured %s requesting [%s] and re-directing them to login page"<\/span>, r-&gt;clientAddr, url);$/;"	a
l00119	doc/html/http_8c-source.html	/^<a name="l00119"><\/a>00119                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to login page"<\/span>);$/;"	a
l00120	doc/html/http_8c-source.html	/^<a name="l00120"><\/a>00120                 free(urlFragment);$/;"	a
l00121	doc/html/http_8c-source.html	/^<a name="l00121"><\/a>00121         }$/;"	a
l00122	doc/html/http_8c-source.html	/^<a name="l00122"><\/a>00122         free(url);$/;"	a
l00123	doc/html/http_8c-source.html	/^<a name="l00123"><\/a>00123 }$/;"	a
l00124	doc/html/http_8c-source.html	/^<a name="l00124"><\/a>00124 $/;"	a
l00125	doc/html/http_8c-source.html	/^<a name="l00125"><\/a>00125 <span class="keywordtype">void<\/span> $/;"	a
l00126	doc/html/http_8c-source.html	/^<a name="l00126"><\/a><a class="code" href="http_8h.html#a61e9e265a1529e600dd83ef91cd0d14">00126<\/a> <a class="code" href="http_8c.html#a61e9e265a1529e600dd83ef91cd0d14" title="Callback for libhttpd.">http_callback_wifidog<\/a>(httpd *webserver, request *r)$/;"	a
l00127	doc/html/http_8c-source.html	/^<a name="l00127"><\/a>00127 {$/;"	a
l00128	doc/html/http_8c-source.html	/^<a name="l00128"><\/a>00128         <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"WiFiDog"<\/span>, <span class="stringliteral">"Please use the menu to navigate the features of this WiFiDog installation."<\/span>);$/;"	a
l00129	doc/html/http_8c-source.html	/^<a name="l00129"><\/a>00129 }$/;"	a
l00130	doc/html/http_8c-source.html	/^<a name="l00130"><\/a>00130 $/;"	a
l00131	doc/html/http_8c-source.html	/^<a name="l00131"><\/a>00131 <span class="keywordtype">void<\/span> $/;"	a
l00132	doc/html/http_8c-source.html	/^<a name="l00132"><\/a><a class="code" href="http_8h.html#f306222145f5e2699ed19e716df0fb35">00132<\/a> <a class="code" href="http_8c.html#f306222145f5e2699ed19e716df0fb35" title="Callback for libhttpd.">http_callback_about<\/a>(httpd *webserver, request *r)$/;"	a
l00133	doc/html/http_8c-source.html	/^<a name="l00133"><\/a>00133 {$/;"	a
l00134	doc/html/http_8c-source.html	/^<a name="l00134"><\/a>00134         <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"About WiFiDog"<\/span>, <span class="stringliteral">"This is WiFiDog version &lt;strong&gt;"<\/span> VERSION <span class="stringliteral">"&lt;\/strong&gt;"<\/span>);$/;"	a
l00135	doc/html/http_8c-source.html	/^<a name="l00135"><\/a>00135 }$/;"	a
l00136	doc/html/http_8c-source.html	/^<a name="l00136"><\/a>00136 $/;"	a
l00137	doc/html/http_8c-source.html	/^<a name="l00137"><\/a>00137 <span class="keywordtype">void<\/span> $/;"	a
l00138	doc/html/http_8c-source.html	/^<a name="l00138"><\/a><a class="code" href="http_8h.html#676d4eaab18f4187387db5c1236b55b8">00138<\/a> <a class="code" href="http_8c.html#676d4eaab18f4187387db5c1236b55b8" title="Callback for libhttpd.">http_callback_status<\/a>(httpd *webserver, request *r)$/;"	a
l00139	doc/html/http_8c-source.html	/^<a name="l00139"><\/a>00139 {$/;"	a
l00140	doc/html/http_8c-source.html	/^<a name="l00140"><\/a>00140         <span class="keyword">const<\/span> <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00141	doc/html/http_8c-source.html	/^<a name="l00141"><\/a>00141         <span class="keywordtype">char<\/span> * status = NULL;$/;"	a
l00142	doc/html/http_8c-source.html	/^<a name="l00142"><\/a>00142         <span class="keywordtype">char<\/span> *buf;$/;"	a
l00143	doc/html/http_8c-source.html	/^<a name="l00143"><\/a>00143 $/;"	a
l00144	doc/html/http_8c-source.html	/^<a name="l00144"><\/a>00144         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a> &amp;&amp; $/;"	a
l00145	doc/html/http_8c-source.html	/^<a name="l00145"><\/a>00145                         (strcmp(config-&gt;<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a>, r-&gt;request.authUser) ||$/;"	a
l00146	doc/html/http_8c-source.html	/^<a name="l00146"><\/a>00146                          strcmp(config-&gt;<a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5" title="Password for HTTP authentication.">httpdpassword<\/a>, r-&gt;request.authPassword))) {$/;"	a
l00147	doc/html/http_8c-source.html	/^<a name="l00147"><\/a>00147                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Status page requested, forcing authentication"<\/span>);$/;"	a
l00148	doc/html/http_8c-source.html	/^<a name="l00148"><\/a>00148                 httpdForceAuthenticate(r, config-&gt;<a class="code" href="structs__config.html#283515007953f307a7b599ee480b743d" title="HTTP Authentication realm.">httpdrealm<\/a>);$/;"	a
l00149	doc/html/http_8c-source.html	/^<a name="l00149"><\/a>00149                 <span class="keywordflow">return<\/span>;$/;"	a
l00150	doc/html/http_8c-source.html	/^<a name="l00150"><\/a>00150         }$/;"	a
l00151	doc/html/http_8c-source.html	/^<a name="l00151"><\/a>00151 $/;"	a
l00152	doc/html/http_8c-source.html	/^<a name="l00152"><\/a>00152         status = get_status_text();$/;"	a
l00153	doc/html/http_8c-source.html	/^<a name="l00153"><\/a>00153         safe_asprintf(&amp;buf, <span class="stringliteral">"&lt;pre&gt;%s&lt;\/pre&gt;"<\/span>, status);$/;"	a
l00154	doc/html/http_8c-source.html	/^<a name="l00154"><\/a>00154         <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"WiFiDog Status"<\/span>, buf);$/;"	a
l00155	doc/html/http_8c-source.html	/^<a name="l00155"><\/a>00155         free(buf);$/;"	a
l00156	doc/html/http_8c-source.html	/^<a name="l00156"><\/a>00156         free(status);$/;"	a
l00157	doc/html/http_8c-source.html	/^<a name="l00157"><\/a>00157 }$/;"	a
l00162	doc/html/http_8c-source.html	/^<a name="l00162"><\/a><a class="code" href="http_8h.html#e31633b9629ec33c9006d0d29ad9ba83">00162<\/a> <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(request *r, <span class="keywordtype">char<\/span> *urlFragment, <span class="keywordtype">char<\/span> *text)$/;"	a
l00163	doc/html/http_8c-source.html	/^<a name="l00163"><\/a>00163 {$/;"	a
l00164	doc/html/http_8c-source.html	/^<a name="l00164"><\/a>00164         <span class="keywordtype">char<\/span> *protocol = NULL;$/;"	a
l00165	doc/html/http_8c-source.html	/^<a name="l00165"><\/a>00165         <span class="keywordtype">int<\/span> port = 80;$/;"	a
l00166	doc/html/http_8c-source.html	/^<a name="l00166"><\/a>00166         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00167	doc/html/http_8c-source.html	/^<a name="l00167"><\/a>00167 $/;"	a
l00168	doc/html/http_8c-source.html	/^<a name="l00168"><\/a>00168         <span class="keywordflow">if<\/span> (auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#87bde1ef8a18890d18858a360d276098" title="Use SSL or not.">authserv_use_ssl<\/a>) {$/;"	a
l00169	doc/html/http_8c-source.html	/^<a name="l00169"><\/a>00169                 protocol = <span class="stringliteral">"https"<\/span>;$/;"	a
l00170	doc/html/http_8c-source.html	/^<a name="l00170"><\/a>00170                 port = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#f4d82be7a680c24437a91ed1467f8921" title="Https port the central server listens on.">authserv_ssl_port<\/a>;$/;"	a
l00171	doc/html/http_8c-source.html	/^<a name="l00171"><\/a>00171         } <span class="keywordflow">else<\/span> {$/;"	a
l00172	doc/html/http_8c-source.html	/^<a name="l00172"><\/a>00172                 protocol = <span class="stringliteral">"http"<\/span>;$/;"	a
l00173	doc/html/http_8c-source.html	/^<a name="l00173"><\/a>00173                 port = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>;$/;"	a
l00174	doc/html/http_8c-source.html	/^<a name="l00174"><\/a>00174         }$/;"	a
l00175	doc/html/http_8c-source.html	/^<a name="l00175"><\/a>00175                                         $/;"	a
l00176	doc/html/http_8c-source.html	/^<a name="l00176"><\/a>00176         <span class="keywordtype">char<\/span> *url = NULL;$/;"	a
l00177	doc/html/http_8c-source.html	/^<a name="l00177"><\/a>00177         safe_asprintf(&amp;url, <span class="stringliteral">"%s:\/\/%s:%d%s%s"<\/span>,$/;"	a
l00178	doc/html/http_8c-source.html	/^<a name="l00178"><\/a>00178                 protocol,$/;"	a
l00179	doc/html/http_8c-source.html	/^<a name="l00179"><\/a>00179                 auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>,$/;"	a
l00180	doc/html/http_8c-source.html	/^<a name="l00180"><\/a>00180                 port,$/;"	a
l00181	doc/html/http_8c-source.html	/^<a name="l00181"><\/a>00181                 auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#ff64f568944bbf0b01bb379b17ae2161" title="Path where wifidog resides.">authserv_path<\/a>,$/;"	a
l00182	doc/html/http_8c-source.html	/^<a name="l00182"><\/a>00182                 urlFragment$/;"	a
l00183	doc/html/http_8c-source.html	/^<a name="l00183"><\/a>00183         );$/;"	a
l00184	doc/html/http_8c-source.html	/^<a name="l00184"><\/a>00184         <a class="code" href="http_8c.html#bbf6eaf48119c43e4d37a8d7b3f16f11" title="Sends a redirect to the web browser.">http_send_redirect<\/a>(r, url, text);$/;"	a
l00185	doc/html/http_8c-source.html	/^<a name="l00185"><\/a>00185         free(url);      $/;"	a
l00186	doc/html/http_8c-source.html	/^<a name="l00186"><\/a>00186 }$/;"	a
l00187	doc/html/http_8c-source.html	/^<a name="l00187"><\/a>00187 $/;"	a
l00192	doc/html/http_8c-source.html	/^<a name="l00192"><\/a><a class="code" href="http_8h.html#bbf6eaf48119c43e4d37a8d7b3f16f11">00192<\/a> <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#bbf6eaf48119c43e4d37a8d7b3f16f11" title="Sends a redirect to the web browser.">http_send_redirect<\/a>(request *r, <span class="keywordtype">char<\/span> *url, <span class="keywordtype">char<\/span> *text)$/;"	a
l00193	doc/html/http_8c-source.html	/^<a name="l00193"><\/a>00193 {$/;"	a
l00194	doc/html/http_8c-source.html	/^<a name="l00194"><\/a>00194                 <span class="keywordtype">char<\/span> *message = NULL;$/;"	a
l00195	doc/html/http_8c-source.html	/^<a name="l00195"><\/a>00195                 <span class="keywordtype">char<\/span> *header = NULL;$/;"	a
l00196	doc/html/http_8c-source.html	/^<a name="l00196"><\/a>00196                 <span class="keywordtype">char<\/span> *response = NULL;$/;"	a
l00197	doc/html/http_8c-source.html	/^<a name="l00197"><\/a>00197                                                         <span class="comment">\/* Re-direct them to auth server *\/<\/span>$/;"	a
l00198	doc/html/http_8c-source.html	/^<a name="l00198"><\/a>00198                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Redirecting client browser to %s"<\/span>, url);$/;"	a
l00199	doc/html/http_8c-source.html	/^<a name="l00199"><\/a>00199                 safe_asprintf(&amp;header, <span class="stringliteral">"Location: %s"<\/span>,$/;"	a
l00200	doc/html/http_8c-source.html	/^<a name="l00200"><\/a>00200                         url$/;"	a
l00201	doc/html/http_8c-source.html	/^<a name="l00201"><\/a>00201                 );$/;"	a
l00202	doc/html/http_8c-source.html	/^<a name="l00202"><\/a>00202                 <span class="keywordflow">if<\/span>(text) {$/;"	a
l00203	doc/html/http_8c-source.html	/^<a name="l00203"><\/a>00203                         safe_asprintf(&amp;response, <span class="stringliteral">"307 %s\\n"<\/span>,$/;"	a
l00204	doc/html/http_8c-source.html	/^<a name="l00204"><\/a>00204                                 text$/;"	a
l00205	doc/html/http_8c-source.html	/^<a name="l00205"><\/a>00205                         );      $/;"	a
l00206	doc/html/http_8c-source.html	/^<a name="l00206"><\/a>00206                 }$/;"	a
l00207	doc/html/http_8c-source.html	/^<a name="l00207"><\/a>00207                 <span class="keywordflow">else<\/span> {$/;"	a
l00208	doc/html/http_8c-source.html	/^<a name="l00208"><\/a>00208                         safe_asprintf(&amp;response, <span class="stringliteral">"307 %s\\n"<\/span>,$/;"	a
l00209	doc/html/http_8c-source.html	/^<a name="l00209"><\/a>00209                                 <span class="stringliteral">"Redirecting"<\/span>$/;"	a
l00210	doc/html/http_8c-source.html	/^<a name="l00210"><\/a>00210                         );              $/;"	a
l00211	doc/html/http_8c-source.html	/^<a name="l00211"><\/a>00211                 }       $/;"	a
l00212	doc/html/http_8c-source.html	/^<a name="l00212"><\/a>00212                 httpdSetResponse(r, response);$/;"	a
l00213	doc/html/http_8c-source.html	/^<a name="l00213"><\/a>00213                 httpdAddHeader(r, header);$/;"	a
l00214	doc/html/http_8c-source.html	/^<a name="l00214"><\/a>00214                 free(response);$/;"	a
l00215	doc/html/http_8c-source.html	/^<a name="l00215"><\/a>00215                 free(header);   $/;"	a
l00216	doc/html/http_8c-source.html	/^<a name="l00216"><\/a>00216                 safe_asprintf(&amp;message, <span class="stringliteral">"Please &lt;a href='%s'&gt;click here&lt;\/a&gt;."<\/span>, url);$/;"	a
l00217	doc/html/http_8c-source.html	/^<a name="l00217"><\/a>00217                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, text ? text : <span class="stringliteral">"Redirection to message"<\/span>, message);$/;"	a
l00218	doc/html/http_8c-source.html	/^<a name="l00218"><\/a>00218                 free(message);$/;"	a
l00219	doc/html/http_8c-source.html	/^<a name="l00219"><\/a>00219 }$/;"	a
l00220	doc/html/http_8c-source.html	/^<a name="l00220"><\/a>00220 $/;"	a
l00221	doc/html/http_8c-source.html	/^<a name="l00221"><\/a>00221 <span class="keywordtype">void<\/span> $/;"	a
l00222	doc/html/http_8c-source.html	/^<a name="l00222"><\/a><a class="code" href="http_8h.html#f5d4744903ff7f32bd96a8cb85af299e">00222<\/a> <a class="code" href="http_8c.html#f5d4744903ff7f32bd96a8cb85af299e" title="Callback for libhttpd, main entry point post login for auth confirmation.">http_callback_auth<\/a>(httpd *webserver, request *r)$/;"	a
l00223	doc/html/http_8c-source.html	/^<a name="l00223"><\/a>00223 {$/;"	a
l00224	doc/html/http_8c-source.html	/^<a name="l00224"><\/a>00224         <a class="code" href="struct__t__client.html">t_client<\/a>        *client;$/;"	a
l00225	doc/html/http_8c-source.html	/^<a name="l00225"><\/a>00225         httpVar * token;$/;"	a
l00226	doc/html/http_8c-source.html	/^<a name="l00226"><\/a>00226         <span class="keywordtype">char<\/span>    *mac;$/;"	a
l00227	doc/html/http_8c-source.html	/^<a name="l00227"><\/a>00227         httpVar *logout = httpdGetVariableByName(r, <span class="stringliteral">"logout"<\/span>);$/;"	a
l00228	doc/html/http_8c-source.html	/^<a name="l00228"><\/a>00228         <span class="keywordflow">if<\/span> ((token = httpdGetVariableByName(r, <span class="stringliteral">"token"<\/span>))) {$/;"	a
l00229	doc/html/http_8c-source.html	/^<a name="l00229"><\/a>00229                 <span class="comment">\/* They supplied variable "token" *\/<\/span>$/;"	a
l00230	doc/html/http_8c-source.html	/^<a name="l00230"><\/a>00230                 <span class="keywordflow">if<\/span> (!(mac = arp_get(r-&gt;clientAddr))) {$/;"	a
l00231	doc/html/http_8c-source.html	/^<a name="l00231"><\/a>00231                         <span class="comment">\/* We could not get their MAC address *\/<\/span>$/;"	a
l00232	doc/html/http_8c-source.html	/^<a name="l00232"><\/a>00232                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Failed to retrieve MAC address for ip %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00233	doc/html/http_8c-source.html	/^<a name="l00233"><\/a>00233                         <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"WiFiDog Error"<\/span>, <span class="stringliteral">"Failed to retrieve your MAC address"<\/span>);$/;"	a
l00234	doc/html/http_8c-source.html	/^<a name="l00234"><\/a>00234                 } <span class="keywordflow">else<\/span> {$/;"	a
l00235	doc/html/http_8c-source.html	/^<a name="l00235"><\/a>00235                         <span class="comment">\/* We have their MAC address *\/<\/span>$/;"	a
l00236	doc/html/http_8c-source.html	/^<a name="l00236"><\/a>00236 $/;"	a
l00237	doc/html/http_8c-source.html	/^<a name="l00237"><\/a>00237                         LOCK_CLIENT_LIST();$/;"	a
l00238	doc/html/http_8c-source.html	/^<a name="l00238"><\/a>00238                         $/;"	a
l00239	doc/html/http_8c-source.html	/^<a name="l00239"><\/a>00239                         <span class="keywordflow">if<\/span> ((client = <a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(r-&gt;clientAddr, mac)) == NULL) {$/;"	a
l00240	doc/html/http_8c-source.html	/^<a name="l00240"><\/a>00240                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"New client for %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00241	doc/html/http_8c-source.html	/^<a name="l00241"><\/a>00241                                 <a class="code" href="client__list_8c.html#65ad84da2af952d86d9ea8c326951911" title="Adds a new client to the connections list.">client_list_append<\/a>(r-&gt;clientAddr, mac, token-&gt;value);$/;"	a
l00242	doc/html/http_8c-source.html	/^<a name="l00242"><\/a>00242                         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (logout) {$/;"	a
l00243	doc/html/http_8c-source.html	/^<a name="l00243"><\/a>00243                             <a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a>  authresponse;$/;"	a
l00244	doc/html/http_8c-source.html	/^<a name="l00244"><\/a>00244                             <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00245	doc/html/http_8c-source.html	/^<a name="l00245"><\/a>00245                             <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> incoming = client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>;$/;"	a
l00246	doc/html/http_8c-source.html	/^<a name="l00246"><\/a>00246                             <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> outgoing = client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>;$/;"	a
l00247	doc/html/http_8c-source.html	/^<a name="l00247"><\/a>00247                             <span class="keywordtype">char<\/span> *ip = safe_strdup(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00248	doc/html/http_8c-source.html	/^<a name="l00248"><\/a>00248                             <span class="keywordtype">char<\/span> *urlFragment = NULL;$/;"	a
l00249	doc/html/http_8c-source.html	/^<a name="l00249"><\/a>00249                             <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00250	doc/html/http_8c-source.html	/^<a name="l00250"><\/a>00250                                                                 $/;"	a
l00251	doc/html/http_8c-source.html	/^<a name="l00251"><\/a>00251                             fw_deny(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00252	doc/html/http_8c-source.html	/^<a name="l00252"><\/a>00252                             <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(client);$/;"	a
l00253	doc/html/http_8c-source.html	/^<a name="l00253"><\/a>00253                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Got logout from %s"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00254	doc/html/http_8c-source.html	/^<a name="l00254"><\/a>00254                             $/;"	a
l00255	doc/html/http_8c-source.html	/^<a name="l00255"><\/a>00255                             <span class="comment">\/* Advertise the logout if we have an auth server *\/<\/span>$/;"	a
l00256	doc/html/http_8c-source.html	/^<a name="l00256"><\/a>00256                             <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> != NULL) {$/;"	a
l00257	doc/html/http_8c-source.html	/^<a name="l00257"><\/a>00257                                         UNLOCK_CLIENT_LIST();$/;"	a
l00258	doc/html/http_8c-source.html	/^<a name="l00258"><\/a>00258                                         <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(&amp;authresponse, <a class="code" href="centralserver_8h.html#b262747ac931a0a8c357448e7a2cf301" title="Notify the the central server of a client logout.">REQUEST_TYPE_LOGOUT<\/a>, ip, mac, token-&gt;value, $/;"	a
l00259	doc/html/http_8c-source.html	/^<a name="l00259"><\/a>00259                                                                             incoming, outgoing);$/;"	a
l00260	doc/html/http_8c-source.html	/^<a name="l00260"><\/a>00260                                         LOCK_CLIENT_LIST();$/;"	a
l00261	doc/html/http_8c-source.html	/^<a name="l00261"><\/a>00261                                         $/;"	a
l00262	doc/html/http_8c-source.html	/^<a name="l00262"><\/a>00262                                         <span class="comment">\/* Re-direct them to auth server *\/<\/span>$/;"	a
l00263	doc/html/http_8c-source.html	/^<a name="l00263"><\/a>00263                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got manual logout from client ip %s, mac %s, token %s"<\/span>$/;"	a
l00264	doc/html/http_8c-source.html	/^<a name="l00264"><\/a>00264                                         <span class="stringliteral">"- redirecting them to logout message"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00265	doc/html/http_8c-source.html	/^<a name="l00265"><\/a>00265                                         safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%smessage=%s"<\/span>,$/;"	a
l00266	doc/html/http_8c-source.html	/^<a name="l00266"><\/a>00266                                                 auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>,$/;"	a
l00267	doc/html/http_8c-source.html	/^<a name="l00267"><\/a>00267                                                 <a class="code" href="centralserver_8h.html#9aa808dd68665d6af8a050e22bb9e1c4" title="Sent after the user performed a manual log-out on the gateway.">GATEWAY_MESSAGE_ACCOUNT_LOGGED_OUT<\/a>$/;"	a
l00268	doc/html/http_8c-source.html	/^<a name="l00268"><\/a>00268                                         );$/;"	a
l00269	doc/html/http_8c-source.html	/^<a name="l00269"><\/a>00269                                         <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to logout message"<\/span>);$/;"	a
l00270	doc/html/http_8c-source.html	/^<a name="l00270"><\/a>00270                                         free(urlFragment);$/;"	a
l00271	doc/html/http_8c-source.html	/^<a name="l00271"><\/a>00271                             }$/;"	a
l00272	doc/html/http_8c-source.html	/^<a name="l00272"><\/a>00272                             free(ip);$/;"	a
l00273	doc/html/http_8c-source.html	/^<a name="l00273"><\/a>00273                         } $/;"	a
l00274	doc/html/http_8c-source.html	/^<a name="l00274"><\/a>00274                         <span class="keywordflow">else<\/span> {$/;"	a
l00275	doc/html/http_8c-source.html	/^<a name="l00275"><\/a>00275                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Client for %s is already in the client list"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00276	doc/html/http_8c-source.html	/^<a name="l00276"><\/a>00276                         }$/;"	a
l00277	doc/html/http_8c-source.html	/^<a name="l00277"><\/a>00277                         UNLOCK_CLIENT_LIST();$/;"	a
l00278	doc/html/http_8c-source.html	/^<a name="l00278"><\/a>00278                         <span class="keywordflow">if<\/span> (!logout) {$/;"	a
l00279	doc/html/http_8c-source.html	/^<a name="l00279"><\/a>00279                                 <a class="code" href="auth_8c.html#88932f2cd4b44875ef888e2fc0817da5" title="Authenticate a single client against the central server.">authenticate_client<\/a>(r);$/;"	a
l00280	doc/html/http_8c-source.html	/^<a name="l00280"><\/a>00280                         }$/;"	a
l00281	doc/html/http_8c-source.html	/^<a name="l00281"><\/a>00281                         free(mac);$/;"	a
l00282	doc/html/http_8c-source.html	/^<a name="l00282"><\/a>00282                 }$/;"	a
l00283	doc/html/http_8c-source.html	/^<a name="l00283"><\/a>00283         } <span class="keywordflow">else<\/span> {$/;"	a
l00284	doc/html/http_8c-source.html	/^<a name="l00284"><\/a>00284                 <span class="comment">\/* They did not supply variable "token" *\/<\/span>$/;"	a
l00285	doc/html/http_8c-source.html	/^<a name="l00285"><\/a>00285                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"WiFiDog error"<\/span>, <span class="stringliteral">"Invalid token"<\/span>);$/;"	a
l00286	doc/html/http_8c-source.html	/^<a name="l00286"><\/a>00286         }$/;"	a
l00287	doc/html/http_8c-source.html	/^<a name="l00287"><\/a>00287 }$/;"	a
l00288	doc/html/http_8c-source.html	/^<a name="l00288"><\/a>00288 $/;"	a
l00289	doc/html/http_8c-source.html	/^<a name="l00289"><\/a><a class="code" href="http_8h.html#fdcb681ef78f59098d6bc931333640ae">00289<\/a> <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(request *r, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *title, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span>* message)$/;"	a
l00290	doc/html/http_8c-source.html	/^<a name="l00290"><\/a>00290 {$/;"	a
l00291	doc/html/http_8c-source.html	/^<a name="l00291"><\/a>00291     <a class="code" href="structs__config.html">s_config<\/a>    *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00292	doc/html/http_8c-source.html	/^<a name="l00292"><\/a>00292     <span class="keywordtype">char<\/span> *buffer;$/;"	a
l00293	doc/html/http_8c-source.html	/^<a name="l00293"><\/a>00293     <span class="keyword">struct <\/span>stat stat_info;$/;"	a
l00294	doc/html/http_8c-source.html	/^<a name="l00294"><\/a>00294     <span class="keywordtype">int<\/span> fd;$/;"	a
l00295	doc/html/http_8c-source.html	/^<a name="l00295"><\/a>00295     ssize_t written;$/;"	a
l00296	doc/html/http_8c-source.html	/^<a name="l00296"><\/a>00296 $/;"	a
l00297	doc/html/http_8c-source.html	/^<a name="l00297"><\/a>00297     fd=open(config-&gt;<a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6" title="name of the HTML file used for messages">htmlmsgfile<\/a>, O_RDONLY);$/;"	a
l00298	doc/html/http_8c-source.html	/^<a name="l00298"><\/a>00298     <span class="keywordflow">if<\/span> (fd==-1) {$/;"	a
l00299	doc/html/http_8c-source.html	/^<a name="l00299"><\/a>00299         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to open HTML message file %s: %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6" title="name of the HTML file used for messages">htmlmsgfile<\/a>, strerror(errno));$/;"	a
l00300	doc/html/http_8c-source.html	/^<a name="l00300"><\/a>00300         <span class="keywordflow">return<\/span>;$/;"	a
l00301	doc/html/http_8c-source.html	/^<a name="l00301"><\/a>00301     }$/;"	a
l00302	doc/html/http_8c-source.html	/^<a name="l00302"><\/a>00302 $/;"	a
l00303	doc/html/http_8c-source.html	/^<a name="l00303"><\/a>00303     <span class="keywordflow">if<\/span> (fstat(fd, &amp;stat_info)==-1) {$/;"	a
l00304	doc/html/http_8c-source.html	/^<a name="l00304"><\/a>00304         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to stat HTML message file: %s"<\/span>, strerror(errno));$/;"	a
l00305	doc/html/http_8c-source.html	/^<a name="l00305"><\/a>00305         close(fd);$/;"	a
l00306	doc/html/http_8c-source.html	/^<a name="l00306"><\/a>00306         <span class="keywordflow">return<\/span>;$/;"	a
l00307	doc/html/http_8c-source.html	/^<a name="l00307"><\/a>00307     }$/;"	a
l00308	doc/html/http_8c-source.html	/^<a name="l00308"><\/a>00308 $/;"	a
l00309	doc/html/http_8c-source.html	/^<a name="l00309"><\/a>00309     buffer=(<span class="keywordtype">char<\/span>*)<a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(stat_info.st_size+1);$/;"	a
l00310	doc/html/http_8c-source.html	/^<a name="l00310"><\/a>00310     written=read(fd, buffer, stat_info.st_size);$/;"	a
l00311	doc/html/http_8c-source.html	/^<a name="l00311"><\/a>00311     <span class="keywordflow">if<\/span> (written==-1) {$/;"	a
l00312	doc/html/http_8c-source.html	/^<a name="l00312"><\/a>00312         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to read HTML message file: %s"<\/span>, strerror(errno));$/;"	a
l00313	doc/html/http_8c-source.html	/^<a name="l00313"><\/a>00313         free(buffer);$/;"	a
l00314	doc/html/http_8c-source.html	/^<a name="l00314"><\/a>00314         close(fd);$/;"	a
l00315	doc/html/http_8c-source.html	/^<a name="l00315"><\/a>00315         <span class="keywordflow">return<\/span>;$/;"	a
l00316	doc/html/http_8c-source.html	/^<a name="l00316"><\/a>00316     }$/;"	a
l00317	doc/html/http_8c-source.html	/^<a name="l00317"><\/a>00317     close(fd);$/;"	a
l00318	doc/html/http_8c-source.html	/^<a name="l00318"><\/a>00318 $/;"	a
l00319	doc/html/http_8c-source.html	/^<a name="l00319"><\/a>00319     buffer[written]=0;$/;"	a
l00320	doc/html/http_8c-source.html	/^<a name="l00320"><\/a>00320     httpdAddVariable(r, <span class="stringliteral">"title"<\/span>, title);$/;"	a
l00321	doc/html/http_8c-source.html	/^<a name="l00321"><\/a>00321     httpdAddVariable(r, <span class="stringliteral">"message"<\/span>, message);$/;"	a
l00322	doc/html/http_8c-source.html	/^<a name="l00322"><\/a>00322     httpdAddVariable(r, <span class="stringliteral">"nodeID"<\/span>, config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>);$/;"	a
l00323	doc/html/http_8c-source.html	/^<a name="l00323"><\/a>00323     httpdOutput(r, buffer);$/;"	a
l00324	doc/html/http_8c-source.html	/^<a name="l00324"><\/a>00324     free(buffer);$/;"	a
l00325	doc/html/http_8c-source.html	/^<a name="l00325"><\/a>00325 }$/;"	a
l00326	doc/html/http_8c-source.html	/^<a name="l00326"><\/a>00326 $/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	doc/html/http_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="http.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
676d4eaab18f4187387db5c1236b55b8	doc/html/http_8c.html	/^<a class="anchor" name="676d4eaab18f4187387db5c1236b55b8"><\/a><!-- doxytag: member="http.c::http_callback_status" ref="676d4eaab18f4187387db5c1236b55b8" args="(httpd *webserver, request *r)" -->$/;"	a
7164c2c972bb0668cf8a7ac5c5f2a0a6	doc/html/http_8c.html	/^<a class="anchor" name="7164c2c972bb0668cf8a7ac5c5f2a0a6"><\/a><!-- doxytag: member="http.c::http_callback_404" ref="7164c2c972bb0668cf8a7ac5c5f2a0a6" args="(httpd *webserver, request *r)" -->$/;"	a
_details	doc/html/http_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a61e9e265a1529e600dd83ef91cd0d14	doc/html/http_8c.html	/^<a class="anchor" name="a61e9e265a1529e600dd83ef91cd0d14"><\/a><!-- doxytag: member="http.c::http_callback_wifidog" ref="a61e9e265a1529e600dd83ef91cd0d14" args="(httpd *webserver, request *r)" -->$/;"	a
bbf6eaf48119c43e4d37a8d7b3f16f11	doc/html/http_8c.html	/^<a class="anchor" name="bbf6eaf48119c43e4d37a8d7b3f16f11"><\/a><!-- doxytag: member="http.c::http_send_redirect" ref="bbf6eaf48119c43e4d37a8d7b3f16f11" args="(request *r, char *url, char *text)" -->$/;"	a
e31633b9629ec33c9006d0d29ad9ba83	doc/html/http_8c.html	/^<a class="anchor" name="e31633b9629ec33c9006d0d29ad9ba83"><\/a><!-- doxytag: member="http.c::http_send_redirect_to_auth" ref="e31633b9629ec33c9006d0d29ad9ba83" args="(request *r, char *urlFragment, char *text)" -->$/;"	a
f306222145f5e2699ed19e716df0fb35	doc/html/http_8c.html	/^<a class="anchor" name="f306222145f5e2699ed19e716df0fb35"><\/a><!-- doxytag: member="http.c::http_callback_about" ref="f306222145f5e2699ed19e716df0fb35" args="(httpd *webserver, request *r)" -->$/;"	a
f5d4744903ff7f32bd96a8cb85af299e	doc/html/http_8c.html	/^<a class="anchor" name="f5d4744903ff7f32bd96a8cb85af299e"><\/a><!-- doxytag: member="http.c::http_callback_auth" ref="f5d4744903ff7f32bd96a8cb85af299e" args="(httpd *webserver, request *r)" -->$/;"	a
fdcb681ef78f59098d6bc931333640ae	doc/html/http_8c.html	/^<a class="anchor" name="fdcb681ef78f59098d6bc931333640ae"><\/a><!-- doxytag: member="http.c::send_http_page" ref="fdcb681ef78f59098d6bc931333640ae" args="(request *r, const char *title, const char *message)" -->$/;"	a
l00001	doc/html/http_8h-source.html	/^<h1>http.h<\/h1><a href="http_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/http_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/http_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/http_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/http_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/http_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/http_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/http_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/http_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/http_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/http_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/http_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/http_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/http_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/http_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/http_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/http_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/http_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/http_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/http_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/http_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: http.h 1346 2008-04-21 23:04:40Z acv $ *\/<\/span>$/;"	a
l00027	doc/html/http_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _HTTP_H_<\/span>$/;"	a
l00028	doc/html/http_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _HTTP_H_<\/span>$/;"	a
l00029	doc/html/http_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/http_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00031	doc/html/http_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00033	doc/html/http_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#7164c2c972bb0668cf8a7ac5c5f2a0a6" title="Callback for libhttpd, main entry point for captive portal.">http_callback_404<\/a>(httpd *webserver, request *r);$/;"	a
l00035	doc/html/http_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#a61e9e265a1529e600dd83ef91cd0d14" title="Callback for libhttpd.">http_callback_wifidog<\/a>(httpd *webserver, request *r);$/;"	a
l00037	doc/html/http_8h-source.html	/^<a name="l00037"><\/a>00037 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#f306222145f5e2699ed19e716df0fb35" title="Callback for libhttpd.">http_callback_about<\/a>(httpd *webserver, request *r);$/;"	a
l00039	doc/html/http_8h-source.html	/^<a name="l00039"><\/a>00039 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#676d4eaab18f4187387db5c1236b55b8" title="Callback for libhttpd.">http_callback_status<\/a>(httpd *webserver, request *r);$/;"	a
l00041	doc/html/http_8h-source.html	/^<a name="l00041"><\/a>00041 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#f5d4744903ff7f32bd96a8cb85af299e" title="Callback for libhttpd, main entry point post login for auth confirmation.">http_callback_auth<\/a>(httpd *webserver, request *r);$/;"	a
l00042	doc/html/http_8h-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00044	doc/html/http_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(request *r, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *title, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span>* message);$/;"	a
l00045	doc/html/http_8h-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00047	doc/html/http_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#bbf6eaf48119c43e4d37a8d7b3f16f11" title="Sends a redirect to the web browser.">http_send_redirect<\/a>(request *r, <span class="keywordtype">char<\/span> *url, <span class="keywordtype">char<\/span> *text);$/;"	a
l00049	doc/html/http_8h-source.html	/^<a name="l00049"><\/a>00049 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(request *r, <span class="keywordtype">char<\/span> *urlFragment, <span class="keywordtype">char<\/span> *text);$/;"	a
l00050	doc/html/http_8h-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#endif <\/span><span class="comment">\/* _HTTP_H_ *\/<\/span>$/;"	a
676d4eaab18f4187387db5c1236b55b8	doc/html/http_8h.html	/^<a class="anchor" name="676d4eaab18f4187387db5c1236b55b8"><\/a><!-- doxytag: member="http.h::http_callback_status" ref="676d4eaab18f4187387db5c1236b55b8" args="(httpd *webserver, request *r)" -->$/;"	a
7164c2c972bb0668cf8a7ac5c5f2a0a6	doc/html/http_8h.html	/^<a class="anchor" name="7164c2c972bb0668cf8a7ac5c5f2a0a6"><\/a><!-- doxytag: member="http.h::http_callback_404" ref="7164c2c972bb0668cf8a7ac5c5f2a0a6" args="(httpd *webserver, request *r)" -->$/;"	a
_details	doc/html/http_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a61e9e265a1529e600dd83ef91cd0d14	doc/html/http_8h.html	/^<a class="anchor" name="a61e9e265a1529e600dd83ef91cd0d14"><\/a><!-- doxytag: member="http.h::http_callback_wifidog" ref="a61e9e265a1529e600dd83ef91cd0d14" args="(httpd *webserver, request *r)" -->$/;"	a
bbf6eaf48119c43e4d37a8d7b3f16f11	doc/html/http_8h.html	/^<a class="anchor" name="bbf6eaf48119c43e4d37a8d7b3f16f11"><\/a><!-- doxytag: member="http.h::http_send_redirect" ref="bbf6eaf48119c43e4d37a8d7b3f16f11" args="(request *r, char *url, char *text)" -->$/;"	a
e31633b9629ec33c9006d0d29ad9ba83	doc/html/http_8h.html	/^<a class="anchor" name="e31633b9629ec33c9006d0d29ad9ba83"><\/a><!-- doxytag: member="http.h::http_send_redirect_to_auth" ref="e31633b9629ec33c9006d0d29ad9ba83" args="(request *r, char *urlFragment, char *text)" -->$/;"	a
f306222145f5e2699ed19e716df0fb35	doc/html/http_8h.html	/^<a class="anchor" name="f306222145f5e2699ed19e716df0fb35"><\/a><!-- doxytag: member="http.h::http_callback_about" ref="f306222145f5e2699ed19e716df0fb35" args="(httpd *webserver, request *r)" -->$/;"	a
f5d4744903ff7f32bd96a8cb85af299e	doc/html/http_8h.html	/^<a class="anchor" name="f5d4744903ff7f32bd96a8cb85af299e"><\/a><!-- doxytag: member="http.h::http_callback_auth" ref="f5d4744903ff7f32bd96a8cb85af299e" args="(httpd *webserver, request *r)" -->$/;"	a
fdcb681ef78f59098d6bc931333640ae	doc/html/http_8h.html	/^<a class="anchor" name="fdcb681ef78f59098d6bc931333640ae"><\/a><!-- doxytag: member="http.h::send_http_page" ref="fdcb681ef78f59098d6bc931333640ae" args="(request *r, const char *title, const char *message)" -->$/;"	a
l00001	doc/html/httpd__thread_8c-source.html	/^<h1>httpd_thread.c<\/h1><a href="httpd__thread_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/httpd__thread_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/httpd__thread_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/httpd__thread_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/httpd__thread_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/httpd__thread_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/httpd__thread_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/httpd__thread_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/httpd__thread_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/httpd__thread_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/httpd__thread_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/httpd__thread_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/httpd__thread_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/httpd__thread_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/httpd__thread_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/httpd__thread_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/httpd__thread_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/httpd__thread_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/httpd__thread_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/httpd__thread_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/httpd__thread_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: httpd_thread.c 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00022	doc/html/httpd__thread_8c-source.html	/^<a name="l00022"><\/a>00022 $/;"	a
l00028	doc/html/httpd__thread_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00029	doc/html/httpd__thread_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/httpd__thread_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00031	doc/html/httpd__thread_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00032	doc/html/httpd__thread_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00033	doc/html/httpd__thread_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00034	doc/html/httpd__thread_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00035	doc/html/httpd__thread_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00036	doc/html/httpd__thread_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;signal.h&gt;<\/span>$/;"	a
l00037	doc/html/httpd__thread_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00038	doc/html/httpd__thread_8c-source.html	/^<a name="l00038"><\/a>00038 $/;"	a
l00039	doc/html/httpd__thread_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00040	doc/html/httpd__thread_8c-source.html	/^<a name="l00040"><\/a>00040 $/;"	a
l00041	doc/html/httpd__thread_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00042	doc/html/httpd__thread_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00043	doc/html/httpd__thread_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00044	doc/html/httpd__thread_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="httpd__thread_8h.html" title="WiFiDog httpd worker thread.">httpd_thread.h<\/a>"<\/span>$/;"	a
l00045	doc/html/httpd__thread_8c-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00049	doc/html/httpd__thread_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="keywordtype">void<\/span>$/;"	a
l00050	doc/html/httpd__thread_8c-source.html	/^<a name="l00050"><\/a><a class="code" href="httpd__thread_8h.html#2925feb4c55460a80bd30f6ef363779d">00050<\/a> <a class="code" href="httpd__thread_8c.html#2925feb4c55460a80bd30f6ef363779d" title="Handle a web request.">thread_httpd<\/a>(<span class="keywordtype">void<\/span> *args)$/;"	a
l00051	doc/html/httpd__thread_8c-source.html	/^<a name="l00051"><\/a>00051 {$/;"	a
l00052	doc/html/httpd__thread_8c-source.html	/^<a name="l00052"><\/a>00052         <span class="keywordtype">void<\/span>    **params;$/;"	a
l00053	doc/html/httpd__thread_8c-source.html	/^<a name="l00053"><\/a>00053         httpd   *webserver;$/;"	a
l00054	doc/html/httpd__thread_8c-source.html	/^<a name="l00054"><\/a>00054         request *r;$/;"	a
l00055	doc/html/httpd__thread_8c-source.html	/^<a name="l00055"><\/a>00055         $/;"	a
l00056	doc/html/httpd__thread_8c-source.html	/^<a name="l00056"><\/a>00056         params = (<span class="keywordtype">void<\/span> **)args;$/;"	a
l00057	doc/html/httpd__thread_8c-source.html	/^<a name="l00057"><\/a>00057         webserver = *params;$/;"	a
l00058	doc/html/httpd__thread_8c-source.html	/^<a name="l00058"><\/a>00058         r = *(params + 1);$/;"	a
l00059	doc/html/httpd__thread_8c-source.html	/^<a name="l00059"><\/a>00059         free(params); <span class="comment">\/* XXX We must release this ourselves. *\/<\/span>$/;"	a
l00060	doc/html/httpd__thread_8c-source.html	/^<a name="l00060"><\/a>00060         $/;"	a
l00061	doc/html/httpd__thread_8c-source.html	/^<a name="l00061"><\/a>00061         <span class="keywordflow">if<\/span> (httpdReadRequest(webserver, r) == 0) {$/;"	a
l00062	doc/html/httpd__thread_8c-source.html	/^<a name="l00062"><\/a>00062                 <span class="comment">\/*<\/span>$/;"	a
l00063	doc/html/httpd__thread_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="comment">                 * We read the request fine<\/span>$/;"	a
l00064	doc/html/httpd__thread_8c-source.html	/^<a name="l00064"><\/a>00064 <span class="comment">                 *\/<\/span>$/;"	a
l00065	doc/html/httpd__thread_8c-source.html	/^<a name="l00065"><\/a>00065                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Processing request from %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00066	doc/html/httpd__thread_8c-source.html	/^<a name="l00066"><\/a>00066                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Calling httpdProcessRequest() for %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00067	doc/html/httpd__thread_8c-source.html	/^<a name="l00067"><\/a>00067                 httpdProcessRequest(webserver, r);$/;"	a
l00068	doc/html/httpd__thread_8c-source.html	/^<a name="l00068"><\/a>00068                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Returned from httpdProcessRequest() for %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00069	doc/html/httpd__thread_8c-source.html	/^<a name="l00069"><\/a>00069         }$/;"	a
l00070	doc/html/httpd__thread_8c-source.html	/^<a name="l00070"><\/a>00070         <span class="keywordflow">else<\/span> {$/;"	a
l00071	doc/html/httpd__thread_8c-source.html	/^<a name="l00071"><\/a>00071                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"No valid request received from %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00072	doc/html/httpd__thread_8c-source.html	/^<a name="l00072"><\/a>00072         }$/;"	a
l00073	doc/html/httpd__thread_8c-source.html	/^<a name="l00073"><\/a>00073         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Closing connection with %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00074	doc/html/httpd__thread_8c-source.html	/^<a name="l00074"><\/a>00074         httpdEndRequest(r);$/;"	a
l00075	doc/html/httpd__thread_8c-source.html	/^<a name="l00075"><\/a>00075 }$/;"	a
2925feb4c55460a80bd30f6ef363779d	doc/html/httpd__thread_8c.html	/^<a class="anchor" name="2925feb4c55460a80bd30f6ef363779d"><\/a><!-- doxytag: member="httpd_thread.c::thread_httpd" ref="2925feb4c55460a80bd30f6ef363779d" args="(void *args)" -->$/;"	a
_details	doc/html/httpd__thread_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	doc/html/httpd__thread_8h-source.html	/^<h1>httpd_thread.h<\/h1><a href="httpd__thread_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/httpd__thread_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/httpd__thread_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/httpd__thread_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/httpd__thread_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/httpd__thread_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/httpd__thread_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/httpd__thread_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/httpd__thread_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/httpd__thread_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/httpd__thread_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/httpd__thread_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/httpd__thread_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/httpd__thread_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/httpd__thread_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/httpd__thread_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/httpd__thread_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/httpd__thread_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/httpd__thread_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/httpd__thread_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/httpd__thread_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: httpd_thread.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	doc/html/httpd__thread_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _HTTPD_THREAD_H_<\/span>$/;"	a
l00028	doc/html/httpd__thread_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _HTTPD_THREAD_H_<\/span>$/;"	a
l00029	doc/html/httpd__thread_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00031	doc/html/httpd__thread_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="keywordtype">void<\/span> <a class="code" href="httpd__thread_8c.html#2925feb4c55460a80bd30f6ef363779d" title="Handle a web request.">thread_httpd<\/a>(<span class="keywordtype">void<\/span> *args);$/;"	a
l00032	doc/html/httpd__thread_8h-source.html	/^<a name="l00032"><\/a>00032 $/;"	a
l00033	doc/html/httpd__thread_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#endif<\/span>$/;"	a
2925feb4c55460a80bd30f6ef363779d	doc/html/httpd__thread_8h.html	/^<a class="anchor" name="2925feb4c55460a80bd30f6ef363779d"><\/a><!-- doxytag: member="httpd_thread.h::thread_httpd" ref="2925feb4c55460a80bd30f6ef363779d" args="(void *args)" -->$/;"	a
_details	doc/html/httpd__thread_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	doc/html/ping__thread_8c-source.html	/^<h1>ping_thread.c<\/h1><a href="ping__thread_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/ping__thread_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/ping__thread_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/ping__thread_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/ping__thread_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/ping__thread_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/ping__thread_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/ping__thread_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/ping__thread_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/ping__thread_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/ping__thread_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/ping__thread_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/ping__thread_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/ping__thread_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/ping__thread_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/ping__thread_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/ping__thread_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/ping__thread_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/ping__thread_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/ping__thread_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/ping__thread_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: ping_thread.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00029	doc/html/ping__thread_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00030	doc/html/ping__thread_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor"><\/span>$/;"	a
l00031	doc/html/ping__thread_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00032	doc/html/ping__thread_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00033	doc/html/ping__thread_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00034	doc/html/ping__thread_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00035	doc/html/ping__thread_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00036	doc/html/ping__thread_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00037	doc/html/ping__thread_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00038	doc/html/ping__thread_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00039	doc/html/ping__thread_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00040	doc/html/ping__thread_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;netdb.h&gt;<\/span>$/;"	a
l00041	doc/html/ping__thread_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00042	doc/html/ping__thread_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00043	doc/html/ping__thread_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include &lt;signal.h&gt;<\/span>$/;"	a
l00044	doc/html/ping__thread_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00045	doc/html/ping__thread_8c-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	doc/html/ping__thread_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00047	doc/html/ping__thread_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00048	doc/html/ping__thread_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00049	doc/html/ping__thread_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00050	doc/html/ping__thread_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00051	doc/html/ping__thread_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include "<a class="code" href="ping__thread_8h.html" title="WiFiDog heartbeat thread.">ping_thread.h<\/a>"<\/span>$/;"	a
l00052	doc/html/ping__thread_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00053	doc/html/ping__thread_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00054	doc/html/ping__thread_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00055	doc/html/ping__thread_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> <a class="code" href="ping__thread_8c.html#2d355ce676ac949c810c9379cbba5ba9">ping<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00056	doc/html/ping__thread_8c-source.html	/^<a name="l00056"><\/a>00056 $/;"	a
l00057	doc/html/ping__thread_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="keyword">extern<\/span> time_t started_time;$/;"	a
l00058	doc/html/ping__thread_8c-source.html	/^<a name="l00058"><\/a>00058 $/;"	a
l00063	doc/html/ping__thread_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="keywordtype">void<\/span>$/;"	a
l00064	doc/html/ping__thread_8c-source.html	/^<a name="l00064"><\/a><a class="code" href="ping__thread_8h.html#3b019c5b71e02b8f475285a22222b296">00064<\/a> <a class="code" href="ping__thread_8c.html#3b019c5b71e02b8f475285a22222b296" title="Periodically checks on the auth server to see if it&amp;#39;s alive.">thread_ping<\/a>(<span class="keywordtype">void<\/span> *arg)$/;"	a
l00065	doc/html/ping__thread_8c-source.html	/^<a name="l00065"><\/a>00065 {$/;"	a
l00066	doc/html/ping__thread_8c-source.html	/^<a name="l00066"><\/a>00066         pthread_cond_t          cond = PTHREAD_COND_INITIALIZER;$/;"	a
l00067	doc/html/ping__thread_8c-source.html	/^<a name="l00067"><\/a>00067         pthread_mutex_t         cond_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00068	doc/html/ping__thread_8c-source.html	/^<a name="l00068"><\/a>00068         <span class="keyword">struct  <\/span>timespec        timeout;$/;"	a
l00069	doc/html/ping__thread_8c-source.html	/^<a name="l00069"><\/a>00069         $/;"	a
l00070	doc/html/ping__thread_8c-source.html	/^<a name="l00070"><\/a>00070         <span class="keywordflow">while<\/span> (1) {$/;"	a
l00071	doc/html/ping__thread_8c-source.html	/^<a name="l00071"><\/a>00071                 <span class="comment">\/* Make sure we check the servers at the very begining *\/<\/span>$/;"	a
l00072	doc/html/ping__thread_8c-source.html	/^<a name="l00072"><\/a>00072                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Running ping()"<\/span>);$/;"	a
l00073	doc/html/ping__thread_8c-source.html	/^<a name="l00073"><\/a>00073                 <a class="code" href="ping__thread_8c.html#2d355ce676ac949c810c9379cbba5ba9">ping<\/a>();$/;"	a
l00074	doc/html/ping__thread_8c-source.html	/^<a name="l00074"><\/a>00074                 $/;"	a
l00075	doc/html/ping__thread_8c-source.html	/^<a name="l00075"><\/a>00075                 <span class="comment">\/* Sleep for config.checkinterval seconds... *\/<\/span>$/;"	a
l00076	doc/html/ping__thread_8c-source.html	/^<a name="l00076"><\/a>00076                 timeout.tv_sec = time(NULL) + <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a>;$/;"	a
l00077	doc/html/ping__thread_8c-source.html	/^<a name="l00077"><\/a>00077                 timeout.tv_nsec = 0;$/;"	a
l00078	doc/html/ping__thread_8c-source.html	/^<a name="l00078"><\/a>00078 $/;"	a
l00079	doc/html/ping__thread_8c-source.html	/^<a name="l00079"><\/a>00079                 <span class="comment">\/* Mutex must be locked for pthread_cond_timedwait... *\/<\/span>$/;"	a
l00080	doc/html/ping__thread_8c-source.html	/^<a name="l00080"><\/a>00080                 pthread_mutex_lock(&amp;cond_mutex);$/;"	a
l00081	doc/html/ping__thread_8c-source.html	/^<a name="l00081"><\/a>00081                 $/;"	a
l00082	doc/html/ping__thread_8c-source.html	/^<a name="l00082"><\/a>00082                 <span class="comment">\/* Thread safe "sleep" *\/<\/span>$/;"	a
l00083	doc/html/ping__thread_8c-source.html	/^<a name="l00083"><\/a>00083                 pthread_cond_timedwait(&amp;cond, &amp;cond_mutex, &amp;timeout);$/;"	a
l00084	doc/html/ping__thread_8c-source.html	/^<a name="l00084"><\/a>00084 $/;"	a
l00085	doc/html/ping__thread_8c-source.html	/^<a name="l00085"><\/a>00085                 <span class="comment">\/* No longer needs to be locked *\/<\/span>$/;"	a
l00086	doc/html/ping__thread_8c-source.html	/^<a name="l00086"><\/a>00086                 pthread_mutex_unlock(&amp;cond_mutex);$/;"	a
l00087	doc/html/ping__thread_8c-source.html	/^<a name="l00087"><\/a>00087         }$/;"	a
l00088	doc/html/ping__thread_8c-source.html	/^<a name="l00088"><\/a>00088 }$/;"	a
l00089	doc/html/ping__thread_8c-source.html	/^<a name="l00089"><\/a>00089 $/;"	a
l00093	doc/html/ping__thread_8c-source.html	/^<a name="l00093"><\/a>00093 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00094	doc/html/ping__thread_8c-source.html	/^<a name="l00094"><\/a><a class="code" href="ping__thread_8c.html#2d355ce676ac949c810c9379cbba5ba9">00094<\/a> <a class="code" href="ping__thread_8c.html#2d355ce676ac949c810c9379cbba5ba9">ping<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00095	doc/html/ping__thread_8c-source.html	/^<a name="l00095"><\/a>00095 {$/;"	a
l00096	doc/html/ping__thread_8c-source.html	/^<a name="l00096"><\/a>00096         ssize_t                 numbytes;$/;"	a
l00097	doc/html/ping__thread_8c-source.html	/^<a name="l00097"><\/a>00097         <span class="keywordtype">size_t<\/span>                  totalbytes;$/;"	a
l00098	doc/html/ping__thread_8c-source.html	/^<a name="l00098"><\/a>00098         <span class="keywordtype">int<\/span>                     sockfd, nfds, done;$/;"	a
l00099	doc/html/ping__thread_8c-source.html	/^<a name="l00099"><\/a>00099         <span class="keywordtype">char<\/span>                    request[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00100	doc/html/ping__thread_8c-source.html	/^<a name="l00100"><\/a>00100         fd_set                  readfds;$/;"	a
l00101	doc/html/ping__thread_8c-source.html	/^<a name="l00101"><\/a>00101         <span class="keyword">struct <\/span>timeval          timeout;$/;"	a
l00102	doc/html/ping__thread_8c-source.html	/^<a name="l00102"><\/a>00102         FILE * fh;$/;"	a
l00103	doc/html/ping__thread_8c-source.html	/^<a name="l00103"><\/a>00103         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> sys_uptime  = 0;$/;"	a
l00104	doc/html/ping__thread_8c-source.html	/^<a name="l00104"><\/a>00104         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span>      sys_memfree = 0;$/;"	a
l00105	doc/html/ping__thread_8c-source.html	/^<a name="l00105"><\/a>00105         <span class="keywordtype">float<\/span>             sys_load    = 0;$/;"	a
l00106	doc/html/ping__thread_8c-source.html	/^<a name="l00106"><\/a>00106         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = NULL;$/;"	a
l00107	doc/html/ping__thread_8c-source.html	/^<a name="l00107"><\/a>00107         auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00108	doc/html/ping__thread_8c-source.html	/^<a name="l00108"><\/a>00108         $/;"	a
l00109	doc/html/ping__thread_8c-source.html	/^<a name="l00109"><\/a>00109         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Entering ping()"<\/span>);$/;"	a
l00110	doc/html/ping__thread_8c-source.html	/^<a name="l00110"><\/a>00110         $/;"	a
l00111	doc/html/ping__thread_8c-source.html	/^<a name="l00111"><\/a>00111         <span class="comment">\/*<\/span>$/;"	a
l00112	doc/html/ping__thread_8c-source.html	/^<a name="l00112"><\/a>00112 <span class="comment">         * The ping thread does not really try to see if the auth server is actually<\/span>$/;"	a
l00113	doc/html/ping__thread_8c-source.html	/^<a name="l00113"><\/a>00113 <span class="comment">         * working. Merely that there is a web server listening at the port. And that<\/span>$/;"	a
l00114	doc/html/ping__thread_8c-source.html	/^<a name="l00114"><\/a>00114 <span class="comment">         * is done by connect_auth_server() internally.<\/span>$/;"	a
l00115	doc/html/ping__thread_8c-source.html	/^<a name="l00115"><\/a>00115 <span class="comment">         *\/<\/span>$/;"	a
l00116	doc/html/ping__thread_8c-source.html	/^<a name="l00116"><\/a>00116         sockfd = <a class="code" href="centralserver_8c.html#168b78813319c6f409394019fcf45f62" title="Tries really hard to connect to an auth server. Returns a connected file descriptor...">connect_auth_server<\/a>();$/;"	a
l00117	doc/html/ping__thread_8c-source.html	/^<a name="l00117"><\/a>00117         <span class="keywordflow">if<\/span> (sockfd == -1) {$/;"	a
l00118	doc/html/ping__thread_8c-source.html	/^<a name="l00118"><\/a>00118                 <span class="comment">\/*<\/span>$/;"	a
l00119	doc/html/ping__thread_8c-source.html	/^<a name="l00119"><\/a>00119 <span class="comment">                 * No auth servers for me to talk to<\/span>$/;"	a
l00120	doc/html/ping__thread_8c-source.html	/^<a name="l00120"><\/a>00120 <span class="comment">                 *\/<\/span>$/;"	a
l00121	doc/html/ping__thread_8c-source.html	/^<a name="l00121"><\/a>00121                 <span class="keywordflow">return<\/span>;$/;"	a
l00122	doc/html/ping__thread_8c-source.html	/^<a name="l00122"><\/a>00122         }$/;"	a
l00123	doc/html/ping__thread_8c-source.html	/^<a name="l00123"><\/a>00123 $/;"	a
l00124	doc/html/ping__thread_8c-source.html	/^<a name="l00124"><\/a>00124         <span class="comment">\/*<\/span>$/;"	a
l00125	doc/html/ping__thread_8c-source.html	/^<a name="l00125"><\/a>00125 <span class="comment">         * Populate uptime, memfree and load<\/span>$/;"	a
l00126	doc/html/ping__thread_8c-source.html	/^<a name="l00126"><\/a>00126 <span class="comment">         *\/<\/span>$/;"	a
l00127	doc/html/ping__thread_8c-source.html	/^<a name="l00127"><\/a>00127         <span class="keywordflow">if<\/span> ((fh = fopen(<span class="stringliteral">"\/proc\/uptime"<\/span>, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00128	doc/html/ping__thread_8c-source.html	/^<a name="l00128"><\/a>00128                 fscanf(fh, <span class="stringliteral">"%lu"<\/span>, &amp;sys_uptime);$/;"	a
l00129	doc/html/ping__thread_8c-source.html	/^<a name="l00129"><\/a>00129                 fclose(fh);$/;"	a
l00130	doc/html/ping__thread_8c-source.html	/^<a name="l00130"><\/a>00130         }$/;"	a
l00131	doc/html/ping__thread_8c-source.html	/^<a name="l00131"><\/a>00131         <span class="keywordflow">if<\/span> ((fh = fopen(<span class="stringliteral">"\/proc\/meminfo"<\/span>, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00132	doc/html/ping__thread_8c-source.html	/^<a name="l00132"><\/a>00132                 <span class="keywordflow">while<\/span> (!feof(fh)) {$/;"	a
l00133	doc/html/ping__thread_8c-source.html	/^<a name="l00133"><\/a>00133                         <span class="keywordflow">if<\/span> (fscanf(fh, <span class="stringliteral">"MemFree: %u"<\/span>, &amp;sys_memfree) == 0) {$/;"	a
l00134	doc/html/ping__thread_8c-source.html	/^<a name="l00134"><\/a>00134                                 <span class="comment">\/* Not on this line *\/<\/span>$/;"	a
l00135	doc/html/ping__thread_8c-source.html	/^<a name="l00135"><\/a>00135                                 <span class="keywordflow">while<\/span> (!feof(fh) &amp;&amp; fgetc(fh) != <span class="charliteral">'\\n'<\/span>);$/;"	a
l00136	doc/html/ping__thread_8c-source.html	/^<a name="l00136"><\/a>00136                         }$/;"	a
l00137	doc/html/ping__thread_8c-source.html	/^<a name="l00137"><\/a>00137                         <span class="keywordflow">else<\/span> {$/;"	a
l00138	doc/html/ping__thread_8c-source.html	/^<a name="l00138"><\/a>00138                                 <span class="comment">\/* Found it *\/<\/span>$/;"	a
l00139	doc/html/ping__thread_8c-source.html	/^<a name="l00139"><\/a>00139                                 <span class="keywordflow">break<\/span>;$/;"	a
l00140	doc/html/ping__thread_8c-source.html	/^<a name="l00140"><\/a>00140                         }$/;"	a
l00141	doc/html/ping__thread_8c-source.html	/^<a name="l00141"><\/a>00141                 }$/;"	a
l00142	doc/html/ping__thread_8c-source.html	/^<a name="l00142"><\/a>00142                 fclose(fh);$/;"	a
l00143	doc/html/ping__thread_8c-source.html	/^<a name="l00143"><\/a>00143         }$/;"	a
l00144	doc/html/ping__thread_8c-source.html	/^<a name="l00144"><\/a>00144         <span class="keywordflow">if<\/span> ((fh = fopen(<span class="stringliteral">"\/proc\/loadavg"<\/span>, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00145	doc/html/ping__thread_8c-source.html	/^<a name="l00145"><\/a>00145                 fscanf(fh, <span class="stringliteral">"%f"<\/span>, &amp;sys_load);$/;"	a
l00146	doc/html/ping__thread_8c-source.html	/^<a name="l00146"><\/a>00146                 fclose(fh);$/;"	a
l00147	doc/html/ping__thread_8c-source.html	/^<a name="l00147"><\/a>00147         }$/;"	a
l00148	doc/html/ping__thread_8c-source.html	/^<a name="l00148"><\/a>00148 $/;"	a
l00149	doc/html/ping__thread_8c-source.html	/^<a name="l00149"><\/a>00149         <span class="comment">\/*<\/span>$/;"	a
l00150	doc/html/ping__thread_8c-source.html	/^<a name="l00150"><\/a>00150 <span class="comment">         * Prep &amp; send request<\/span>$/;"	a
l00151	doc/html/ping__thread_8c-source.html	/^<a name="l00151"><\/a>00151 <span class="comment">         *\/<\/span>$/;"	a
l00152	doc/html/ping__thread_8c-source.html	/^<a name="l00152"><\/a>00152         snprintf(request, <span class="keyword">sizeof<\/span>(request) - 1,$/;"	a
l00153	doc/html/ping__thread_8c-source.html	/^<a name="l00153"><\/a>00153                         <span class="stringliteral">"GET %s%sgw_id=%s&amp;sys_uptime=%lu&amp;sys_memfree=%u&amp;sys_load=%.2f&amp;wifidog_uptime=%lu HTTP\/1.0\\r\\n"<\/span>$/;"	a
l00154	doc/html/ping__thread_8c-source.html	/^<a name="l00154"><\/a>00154                         <span class="stringliteral">"User-Agent: WiFiDog %s\\r\\n"<\/span>$/;"	a
l00155	doc/html/ping__thread_8c-source.html	/^<a name="l00155"><\/a>00155                         <span class="stringliteral">"Host: %s\\r\\n"<\/span>$/;"	a
l00156	doc/html/ping__thread_8c-source.html	/^<a name="l00156"><\/a>00156                         <span class="stringliteral">"\\r\\n"<\/span>,$/;"	a
l00157	doc/html/ping__thread_8c-source.html	/^<a name="l00157"><\/a>00157                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#ff64f568944bbf0b01bb379b17ae2161" title="Path where wifidog resides.">authserv_path<\/a>,$/;"	a
l00158	doc/html/ping__thread_8c-source.html	/^<a name="l00158"><\/a>00158                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#b33784964244174aef057fa405f76756" title="This is the ping heartbeating script.">authserv_ping_script_path_fragment<\/a>,$/;"	a
l00159	doc/html/ping__thread_8c-source.html	/^<a name="l00159"><\/a>00159                         <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;gw_id,$/;"	a
l00160	doc/html/ping__thread_8c-source.html	/^<a name="l00160"><\/a>00160                         sys_uptime,$/;"	a
l00161	doc/html/ping__thread_8c-source.html	/^<a name="l00161"><\/a>00161                         sys_memfree,$/;"	a
l00162	doc/html/ping__thread_8c-source.html	/^<a name="l00162"><\/a>00162                         sys_load,$/;"	a
l00163	doc/html/ping__thread_8c-source.html	/^<a name="l00163"><\/a>00163                         (<span class="keywordtype">long<\/span> <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span>)((<span class="keywordtype">long<\/span> <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span>)time(NULL) - (<span class="keywordtype">long<\/span> <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span>)started_time),$/;"	a
l00164	doc/html/ping__thread_8c-source.html	/^<a name="l00164"><\/a>00164                         VERSION,$/;"	a
l00165	doc/html/ping__thread_8c-source.html	/^<a name="l00165"><\/a>00165                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>);$/;"	a
l00166	doc/html/ping__thread_8c-source.html	/^<a name="l00166"><\/a>00166 $/;"	a
l00167	doc/html/ping__thread_8c-source.html	/^<a name="l00167"><\/a>00167         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"HTTP Request to Server: [%s]"<\/span>, request);$/;"	a
l00168	doc/html/ping__thread_8c-source.html	/^<a name="l00168"><\/a>00168         $/;"	a
l00169	doc/html/ping__thread_8c-source.html	/^<a name="l00169"><\/a>00169         send(sockfd, request, strlen(request), 0);$/;"	a
l00170	doc/html/ping__thread_8c-source.html	/^<a name="l00170"><\/a>00170 $/;"	a
l00171	doc/html/ping__thread_8c-source.html	/^<a name="l00171"><\/a>00171         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Reading response"<\/span>);$/;"	a
l00172	doc/html/ping__thread_8c-source.html	/^<a name="l00172"><\/a>00172         $/;"	a
l00173	doc/html/ping__thread_8c-source.html	/^<a name="l00173"><\/a>00173         numbytes = totalbytes = 0;$/;"	a
l00174	doc/html/ping__thread_8c-source.html	/^<a name="l00174"><\/a>00174         done = 0;$/;"	a
l00175	doc/html/ping__thread_8c-source.html	/^<a name="l00175"><\/a>00175         <span class="keywordflow">do<\/span> {$/;"	a
l00176	doc/html/ping__thread_8c-source.html	/^<a name="l00176"><\/a>00176                 FD_ZERO(&amp;readfds);$/;"	a
l00177	doc/html/ping__thread_8c-source.html	/^<a name="l00177"><\/a>00177                 FD_SET(sockfd, &amp;readfds);$/;"	a
l00178	doc/html/ping__thread_8c-source.html	/^<a name="l00178"><\/a>00178                 timeout.tv_sec = 30; <span class="comment">\/* XXX magic... 30 second *\/<\/span>$/;"	a
l00179	doc/html/ping__thread_8c-source.html	/^<a name="l00179"><\/a>00179                 timeout.tv_usec = 0;$/;"	a
l00180	doc/html/ping__thread_8c-source.html	/^<a name="l00180"><\/a>00180                 nfds = sockfd + 1;$/;"	a
l00181	doc/html/ping__thread_8c-source.html	/^<a name="l00181"><\/a>00181 $/;"	a
l00182	doc/html/ping__thread_8c-source.html	/^<a name="l00182"><\/a>00182                 nfds = select(nfds, &amp;readfds, NULL, NULL, &amp;timeout);$/;"	a
l00183	doc/html/ping__thread_8c-source.html	/^<a name="l00183"><\/a>00183 $/;"	a
l00184	doc/html/ping__thread_8c-source.html	/^<a name="l00184"><\/a>00184                 <span class="keywordflow">if<\/span> (nfds &gt; 0) {$/;"	a
l00187	doc/html/ping__thread_8c-source.html	/^<a name="l00187"><\/a>00187                         numbytes = read(sockfd, request + totalbytes, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - (totalbytes + 1));$/;"	a
l00188	doc/html/ping__thread_8c-source.html	/^<a name="l00188"><\/a>00188                         <span class="keywordflow">if<\/span> (numbytes &lt; 0) {$/;"	a
l00189	doc/html/ping__thread_8c-source.html	/^<a name="l00189"><\/a>00189                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"An error occurred while reading from auth server: %s"<\/span>, strerror(errno));$/;"	a
l00190	doc/html/ping__thread_8c-source.html	/^<a name="l00190"><\/a>00190                                 <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00191	doc/html/ping__thread_8c-source.html	/^<a name="l00191"><\/a>00191                                 close(sockfd);$/;"	a
l00192	doc/html/ping__thread_8c-source.html	/^<a name="l00192"><\/a>00192                                 <span class="keywordflow">return<\/span>;$/;"	a
l00193	doc/html/ping__thread_8c-source.html	/^<a name="l00193"><\/a>00193                         }$/;"	a
l00194	doc/html/ping__thread_8c-source.html	/^<a name="l00194"><\/a>00194                         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (numbytes == 0) {$/;"	a
l00195	doc/html/ping__thread_8c-source.html	/^<a name="l00195"><\/a>00195                                 done = 1;$/;"	a
l00196	doc/html/ping__thread_8c-source.html	/^<a name="l00196"><\/a>00196                         }$/;"	a
l00197	doc/html/ping__thread_8c-source.html	/^<a name="l00197"><\/a>00197                         <span class="keywordflow">else<\/span> {$/;"	a
l00198	doc/html/ping__thread_8c-source.html	/^<a name="l00198"><\/a>00198                                 totalbytes += numbytes;$/;"	a
l00199	doc/html/ping__thread_8c-source.html	/^<a name="l00199"><\/a>00199                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read %d bytes, total now %d"<\/span>, numbytes, totalbytes);$/;"	a
l00200	doc/html/ping__thread_8c-source.html	/^<a name="l00200"><\/a>00200                         }$/;"	a
l00201	doc/html/ping__thread_8c-source.html	/^<a name="l00201"><\/a>00201                 }$/;"	a
l00202	doc/html/ping__thread_8c-source.html	/^<a name="l00202"><\/a>00202                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (nfds == 0) {$/;"	a
l00203	doc/html/ping__thread_8c-source.html	/^<a name="l00203"><\/a>00203                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Timed out reading data via select() from auth server"<\/span>);$/;"	a
l00204	doc/html/ping__thread_8c-source.html	/^<a name="l00204"><\/a>00204                         <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00205	doc/html/ping__thread_8c-source.html	/^<a name="l00205"><\/a>00205                         close(sockfd);$/;"	a
l00206	doc/html/ping__thread_8c-source.html	/^<a name="l00206"><\/a>00206                         <span class="keywordflow">return<\/span>;$/;"	a
l00207	doc/html/ping__thread_8c-source.html	/^<a name="l00207"><\/a>00207                 }$/;"	a
l00208	doc/html/ping__thread_8c-source.html	/^<a name="l00208"><\/a>00208                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (nfds &lt; 0) {$/;"	a
l00209	doc/html/ping__thread_8c-source.html	/^<a name="l00209"><\/a>00209                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Error reading data via select() from auth server: %s"<\/span>, strerror(errno));$/;"	a
l00210	doc/html/ping__thread_8c-source.html	/^<a name="l00210"><\/a>00210                         <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00211	doc/html/ping__thread_8c-source.html	/^<a name="l00211"><\/a>00211                         close(sockfd);$/;"	a
l00212	doc/html/ping__thread_8c-source.html	/^<a name="l00212"><\/a>00212                         <span class="keywordflow">return<\/span>;$/;"	a
l00213	doc/html/ping__thread_8c-source.html	/^<a name="l00213"><\/a>00213                 }$/;"	a
l00214	doc/html/ping__thread_8c-source.html	/^<a name="l00214"><\/a>00214         } <span class="keywordflow">while<\/span> (!done);$/;"	a
l00215	doc/html/ping__thread_8c-source.html	/^<a name="l00215"><\/a>00215         close(sockfd);$/;"	a
l00216	doc/html/ping__thread_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00217	doc/html/ping__thread_8c-source.html	/^<a name="l00217"><\/a>00217         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Done reading reply, total %d bytes"<\/span>, totalbytes);$/;"	a
l00218	doc/html/ping__thread_8c-source.html	/^<a name="l00218"><\/a>00218 $/;"	a
l00219	doc/html/ping__thread_8c-source.html	/^<a name="l00219"><\/a>00219         request[totalbytes] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00220	doc/html/ping__thread_8c-source.html	/^<a name="l00220"><\/a>00220 $/;"	a
l00221	doc/html/ping__thread_8c-source.html	/^<a name="l00221"><\/a>00221         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"HTTP Response from Server: [%s]"<\/span>, request);$/;"	a
l00222	doc/html/ping__thread_8c-source.html	/^<a name="l00222"><\/a>00222         $/;"	a
l00223	doc/html/ping__thread_8c-source.html	/^<a name="l00223"><\/a>00223         <span class="keywordflow">if<\/span> (strstr(request, <span class="stringliteral">"Pong"<\/span>) == 0) {$/;"	a
l00224	doc/html/ping__thread_8c-source.html	/^<a name="l00224"><\/a>00224                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"Auth server did NOT say pong!"<\/span>);$/;"	a
l00225	doc/html/ping__thread_8c-source.html	/^<a name="l00225"><\/a>00225                 <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00226	doc/html/ping__thread_8c-source.html	/^<a name="l00226"><\/a>00226         }$/;"	a
l00227	doc/html/ping__thread_8c-source.html	/^<a name="l00227"><\/a>00227         <span class="keywordflow">else<\/span> {$/;"	a
l00228	doc/html/ping__thread_8c-source.html	/^<a name="l00228"><\/a>00228                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Auth Server Says: Pong"<\/span>);$/;"	a
l00229	doc/html/ping__thread_8c-source.html	/^<a name="l00229"><\/a>00229         }$/;"	a
l00230	doc/html/ping__thread_8c-source.html	/^<a name="l00230"><\/a>00230 $/;"	a
l00231	doc/html/ping__thread_8c-source.html	/^<a name="l00231"><\/a>00231         <span class="keywordflow">return<\/span>; $/;"	a
l00232	doc/html/ping__thread_8c-source.html	/^<a name="l00232"><\/a>00232 }$/;"	a
2d355ce676ac949c810c9379cbba5ba9	doc/html/ping__thread_8c.html	/^<a class="anchor" name="2d355ce676ac949c810c9379cbba5ba9"><\/a><!-- doxytag: member="ping_thread.c::ping" ref="2d355ce676ac949c810c9379cbba5ba9" args="(void)" -->$/;"	a
3b019c5b71e02b8f475285a22222b296	doc/html/ping__thread_8c.html	/^<a class="anchor" name="3b019c5b71e02b8f475285a22222b296"><\/a><!-- doxytag: member="ping_thread.c::thread_ping" ref="3b019c5b71e02b8f475285a22222b296" args="(void *arg)" -->$/;"	a
_details	doc/html/ping__thread_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
f0eea6ebdbba8400df1fe94af7991211	doc/html/ping__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f0eea6ebdbba8400df1fe94af7991211"><\/a><!-- doxytag: member="ping_thread.c::started_time" ref="f0eea6ebdbba8400df1fe94af7991211" args="" -->$/;"	a
l00001	doc/html/ping__thread_8h-source.html	/^<h1>ping_thread.h<\/h1><a href="ping__thread_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/ping__thread_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/ping__thread_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/ping__thread_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/ping__thread_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/ping__thread_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/ping__thread_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/ping__thread_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/ping__thread_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/ping__thread_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/ping__thread_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/ping__thread_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/ping__thread_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/ping__thread_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/ping__thread_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/ping__thread_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/ping__thread_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/ping__thread_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/ping__thread_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/ping__thread_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/ping__thread_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: ping_thread.h 1104 2006-10-09 00:58:46Z acv $ *\/<\/span>$/;"	a
l00027	doc/html/ping__thread_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _PING_THREAD_H_<\/span>$/;"	a
l00028	doc/html/ping__thread_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _PING_THREAD_H_<\/span>$/;"	a
l00029	doc/html/ping__thread_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/ping__thread_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define MINIMUM_STARTED_TIME 1041379200 <\/span><span class="comment">\/* 2003-01-01 *\/<\/span>$/;"	a
l00031	doc/html/ping__thread_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00033	doc/html/ping__thread_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="keywordtype">void<\/span> <a class="code" href="ping__thread_8c.html#3b019c5b71e02b8f475285a22222b296" title="Periodically checks on the auth server to see if it&amp;#39;s alive.">thread_ping<\/a>(<span class="keywordtype">void<\/span> *arg);$/;"	a
l00034	doc/html/ping__thread_8h-source.html	/^<a name="l00034"><\/a>00034 $/;"	a
l00035	doc/html/ping__thread_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#endif<\/span>$/;"	a
1e3706b097a2ecc4d3390dedca7d5438	doc/html/ping__thread_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1e3706b097a2ecc4d3390dedca7d5438"><\/a><!-- doxytag: member="ping_thread.h::MINIMUM_STARTED_TIME" ref="1e3706b097a2ecc4d3390dedca7d5438" args="" -->$/;"	a
3b019c5b71e02b8f475285a22222b296	doc/html/ping__thread_8h.html	/^<a class="anchor" name="3b019c5b71e02b8f475285a22222b296"><\/a><!-- doxytag: member="ping_thread.h::thread_ping" ref="3b019c5b71e02b8f475285a22222b296" args="(void *arg)" -->$/;"	a
_details	doc/html/ping__thread_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	doc/html/safe_8c-source.html	/^<h1>safe.c<\/h1><a href="safe_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/safe_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/safe_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/safe_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/safe_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/safe_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/safe_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/safe_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/safe_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/safe_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/safe_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/safe_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/safe_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/safe_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/safe_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/safe_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/safe_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/safe_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/safe_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/safe_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/safe_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/*<\/span>$/;"	a
l00022	doc/html/safe_8c-source.html	/^<a name="l00022"><\/a>00022 <span class="comment"> * $Id: safe.c 901 2006-01-17 18:58:13Z mina $<\/span>$/;"	a
l00023	doc/html/safe_8c-source.html	/^<a name="l00023"><\/a>00023 <span class="comment"> *\/<\/span>$/;"	a
l00031	doc/html/safe_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00032	doc/html/safe_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00033	doc/html/safe_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00034	doc/html/safe_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00035	doc/html/safe_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00036	doc/html/safe_8c-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	doc/html/safe_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00038	doc/html/safe_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00039	doc/html/safe_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00040	doc/html/safe_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00041	doc/html/safe_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	doc/html/safe_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="comment">\/* From gateway.c *\/<\/span>$/;"	a
l00043	doc/html/safe_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="keyword">extern<\/span> httpd * webserver;$/;"	a
l00044	doc/html/safe_8c-source.html	/^<a name="l00044"><\/a>00044 $/;"	a
l00045	doc/html/safe_8c-source.html	/^<a name="l00045"><\/a><a class="code" href="safe_8h.html#c26280b92f7122e6f76a0407d26ae8e7">00045<\/a> <span class="keywordtype">void<\/span> * <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a> (<span class="keywordtype">size_t<\/span> size) {$/;"	a
l00046	doc/html/safe_8c-source.html	/^<a name="l00046"><\/a>00046         <span class="keywordtype">void<\/span> * retval = NULL;$/;"	a
l00047	doc/html/safe_8c-source.html	/^<a name="l00047"><\/a>00047         retval = malloc(size);$/;"	a
l00048	doc/html/safe_8c-source.html	/^<a name="l00048"><\/a>00048         <span class="keywordflow">if<\/span> (!retval) {$/;"	a
l00049	doc/html/safe_8c-source.html	/^<a name="l00049"><\/a>00049                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to malloc %d bytes of memory: %s.  Bailing out"<\/span>, size, strerror(errno));$/;"	a
l00050	doc/html/safe_8c-source.html	/^<a name="l00050"><\/a>00050                 exit(1);$/;"	a
l00051	doc/html/safe_8c-source.html	/^<a name="l00051"><\/a>00051         }$/;"	a
l00052	doc/html/safe_8c-source.html	/^<a name="l00052"><\/a>00052         <span class="keywordflow">return<\/span> (retval);$/;"	a
l00053	doc/html/safe_8c-source.html	/^<a name="l00053"><\/a>00053 }$/;"	a
l00054	doc/html/safe_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00055	doc/html/safe_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="keywordtype">char<\/span> * safe_strdup(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *s) {$/;"	a
l00056	doc/html/safe_8c-source.html	/^<a name="l00056"><\/a>00056         <span class="keywordtype">char<\/span> * retval = NULL;$/;"	a
l00057	doc/html/safe_8c-source.html	/^<a name="l00057"><\/a>00057         <span class="keywordflow">if<\/span> (!s) {$/;"	a
l00058	doc/html/safe_8c-source.html	/^<a name="l00058"><\/a>00058                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"safe_strdup called with NULL which would have crashed strdup. Bailing out"<\/span>);$/;"	a
l00059	doc/html/safe_8c-source.html	/^<a name="l00059"><\/a>00059                 exit(1);$/;"	a
l00060	doc/html/safe_8c-source.html	/^<a name="l00060"><\/a>00060         }$/;"	a
l00061	doc/html/safe_8c-source.html	/^<a name="l00061"><\/a>00061         retval = strdup(s);$/;"	a
l00062	doc/html/safe_8c-source.html	/^<a name="l00062"><\/a>00062         <span class="keywordflow">if<\/span> (!retval) {$/;"	a
l00063	doc/html/safe_8c-source.html	/^<a name="l00063"><\/a>00063                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to duplicate a string: %s.  Bailing out"<\/span>, strerror(errno));$/;"	a
l00064	doc/html/safe_8c-source.html	/^<a name="l00064"><\/a>00064                 exit(1);$/;"	a
l00065	doc/html/safe_8c-source.html	/^<a name="l00065"><\/a>00065         }$/;"	a
l00066	doc/html/safe_8c-source.html	/^<a name="l00066"><\/a>00066         <span class="keywordflow">return<\/span> (retval);$/;"	a
l00067	doc/html/safe_8c-source.html	/^<a name="l00067"><\/a>00067 }$/;"	a
l00068	doc/html/safe_8c-source.html	/^<a name="l00068"><\/a>00068 $/;"	a
l00069	doc/html/safe_8c-source.html	/^<a name="l00069"><\/a>00069 <span class="keywordtype">int<\/span> safe_asprintf(<span class="keywordtype">char<\/span> **strp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *fmt, ...) {$/;"	a
l00070	doc/html/safe_8c-source.html	/^<a name="l00070"><\/a>00070         va_list ap;$/;"	a
l00071	doc/html/safe_8c-source.html	/^<a name="l00071"><\/a>00071         <span class="keywordtype">int<\/span> retval;$/;"	a
l00072	doc/html/safe_8c-source.html	/^<a name="l00072"><\/a>00072 $/;"	a
l00073	doc/html/safe_8c-source.html	/^<a name="l00073"><\/a>00073         va_start(ap, fmt);$/;"	a
l00074	doc/html/safe_8c-source.html	/^<a name="l00074"><\/a>00074         retval = safe_vasprintf(strp, fmt, ap);$/;"	a
l00075	doc/html/safe_8c-source.html	/^<a name="l00075"><\/a>00075         va_end(ap);$/;"	a
l00076	doc/html/safe_8c-source.html	/^<a name="l00076"><\/a>00076 $/;"	a
l00077	doc/html/safe_8c-source.html	/^<a name="l00077"><\/a>00077         <span class="keywordflow">return<\/span> (retval);$/;"	a
l00078	doc/html/safe_8c-source.html	/^<a name="l00078"><\/a>00078 }$/;"	a
l00079	doc/html/safe_8c-source.html	/^<a name="l00079"><\/a>00079 $/;"	a
l00080	doc/html/safe_8c-source.html	/^<a name="l00080"><\/a>00080 <span class="keywordtype">int<\/span> safe_vasprintf(<span class="keywordtype">char<\/span> **strp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *fmt, va_list ap) {$/;"	a
l00081	doc/html/safe_8c-source.html	/^<a name="l00081"><\/a>00081         <span class="keywordtype">int<\/span> retval;$/;"	a
l00082	doc/html/safe_8c-source.html	/^<a name="l00082"><\/a>00082 $/;"	a
l00083	doc/html/safe_8c-source.html	/^<a name="l00083"><\/a>00083         retval = vasprintf(strp, fmt, ap);$/;"	a
l00084	doc/html/safe_8c-source.html	/^<a name="l00084"><\/a>00084 $/;"	a
l00085	doc/html/safe_8c-source.html	/^<a name="l00085"><\/a>00085         <span class="keywordflow">if<\/span> (retval == -1) {$/;"	a
l00086	doc/html/safe_8c-source.html	/^<a name="l00086"><\/a>00086                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to vasprintf: %s.  Bailing out"<\/span>, strerror(errno));$/;"	a
l00087	doc/html/safe_8c-source.html	/^<a name="l00087"><\/a>00087                 exit (1);$/;"	a
l00088	doc/html/safe_8c-source.html	/^<a name="l00088"><\/a>00088         }$/;"	a
l00089	doc/html/safe_8c-source.html	/^<a name="l00089"><\/a>00089         <span class="keywordflow">return<\/span> (retval);$/;"	a
l00090	doc/html/safe_8c-source.html	/^<a name="l00090"><\/a>00090 }$/;"	a
l00091	doc/html/safe_8c-source.html	/^<a name="l00091"><\/a>00091 $/;"	a
l00092	doc/html/safe_8c-source.html	/^<a name="l00092"><\/a>00092 pid_t safe_fork(<span class="keywordtype">void<\/span>) {$/;"	a
l00093	doc/html/safe_8c-source.html	/^<a name="l00093"><\/a>00093         pid_t result;$/;"	a
l00094	doc/html/safe_8c-source.html	/^<a name="l00094"><\/a>00094         result = fork();$/;"	a
l00095	doc/html/safe_8c-source.html	/^<a name="l00095"><\/a>00095 $/;"	a
l00096	doc/html/safe_8c-source.html	/^<a name="l00096"><\/a>00096         <span class="keywordflow">if<\/span> (result == -1) {$/;"	a
l00097	doc/html/safe_8c-source.html	/^<a name="l00097"><\/a>00097                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to fork: %s.  Bailing out"<\/span>, strerror(errno));$/;"	a
l00098	doc/html/safe_8c-source.html	/^<a name="l00098"><\/a>00098                 exit (1);$/;"	a
l00099	doc/html/safe_8c-source.html	/^<a name="l00099"><\/a>00099         }$/;"	a
l00100	doc/html/safe_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (result == 0) {$/;"	a
l00101	doc/html/safe_8c-source.html	/^<a name="l00101"><\/a>00101                 <span class="comment">\/* I'm the child - do some cleanup *\/<\/span>$/;"	a
l00102	doc/html/safe_8c-source.html	/^<a name="l00102"><\/a>00102                 <span class="keywordflow">if<\/span> (webserver) {$/;"	a
l00103	doc/html/safe_8c-source.html	/^<a name="l00103"><\/a>00103                         close(webserver-&gt;serverSock);$/;"	a
l00104	doc/html/safe_8c-source.html	/^<a name="l00104"><\/a>00104                         webserver = NULL;$/;"	a
l00105	doc/html/safe_8c-source.html	/^<a name="l00105"><\/a>00105                 }$/;"	a
l00106	doc/html/safe_8c-source.html	/^<a name="l00106"><\/a>00106         }$/;"	a
l00107	doc/html/safe_8c-source.html	/^<a name="l00107"><\/a>00107 $/;"	a
l00108	doc/html/safe_8c-source.html	/^<a name="l00108"><\/a>00108         <span class="keywordflow">return<\/span> result;$/;"	a
l00109	doc/html/safe_8c-source.html	/^<a name="l00109"><\/a>00109 }$/;"	a
l00110	doc/html/safe_8c-source.html	/^<a name="l00110"><\/a>00110 $/;"	a
26d804f329dea2733da34a4953a22a9d	doc/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="26d804f329dea2733da34a4953a22a9d"><\/a><!-- doxytag: member="safe.c::safe_strdup" ref="26d804f329dea2733da34a4953a22a9d" args="(const char *s)" -->$/;"	a
449f05a9c30dc0c5368ecbb5c3c9db9e	doc/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="449f05a9c30dc0c5368ecbb5c3c9db9e"><\/a><!-- doxytag: member="safe.c::safe_fork" ref="449f05a9c30dc0c5368ecbb5c3c9db9e" args="(void)" -->$/;"	a
4b7c5789d13951000a0b5faa1afeaa23	doc/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4b7c5789d13951000a0b5faa1afeaa23"><\/a><!-- doxytag: member="safe.c::safe_asprintf" ref="4b7c5789d13951000a0b5faa1afeaa23" args="(char **strp, const char *fmt,...)" -->$/;"	a
89cbee244ffadc05f3e2629ef0e9c3c2	doc/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="89cbee244ffadc05f3e2629ef0e9c3c2"><\/a><!-- doxytag: member="safe.c::safe_vasprintf" ref="89cbee244ffadc05f3e2629ef0e9c3c2" args="(char **strp, const char *fmt, va_list ap)" -->$/;"	a
_details	doc/html/safe_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a220f44b717da5c2f1b65fe1e068477a	doc/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a220f44b717da5c2f1b65fe1e068477a"><\/a><!-- doxytag: member="safe.c::webserver" ref="a220f44b717da5c2f1b65fe1e068477a" args="" -->$/;"	a
c26280b92f7122e6f76a0407d26ae8e7	doc/html/safe_8c.html	/^<a class="anchor" name="c26280b92f7122e6f76a0407d26ae8e7"><\/a><!-- doxytag: member="safe.c::safe_malloc" ref="c26280b92f7122e6f76a0407d26ae8e7" args="(size_t size)" -->$/;"	a
l00001	doc/html/safe_8h-source.html	/^<h1>safe.h<\/h1><a href="safe_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/safe_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/safe_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/safe_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/safe_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/safe_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/safe_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/safe_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/safe_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/safe_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/safe_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/safe_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/safe_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/safe_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/safe_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/safe_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/safe_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/safe_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/safe_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/safe_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/safe_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: safe.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	doc/html/safe_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _SAFE_H_<\/span>$/;"	a
l00028	doc/html/safe_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _SAFE_H_<\/span>$/;"	a
l00029	doc/html/safe_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/safe_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span> <span class="comment">\/* For va_list *\/<\/span>$/;"	a
l00031	doc/html/safe_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span> <span class="comment">\/* For fork *\/<\/span>$/;"	a
l00032	doc/html/safe_8h-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span> <span class="comment">\/* For fork *\/<\/span>$/;"	a
l00033	doc/html/safe_8h-source.html	/^<a name="l00033"><\/a>00033 $/;"	a
l00036	doc/html/safe_8h-source.html	/^<a name="l00036"><\/a>00036 <span class="keywordtype">void<\/span> * <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a> (<span class="keywordtype">size_t<\/span> size);$/;"	a
l00037	doc/html/safe_8h-source.html	/^<a name="l00037"><\/a>00037 $/;"	a
l00038	doc/html/safe_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="comment">\/* @brief Safe version of strdup<\/span>$/;"	a
l00039	doc/html/safe_8h-source.html	/^<a name="l00039"><\/a>00039 <span class="comment"> *\/<\/span>$/;"	a
l00040	doc/html/safe_8h-source.html	/^<a name="l00040"><\/a>00040 <span class="keywordtype">char<\/span> * safe_strdup(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *s);$/;"	a
l00041	doc/html/safe_8h-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	doc/html/safe_8h-source.html	/^<a name="l00042"><\/a>00042 <span class="comment">\/* @brief Safe version of asprintf<\/span>$/;"	a
l00043	doc/html/safe_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="comment"> *\/<\/span>$/;"	a
l00044	doc/html/safe_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="keywordtype">int<\/span> safe_asprintf(<span class="keywordtype">char<\/span> **strp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *fmt, ...);$/;"	a
l00045	doc/html/safe_8h-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	doc/html/safe_8h-source.html	/^<a name="l00046"><\/a>00046 <span class="comment">\/* @brief Safe version of vasprintf<\/span>$/;"	a
l00047	doc/html/safe_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="comment"> *\/<\/span>$/;"	a
l00048	doc/html/safe_8h-source.html	/^<a name="l00048"><\/a>00048 <span class="keywordtype">int<\/span> safe_vasprintf(<span class="keywordtype">char<\/span> **strp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *fmt, va_list ap);$/;"	a
l00049	doc/html/safe_8h-source.html	/^<a name="l00049"><\/a>00049 $/;"	a
l00050	doc/html/safe_8h-source.html	/^<a name="l00050"><\/a>00050 <span class="comment">\/* @brief Safe version of fork<\/span>$/;"	a
l00051	doc/html/safe_8h-source.html	/^<a name="l00051"><\/a>00051 <span class="comment"> *\/<\/span>$/;"	a
l00052	doc/html/safe_8h-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00053	doc/html/safe_8h-source.html	/^<a name="l00053"><\/a>00053 pid_t safe_fork(<span class="keywordtype">void<\/span>);$/;"	a
l00054	doc/html/safe_8h-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00055	doc/html/safe_8h-source.html	/^<a name="l00055"><\/a>00055 <span class="preprocessor">#endif <\/span><span class="comment">\/* _SAFE_H_ *\/<\/span>$/;"	a
l00056	doc/html/safe_8h-source.html	/^<a name="l00056"><\/a>00056 $/;"	a
26d804f329dea2733da34a4953a22a9d	doc/html/safe_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="26d804f329dea2733da34a4953a22a9d"><\/a><!-- doxytag: member="safe.h::safe_strdup" ref="26d804f329dea2733da34a4953a22a9d" args="(const char *s)" -->$/;"	a
449f05a9c30dc0c5368ecbb5c3c9db9e	doc/html/safe_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="449f05a9c30dc0c5368ecbb5c3c9db9e"><\/a><!-- doxytag: member="safe.h::safe_fork" ref="449f05a9c30dc0c5368ecbb5c3c9db9e" args="(void)" -->$/;"	a
4b7c5789d13951000a0b5faa1afeaa23	doc/html/safe_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4b7c5789d13951000a0b5faa1afeaa23"><\/a><!-- doxytag: member="safe.h::safe_asprintf" ref="4b7c5789d13951000a0b5faa1afeaa23" args="(char **strp, const char *fmt,...)" -->$/;"	a
89cbee244ffadc05f3e2629ef0e9c3c2	doc/html/safe_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="89cbee244ffadc05f3e2629ef0e9c3c2"><\/a><!-- doxytag: member="safe.h::safe_vasprintf" ref="89cbee244ffadc05f3e2629ef0e9c3c2" args="(char **strp, const char *fmt, va_list ap)" -->$/;"	a
_details	doc/html/safe_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
c26280b92f7122e6f76a0407d26ae8e7	doc/html/safe_8h.html	/^<a class="anchor" name="c26280b92f7122e6f76a0407d26ae8e7"><\/a><!-- doxytag: member="safe.h::safe_malloc" ref="c26280b92f7122e6f76a0407d26ae8e7" args="(size_t size)" -->$/;"	a
0752c3da9e2be08ca6d19449fa4cf425	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="0752c3da9e2be08ca6d19449fa4cf425"><\/a><!-- doxytag: member="_auth_serv_t::authserv_login_script_path_fragment" ref="0752c3da9e2be08ca6d19449fa4cf425" args="" -->$/;"	a
175f8cddd51f79e81679c70e2ce172f3	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="175f8cddd51f79e81679c70e2ce172f3"><\/a><!-- doxytag: member="_auth_serv_t::authserv_hostname" ref="175f8cddd51f79e81679c70e2ce172f3" args="" -->$/;"	a
7e294f129187f1449244d266028c68e5	doc/html/struct__auth__serv__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7e294f129187f1449244d266028c68e5"><\/a><!-- doxytag: member="_auth_serv_t::next" ref="7e294f129187f1449244d266028c68e5" args="" -->$/;"	a
7f1ad17f9e62f68144ff1981def918fb	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="7f1ad17f9e62f68144ff1981def918fb"><\/a><!-- doxytag: member="_auth_serv_t::authserv_http_port" ref="7f1ad17f9e62f68144ff1981def918fb" args="" -->$/;"	a
87bde1ef8a18890d18858a360d276098	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="87bde1ef8a18890d18858a360d276098"><\/a><!-- doxytag: member="_auth_serv_t::authserv_use_ssl" ref="87bde1ef8a18890d18858a360d276098" args="" -->$/;"	a
88f07a2b3771a88671ca3c4a77790f10	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="88f07a2b3771a88671ca3c4a77790f10"><\/a><!-- doxytag: member="_auth_serv_t::authserv_msg_script_path_fragment" ref="88f07a2b3771a88671ca3c4a77790f10" args="" -->$/;"	a
_details	doc/html/struct__auth__serv__t.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b33784964244174aef057fa405f76756	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="b33784964244174aef057fa405f76756"><\/a><!-- doxytag: member="_auth_serv_t::authserv_ping_script_path_fragment" ref="b33784964244174aef057fa405f76756" args="" -->$/;"	a
bb67841d88cfe9fd79f9b965dd72b28e	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="bb67841d88cfe9fd79f9b965dd72b28e"><\/a><!-- doxytag: member="_auth_serv_t::last_ip" ref="bb67841d88cfe9fd79f9b965dd72b28e" args="" -->$/;"	a
bcf430ab833dd65830904abf5793e1c6	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="bcf430ab833dd65830904abf5793e1c6"><\/a><!-- doxytag: member="_auth_serv_t::authserv_portal_script_path_fragment" ref="bcf430ab833dd65830904abf5793e1c6" args="" -->$/;"	a
c1144ccb4a8c9418fe1b92a13aa701e8	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="c1144ccb4a8c9418fe1b92a13aa701e8"><\/a><!-- doxytag: member="_auth_serv_t::authserv_auth_script_path_fragment" ref="c1144ccb4a8c9418fe1b92a13aa701e8" args="" -->$/;"	a
f4d82be7a680c24437a91ed1467f8921	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="f4d82be7a680c24437a91ed1467f8921"><\/a><!-- doxytag: member="_auth_serv_t::authserv_ssl_port" ref="f4d82be7a680c24437a91ed1467f8921" args="" -->$/;"	a
ff64f568944bbf0b01bb379b17ae2161	doc/html/struct__auth__serv__t.html	/^<a class="anchor" name="ff64f568944bbf0b01bb379b17ae2161"><\/a><!-- doxytag: member="_auth_serv_t::authserv_path" ref="ff64f568944bbf0b01bb379b17ae2161" args="" -->$/;"	a
172be165ac52a92dfe57e0911678698d	doc/html/struct__firewall__rule__t.html	/^<a class="anchor" name="172be165ac52a92dfe57e0911678698d"><\/a><!-- doxytag: member="_firewall_rule_t::port" ref="172be165ac52a92dfe57e0911678698d" args="" -->$/;"	a
4319185967c4252ced90b2d440034b47	doc/html/struct__firewall__rule__t.html	/^<a class="anchor" name="4319185967c4252ced90b2d440034b47"><\/a><!-- doxytag: member="_firewall_rule_t::block_allow" ref="4319185967c4252ced90b2d440034b47" args="" -->$/;"	a
46cf31ace7a4781cd8f67fbf3c8f75de	doc/html/struct__firewall__rule__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="46cf31ace7a4781cd8f67fbf3c8f75de"><\/a><!-- doxytag: member="_firewall_rule_t::next" ref="46cf31ace7a4781cd8f67fbf3c8f75de" args="" -->$/;"	a
71fecaae85673b8c3d00a7c14f528f73	doc/html/struct__firewall__rule__t.html	/^<a class="anchor" name="71fecaae85673b8c3d00a7c14f528f73"><\/a><!-- doxytag: member="_firewall_rule_t::mask" ref="71fecaae85673b8c3d00a7c14f528f73" args="" -->$/;"	a
_details	doc/html/struct__firewall__rule__t.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
de917f67daf277f81767a9ca7cb6ac1e	doc/html/struct__firewall__rule__t.html	/^<a class="anchor" name="de917f67daf277f81767a9ca7cb6ac1e"><\/a><!-- doxytag: member="_firewall_rule_t::protocol" ref="de917f67daf277f81767a9ca7cb6ac1e" args="" -->$/;"	a
01cf836d509e646ac7fee6d5ac791ead	doc/html/struct__firewall__ruleset__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="01cf836d509e646ac7fee6d5ac791ead"><\/a><!-- doxytag: member="_firewall_ruleset_t::name" ref="01cf836d509e646ac7fee6d5ac791ead" args="" -->$/;"	a
51556fca7d717b95a9b53695bfd0c07a	doc/html/struct__firewall__ruleset__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="51556fca7d717b95a9b53695bfd0c07a"><\/a><!-- doxytag: member="_firewall_ruleset_t::next" ref="51556fca7d717b95a9b53695bfd0c07a" args="" -->$/;"	a
_details	doc/html/struct__firewall__ruleset__t.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
ee34ad9758267b6ae770681d6017a4a7	doc/html/struct__firewall__ruleset__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ee34ad9758267b6ae770681d6017a4a7"><\/a><!-- doxytag: member="_firewall_ruleset_t::rules" ref="ee34ad9758267b6ae770681d6017a4a7" args="" -->$/;"	a
4d2a8485133db0ba5eb394bb45ba3e8d	doc/html/struct__t__authresponse.html	/^<a class="anchor" name="4d2a8485133db0ba5eb394bb45ba3e8d"><\/a><!-- doxytag: member="_t_authresponse::authcode" ref="4d2a8485133db0ba5eb394bb45ba3e8d" args="" -->$/;"	a
_details	doc/html/struct__t__authresponse.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
211c67d5a5f5eea8ea443947dccacf82	doc/html/struct__t__client.html	/^<a class="anchor" name="211c67d5a5f5eea8ea443947dccacf82"><\/a><!-- doxytag: member="_t_client::ip" ref="211c67d5a5f5eea8ea443947dccacf82" args="" -->$/;"	a
495baef8f1dc90c94c24561ebd61140d	doc/html/struct__t__client.html	/^<a class="anchor" name="495baef8f1dc90c94c24561ebd61140d"><\/a><!-- doxytag: member="_t_client::fd" ref="495baef8f1dc90c94c24561ebd61140d" args="" -->$/;"	a
530b82c768532f3467c80abd51c06d1b	doc/html/struct__t__client.html	/^<a class="anchor" name="530b82c768532f3467c80abd51c06d1b"><\/a><!-- doxytag: member="_t_client::mac" ref="530b82c768532f3467c80abd51c06d1b" args="" -->$/;"	a
5daa51a49977df48e0664b89f029f082	doc/html/struct__t__client.html	/^<a class="anchor" name="5daa51a49977df48e0664b89f029f082"><\/a><!-- doxytag: member="_t_client::next" ref="5daa51a49977df48e0664b89f029f082" args="" -->$/;"	a
6aa8adb62a098684aa47c3105a7090d1	doc/html/struct__t__client.html	/^<a class="anchor" name="6aa8adb62a098684aa47c3105a7090d1"><\/a><!-- doxytag: member="_t_client::counters" ref="6aa8adb62a098684aa47c3105a7090d1" args="" -->$/;"	a
80d3364a1172ca74e1fb475609a54a15	doc/html/struct__t__client.html	/^<a class="anchor" name="80d3364a1172ca74e1fb475609a54a15"><\/a><!-- doxytag: member="_t_client::fw_connection_state" ref="80d3364a1172ca74e1fb475609a54a15" args="" -->$/;"	a
_details	doc/html/struct__t__client.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
f75604bedd92e1054f3fca789a5a41ad	doc/html/struct__t__client.html	/^<a class="anchor" name="f75604bedd92e1054f3fca789a5a41ad"><\/a><!-- doxytag: member="_t_client::token" ref="f75604bedd92e1054f3fca789a5a41ad" args="" -->$/;"	a
10913bf2ef2987382c044428fb9c39e9	doc/html/struct__t__counters.html	/^<a class="anchor" name="10913bf2ef2987382c044428fb9c39e9"><\/a><!-- doxytag: member="_t_counters::incoming_history" ref="10913bf2ef2987382c044428fb9c39e9" args="" -->$/;"	a
6fbba5b171f4deb67169798cdfecb4ba	doc/html/struct__t__counters.html	/^<a class="anchor" name="6fbba5b171f4deb67169798cdfecb4ba"><\/a><!-- doxytag: member="_t_counters::outgoing_history" ref="6fbba5b171f4deb67169798cdfecb4ba" args="" -->$/;"	a
8953c7b1e636c79dad0359282c28b5d1	doc/html/struct__t__counters.html	/^<a class="anchor" name="8953c7b1e636c79dad0359282c28b5d1"><\/a><!-- doxytag: member="_t_counters::last_updated" ref="8953c7b1e636c79dad0359282c28b5d1" args="" -->$/;"	a
_details	doc/html/struct__t__counters.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
ad35b1bd0b0de20a4fbcacc133898063	doc/html/struct__t__counters.html	/^<a class="anchor" name="ad35b1bd0b0de20a4fbcacc133898063"><\/a><!-- doxytag: member="_t_counters::incoming" ref="ad35b1bd0b0de20a4fbcacc133898063" args="" -->$/;"	a
e8c2b343f2e37219011e5c53fd39390d	doc/html/struct__t__counters.html	/^<a class="anchor" name="e8c2b343f2e37219011e5c53fd39390d"><\/a><!-- doxytag: member="_t_counters::outgoing" ref="e8c2b343f2e37219011e5c53fd39390d" args="" -->$/;"	a
4e4381cfff2bbfbd9455640102b21f14	doc/html/struct__trusted__mac__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4e4381cfff2bbfbd9455640102b21f14"><\/a><!-- doxytag: member="_trusted_mac_t::mac" ref="4e4381cfff2bbfbd9455640102b21f14" args="" -->$/;"	a
949f4da24c7f33f4a8463dac5d9d565c	doc/html/struct__trusted__mac__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="949f4da24c7f33f4a8463dac5d9d565c"><\/a><!-- doxytag: member="_trusted_mac_t::next" ref="949f4da24c7f33f4a8463dac5d9d565c" args="" -->$/;"	a
_details	doc/html/struct__trusted__mac__t.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
0d3b219bafe97bb489549dcdd334b074	doc/html/structs__config.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0d3b219bafe97bb489549dcdd334b074"><\/a><!-- doxytag: member="s_config::param" ref="0d3b219bafe97bb489549dcdd334b074" args="" -->$/;"	a
10bef4a1d29228311acf38c9692a5a81	doc/html/structs__config.html	/^<a class="anchor" name="10bef4a1d29228311acf38c9692a5a81"><\/a><!-- doxytag: member="s_config::configfile" ref="10bef4a1d29228311acf38c9692a5a81" args="[255]" -->$/;"	a
116c013bc650d44eb25f9e3521b0f88d	doc/html/structs__config.html	/^<a class="anchor" name="116c013bc650d44eb25f9e3521b0f88d"><\/a><!-- doxytag: member="s_config::httpdusername" ref="116c013bc650d44eb25f9e3521b0f88d" args="" -->$/;"	a
132360d3c982b91fe0cdff6622eee1f1	doc/html/structs__config.html	/^<a class="anchor" name="132360d3c982b91fe0cdff6622eee1f1"><\/a><!-- doxytag: member="s_config::internal_sock" ref="132360d3c982b91fe0cdff6622eee1f1" args="" -->$/;"	a
16d75212a8b3ca23cadd6c5e5aa61189	doc/html/structs__config.html	/^<a class="anchor" name="16d75212a8b3ca23cadd6c5e5aa61189"><\/a><!-- doxytag: member="s_config::gw_port" ref="16d75212a8b3ca23cadd6c5e5aa61189" args="" -->$/;"	a
18aae60cdf3f7cf683a8344da8f039a6	doc/html/structs__config.html	/^<a class="anchor" name="18aae60cdf3f7cf683a8344da8f039a6"><\/a><!-- doxytag: member="s_config::htmlmsgfile" ref="18aae60cdf3f7cf683a8344da8f039a6" args="" -->$/;"	a
205a18044b75a27d255ca3fdf30c0d64	doc/html/structs__config.html	/^<a class="anchor" name="205a18044b75a27d255ca3fdf30c0d64"><\/a><!-- doxytag: member="s_config::trustedmaclist" ref="205a18044b75a27d255ca3fdf30c0d64" args="" -->$/;"	a
283515007953f307a7b599ee480b743d	doc/html/structs__config.html	/^<a class="anchor" name="283515007953f307a7b599ee480b743d"><\/a><!-- doxytag: member="s_config::httpdrealm" ref="283515007953f307a7b599ee480b743d" args="" -->$/;"	a
2d5969c6676bbefa37c435bfe018a15d	doc/html/structs__config.html	/^<a class="anchor" name="2d5969c6676bbefa37c435bfe018a15d"><\/a><!-- doxytag: member="s_config::wdctl_sock" ref="2d5969c6676bbefa37c435bfe018a15d" args="" -->$/;"	a
2ed9a59507be060fe0e1deae7fcc077b	doc/html/structs__config.html	/^<a class="anchor" name="2ed9a59507be060fe0e1deae7fcc077b"><\/a><!-- doxytag: member="s_config::httpdname" ref="2ed9a59507be060fe0e1deae7fcc077b" args="" -->$/;"	a
69743b1cf3e7e8d6ed2069e67f76a9a8	doc/html/structs__config.html	/^<a class="anchor" name="69743b1cf3e7e8d6ed2069e67f76a9a8"><\/a><!-- doxytag: member="s_config::gw_id" ref="69743b1cf3e7e8d6ed2069e67f76a9a8" args="" -->$/;"	a
72a375118114359c8fcf890bba1e77fb	doc/html/structs__config.html	/^<a class="anchor" name="72a375118114359c8fcf890bba1e77fb"><\/a><!-- doxytag: member="s_config::debuglevel" ref="72a375118114359c8fcf890bba1e77fb" args="" -->$/;"	a
784dd5fa3d27b3d1311b18f23e919362	doc/html/structs__config.html	/^<a class="anchor" name="784dd5fa3d27b3d1311b18f23e919362"><\/a><!-- doxytag: member="s_config::log_syslog" ref="784dd5fa3d27b3d1311b18f23e919362" args="" -->$/;"	a
7a24ca5b2cc1ff099bda0af17e654a95	doc/html/structs__config.html	/^<a class="anchor" name="7a24ca5b2cc1ff099bda0af17e654a95"><\/a><!-- doxytag: member="s_config::httpdmaxconn" ref="7a24ca5b2cc1ff099bda0af17e654a95" args="" -->$/;"	a
860efab2a31502f548fc188ba2243f4e	doc/html/structs__config.html	/^<a class="anchor" name="860efab2a31502f548fc188ba2243f4e"><\/a><!-- doxytag: member="s_config::auth_servers" ref="860efab2a31502f548fc188ba2243f4e" args="" -->$/;"	a
9284ae2f338cce20da86aa74916df38c	doc/html/structs__config.html	/^<a class="anchor" name="9284ae2f338cce20da86aa74916df38c"><\/a><!-- doxytag: member="s_config::clienttimeout" ref="9284ae2f338cce20da86aa74916df38c" args="" -->$/;"	a
93ffa58b6d61d2a8eb6dd31dc4346fd4	doc/html/structs__config.html	/^<a class="anchor" name="93ffa58b6d61d2a8eb6dd31dc4346fd4"><\/a><!-- doxytag: member="s_config::rulesets" ref="93ffa58b6d61d2a8eb6dd31dc4346fd4" args="" -->$/;"	a
9ef8928b35edeee0b3b4da39489c1ff7	doc/html/structs__config.html	/^<a class="anchor" name="9ef8928b35edeee0b3b4da39489c1ff7"><\/a><!-- doxytag: member="s_config::checkinterval" ref="9ef8928b35edeee0b3b4da39489c1ff7" args="" -->$/;"	a
_details	doc/html/structs__config.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a9067918ad171a070ccd631887fe2da0	doc/html/structs__config.html	/^<a class="anchor" name="a9067918ad171a070ccd631887fe2da0"><\/a><!-- doxytag: member="s_config::gw_address" ref="a9067918ad171a070ccd631887fe2da0" args="" -->$/;"	a
cf2da8057a1661fb677d6a4c805843a5	doc/html/structs__config.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cf2da8057a1661fb677d6a4c805843a5"><\/a><!-- doxytag: member="s_config::command" ref="cf2da8057a1661fb677d6a4c805843a5" args="" -->$/;"	a
d331abd0de5c051099d862891f454e7a	doc/html/structs__config.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d331abd0de5c051099d862891f454e7a"><\/a><!-- doxytag: member="s_config::socket" ref="d331abd0de5c051099d862891f454e7a" args="" -->$/;"	a
d618811ef3a6a0e3b373d972c6cf2e8c	doc/html/structs__config.html	/^<a class="anchor" name="d618811ef3a6a0e3b373d972c6cf2e8c"><\/a><!-- doxytag: member="s_config::gw_interface" ref="d618811ef3a6a0e3b373d972c6cf2e8c" args="" -->$/;"	a
e53582fbd0f3930cb34130a0f6d98389	doc/html/structs__config.html	/^<a class="anchor" name="e53582fbd0f3930cb34130a0f6d98389"><\/a><!-- doxytag: member="s_config::daemon" ref="e53582fbd0f3930cb34130a0f6d98389" args="" -->$/;"	a
e78aa9497032c5a27194633fcad862a5	doc/html/structs__config.html	/^<a class="anchor" name="e78aa9497032c5a27194633fcad862a5"><\/a><!-- doxytag: member="s_config::httpdpassword" ref="e78aa9497032c5a27194633fcad862a5" args="" -->$/;"	a
eaad87f73a87a2f752b111dad813902d	doc/html/structs__config.html	/^<a class="anchor" name="eaad87f73a87a2f752b111dad813902d"><\/a><!-- doxytag: member="s_config::syslog_facility" ref="eaad87f73a87a2f752b111dad813902d" args="" -->$/;"	a
ff90f0dcf55e28b34b056bb8a86f5b62	doc/html/structs__config.html	/^<a class="anchor" name="ff90f0dcf55e28b34b056bb8a86f5b62"><\/a><!-- doxytag: member="s_config::external_interface" ref="ff90f0dcf55e28b34b056bb8a86f5b62" args="" -->$/;"	a
_todo000001	doc/html/todo.html	/^<a class="anchor" name="_todo000001"><\/a> <dl>$/;"	a
_todo000003	doc/html/todo.html	/^<a class="anchor" name="_todo000003"><\/a> <dl>$/;"	a
_todo000004	doc/html/todo.html	/^<a class="anchor" name="_todo000004"><\/a> <dl>$/;"	a
_todo000005	doc/html/todo.html	/^<a class="anchor" name="_todo000005"><\/a> <dl>$/;"	a
_todo000006	doc/html/todo.html	/^<a class="anchor" name="_todo000006"><\/a> <dl>$/;"	a
_todo000007	doc/html/todo.html	/^<a class="anchor" name="_todo000007"><\/a> <dl>$/;"	a
todo	doc/html/todo.html	/^<h1><a class="anchor" name="todo">Todo List <\/a><\/h1><a class="anchor" name="_todo000001"><\/a> <dl>$/;"	a
toggleFolder	doc/html/tree.html	/^    function toggleFolder(id, imageNode) $/;"	f
l00001	doc/html/util_8c-source.html	/^<h1>util.c<\/h1><a href="util_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/util_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/util_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/util_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/util_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/util_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/util_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/util_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/util_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/util_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/util_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/util_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/util_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/util_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/util_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/util_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/util_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/util_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/util_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/util_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/util_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/*<\/span>$/;"	a
l00022	doc/html/util_8c-source.html	/^<a name="l00022"><\/a>00022 <span class="comment"> * $Id: util.c 1381 2008-09-30 12:16:08Z wichert $<\/span>$/;"	a
l00023	doc/html/util_8c-source.html	/^<a name="l00023"><\/a>00023 <span class="comment"> *\/<\/span>$/;"	a
l00031	doc/html/util_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00032	doc/html/util_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor"><\/span>$/;"	a
l00033	doc/html/util_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00034	doc/html/util_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00035	doc/html/util_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00036	doc/html/util_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00037	doc/html/util_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00038	doc/html/util_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;sys\/wait.h&gt;<\/span>$/;"	a
l00039	doc/html/util_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00040	doc/html/util_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;sys\/unistd.h&gt;<\/span>$/;"	a
l00041	doc/html/util_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00042	doc/html/util_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include &lt;sys\/ioctl.h&gt;<\/span>$/;"	a
l00043	doc/html/util_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00044	doc/html/util_8c-source.html	/^<a name="l00044"><\/a>00044 $/;"	a
l00045	doc/html/util_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#if defined(__NetBSD__)<\/span>$/;"	a
l00046	doc/html/util_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor"><\/span><span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00047	doc/html/util_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include &lt;ifaddrs.h&gt;<\/span>$/;"	a
l00048	doc/html/util_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include &lt;net\/if.h&gt;<\/span>$/;"	a
l00049	doc/html/util_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include &lt;net\/if_dl.h&gt;<\/span>$/;"	a
l00050	doc/html/util_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include &lt;<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>&gt;<\/span>$/;"	a
l00051	doc/html/util_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#endif<\/span>$/;"	a
l00052	doc/html/util_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor"><\/span>$/;"	a
l00053	doc/html/util_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#ifdef __linux__<\/span>$/;"	a
l00054	doc/html/util_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor"><\/span><span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00055	doc/html/util_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="preprocessor">#include &lt;net\/if.h&gt;<\/span>$/;"	a
l00056	doc/html/util_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="preprocessor">#endif<\/span>$/;"	a
l00057	doc/html/util_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="preprocessor"><\/span>$/;"	a
l00058	doc/html/util_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00059	doc/html/util_8c-source.html	/^<a name="l00059"><\/a>00059 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00060	doc/html/util_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="preprocessor">#include &lt;netdb.h&gt;<\/span>$/;"	a
l00061	doc/html/util_8c-source.html	/^<a name="l00061"><\/a>00061 $/;"	a
l00062	doc/html/util_8c-source.html	/^<a name="l00062"><\/a>00062 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00063	doc/html/util_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00064	doc/html/util_8c-source.html	/^<a name="l00064"><\/a>00064 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00065	doc/html/util_8c-source.html	/^<a name="l00065"><\/a>00065 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00066	doc/html/util_8c-source.html	/^<a name="l00066"><\/a>00066 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00067	doc/html/util_8c-source.html	/^<a name="l00067"><\/a>00067 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00068	doc/html/util_8c-source.html	/^<a name="l00068"><\/a>00068 $/;"	a
l00069	doc/html/util_8c-source.html	/^<a name="l00069"><\/a>00069 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00070	doc/html/util_8c-source.html	/^<a name="l00070"><\/a>00070 $/;"	a
l00071	doc/html/util_8c-source.html	/^<a name="l00071"><\/a>00071 <span class="keyword">static<\/span> pthread_mutex_t ghbn_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00072	doc/html/util_8c-source.html	/^<a name="l00072"><\/a>00072 $/;"	a
l00073	doc/html/util_8c-source.html	/^<a name="l00073"><\/a>00073 <span class="comment">\/* Defined in ping_thread.c *\/<\/span>$/;"	a
l00074	doc/html/util_8c-source.html	/^<a name="l00074"><\/a>00074 <span class="keyword">extern<\/span> time_t started_time;$/;"	a
l00075	doc/html/util_8c-source.html	/^<a name="l00075"><\/a>00075 $/;"	a
l00076	doc/html/util_8c-source.html	/^<a name="l00076"><\/a>00076 <span class="comment">\/* Defined in clientlist.c *\/<\/span>$/;"	a
l00077	doc/html/util_8c-source.html	/^<a name="l00077"><\/a>00077 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00078	doc/html/util_8c-source.html	/^<a name="l00078"><\/a>00078 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a>;$/;"	a
l00079	doc/html/util_8c-source.html	/^<a name="l00079"><\/a>00079 $/;"	a
l00080	doc/html/util_8c-source.html	/^<a name="l00080"><\/a>00080 <span class="comment">\/* Defined in commandline.c *\/<\/span>$/;"	a
l00081	doc/html/util_8c-source.html	/^<a name="l00081"><\/a>00081 <span class="keyword">extern<\/span> pid_t restart_orig_pid;$/;"	a
l00082	doc/html/util_8c-source.html	/^<a name="l00082"><\/a>00082 $/;"	a
l00083	doc/html/util_8c-source.html	/^<a name="l00083"><\/a>00083 <span class="comment">\/* XXX Do these need to be locked ? *\/<\/span>$/;"	a
l00084	doc/html/util_8c-source.html	/^<a name="l00084"><\/a>00084 <span class="keyword">static<\/span> time_t last_online_time = 0;$/;"	a
l00085	doc/html/util_8c-source.html	/^<a name="l00085"><\/a>00085 <span class="keyword">static<\/span> time_t last_offline_time = 0;$/;"	a
l00086	doc/html/util_8c-source.html	/^<a name="l00086"><\/a>00086 <span class="keyword">static<\/span> time_t last_auth_online_time = 0;$/;"	a
l00087	doc/html/util_8c-source.html	/^<a name="l00087"><\/a>00087 <span class="keyword">static<\/span> time_t last_auth_offline_time = 0;$/;"	a
l00088	doc/html/util_8c-source.html	/^<a name="l00088"><\/a>00088 $/;"	a
l00089	doc/html/util_8c-source.html	/^<a name="l00089"><\/a>00089 <span class="keywordtype">long<\/span> served_this_session = 0;$/;"	a
l00090	doc/html/util_8c-source.html	/^<a name="l00090"><\/a>00090 $/;"	a
l00096	doc/html/util_8c-source.html	/^<a name="l00096"><\/a>00096 <span class="keywordtype">int<\/span>$/;"	a
l00097	doc/html/util_8c-source.html	/^<a name="l00097"><\/a><a class="code" href="util_8h.html#d3c0ab429f95535fa08bc6a4fb884bab">00097<\/a> <a class="code" href="util_8c.html#d3c0ab429f95535fa08bc6a4fb884bab" title="Execute a shell command.">execute<\/a>(<span class="keywordtype">char<\/span> *cmd_line, <span class="keywordtype">int<\/span> quiet)$/;"	a
l00098	doc/html/util_8c-source.html	/^<a name="l00098"><\/a>00098 {$/;"	a
l00099	doc/html/util_8c-source.html	/^<a name="l00099"><\/a>00099         <span class="keywordtype">int<\/span> pid,$/;"	a
l00100	doc/html/util_8c-source.html	/^<a name="l00100"><\/a>00100             status,$/;"	a
l00101	doc/html/util_8c-source.html	/^<a name="l00101"><\/a>00101             rc;$/;"	a
l00102	doc/html/util_8c-source.html	/^<a name="l00102"><\/a>00102 $/;"	a
l00103	doc/html/util_8c-source.html	/^<a name="l00103"><\/a>00103         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *new_argv[4];$/;"	a
l00104	doc/html/util_8c-source.html	/^<a name="l00104"><\/a>00104         new_argv[0] = <span class="stringliteral">"\/bin\/sh"<\/span>;$/;"	a
l00105	doc/html/util_8c-source.html	/^<a name="l00105"><\/a>00105         new_argv[1] = <span class="stringliteral">"-c"<\/span>;$/;"	a
l00106	doc/html/util_8c-source.html	/^<a name="l00106"><\/a>00106         new_argv[2] = cmd_line;$/;"	a
l00107	doc/html/util_8c-source.html	/^<a name="l00107"><\/a>00107         new_argv[3] = NULL;$/;"	a
l00108	doc/html/util_8c-source.html	/^<a name="l00108"><\/a>00108 $/;"	a
l00109	doc/html/util_8c-source.html	/^<a name="l00109"><\/a>00109         pid = safe_fork();$/;"	a
l00110	doc/html/util_8c-source.html	/^<a name="l00110"><\/a>00110         <span class="keywordflow">if<\/span> (pid == 0) {    <span class="comment">\/* for the child process:         *\/<\/span>$/;"	a
l00111	doc/html/util_8c-source.html	/^<a name="l00111"><\/a>00111                 <span class="comment">\/* We don't want to see any errors if quiet flag is on *\/<\/span>$/;"	a
l00112	doc/html/util_8c-source.html	/^<a name="l00112"><\/a>00112                 <span class="keywordflow">if<\/span> (quiet) close(2);$/;"	a
l00113	doc/html/util_8c-source.html	/^<a name="l00113"><\/a>00113                 <span class="keywordflow">if<\/span> (execvp(<span class="stringliteral">"\/bin\/sh"<\/span>, (<span class="keywordtype">char<\/span> *<span class="keyword">const<\/span> *)new_argv) == -1) {    <span class="comment">\/* execute the command  *\/<\/span>$/;"	a
l00114	doc/html/util_8c-source.html	/^<a name="l00114"><\/a>00114                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"execvp(): %s"<\/span>, strerror(errno));$/;"	a
l00115	doc/html/util_8c-source.html	/^<a name="l00115"><\/a>00115                 } <span class="keywordflow">else<\/span> {$/;"	a
l00116	doc/html/util_8c-source.html	/^<a name="l00116"><\/a>00116                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"execvp() failed"<\/span>);$/;"	a
l00117	doc/html/util_8c-source.html	/^<a name="l00117"><\/a>00117                 }$/;"	a
l00118	doc/html/util_8c-source.html	/^<a name="l00118"><\/a>00118                 exit(1);$/;"	a
l00119	doc/html/util_8c-source.html	/^<a name="l00119"><\/a>00119         }$/;"	a
l00120	doc/html/util_8c-source.html	/^<a name="l00120"><\/a>00120 $/;"	a
l00121	doc/html/util_8c-source.html	/^<a name="l00121"><\/a>00121         <span class="comment">\/* for the parent:      *\/<\/span>$/;"	a
l00122	doc/html/util_8c-source.html	/^<a name="l00122"><\/a>00122         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Waiting for PID %d to exit"<\/span>, pid);$/;"	a
l00123	doc/html/util_8c-source.html	/^<a name="l00123"><\/a>00123         rc = waitpid(pid, &amp;status, 0);$/;"	a
l00124	doc/html/util_8c-source.html	/^<a name="l00124"><\/a>00124         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Process PID %d exited"<\/span>, rc);$/;"	a
l00125	doc/html/util_8c-source.html	/^<a name="l00125"><\/a>00125 $/;"	a
l00126	doc/html/util_8c-source.html	/^<a name="l00126"><\/a>00126         <span class="keywordflow">return<\/span> (WEXITSTATUS(status));$/;"	a
l00127	doc/html/util_8c-source.html	/^<a name="l00127"><\/a>00127 }$/;"	a
l00128	doc/html/util_8c-source.html	/^<a name="l00128"><\/a>00128 $/;"	a
l00129	doc/html/util_8c-source.html	/^<a name="l00129"><\/a>00129         <span class="keyword">struct <\/span>in_addr *$/;"	a
l00130	doc/html/util_8c-source.html	/^<a name="l00130"><\/a>00130 wd_gethostbyname(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *name)$/;"	a
l00131	doc/html/util_8c-source.html	/^<a name="l00131"><\/a>00131 {$/;"	a
l00132	doc/html/util_8c-source.html	/^<a name="l00132"><\/a>00132         <span class="keyword">struct <\/span>hostent *he;$/;"	a
l00133	doc/html/util_8c-source.html	/^<a name="l00133"><\/a>00133         <span class="keyword">struct <\/span>in_addr *h_addr, *in_addr_temp;$/;"	a
l00134	doc/html/util_8c-source.html	/^<a name="l00134"><\/a>00134 $/;"	a
l00135	doc/html/util_8c-source.html	/^<a name="l00135"><\/a>00135         <span class="comment">\/* XXX Calling function is reponsible for free() *\/<\/span>$/;"	a
l00136	doc/html/util_8c-source.html	/^<a name="l00136"><\/a>00136 $/;"	a
l00137	doc/html/util_8c-source.html	/^<a name="l00137"><\/a>00137         h_addr = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<span class="keyword">struct<\/span> in_addr));$/;"	a
l00138	doc/html/util_8c-source.html	/^<a name="l00138"><\/a>00138 $/;"	a
l00139	doc/html/util_8c-source.html	/^<a name="l00139"><\/a>00139         LOCK_GHBN();$/;"	a
l00140	doc/html/util_8c-source.html	/^<a name="l00140"><\/a>00140 $/;"	a
l00141	doc/html/util_8c-source.html	/^<a name="l00141"><\/a>00141         he = gethostbyname(name);$/;"	a
l00142	doc/html/util_8c-source.html	/^<a name="l00142"><\/a>00142 $/;"	a
l00143	doc/html/util_8c-source.html	/^<a name="l00143"><\/a>00143         <span class="keywordflow">if<\/span> (he == NULL) {$/;"	a
l00144	doc/html/util_8c-source.html	/^<a name="l00144"><\/a>00144                 free(h_addr);$/;"	a
l00145	doc/html/util_8c-source.html	/^<a name="l00145"><\/a>00145                 UNLOCK_GHBN();$/;"	a
l00146	doc/html/util_8c-source.html	/^<a name="l00146"><\/a>00146                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00147	doc/html/util_8c-source.html	/^<a name="l00147"><\/a>00147         }$/;"	a
l00148	doc/html/util_8c-source.html	/^<a name="l00148"><\/a>00148 $/;"	a
l00149	doc/html/util_8c-source.html	/^<a name="l00149"><\/a>00149         mark_online();$/;"	a
l00150	doc/html/util_8c-source.html	/^<a name="l00150"><\/a>00150 $/;"	a
l00151	doc/html/util_8c-source.html	/^<a name="l00151"><\/a>00151         in_addr_temp = (<span class="keyword">struct <\/span>in_addr *)he-&gt;h_addr_list[0];$/;"	a
l00152	doc/html/util_8c-source.html	/^<a name="l00152"><\/a>00152         h_addr-&gt;s_addr = in_addr_temp-&gt;s_addr;$/;"	a
l00153	doc/html/util_8c-source.html	/^<a name="l00153"><\/a>00153 $/;"	a
l00154	doc/html/util_8c-source.html	/^<a name="l00154"><\/a>00154         UNLOCK_GHBN();$/;"	a
l00155	doc/html/util_8c-source.html	/^<a name="l00155"><\/a>00155 $/;"	a
l00156	doc/html/util_8c-source.html	/^<a name="l00156"><\/a>00156         <span class="keywordflow">return<\/span> h_addr;$/;"	a
l00157	doc/html/util_8c-source.html	/^<a name="l00157"><\/a>00157 }$/;"	a
l00158	doc/html/util_8c-source.html	/^<a name="l00158"><\/a>00158 $/;"	a
l00159	doc/html/util_8c-source.html	/^<a name="l00159"><\/a>00159         <span class="keywordtype">char<\/span> *$/;"	a
l00160	doc/html/util_8c-source.html	/^<a name="l00160"><\/a>00160 get_iface_ip(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ifname)$/;"	a
l00161	doc/html/util_8c-source.html	/^<a name="l00161"><\/a>00161 {$/;"	a
l00162	doc/html/util_8c-source.html	/^<a name="l00162"><\/a>00162 <span class="preprocessor">#if defined(__linux__)<\/span>$/;"	a
l00163	doc/html/util_8c-source.html	/^<a name="l00163"><\/a>00163 <span class="preprocessor"><\/span>        <span class="keyword">struct <\/span>ifreq if_data;$/;"	a
l00164	doc/html/util_8c-source.html	/^<a name="l00164"><\/a>00164         <span class="keyword">struct <\/span>in_addr in;$/;"	a
l00165	doc/html/util_8c-source.html	/^<a name="l00165"><\/a>00165         <span class="keywordtype">char<\/span> *ip_str;$/;"	a
l00166	doc/html/util_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordtype">int<\/span> sockd;$/;"	a
l00167	doc/html/util_8c-source.html	/^<a name="l00167"><\/a>00167         u_int32_t ip;$/;"	a
l00168	doc/html/util_8c-source.html	/^<a name="l00168"><\/a>00168 $/;"	a
l00169	doc/html/util_8c-source.html	/^<a name="l00169"><\/a>00169         <span class="comment">\/* Create a socket *\/<\/span>$/;"	a
l00170	doc/html/util_8c-source.html	/^<a name="l00170"><\/a>00170         <span class="keywordflow">if<\/span> ((sockd = socket (AF_INET, SOCK_PACKET, htons(0x8086))) &lt; 0) {$/;"	a
l00171	doc/html/util_8c-source.html	/^<a name="l00171"><\/a>00171                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"socket(): %s"<\/span>, strerror(errno));$/;"	a
l00172	doc/html/util_8c-source.html	/^<a name="l00172"><\/a>00172                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00173	doc/html/util_8c-source.html	/^<a name="l00173"><\/a>00173         }$/;"	a
l00174	doc/html/util_8c-source.html	/^<a name="l00174"><\/a>00174 $/;"	a
l00175	doc/html/util_8c-source.html	/^<a name="l00175"><\/a>00175         <span class="comment">\/* Get IP of internal interface *\/<\/span>$/;"	a
l00176	doc/html/util_8c-source.html	/^<a name="l00176"><\/a>00176         strcpy (if_data.ifr_name, ifname);$/;"	a
l00177	doc/html/util_8c-source.html	/^<a name="l00177"><\/a>00177 $/;"	a
l00178	doc/html/util_8c-source.html	/^<a name="l00178"><\/a>00178         <span class="comment">\/* Get the IP address *\/<\/span>$/;"	a
l00179	doc/html/util_8c-source.html	/^<a name="l00179"><\/a>00179         <span class="keywordflow">if<\/span> (ioctl (sockd, SIOCGIFADDR, &amp;if_data) &lt; 0) {$/;"	a
l00180	doc/html/util_8c-source.html	/^<a name="l00180"><\/a>00180                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"ioctl(): SIOCGIFADDR %s"<\/span>, strerror(errno));$/;"	a
l00181	doc/html/util_8c-source.html	/^<a name="l00181"><\/a>00181                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00182	doc/html/util_8c-source.html	/^<a name="l00182"><\/a>00182         }$/;"	a
l00183	doc/html/util_8c-source.html	/^<a name="l00183"><\/a>00183         memcpy ((<span class="keywordtype">void<\/span> *) &amp;ip, (<span class="keywordtype">void<\/span> *) &amp;if_data.ifr_addr.sa_data + 2, 4);$/;"	a
l00184	doc/html/util_8c-source.html	/^<a name="l00184"><\/a>00184         in.s_addr = ip;$/;"	a
l00185	doc/html/util_8c-source.html	/^<a name="l00185"><\/a>00185 $/;"	a
l00186	doc/html/util_8c-source.html	/^<a name="l00186"><\/a>00186         ip_str = inet_ntoa(in);$/;"	a
l00187	doc/html/util_8c-source.html	/^<a name="l00187"><\/a>00187         close(sockd);$/;"	a
l00188	doc/html/util_8c-source.html	/^<a name="l00188"><\/a>00188         <span class="keywordflow">return<\/span> safe_strdup(ip_str);$/;"	a
l00189	doc/html/util_8c-source.html	/^<a name="l00189"><\/a>00189 <span class="preprocessor">#elif defined(__NetBSD__)<\/span>$/;"	a
l00190	doc/html/util_8c-source.html	/^<a name="l00190"><\/a>00190 <span class="preprocessor"><\/span>        <span class="keyword">struct <\/span>ifaddrs *ifa, *ifap;$/;"	a
l00191	doc/html/util_8c-source.html	/^<a name="l00191"><\/a>00191         <span class="keywordtype">char<\/span> *str = NULL;$/;"	a
l00192	doc/html/util_8c-source.html	/^<a name="l00192"><\/a>00192 $/;"	a
l00193	doc/html/util_8c-source.html	/^<a name="l00193"><\/a>00193         <span class="keywordflow">if<\/span> (getifaddrs(&amp;ifap) == -1) {$/;"	a
l00194	doc/html/util_8c-source.html	/^<a name="l00194"><\/a>00194                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"getifaddrs(): %s"<\/span>, strerror(errno));$/;"	a
l00195	doc/html/util_8c-source.html	/^<a name="l00195"><\/a>00195                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00196	doc/html/util_8c-source.html	/^<a name="l00196"><\/a>00196         }$/;"	a
l00197	doc/html/util_8c-source.html	/^<a name="l00197"><\/a>00197         <span class="comment">\/* XXX arbitrarily pick the first IPv4 address *\/<\/span>$/;"	a
l00198	doc/html/util_8c-source.html	/^<a name="l00198"><\/a>00198         <span class="keywordflow">for<\/span> (ifa = ifap; ifa != NULL; ifa = ifa-&gt;ifa_next) {$/;"	a
l00199	doc/html/util_8c-source.html	/^<a name="l00199"><\/a>00199                 <span class="keywordflow">if<\/span> (strcmp(ifa-&gt;ifa_name, ifname) == 0 &amp;&amp;$/;"	a
l00200	doc/html/util_8c-source.html	/^<a name="l00200"><\/a>00200                                 ifa-&gt;ifa_addr-&gt;sa_family == AF_INET)$/;"	a
l00201	doc/html/util_8c-source.html	/^<a name="l00201"><\/a>00201                         <span class="keywordflow">break<\/span>;$/;"	a
l00202	doc/html/util_8c-source.html	/^<a name="l00202"><\/a>00202         }$/;"	a
l00203	doc/html/util_8c-source.html	/^<a name="l00203"><\/a>00203         <span class="keywordflow">if<\/span> (ifa == NULL) {$/;"	a
l00204	doc/html/util_8c-source.html	/^<a name="l00204"><\/a>00204                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"%s: no IPv4 address assigned"<\/span>);$/;"	a
l00205	doc/html/util_8c-source.html	/^<a name="l00205"><\/a>00205                 <span class="keywordflow">goto<\/span> out;$/;"	a
l00206	doc/html/util_8c-source.html	/^<a name="l00206"><\/a>00206         }$/;"	a
l00207	doc/html/util_8c-source.html	/^<a name="l00207"><\/a>00207         str = safe_strdup(inet_ntoa($/;"	a
l00208	doc/html/util_8c-source.html	/^<a name="l00208"><\/a>00208                                 ((<span class="keyword">struct<\/span> sockaddr_in *)ifa-&gt;ifa_addr)-&gt;sin_addr));$/;"	a
l00209	doc/html/util_8c-source.html	/^<a name="l00209"><\/a>00209 out:$/;"	a
l00210	doc/html/util_8c-source.html	/^<a name="l00210"><\/a>00210         freeifaddrs(ifap);$/;"	a
l00211	doc/html/util_8c-source.html	/^<a name="l00211"><\/a>00211         <span class="keywordflow">return<\/span> str;$/;"	a
l00212	doc/html/util_8c-source.html	/^<a name="l00212"><\/a>00212 <span class="preprocessor">#else<\/span>$/;"	a
l00213	doc/html/util_8c-source.html	/^<a name="l00213"><\/a>00213 <span class="preprocessor"><\/span>        <span class="keywordflow">return<\/span> safe_strdup(<span class="stringliteral">"0.0.0.0"<\/span>);$/;"	a
l00214	doc/html/util_8c-source.html	/^<a name="l00214"><\/a>00214 <span class="preprocessor">#endif<\/span>$/;"	a
l00215	doc/html/util_8c-source.html	/^<a name="l00215"><\/a>00215 <span class="preprocessor"><\/span>}$/;"	a
l00216	doc/html/util_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00217	doc/html/util_8c-source.html	/^<a name="l00217"><\/a>00217         <span class="keywordtype">char<\/span> *$/;"	a
l00218	doc/html/util_8c-source.html	/^<a name="l00218"><\/a>00218 get_iface_mac(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ifname)$/;"	a
l00219	doc/html/util_8c-source.html	/^<a name="l00219"><\/a>00219 {$/;"	a
l00220	doc/html/util_8c-source.html	/^<a name="l00220"><\/a>00220 <span class="preprocessor">#if defined(__linux__)<\/span>$/;"	a
l00221	doc/html/util_8c-source.html	/^<a name="l00221"><\/a>00221 <span class="preprocessor"><\/span>        <span class="keywordtype">int<\/span> r, s;$/;"	a
l00222	doc/html/util_8c-source.html	/^<a name="l00222"><\/a>00222         <span class="keyword">struct <\/span>ifreq ifr;$/;"	a
l00223	doc/html/util_8c-source.html	/^<a name="l00223"><\/a>00223         <span class="keywordtype">char<\/span> *hwaddr, mac[13];$/;"	a
l00224	doc/html/util_8c-source.html	/^<a name="l00224"><\/a>00224 $/;"	a
l00225	doc/html/util_8c-source.html	/^<a name="l00225"><\/a>00225         strcpy(ifr.ifr_name, ifname);$/;"	a
l00226	doc/html/util_8c-source.html	/^<a name="l00226"><\/a>00226 $/;"	a
l00227	doc/html/util_8c-source.html	/^<a name="l00227"><\/a>00227         s = socket(PF_INET, SOCK_DGRAM, 0);$/;"	a
l00228	doc/html/util_8c-source.html	/^<a name="l00228"><\/a>00228         <span class="keywordflow">if<\/span> (-1 == s) {$/;"	a
l00229	doc/html/util_8c-source.html	/^<a name="l00229"><\/a>00229                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"get_iface_mac socket: %s"<\/span>, strerror(errno));$/;"	a
l00230	doc/html/util_8c-source.html	/^<a name="l00230"><\/a>00230                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00231	doc/html/util_8c-source.html	/^<a name="l00231"><\/a>00231         }$/;"	a
l00232	doc/html/util_8c-source.html	/^<a name="l00232"><\/a>00232 $/;"	a
l00233	doc/html/util_8c-source.html	/^<a name="l00233"><\/a>00233         r = ioctl(s, SIOCGIFHWADDR, &amp;ifr);$/;"	a
l00234	doc/html/util_8c-source.html	/^<a name="l00234"><\/a>00234         <span class="keywordflow">if<\/span> (r == -1) {$/;"	a
l00235	doc/html/util_8c-source.html	/^<a name="l00235"><\/a>00235                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"get_iface_mac ioctl(SIOCGIFHWADDR): %s"<\/span>, strerror(errno));$/;"	a
l00236	doc/html/util_8c-source.html	/^<a name="l00236"><\/a>00236                 close(s);$/;"	a
l00237	doc/html/util_8c-source.html	/^<a name="l00237"><\/a>00237                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00238	doc/html/util_8c-source.html	/^<a name="l00238"><\/a>00238         }$/;"	a
l00239	doc/html/util_8c-source.html	/^<a name="l00239"><\/a>00239 $/;"	a
l00240	doc/html/util_8c-source.html	/^<a name="l00240"><\/a>00240         hwaddr = ifr.ifr_hwaddr.sa_data;$/;"	a
l00241	doc/html/util_8c-source.html	/^<a name="l00241"><\/a>00241         close(s);$/;"	a
l00242	doc/html/util_8c-source.html	/^<a name="l00242"><\/a>00242         snprintf(mac, <span class="keyword">sizeof<\/span>(mac), <span class="stringliteral">"%02X%02X%02X%02X%02X%02X"<\/span>, $/;"	a
l00243	doc/html/util_8c-source.html	/^<a name="l00243"><\/a>00243                         hwaddr[0] &amp; 0xFF,$/;"	a
l00244	doc/html/util_8c-source.html	/^<a name="l00244"><\/a>00244                         hwaddr[1] &amp; 0xFF,$/;"	a
l00245	doc/html/util_8c-source.html	/^<a name="l00245"><\/a>00245                         hwaddr[2] &amp; 0xFF,$/;"	a
l00246	doc/html/util_8c-source.html	/^<a name="l00246"><\/a>00246                         hwaddr[3] &amp; 0xFF,$/;"	a
l00247	doc/html/util_8c-source.html	/^<a name="l00247"><\/a>00247                         hwaddr[4] &amp; 0xFF,$/;"	a
l00248	doc/html/util_8c-source.html	/^<a name="l00248"><\/a>00248                         hwaddr[5] &amp; 0xFF$/;"	a
l00249	doc/html/util_8c-source.html	/^<a name="l00249"><\/a>00249                 );$/;"	a
l00250	doc/html/util_8c-source.html	/^<a name="l00250"><\/a>00250 $/;"	a
l00251	doc/html/util_8c-source.html	/^<a name="l00251"><\/a>00251         <span class="keywordflow">return<\/span> safe_strdup(mac);$/;"	a
l00252	doc/html/util_8c-source.html	/^<a name="l00252"><\/a>00252 <span class="preprocessor">#elif defined(__NetBSD__)<\/span>$/;"	a
l00253	doc/html/util_8c-source.html	/^<a name="l00253"><\/a>00253 <span class="preprocessor"><\/span>        <span class="keyword">struct <\/span>ifaddrs *ifa, *ifap;$/;"	a
l00254	doc/html/util_8c-source.html	/^<a name="l00254"><\/a>00254         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *hwaddr;$/;"	a
l00255	doc/html/util_8c-source.html	/^<a name="l00255"><\/a>00255         <span class="keywordtype">char<\/span> mac[13], *str = NULL;$/;"	a
l00256	doc/html/util_8c-source.html	/^<a name="l00256"><\/a>00256         <span class="keyword">struct <\/span>sockaddr_dl *sdl;$/;"	a
l00257	doc/html/util_8c-source.html	/^<a name="l00257"><\/a>00257 $/;"	a
l00258	doc/html/util_8c-source.html	/^<a name="l00258"><\/a>00258         <span class="keywordflow">if<\/span> (getifaddrs(&amp;ifap) == -1) {$/;"	a
l00259	doc/html/util_8c-source.html	/^<a name="l00259"><\/a>00259                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"getifaddrs(): %s"<\/span>, strerror(errno));$/;"	a
l00260	doc/html/util_8c-source.html	/^<a name="l00260"><\/a>00260                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00261	doc/html/util_8c-source.html	/^<a name="l00261"><\/a>00261         }$/;"	a
l00262	doc/html/util_8c-source.html	/^<a name="l00262"><\/a>00262         <span class="keywordflow">for<\/span> (ifa = ifap; ifa != NULL; ifa = ifa-&gt;ifa_next) {$/;"	a
l00263	doc/html/util_8c-source.html	/^<a name="l00263"><\/a>00263                 <span class="keywordflow">if<\/span> (strcmp(ifa-&gt;ifa_name, ifname) == 0 &amp;&amp;$/;"	a
l00264	doc/html/util_8c-source.html	/^<a name="l00264"><\/a>00264                                 ifa-&gt;ifa_addr-&gt;sa_family == AF_LINK)$/;"	a
l00265	doc/html/util_8c-source.html	/^<a name="l00265"><\/a>00265                         <span class="keywordflow">break<\/span>;$/;"	a
l00266	doc/html/util_8c-source.html	/^<a name="l00266"><\/a>00266         }$/;"	a
l00267	doc/html/util_8c-source.html	/^<a name="l00267"><\/a>00267         <span class="keywordflow">if<\/span> (ifa == NULL) {$/;"	a
l00268	doc/html/util_8c-source.html	/^<a name="l00268"><\/a>00268                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"%s: no link-layer address assigned"<\/span>);$/;"	a
l00269	doc/html/util_8c-source.html	/^<a name="l00269"><\/a>00269                 <span class="keywordflow">goto<\/span> out;$/;"	a
l00270	doc/html/util_8c-source.html	/^<a name="l00270"><\/a>00270         }$/;"	a
l00271	doc/html/util_8c-source.html	/^<a name="l00271"><\/a>00271         sdl = (<span class="keyword">struct <\/span>sockaddr_dl *)ifa-&gt;ifa_addr;$/;"	a
l00272	doc/html/util_8c-source.html	/^<a name="l00272"><\/a>00272         hwaddr = LLADDR(sdl);$/;"	a
l00273	doc/html/util_8c-source.html	/^<a name="l00273"><\/a>00273         snprintf(mac, <span class="keyword">sizeof<\/span>(mac), <span class="stringliteral">"%02X%02X%02X%02X%02X%02X"<\/span>,$/;"	a
l00274	doc/html/util_8c-source.html	/^<a name="l00274"><\/a>00274                         hwaddr[0] &amp; 0xFF, hwaddr[1] &amp; 0xFF,$/;"	a
l00275	doc/html/util_8c-source.html	/^<a name="l00275"><\/a>00275                         hwaddr[2] &amp; 0xFF, hwaddr[3] &amp; 0xFF,$/;"	a
l00276	doc/html/util_8c-source.html	/^<a name="l00276"><\/a>00276                         hwaddr[4] &amp; 0xFF, hwaddr[5] &amp; 0xFF);$/;"	a
l00277	doc/html/util_8c-source.html	/^<a name="l00277"><\/a>00277 $/;"	a
l00278	doc/html/util_8c-source.html	/^<a name="l00278"><\/a>00278         str = safe_strdup(mac);$/;"	a
l00279	doc/html/util_8c-source.html	/^<a name="l00279"><\/a>00279 out:$/;"	a
l00280	doc/html/util_8c-source.html	/^<a name="l00280"><\/a>00280         freeifaddrs(ifap);$/;"	a
l00281	doc/html/util_8c-source.html	/^<a name="l00281"><\/a>00281         <span class="keywordflow">return<\/span> str;$/;"	a
l00282	doc/html/util_8c-source.html	/^<a name="l00282"><\/a>00282 <span class="preprocessor">#else<\/span>$/;"	a
l00283	doc/html/util_8c-source.html	/^<a name="l00283"><\/a>00283 <span class="preprocessor"><\/span>        <span class="keywordflow">return<\/span> NULL;$/;"	a
l00284	doc/html/util_8c-source.html	/^<a name="l00284"><\/a>00284 <span class="preprocessor">#endif<\/span>$/;"	a
l00285	doc/html/util_8c-source.html	/^<a name="l00285"><\/a>00285 <span class="preprocessor"><\/span>}$/;"	a
l00286	doc/html/util_8c-source.html	/^<a name="l00286"><\/a>00286 $/;"	a
l00287	doc/html/util_8c-source.html	/^<a name="l00287"><\/a>00287         <span class="keywordtype">char<\/span> *$/;"	a
l00288	doc/html/util_8c-source.html	/^<a name="l00288"><\/a>00288 get_ext_iface(<span class="keywordtype">void<\/span>)$/;"	a
l00289	doc/html/util_8c-source.html	/^<a name="l00289"><\/a>00289 {$/;"	a
l00290	doc/html/util_8c-source.html	/^<a name="l00290"><\/a>00290 <span class="preprocessor">#ifdef __linux__<\/span>$/;"	a
l00291	doc/html/util_8c-source.html	/^<a name="l00291"><\/a>00291 <span class="preprocessor"><\/span>        FILE *input;$/;"	a
l00292	doc/html/util_8c-source.html	/^<a name="l00292"><\/a>00292         <span class="keywordtype">char<\/span> *device, *gw;$/;"	a
l00293	doc/html/util_8c-source.html	/^<a name="l00293"><\/a>00293         <span class="keywordtype">int<\/span> i = 1;$/;"	a
l00294	doc/html/util_8c-source.html	/^<a name="l00294"><\/a>00294         <span class="keywordtype">int<\/span> keep_detecting = 1;$/;"	a
l00295	doc/html/util_8c-source.html	/^<a name="l00295"><\/a>00295         pthread_cond_t          cond = PTHREAD_COND_INITIALIZER;$/;"	a
l00296	doc/html/util_8c-source.html	/^<a name="l00296"><\/a>00296         pthread_mutex_t         cond_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00297	doc/html/util_8c-source.html	/^<a name="l00297"><\/a>00297         <span class="keyword">struct  <\/span>timespec        timeout;$/;"	a
l00298	doc/html/util_8c-source.html	/^<a name="l00298"><\/a>00298         device = (<span class="keywordtype">char<\/span> *)malloc(16);$/;"	a
l00299	doc/html/util_8c-source.html	/^<a name="l00299"><\/a>00299         gw = (<span class="keywordtype">char<\/span> *)malloc(16);$/;"	a
l00300	doc/html/util_8c-source.html	/^<a name="l00300"><\/a>00300         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"get_ext_iface(): Autodectecting the external interface from routing table"<\/span>);$/;"	a
l00301	doc/html/util_8c-source.html	/^<a name="l00301"><\/a>00301         <span class="keywordflow">while<\/span>(keep_detecting) {$/;"	a
l00302	doc/html/util_8c-source.html	/^<a name="l00302"><\/a>00302                 input = fopen(<span class="stringliteral">"\/proc\/net\/route"<\/span>, <span class="stringliteral">"r"<\/span>);$/;"	a
l00303	doc/html/util_8c-source.html	/^<a name="l00303"><\/a>00303                 <span class="keywordflow">while<\/span> (!feof(input)) {$/;"	a
l00304	doc/html/util_8c-source.html	/^<a name="l00304"><\/a>00304                         <span class="comment">\/* XXX scanf(3) is unsafe, risks overrun *\/<\/span> $/;"	a
l00305	doc/html/util_8c-source.html	/^<a name="l00305"><\/a>00305                         fscanf(input, <span class="stringliteral">"%s %s %*s %*s %*s %*s %*s %*s %*s %*s %*s\\n"<\/span>, device, gw);$/;"	a
l00306	doc/html/util_8c-source.html	/^<a name="l00306"><\/a>00306                         <span class="keywordflow">if<\/span> (strcmp(gw, <span class="stringliteral">"00000000"<\/span>) == 0) {$/;"	a
l00307	doc/html/util_8c-source.html	/^<a name="l00307"><\/a>00307                                 free(gw);$/;"	a
l00308	doc/html/util_8c-source.html	/^<a name="l00308"><\/a>00308                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"get_ext_iface(): Detected %s as the default interface after try %d"<\/span>, device, i);$/;"	a
l00309	doc/html/util_8c-source.html	/^<a name="l00309"><\/a>00309                                 <span class="keywordflow">return<\/span> device;$/;"	a
l00310	doc/html/util_8c-source.html	/^<a name="l00310"><\/a>00310                         }$/;"	a
l00311	doc/html/util_8c-source.html	/^<a name="l00311"><\/a>00311                 }$/;"	a
l00312	doc/html/util_8c-source.html	/^<a name="l00312"><\/a>00312                 fclose(input);$/;"	a
l00313	doc/html/util_8c-source.html	/^<a name="l00313"><\/a>00313                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"get_ext_iface(): Failed to detect the external interface after try %d (maybe the interface is not up yet?).  Retry limit: %d"<\/span>, i, <a class="code" href="conf_8h.html#771a6a60dbaa6c7532ab6cd31b397f7d">NUM_EXT_INTERFACE_DETECT_RETRY<\/a>);$/;"	a
l00314	doc/html/util_8c-source.html	/^<a name="l00314"><\/a>00314                 <span class="comment">\/* Sleep for EXT_INTERFACE_DETECT_RETRY_INTERVAL seconds *\/<\/span>$/;"	a
l00315	doc/html/util_8c-source.html	/^<a name="l00315"><\/a>00315                 timeout.tv_sec = time(NULL) + <a class="code" href="conf_8h.html#b67c119b3d066438d4c3405b518bb289">EXT_INTERFACE_DETECT_RETRY_INTERVAL<\/a>;$/;"	a
l00316	doc/html/util_8c-source.html	/^<a name="l00316"><\/a>00316                 timeout.tv_nsec = 0;$/;"	a
l00317	doc/html/util_8c-source.html	/^<a name="l00317"><\/a>00317                 <span class="comment">\/* Mutex must be locked for pthread_cond_timedwait... *\/<\/span>$/;"	a
l00318	doc/html/util_8c-source.html	/^<a name="l00318"><\/a>00318                 pthread_mutex_lock(&amp;cond_mutex);        $/;"	a
l00319	doc/html/util_8c-source.html	/^<a name="l00319"><\/a>00319                 <span class="comment">\/* Thread safe "sleep" *\/<\/span>$/;"	a
l00320	doc/html/util_8c-source.html	/^<a name="l00320"><\/a>00320                 pthread_cond_timedwait(&amp;cond, &amp;cond_mutex, &amp;timeout);$/;"	a
l00321	doc/html/util_8c-source.html	/^<a name="l00321"><\/a>00321                 <span class="comment">\/* No longer needs to be locked *\/<\/span>$/;"	a
l00322	doc/html/util_8c-source.html	/^<a name="l00322"><\/a>00322                 pthread_mutex_unlock(&amp;cond_mutex);$/;"	a
l00323	doc/html/util_8c-source.html	/^<a name="l00323"><\/a>00323                 <span class="comment">\/\/for (i=1; i&lt;=NUM_EXT_INTERFACE_DETECT_RETRY; i++) {<\/span>$/;"	a
l00324	doc/html/util_8c-source.html	/^<a name="l00324"><\/a>00324                 <span class="keywordflow">if<\/span> (<a class="code" href="conf_8h.html#771a6a60dbaa6c7532ab6cd31b397f7d">NUM_EXT_INTERFACE_DETECT_RETRY<\/a> != 0 &amp;&amp; i&gt;<a class="code" href="conf_8h.html#771a6a60dbaa6c7532ab6cd31b397f7d">NUM_EXT_INTERFACE_DETECT_RETRY<\/a>) {$/;"	a
l00325	doc/html/util_8c-source.html	/^<a name="l00325"><\/a>00325                         keep_detecting = 0;$/;"	a
l00326	doc/html/util_8c-source.html	/^<a name="l00326"><\/a>00326                 }$/;"	a
l00327	doc/html/util_8c-source.html	/^<a name="l00327"><\/a>00327                 i++;$/;"	a
l00328	doc/html/util_8c-source.html	/^<a name="l00328"><\/a>00328         }$/;"	a
l00329	doc/html/util_8c-source.html	/^<a name="l00329"><\/a>00329         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"get_ext_iface(): Failed to detect the external interface after %d tries, aborting"<\/span>, i);$/;"	a
l00330	doc/html/util_8c-source.html	/^<a name="l00330"><\/a>00330         exit(1);$/;"	a
l00331	doc/html/util_8c-source.html	/^<a name="l00331"><\/a>00331         free(device);$/;"	a
l00332	doc/html/util_8c-source.html	/^<a name="l00332"><\/a>00332         free(gw);$/;"	a
l00333	doc/html/util_8c-source.html	/^<a name="l00333"><\/a>00333 <span class="preprocessor">#endif<\/span>$/;"	a
l00334	doc/html/util_8c-source.html	/^<a name="l00334"><\/a>00334 <span class="preprocessor"><\/span>        <span class="keywordflow">return<\/span> NULL;$/;"	a
l00335	doc/html/util_8c-source.html	/^<a name="l00335"><\/a>00335         }$/;"	a
l00336	doc/html/util_8c-source.html	/^<a name="l00336"><\/a>00336 $/;"	a
l00337	doc/html/util_8c-source.html	/^<a name="l00337"><\/a>00337         <span class="keywordtype">void<\/span> mark_online() {$/;"	a
l00338	doc/html/util_8c-source.html	/^<a name="l00338"><\/a>00338                 <span class="keywordtype">int<\/span> before;$/;"	a
l00339	doc/html/util_8c-source.html	/^<a name="l00339"><\/a>00339                 <span class="keywordtype">int<\/span> after;$/;"	a
l00340	doc/html/util_8c-source.html	/^<a name="l00340"><\/a>00340 $/;"	a
l00341	doc/html/util_8c-source.html	/^<a name="l00341"><\/a>00341                 before = is_online();$/;"	a
l00342	doc/html/util_8c-source.html	/^<a name="l00342"><\/a>00342                 time(&amp;last_online_time);$/;"	a
l00343	doc/html/util_8c-source.html	/^<a name="l00343"><\/a>00343                 after = is_online();$/;"	a
l00344	doc/html/util_8c-source.html	/^<a name="l00344"><\/a>00344 $/;"	a
l00345	doc/html/util_8c-source.html	/^<a name="l00345"><\/a>00345                 <span class="keywordflow">if<\/span> (before != after) {$/;"	a
l00346	doc/html/util_8c-source.html	/^<a name="l00346"><\/a>00346                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"ONLINE status became %s"<\/span>, (after ? <span class="stringliteral">"ON"<\/span> : <span class="stringliteral">"OFF"<\/span>));$/;"	a
l00347	doc/html/util_8c-source.html	/^<a name="l00347"><\/a>00347                 }$/;"	a
l00348	doc/html/util_8c-source.html	/^<a name="l00348"><\/a>00348 $/;"	a
l00349	doc/html/util_8c-source.html	/^<a name="l00349"><\/a>00349         }$/;"	a
l00350	doc/html/util_8c-source.html	/^<a name="l00350"><\/a>00350 $/;"	a
l00351	doc/html/util_8c-source.html	/^<a name="l00351"><\/a>00351         <span class="keywordtype">void<\/span> mark_offline() {$/;"	a
l00352	doc/html/util_8c-source.html	/^<a name="l00352"><\/a>00352                 <span class="keywordtype">int<\/span> before;$/;"	a
l00353	doc/html/util_8c-source.html	/^<a name="l00353"><\/a>00353                 <span class="keywordtype">int<\/span> after;$/;"	a
l00354	doc/html/util_8c-source.html	/^<a name="l00354"><\/a>00354 $/;"	a
l00355	doc/html/util_8c-source.html	/^<a name="l00355"><\/a>00355                 before = is_online();$/;"	a
l00356	doc/html/util_8c-source.html	/^<a name="l00356"><\/a>00356                 time(&amp;last_offline_time);$/;"	a
l00357	doc/html/util_8c-source.html	/^<a name="l00357"><\/a>00357                 after = is_online();$/;"	a
l00358	doc/html/util_8c-source.html	/^<a name="l00358"><\/a>00358 $/;"	a
l00359	doc/html/util_8c-source.html	/^<a name="l00359"><\/a>00359                 <span class="keywordflow">if<\/span> (before != after) {$/;"	a
l00360	doc/html/util_8c-source.html	/^<a name="l00360"><\/a>00360                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"ONLINE status became %s"<\/span>, (after ? <span class="stringliteral">"ON"<\/span> : <span class="stringliteral">"OFF"<\/span>));$/;"	a
l00361	doc/html/util_8c-source.html	/^<a name="l00361"><\/a>00361                 }$/;"	a
l00362	doc/html/util_8c-source.html	/^<a name="l00362"><\/a>00362 $/;"	a
l00363	doc/html/util_8c-source.html	/^<a name="l00363"><\/a>00363                 <span class="comment">\/* If we're offline it definately means the auth server is offline *\/<\/span>$/;"	a
l00364	doc/html/util_8c-source.html	/^<a name="l00364"><\/a>00364                 mark_auth_offline();$/;"	a
l00365	doc/html/util_8c-source.html	/^<a name="l00365"><\/a>00365 $/;"	a
l00366	doc/html/util_8c-source.html	/^<a name="l00366"><\/a>00366         }$/;"	a
l00367	doc/html/util_8c-source.html	/^<a name="l00367"><\/a>00367 $/;"	a
l00368	doc/html/util_8c-source.html	/^<a name="l00368"><\/a>00368         <span class="keywordtype">int<\/span> is_online() {$/;"	a
l00369	doc/html/util_8c-source.html	/^<a name="l00369"><\/a>00369                 <span class="keywordflow">if<\/span> (last_online_time == 0 || (last_offline_time - last_online_time) &gt;= (<a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;checkinterval * 2) ) {$/;"	a
l00370	doc/html/util_8c-source.html	/^<a name="l00370"><\/a>00370                         <span class="comment">\/* We're probably offline *\/<\/span>$/;"	a
l00371	doc/html/util_8c-source.html	/^<a name="l00371"><\/a>00371                         <span class="keywordflow">return<\/span> (0);$/;"	a
l00372	doc/html/util_8c-source.html	/^<a name="l00372"><\/a>00372                 }$/;"	a
l00373	doc/html/util_8c-source.html	/^<a name="l00373"><\/a>00373                 <span class="keywordflow">else<\/span> {$/;"	a
l00374	doc/html/util_8c-source.html	/^<a name="l00374"><\/a>00374                         <span class="comment">\/* We're probably online *\/<\/span>$/;"	a
l00375	doc/html/util_8c-source.html	/^<a name="l00375"><\/a>00375                         <span class="keywordflow">return<\/span> (1);$/;"	a
l00376	doc/html/util_8c-source.html	/^<a name="l00376"><\/a>00376                 }$/;"	a
l00377	doc/html/util_8c-source.html	/^<a name="l00377"><\/a>00377         }$/;"	a
l00378	doc/html/util_8c-source.html	/^<a name="l00378"><\/a>00378 $/;"	a
l00379	doc/html/util_8c-source.html	/^<a name="l00379"><\/a>00379         <span class="keywordtype">void<\/span> mark_auth_online() {$/;"	a
l00380	doc/html/util_8c-source.html	/^<a name="l00380"><\/a>00380                 <span class="keywordtype">int<\/span> before;$/;"	a
l00381	doc/html/util_8c-source.html	/^<a name="l00381"><\/a>00381                 <span class="keywordtype">int<\/span> after;$/;"	a
l00382	doc/html/util_8c-source.html	/^<a name="l00382"><\/a>00382 $/;"	a
l00383	doc/html/util_8c-source.html	/^<a name="l00383"><\/a>00383                 before = is_auth_online();$/;"	a
l00384	doc/html/util_8c-source.html	/^<a name="l00384"><\/a>00384                 time(&amp;last_auth_online_time);$/;"	a
l00385	doc/html/util_8c-source.html	/^<a name="l00385"><\/a>00385                 after = is_auth_online();$/;"	a
l00386	doc/html/util_8c-source.html	/^<a name="l00386"><\/a>00386 $/;"	a
l00387	doc/html/util_8c-source.html	/^<a name="l00387"><\/a>00387                 <span class="keywordflow">if<\/span> (before != after) {$/;"	a
l00388	doc/html/util_8c-source.html	/^<a name="l00388"><\/a>00388                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"AUTH_ONLINE status became %s"<\/span>, (after ? <span class="stringliteral">"ON"<\/span> : <span class="stringliteral">"OFF"<\/span>));$/;"	a
l00389	doc/html/util_8c-source.html	/^<a name="l00389"><\/a>00389                 }$/;"	a
l00390	doc/html/util_8c-source.html	/^<a name="l00390"><\/a>00390 $/;"	a
l00391	doc/html/util_8c-source.html	/^<a name="l00391"><\/a>00391                 <span class="comment">\/* If auth server is online it means we're definately online *\/<\/span>$/;"	a
l00392	doc/html/util_8c-source.html	/^<a name="l00392"><\/a>00392                 mark_online();$/;"	a
l00393	doc/html/util_8c-source.html	/^<a name="l00393"><\/a>00393 $/;"	a
l00394	doc/html/util_8c-source.html	/^<a name="l00394"><\/a>00394         }$/;"	a
l00395	doc/html/util_8c-source.html	/^<a name="l00395"><\/a>00395 $/;"	a
l00396	doc/html/util_8c-source.html	/^<a name="l00396"><\/a>00396         <span class="keywordtype">void<\/span> mark_auth_offline() {$/;"	a
l00397	doc/html/util_8c-source.html	/^<a name="l00397"><\/a>00397                 <span class="keywordtype">int<\/span> before;$/;"	a
l00398	doc/html/util_8c-source.html	/^<a name="l00398"><\/a>00398                 <span class="keywordtype">int<\/span> after;$/;"	a
l00399	doc/html/util_8c-source.html	/^<a name="l00399"><\/a>00399 $/;"	a
l00400	doc/html/util_8c-source.html	/^<a name="l00400"><\/a>00400                 before = is_auth_online();$/;"	a
l00401	doc/html/util_8c-source.html	/^<a name="l00401"><\/a>00401                 time(&amp;last_auth_offline_time);$/;"	a
l00402	doc/html/util_8c-source.html	/^<a name="l00402"><\/a>00402                 after = is_auth_online();$/;"	a
l00403	doc/html/util_8c-source.html	/^<a name="l00403"><\/a>00403 $/;"	a
l00404	doc/html/util_8c-source.html	/^<a name="l00404"><\/a>00404                 <span class="keywordflow">if<\/span> (before != after) {$/;"	a
l00405	doc/html/util_8c-source.html	/^<a name="l00405"><\/a>00405                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"AUTH_ONLINE status became %s"<\/span>, (after ? <span class="stringliteral">"ON"<\/span> : <span class="stringliteral">"OFF"<\/span>));$/;"	a
l00406	doc/html/util_8c-source.html	/^<a name="l00406"><\/a>00406                 }$/;"	a
l00407	doc/html/util_8c-source.html	/^<a name="l00407"><\/a>00407 $/;"	a
l00408	doc/html/util_8c-source.html	/^<a name="l00408"><\/a>00408         }$/;"	a
l00409	doc/html/util_8c-source.html	/^<a name="l00409"><\/a>00409 $/;"	a
l00410	doc/html/util_8c-source.html	/^<a name="l00410"><\/a>00410         <span class="keywordtype">int<\/span> is_auth_online() {$/;"	a
l00411	doc/html/util_8c-source.html	/^<a name="l00411"><\/a>00411                 <span class="keywordflow">if<\/span> (!is_online()) {$/;"	a
l00412	doc/html/util_8c-source.html	/^<a name="l00412"><\/a>00412                         <span class="comment">\/* If we're not online auth is definately not online :) *\/<\/span>$/;"	a
l00413	doc/html/util_8c-source.html	/^<a name="l00413"><\/a>00413                         <span class="keywordflow">return<\/span> (0);$/;"	a
l00414	doc/html/util_8c-source.html	/^<a name="l00414"><\/a>00414                 }$/;"	a
l00415	doc/html/util_8c-source.html	/^<a name="l00415"><\/a>00415                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (last_auth_online_time == 0 || (last_auth_offline_time - last_auth_online_time) &gt;= (<a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;checkinterval * 2) ) {$/;"	a
l00416	doc/html/util_8c-source.html	/^<a name="l00416"><\/a>00416                         <span class="comment">\/* Auth is  probably offline *\/<\/span>$/;"	a
l00417	doc/html/util_8c-source.html	/^<a name="l00417"><\/a>00417                         <span class="keywordflow">return<\/span> (0);$/;"	a
l00418	doc/html/util_8c-source.html	/^<a name="l00418"><\/a>00418                 }$/;"	a
l00419	doc/html/util_8c-source.html	/^<a name="l00419"><\/a>00419                 <span class="keywordflow">else<\/span> {$/;"	a
l00420	doc/html/util_8c-source.html	/^<a name="l00420"><\/a>00420                         <span class="comment">\/* Auth is probably online *\/<\/span>$/;"	a
l00421	doc/html/util_8c-source.html	/^<a name="l00421"><\/a>00421                         <span class="keywordflow">return<\/span> (1);$/;"	a
l00422	doc/html/util_8c-source.html	/^<a name="l00422"><\/a>00422                 }$/;"	a
l00423	doc/html/util_8c-source.html	/^<a name="l00423"><\/a>00423         }$/;"	a
l00424	doc/html/util_8c-source.html	/^<a name="l00424"><\/a>00424 $/;"	a
l00425	doc/html/util_8c-source.html	/^<a name="l00425"><\/a>00425         <span class="comment">\/*<\/span>$/;"	a
l00426	doc/html/util_8c-source.html	/^<a name="l00426"><\/a>00426 <span class="comment">         * @return A string containing human-readable status text. MUST BE free()d by caller<\/span>$/;"	a
l00427	doc/html/util_8c-source.html	/^<a name="l00427"><\/a>00427 <span class="comment">         *\/<\/span>$/;"	a
l00428	doc/html/util_8c-source.html	/^<a name="l00428"><\/a>00428         <span class="keywordtype">char<\/span> * get_status_text() {$/;"	a
l00429	doc/html/util_8c-source.html	/^<a name="l00429"><\/a>00429                 <span class="keywordtype">char<\/span> buffer[STATUS_BUF_SIZ];$/;"	a
l00430	doc/html/util_8c-source.html	/^<a name="l00430"><\/a>00430                 ssize_t len;$/;"	a
l00431	doc/html/util_8c-source.html	/^<a name="l00431"><\/a>00431                 <a class="code" href="structs__config.html">s_config<\/a> *config;$/;"	a
l00432	doc/html/util_8c-source.html	/^<a name="l00432"><\/a>00432                 <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_server;$/;"	a
l00433	doc/html/util_8c-source.html	/^<a name="l00433"><\/a>00433                 <a class="code" href="struct__t__client.html">t_client<\/a>        *first;$/;"	a
l00434	doc/html/util_8c-source.html	/^<a name="l00434"><\/a>00434                 <span class="keywordtype">int<\/span>             count;$/;"	a
l00435	doc/html/util_8c-source.html	/^<a name="l00435"><\/a>00435                 <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> uptime = 0;$/;"	a
l00436	doc/html/util_8c-source.html	/^<a name="l00436"><\/a>00436                 <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span> days = 0, hours = 0, minutes = 0, seconds = 0;$/;"	a
l00437	doc/html/util_8c-source.html	/^<a name="l00437"><\/a>00437                 <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a> *p;$/;"	a
l00438	doc/html/util_8c-source.html	/^<a name="l00438"><\/a>00438 $/;"	a
l00439	doc/html/util_8c-source.html	/^<a name="l00439"><\/a>00439                 len = 0;$/;"	a
l00440	doc/html/util_8c-source.html	/^<a name="l00440"><\/a>00440                 snprintf(buffer, (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"WiFiDog status\\n\\n"<\/span>);$/;"	a
l00441	doc/html/util_8c-source.html	/^<a name="l00441"><\/a>00441                 len = strlen(buffer);$/;"	a
l00442	doc/html/util_8c-source.html	/^<a name="l00442"><\/a>00442 $/;"	a
l00443	doc/html/util_8c-source.html	/^<a name="l00443"><\/a>00443                 uptime = time(NULL) - started_time;$/;"	a
l00444	doc/html/util_8c-source.html	/^<a name="l00444"><\/a>00444                 days    = uptime \/ (24 * 60 * 60);$/;"	a
l00445	doc/html/util_8c-source.html	/^<a name="l00445"><\/a>00445                 uptime -= days * (24 * 60 * 60);$/;"	a
l00446	doc/html/util_8c-source.html	/^<a name="l00446"><\/a>00446                 hours   = uptime \/ (60 * 60);$/;"	a
l00447	doc/html/util_8c-source.html	/^<a name="l00447"><\/a>00447                 uptime -= hours * (60 * 60);$/;"	a
l00448	doc/html/util_8c-source.html	/^<a name="l00448"><\/a>00448                 minutes = uptime \/ 60;$/;"	a
l00449	doc/html/util_8c-source.html	/^<a name="l00449"><\/a>00449                 uptime -= minutes * 60;$/;"	a
l00450	doc/html/util_8c-source.html	/^<a name="l00450"><\/a>00450                 seconds = uptime;$/;"	a
l00451	doc/html/util_8c-source.html	/^<a name="l00451"><\/a>00451 $/;"	a
l00452	doc/html/util_8c-source.html	/^<a name="l00452"><\/a>00452                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Version: "<\/span> VERSION <span class="stringliteral">"\\n"<\/span>);$/;"	a
l00453	doc/html/util_8c-source.html	/^<a name="l00453"><\/a>00453                 len = strlen(buffer);$/;"	a
l00454	doc/html/util_8c-source.html	/^<a name="l00454"><\/a>00454 $/;"	a
l00455	doc/html/util_8c-source.html	/^<a name="l00455"><\/a>00455                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Uptime: %ud %uh %um %us\\n"<\/span>, days, hours, minutes, seconds);$/;"	a
l00456	doc/html/util_8c-source.html	/^<a name="l00456"><\/a>00456                 len = strlen(buffer);$/;"	a
l00457	doc/html/util_8c-source.html	/^<a name="l00457"><\/a>00457 $/;"	a
l00458	doc/html/util_8c-source.html	/^<a name="l00458"><\/a>00458                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Has been restarted: "<\/span>);$/;"	a
l00459	doc/html/util_8c-source.html	/^<a name="l00459"><\/a>00459                 len = strlen(buffer);$/;"	a
l00460	doc/html/util_8c-source.html	/^<a name="l00460"><\/a>00460                 <span class="keywordflow">if<\/span> (restart_orig_pid) {$/;"	a
l00461	doc/html/util_8c-source.html	/^<a name="l00461"><\/a>00461                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"yes (from PID %d)\\n"<\/span>, restart_orig_pid);$/;"	a
l00462	doc/html/util_8c-source.html	/^<a name="l00462"><\/a>00462                         len = strlen(buffer);$/;"	a
l00463	doc/html/util_8c-source.html	/^<a name="l00463"><\/a>00463                 }$/;"	a
l00464	doc/html/util_8c-source.html	/^<a name="l00464"><\/a>00464                 <span class="keywordflow">else<\/span> {$/;"	a
l00465	doc/html/util_8c-source.html	/^<a name="l00465"><\/a>00465                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"no\\n"<\/span>);$/;"	a
l00466	doc/html/util_8c-source.html	/^<a name="l00466"><\/a>00466                         len = strlen(buffer);$/;"	a
l00467	doc/html/util_8c-source.html	/^<a name="l00467"><\/a>00467                 }$/;"	a
l00468	doc/html/util_8c-source.html	/^<a name="l00468"><\/a>00468 $/;"	a
l00469	doc/html/util_8c-source.html	/^<a name="l00469"><\/a>00469                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Internet Connectivity: %s\\n"<\/span>, (is_online() ? <span class="stringliteral">"yes"<\/span> : <span class="stringliteral">"no"<\/span>));$/;"	a
l00470	doc/html/util_8c-source.html	/^<a name="l00470"><\/a>00470                 len = strlen(buffer);$/;"	a
l00471	doc/html/util_8c-source.html	/^<a name="l00471"><\/a>00471 $/;"	a
l00472	doc/html/util_8c-source.html	/^<a name="l00472"><\/a>00472                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Auth server reachable: %s\\n"<\/span>, (is_auth_online() ? <span class="stringliteral">"yes"<\/span> : <span class="stringliteral">"no"<\/span>));$/;"	a
l00473	doc/html/util_8c-source.html	/^<a name="l00473"><\/a>00473                 len = strlen(buffer);$/;"	a
l00474	doc/html/util_8c-source.html	/^<a name="l00474"><\/a>00474 $/;"	a
l00475	doc/html/util_8c-source.html	/^<a name="l00475"><\/a>00475                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Clients served this session: %lu\\n\\n"<\/span>, served_this_session);$/;"	a
l00476	doc/html/util_8c-source.html	/^<a name="l00476"><\/a>00476                 len = strlen(buffer);$/;"	a
l00477	doc/html/util_8c-source.html	/^<a name="l00477"><\/a>00477 $/;"	a
l00478	doc/html/util_8c-source.html	/^<a name="l00478"><\/a>00478                 LOCK_CLIENT_LIST();$/;"	a
l00479	doc/html/util_8c-source.html	/^<a name="l00479"><\/a>00479 $/;"	a
l00480	doc/html/util_8c-source.html	/^<a name="l00480"><\/a>00480                 first = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>();$/;"	a
l00481	doc/html/util_8c-source.html	/^<a name="l00481"><\/a>00481 $/;"	a
l00482	doc/html/util_8c-source.html	/^<a name="l00482"><\/a>00482                 <span class="keywordflow">if<\/span> (first == NULL) {$/;"	a
l00483	doc/html/util_8c-source.html	/^<a name="l00483"><\/a>00483                         count = 0;$/;"	a
l00484	doc/html/util_8c-source.html	/^<a name="l00484"><\/a>00484                 } <span class="keywordflow">else<\/span> {$/;"	a
l00485	doc/html/util_8c-source.html	/^<a name="l00485"><\/a>00485                         count = 1;$/;"	a
l00486	doc/html/util_8c-source.html	/^<a name="l00486"><\/a>00486                         <span class="keywordflow">while<\/span> (first-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> != NULL) {$/;"	a
l00487	doc/html/util_8c-source.html	/^<a name="l00487"><\/a>00487                                 first = first-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00488	doc/html/util_8c-source.html	/^<a name="l00488"><\/a>00488                                 count++;$/;"	a
l00489	doc/html/util_8c-source.html	/^<a name="l00489"><\/a>00489                         }$/;"	a
l00490	doc/html/util_8c-source.html	/^<a name="l00490"><\/a>00490                 }$/;"	a
l00491	doc/html/util_8c-source.html	/^<a name="l00491"><\/a>00491 $/;"	a
l00492	doc/html/util_8c-source.html	/^<a name="l00492"><\/a>00492                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"%d clients "<\/span>$/;"	a
l00493	doc/html/util_8c-source.html	/^<a name="l00493"><\/a>00493                                 <span class="stringliteral">"connected.\\n"<\/span>, count);$/;"	a
l00494	doc/html/util_8c-source.html	/^<a name="l00494"><\/a>00494                 len = strlen(buffer);$/;"	a
l00495	doc/html/util_8c-source.html	/^<a name="l00495"><\/a>00495 $/;"	a
l00496	doc/html/util_8c-source.html	/^<a name="l00496"><\/a>00496                 first = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>();$/;"	a
l00497	doc/html/util_8c-source.html	/^<a name="l00497"><\/a>00497 $/;"	a
l00498	doc/html/util_8c-source.html	/^<a name="l00498"><\/a>00498                 count = 0;$/;"	a
l00499	doc/html/util_8c-source.html	/^<a name="l00499"><\/a>00499                 <span class="keywordflow">while<\/span> (first != NULL) {$/;"	a
l00500	doc/html/util_8c-source.html	/^<a name="l00500"><\/a>00500                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"\\nClient %d\\n"<\/span>, count);$/;"	a
l00501	doc/html/util_8c-source.html	/^<a name="l00501"><\/a>00501                         len = strlen(buffer);$/;"	a
l00502	doc/html/util_8c-source.html	/^<a name="l00502"><\/a>00502 $/;"	a
l00503	doc/html/util_8c-source.html	/^<a name="l00503"><\/a>00503                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  IP: %s MAC: %s\\n"<\/span>, first-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, first-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00504	doc/html/util_8c-source.html	/^<a name="l00504"><\/a>00504                         len = strlen(buffer);$/;"	a
l00505	doc/html/util_8c-source.html	/^<a name="l00505"><\/a>00505 $/;"	a
l00506	doc/html/util_8c-source.html	/^<a name="l00506"><\/a>00506                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  Token: %s\\n"<\/span>, first-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00507	doc/html/util_8c-source.html	/^<a name="l00507"><\/a>00507                         len = strlen(buffer);$/;"	a
l00508	doc/html/util_8c-source.html	/^<a name="l00508"><\/a>00508 $/;"	a
l00509	doc/html/util_8c-source.html	/^<a name="l00509"><\/a>00509                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  Downloaded: %llu\\n  Uploaded: %llu\\n"<\/span> , first-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>, first-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>);$/;"	a
l00510	doc/html/util_8c-source.html	/^<a name="l00510"><\/a>00510                         len = strlen(buffer);$/;"	a
l00511	doc/html/util_8c-source.html	/^<a name="l00511"><\/a>00511 $/;"	a
l00512	doc/html/util_8c-source.html	/^<a name="l00512"><\/a>00512                         count++;$/;"	a
l00513	doc/html/util_8c-source.html	/^<a name="l00513"><\/a>00513                         first = first-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00514	doc/html/util_8c-source.html	/^<a name="l00514"><\/a>00514                 }$/;"	a
l00515	doc/html/util_8c-source.html	/^<a name="l00515"><\/a>00515 $/;"	a
l00516	doc/html/util_8c-source.html	/^<a name="l00516"><\/a>00516                 UNLOCK_CLIENT_LIST();$/;"	a
l00517	doc/html/util_8c-source.html	/^<a name="l00517"><\/a>00517 $/;"	a
l00518	doc/html/util_8c-source.html	/^<a name="l00518"><\/a>00518                 config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00519	doc/html/util_8c-source.html	/^<a name="l00519"><\/a>00519 $/;"	a
l00520	doc/html/util_8c-source.html	/^<a name="l00520"><\/a>00520                 <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a> != NULL) {$/;"	a
l00521	doc/html/util_8c-source.html	/^<a name="l00521"><\/a>00521                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"\\nTrusted MAC addresses:\\n"<\/span>);$/;"	a
l00522	doc/html/util_8c-source.html	/^<a name="l00522"><\/a>00522                         len = strlen(buffer);$/;"	a
l00523	doc/html/util_8c-source.html	/^<a name="l00523"><\/a>00523 $/;"	a
l00524	doc/html/util_8c-source.html	/^<a name="l00524"><\/a>00524                         <span class="keywordflow">for<\/span> (p = config-&gt;<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>; p != NULL; p = p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a>) {$/;"	a
l00525	doc/html/util_8c-source.html	/^<a name="l00525"><\/a>00525                                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  %s\\n"<\/span>, p-&gt;<a class="code" href="struct__trusted__mac__t.html#4e4381cfff2bbfbd9455640102b21f14">mac<\/a>);$/;"	a
l00526	doc/html/util_8c-source.html	/^<a name="l00526"><\/a>00526                                 len = strlen(buffer);$/;"	a
l00527	doc/html/util_8c-source.html	/^<a name="l00527"><\/a>00527                         }$/;"	a
l00528	doc/html/util_8c-source.html	/^<a name="l00528"><\/a>00528                 }$/;"	a
l00529	doc/html/util_8c-source.html	/^<a name="l00529"><\/a>00529 $/;"	a
l00530	doc/html/util_8c-source.html	/^<a name="l00530"><\/a>00530                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"\\nAuthentication servers:\\n"<\/span>);$/;"	a
l00531	doc/html/util_8c-source.html	/^<a name="l00531"><\/a>00531                 len = strlen(buffer);$/;"	a
l00532	doc/html/util_8c-source.html	/^<a name="l00532"><\/a>00532 $/;"	a
l00533	doc/html/util_8c-source.html	/^<a name="l00533"><\/a>00533                 LOCK_CONFIG();$/;"	a
l00534	doc/html/util_8c-source.html	/^<a name="l00534"><\/a>00534 $/;"	a
l00535	doc/html/util_8c-source.html	/^<a name="l00535"><\/a>00535                 <span class="keywordflow">for<\/span> (auth_server = config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; auth_server != NULL; auth_server = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>) {$/;"	a
l00536	doc/html/util_8c-source.html	/^<a name="l00536"><\/a>00536                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  Host: %s (%s)\\n"<\/span>, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00537	doc/html/util_8c-source.html	/^<a name="l00537"><\/a>00537                         len = strlen(buffer);$/;"	a
l00538	doc/html/util_8c-source.html	/^<a name="l00538"><\/a>00538                 }$/;"	a
l00539	doc/html/util_8c-source.html	/^<a name="l00539"><\/a>00539 $/;"	a
l00540	doc/html/util_8c-source.html	/^<a name="l00540"><\/a>00540                 UNLOCK_CONFIG();$/;"	a
l00541	doc/html/util_8c-source.html	/^<a name="l00541"><\/a>00541 $/;"	a
l00542	doc/html/util_8c-source.html	/^<a name="l00542"><\/a>00542                 <span class="keywordflow">return<\/span> safe_strdup(buffer);$/;"	a
l00543	doc/html/util_8c-source.html	/^<a name="l00543"><\/a>00543         }$/;"	a
0cf123f608ee86a2bc577164c4e58bfc	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0cf123f608ee86a2bc577164c4e58bfc"><\/a><!-- doxytag: member="util.c::mark_auth_offline" ref="0cf123f608ee86a2bc577164c4e58bfc" args="()" -->$/;"	a
0fbc87940c4a8d7907d13b711a19a68f	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0fbc87940c4a8d7907d13b711a19a68f"><\/a><!-- doxytag: member="util.c::ghbn_mutex" ref="0fbc87940c4a8d7907d13b711a19a68f" args="" -->$/;"	a
1292062c6863401b0c8b6743bb746df7	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1292062c6863401b0c8b6743bb746df7"><\/a><!-- doxytag: member="util.c::get_ext_iface" ref="1292062c6863401b0c8b6743bb746df7" args="(void)" -->$/;"	a
3236543c5f99e9273a665f875e0d3061	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3236543c5f99e9273a665f875e0d3061"><\/a><!-- doxytag: member="util.c::wd_gethostbyname" ref="3236543c5f99e9273a665f875e0d3061" args="(const char *name)" -->$/;"	a
3d50bd009ad5dbff8e63077b05925011	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3d50bd009ad5dbff8e63077b05925011"><\/a><!-- doxytag: member="util.c::last_auth_offline_time" ref="3d50bd009ad5dbff8e63077b05925011" args="" -->$/;"	a
41bb1ae6f994fced016bcd412e99f410	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="41bb1ae6f994fced016bcd412e99f410"><\/a><!-- doxytag: member="util.c::is_online" ref="41bb1ae6f994fced016bcd412e99f410" args="()" -->$/;"	a
4e7610fe011a6fcc90cfd7cc57f90c96	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4e7610fe011a6fcc90cfd7cc57f90c96"><\/a><!-- doxytag: member="util.c::is_auth_online" ref="4e7610fe011a6fcc90cfd7cc57f90c96" args="()" -->$/;"	a
566a5213a52fcf010039d572da5c7490	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="566a5213a52fcf010039d572da5c7490"><\/a><!-- doxytag: member="util.c::mark_online" ref="566a5213a52fcf010039d572da5c7490" args="()" -->$/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	doc/html/util_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="util.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
710a60241e13983640602a02301fe8cc	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="710a60241e13983640602a02301fe8cc"><\/a><!-- doxytag: member="util.c::last_offline_time" ref="710a60241e13983640602a02301fe8cc" args="" -->$/;"	a
71d23e774a069ca0b4617c40fc262f4e	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="71d23e774a069ca0b4617c40fc262f4e"><\/a><!-- doxytag: member="util.c::mark_offline" ref="71d23e774a069ca0b4617c40fc262f4e" args="()" -->$/;"	a
_details	doc/html/util_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b374ff230d9977e6b952612d61689f39	doc/html/util_8c.html	/^<a class="anchor" name="b374ff230d9977e6b952612d61689f39"><\/a><!-- doxytag: member="util.c::config_mutex" ref="b374ff230d9977e6b952612d61689f39" args="" -->$/;"	a
b55a47ffb38b07a1c8d865c4821d52cc	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b55a47ffb38b07a1c8d865c4821d52cc"><\/a><!-- doxytag: member="util.c::restart_orig_pid" ref="b55a47ffb38b07a1c8d865c4821d52cc" args="" -->$/;"	a
c4c06e11b18189acbe7ca7c1bb1d1fb8	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c4c06e11b18189acbe7ca7c1bb1d1fb8"><\/a><!-- doxytag: member="util.c::get_status_text" ref="c4c06e11b18189acbe7ca7c1bb1d1fb8" args="()" -->$/;"	a
d309c457ebb918832a3f7910ba2c7b3a	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d309c457ebb918832a3f7910ba2c7b3a"><\/a><!-- doxytag: member="util.c::served_this_session" ref="d309c457ebb918832a3f7910ba2c7b3a" args="" -->$/;"	a
d3c0ab429f95535fa08bc6a4fb884bab	doc/html/util_8c.html	/^<a class="anchor" name="d3c0ab429f95535fa08bc6a4fb884bab"><\/a><!-- doxytag: member="util.c::execute" ref="d3c0ab429f95535fa08bc6a4fb884bab" args="(char *cmd_line, int quiet)" -->$/;"	a
d90431781df5a681e0930efb6e88400b	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d90431781df5a681e0930efb6e88400b"><\/a><!-- doxytag: member="util.c::get_iface_ip" ref="d90431781df5a681e0930efb6e88400b" args="(const char *ifname)" -->$/;"	a
e7518947376bdd01423c520485ebaf14	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e7518947376bdd01423c520485ebaf14"><\/a><!-- doxytag: member="util.c::last_auth_online_time" ref="e7518947376bdd01423c520485ebaf14" args="" -->$/;"	a
eeca5446f2051d6e199c2cf68362fd75	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eeca5446f2051d6e199c2cf68362fd75"><\/a><!-- doxytag: member="util.c::mark_auth_online" ref="eeca5446f2051d6e199c2cf68362fd75" args="()" -->$/;"	a
f0eea6ebdbba8400df1fe94af7991211	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f0eea6ebdbba8400df1fe94af7991211"><\/a><!-- doxytag: member="util.c::started_time" ref="f0eea6ebdbba8400df1fe94af7991211" args="" -->$/;"	a
f62d0c4e60d6cc70ac8e6e44231935e8	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f62d0c4e60d6cc70ac8e6e44231935e8"><\/a><!-- doxytag: member="util.c::get_iface_mac" ref="f62d0c4e60d6cc70ac8e6e44231935e8" args="(const char *ifname)" -->$/;"	a
f8eac168be39d5b2ebce70dfff1034ad	doc/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f8eac168be39d5b2ebce70dfff1034ad"><\/a><!-- doxytag: member="util.c::last_online_time" ref="f8eac168be39d5b2ebce70dfff1034ad" args="" -->$/;"	a
l00001	doc/html/util_8h-source.html	/^<h1>util.h<\/h1><a href="util_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/util_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/util_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/util_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/util_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/util_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/util_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/util_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/util_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/util_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/util_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/util_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/util_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/util_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/util_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/util_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/util_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/util_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/util_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/util_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/util_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: util.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/util_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _UTIL_H_<\/span>$/;"	a
l00028	doc/html/util_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _UTIL_H_<\/span>$/;"	a
l00029	doc/html/util_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/util_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define STATUS_BUF_SIZ  16384<\/span>$/;"	a
l00031	doc/html/util_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor"><\/span>$/;"	a
l00034	doc/html/util_8h-source.html	/^<a name="l00034"><\/a>00034 <span class="keywordtype">int<\/span> <a class="code" href="util_8c.html#d3c0ab429f95535fa08bc6a4fb884bab" title="Execute a shell command.">execute<\/a>(<span class="keywordtype">char<\/span> *cmd_line, <span class="keywordtype">int<\/span> quiet);$/;"	a
l00035	doc/html/util_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="keyword">struct <\/span>in_addr *wd_gethostbyname(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *name);$/;"	a
l00036	doc/html/util_8h-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	doc/html/util_8h-source.html	/^<a name="l00037"><\/a>00037 <span class="comment">\/* @brief Get IP address of an interface *\/<\/span>$/;"	a
l00038	doc/html/util_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="keywordtype">char<\/span> *get_iface_ip(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ifname);$/;"	a
l00039	doc/html/util_8h-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00040	doc/html/util_8h-source.html	/^<a name="l00040"><\/a>00040 <span class="comment">\/* @brief Get MAC address of an interface *\/<\/span>$/;"	a
l00041	doc/html/util_8h-source.html	/^<a name="l00041"><\/a>00041 <span class="keywordtype">char<\/span> *get_iface_mac(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ifname);$/;"	a
l00042	doc/html/util_8h-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	doc/html/util_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="comment">\/* @brief Get interface name of default gateway *\/<\/span>$/;"	a
l00044	doc/html/util_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="keywordtype">char<\/span> *get_ext_iface (<span class="keywordtype">void<\/span>);$/;"	a
l00045	doc/html/util_8h-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	doc/html/util_8h-source.html	/^<a name="l00046"><\/a>00046 <span class="comment">\/* @brief Sets hint that an online action (dns\/connect\/etc using WAN) succeeded *\/<\/span>$/;"	a
l00047	doc/html/util_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="keywordtype">void<\/span> mark_online();$/;"	a
l00048	doc/html/util_8h-source.html	/^<a name="l00048"><\/a>00048 <span class="comment">\/* @brief Sets hint that an online action (dns\/connect\/etc using WAN) failed *\/<\/span>$/;"	a
l00049	doc/html/util_8h-source.html	/^<a name="l00049"><\/a>00049 <span class="keywordtype">void<\/span> mark_offline();$/;"	a
l00050	doc/html/util_8h-source.html	/^<a name="l00050"><\/a>00050 <span class="comment">\/* @brief Returns a guess (true or false) on whether we're online or not based on previous calls to mark_online and mark_offline *\/<\/span>$/;"	a
l00051	doc/html/util_8h-source.html	/^<a name="l00051"><\/a>00051 <span class="keywordtype">int<\/span> is_online();$/;"	a
l00052	doc/html/util_8h-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00053	doc/html/util_8h-source.html	/^<a name="l00053"><\/a>00053 <span class="comment">\/* @brief Sets hint that an auth server online action succeeded *\/<\/span>$/;"	a
l00054	doc/html/util_8h-source.html	/^<a name="l00054"><\/a>00054 <span class="keywordtype">void<\/span> mark_auth_online();$/;"	a
l00055	doc/html/util_8h-source.html	/^<a name="l00055"><\/a>00055 <span class="comment">\/* @brief Sets hint that an auth server online action failed *\/<\/span>$/;"	a
l00056	doc/html/util_8h-source.html	/^<a name="l00056"><\/a>00056 <span class="keywordtype">void<\/span> mark_auth_offline();$/;"	a
l00057	doc/html/util_8h-source.html	/^<a name="l00057"><\/a>00057 <span class="comment">\/* @brief Returns a guess (true or false) on whether we're an auth server is online or not based on previous calls to mark_auth_online and mark_auth_offline *\/<\/span>$/;"	a
l00058	doc/html/util_8h-source.html	/^<a name="l00058"><\/a>00058 <span class="keywordtype">int<\/span> is_auth_online();$/;"	a
l00059	doc/html/util_8h-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00060	doc/html/util_8h-source.html	/^<a name="l00060"><\/a>00060 <span class="comment">\/*<\/span>$/;"	a
l00061	doc/html/util_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="comment"> * @brief Creates a human-readable paragraph of the status of wifidog<\/span>$/;"	a
l00062	doc/html/util_8h-source.html	/^<a name="l00062"><\/a>00062 <span class="comment"> *\/<\/span>$/;"	a
l00063	doc/html/util_8h-source.html	/^<a name="l00063"><\/a>00063 <span class="keywordtype">char<\/span> * get_status_text();$/;"	a
l00064	doc/html/util_8h-source.html	/^<a name="l00064"><\/a>00064 $/;"	a
l00065	doc/html/util_8h-source.html	/^<a name="l00065"><\/a>00065 <span class="preprocessor">#define LOCK_GHBN() do { \\<\/span>$/;"	a
l00066	doc/html/util_8h-source.html	/^<a name="l00066"><\/a>00066 <span class="preprocessor">        debug(LOG_DEBUG, "Locking wd_gethostbyname()"); \\<\/span>$/;"	a
l00067	doc/html/util_8h-source.html	/^<a name="l00067"><\/a>00067 <span class="preprocessor">        pthread_mutex_lock(&amp;ghbn_mutex); \\<\/span>$/;"	a
l00068	doc/html/util_8h-source.html	/^<a name="l00068"><\/a>00068 <span class="preprocessor">        debug(LOG_DEBUG, "wd_gethostbyname() locked"); \\<\/span>$/;"	a
l00069	doc/html/util_8h-source.html	/^<a name="l00069"><\/a>00069 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00070	doc/html/util_8h-source.html	/^<a name="l00070"><\/a>00070 <span class="preprocessor"><\/span>$/;"	a
l00071	doc/html/util_8h-source.html	/^<a name="l00071"><\/a>00071 <span class="preprocessor">#define UNLOCK_GHBN() do { \\<\/span>$/;"	a
l00072	doc/html/util_8h-source.html	/^<a name="l00072"><\/a>00072 <span class="preprocessor">        debug(LOG_DEBUG, "Unlocking wd_gethostbyname()"); \\<\/span>$/;"	a
l00073	doc/html/util_8h-source.html	/^<a name="l00073"><\/a>00073 <span class="preprocessor">        pthread_mutex_unlock(&amp;ghbn_mutex); \\<\/span>$/;"	a
l00074	doc/html/util_8h-source.html	/^<a name="l00074"><\/a>00074 <span class="preprocessor">        debug(LOG_DEBUG, "wd_gethostbyname() unlocked"); \\<\/span>$/;"	a
l00075	doc/html/util_8h-source.html	/^<a name="l00075"><\/a>00075 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00076	doc/html/util_8h-source.html	/^<a name="l00076"><\/a>00076 <span class="preprocessor"><\/span>$/;"	a
l00077	doc/html/util_8h-source.html	/^<a name="l00077"><\/a>00077 <span class="preprocessor">#endif <\/span><span class="comment">\/* _UTIL_H_ *\/<\/span>$/;"	a
l00078	doc/html/util_8h-source.html	/^<a name="l00078"><\/a>00078 $/;"	a
0cf123f608ee86a2bc577164c4e58bfc	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0cf123f608ee86a2bc577164c4e58bfc"><\/a><!-- doxytag: member="util.h::mark_auth_offline" ref="0cf123f608ee86a2bc577164c4e58bfc" args="()" -->$/;"	a
1292062c6863401b0c8b6743bb746df7	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1292062c6863401b0c8b6743bb746df7"><\/a><!-- doxytag: member="util.h::get_ext_iface" ref="1292062c6863401b0c8b6743bb746df7" args="(void)" -->$/;"	a
3236543c5f99e9273a665f875e0d3061	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3236543c5f99e9273a665f875e0d3061"><\/a><!-- doxytag: member="util.h::wd_gethostbyname" ref="3236543c5f99e9273a665f875e0d3061" args="(const char *name)" -->$/;"	a
41bb1ae6f994fced016bcd412e99f410	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="41bb1ae6f994fced016bcd412e99f410"><\/a><!-- doxytag: member="util.h::is_online" ref="41bb1ae6f994fced016bcd412e99f410" args="()" -->$/;"	a
4e7610fe011a6fcc90cfd7cc57f90c96	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4e7610fe011a6fcc90cfd7cc57f90c96"><\/a><!-- doxytag: member="util.h::is_auth_online" ref="4e7610fe011a6fcc90cfd7cc57f90c96" args="()" -->$/;"	a
514397517babe0a7f56651c98674ea84	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="514397517babe0a7f56651c98674ea84"><\/a><!-- doxytag: member="util.h::STATUS_BUF_SIZ" ref="514397517babe0a7f56651c98674ea84" args="" -->$/;"	a
566a5213a52fcf010039d572da5c7490	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="566a5213a52fcf010039d572da5c7490"><\/a><!-- doxytag: member="util.h::mark_online" ref="566a5213a52fcf010039d572da5c7490" args="()" -->$/;"	a
71d23e774a069ca0b4617c40fc262f4e	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="71d23e774a069ca0b4617c40fc262f4e"><\/a><!-- doxytag: member="util.h::mark_offline" ref="71d23e774a069ca0b4617c40fc262f4e" args="()" -->$/;"	a
9fe47cb092157d21079b5f1acd9ffc35	doc/html/util_8h.html	/^<a class="anchor" name="9fe47cb092157d21079b5f1acd9ffc35"><\/a><!-- doxytag: member="util.h::LOCK_GHBN" ref="9fe47cb092157d21079b5f1acd9ffc35" args="()" -->$/;"	a
_details	doc/html/util_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
c4c06e11b18189acbe7ca7c1bb1d1fb8	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c4c06e11b18189acbe7ca7c1bb1d1fb8"><\/a><!-- doxytag: member="util.h::get_status_text" ref="c4c06e11b18189acbe7ca7c1bb1d1fb8" args="()" -->$/;"	a
c81f7a57da68af360e22ee74f9c64e85	doc/html/util_8h.html	/^<a class="anchor" name="c81f7a57da68af360e22ee74f9c64e85"><\/a><!-- doxytag: member="util.h::UNLOCK_GHBN" ref="c81f7a57da68af360e22ee74f9c64e85" args="()" -->$/;"	a
d3c0ab429f95535fa08bc6a4fb884bab	doc/html/util_8h.html	/^<a class="anchor" name="d3c0ab429f95535fa08bc6a4fb884bab"><\/a><!-- doxytag: member="util.h::execute" ref="d3c0ab429f95535fa08bc6a4fb884bab" args="(char *cmd_line, int quiet)" -->$/;"	a
d90431781df5a681e0930efb6e88400b	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d90431781df5a681e0930efb6e88400b"><\/a><!-- doxytag: member="util.h::get_iface_ip" ref="d90431781df5a681e0930efb6e88400b" args="(const char *ifname)" -->$/;"	a
eeca5446f2051d6e199c2cf68362fd75	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eeca5446f2051d6e199c2cf68362fd75"><\/a><!-- doxytag: member="util.h::mark_auth_online" ref="eeca5446f2051d6e199c2cf68362fd75" args="()" -->$/;"	a
f62d0c4e60d6cc70ac8e6e44231935e8	doc/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f62d0c4e60d6cc70ac8e6e44231935e8"><\/a><!-- doxytag: member="util.h::get_iface_mac" ref="f62d0c4e60d6cc70ac8e6e44231935e8" args="(const char *ifname)" -->$/;"	a
l00001	doc/html/wdctl_8c-source.html	/^<h1>wdctl.c<\/h1><a href="wdctl_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/wdctl_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/wdctl_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/wdctl_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/wdctl_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/wdctl_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/wdctl_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/wdctl_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/wdctl_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/wdctl_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/wdctl_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/wdctl_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/wdctl_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/wdctl_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/wdctl_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/wdctl_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/wdctl_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/wdctl_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/wdctl_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/wdctl_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/wdctl_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: wdctl.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	doc/html/wdctl_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00028	doc/html/wdctl_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span>$/;"	a
l00029	doc/html/wdctl_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00030	doc/html/wdctl_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00031	doc/html/wdctl_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00032	doc/html/wdctl_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00033	doc/html/wdctl_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00034	doc/html/wdctl_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00035	doc/html/wdctl_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00036	doc/html/wdctl_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;sys\/un.h&gt;<\/span>$/;"	a
l00037	doc/html/wdctl_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00038	doc/html/wdctl_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00039	doc/html/wdctl_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00040	doc/html/wdctl_8c-source.html	/^<a name="l00040"><\/a>00040 $/;"	a
l00041	doc/html/wdctl_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "<a class="code" href="wdctl_8h.html" title="WiFiDog monitoring client.">wdctl.h<\/a>"<\/span>$/;"	a
l00042	doc/html/wdctl_8c-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	doc/html/wdctl_8c-source.html	/^<a name="l00043"><\/a>00043 <a class="code" href="structs__config.html">s_config<\/a> config;$/;"	a
l00044	doc/html/wdctl_8c-source.html	/^<a name="l00044"><\/a>00044 $/;"	a
l00045	doc/html/wdctl_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> usage(<span class="keywordtype">void<\/span>);$/;"	a
l00046	doc/html/wdctl_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> init_config(<span class="keywordtype">void<\/span>);$/;"	a
l00047	doc/html/wdctl_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(<span class="keywordtype">int<\/span>, <span class="keywordtype">char<\/span> **);$/;"	a
l00048	doc/html/wdctl_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> connect_to_server(<span class="keywordtype">char<\/span> *);$/;"	a
l00049	doc/html/wdctl_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="keyword">static<\/span> <span class="keywordtype">size_t<\/span> send_request(<span class="keywordtype">int<\/span>, <span class="keywordtype">char<\/span> *);$/;"	a
l00050	doc/html/wdctl_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_status(<span class="keywordtype">void<\/span>);$/;"	a
l00051	doc/html/wdctl_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_stop(<span class="keywordtype">void<\/span>);$/;"	a
l00052	doc/html/wdctl_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_reset(<span class="keywordtype">void<\/span>);$/;"	a
l00053	doc/html/wdctl_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_restart(<span class="keywordtype">void<\/span>);$/;"	a
l00054	doc/html/wdctl_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00060	doc/html/wdctl_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00061	doc/html/wdctl_8c-source.html	/^<a name="l00061"><\/a>00061 usage(<span class="keywordtype">void<\/span>)$/;"	a
l00062	doc/html/wdctl_8c-source.html	/^<a name="l00062"><\/a>00062 {$/;"	a
l00063	doc/html/wdctl_8c-source.html	/^<a name="l00063"><\/a>00063     printf(<span class="stringliteral">"Usage: wdctl [options] command [arguments]\\n"<\/span>);$/;"	a
l00064	doc/html/wdctl_8c-source.html	/^<a name="l00064"><\/a>00064     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00065	doc/html/wdctl_8c-source.html	/^<a name="l00065"><\/a>00065     printf(<span class="stringliteral">"options:\\n"<\/span>);$/;"	a
l00066	doc/html/wdctl_8c-source.html	/^<a name="l00066"><\/a>00066     printf(<span class="stringliteral">"  -s &lt;path&gt;         Path to the socket\\n"<\/span>);$/;"	a
l00067	doc/html/wdctl_8c-source.html	/^<a name="l00067"><\/a>00067     printf(<span class="stringliteral">"  -h                Print usage\\n"<\/span>);$/;"	a
l00068	doc/html/wdctl_8c-source.html	/^<a name="l00068"><\/a>00068     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00069	doc/html/wdctl_8c-source.html	/^<a name="l00069"><\/a>00069     printf(<span class="stringliteral">"commands:\\n"<\/span>);$/;"	a
l00070	doc/html/wdctl_8c-source.html	/^<a name="l00070"><\/a>00070     printf(<span class="stringliteral">"  reset [mac|ip]    Reset the specified mac or ip connection\\n"<\/span>);$/;"	a
l00071	doc/html/wdctl_8c-source.html	/^<a name="l00071"><\/a>00071     printf(<span class="stringliteral">"  status            Obtain the status of wifidog\\n"<\/span>);$/;"	a
l00072	doc/html/wdctl_8c-source.html	/^<a name="l00072"><\/a>00072     printf(<span class="stringliteral">"  stop              Stop the running wifidog\\n"<\/span>);$/;"	a
l00073	doc/html/wdctl_8c-source.html	/^<a name="l00073"><\/a>00073     printf(<span class="stringliteral">"  restart           Re-start the running wifidog (without disconnecting active users!)\\n"<\/span>);$/;"	a
l00074	doc/html/wdctl_8c-source.html	/^<a name="l00074"><\/a>00074     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00075	doc/html/wdctl_8c-source.html	/^<a name="l00075"><\/a>00075 }$/;"	a
l00076	doc/html/wdctl_8c-source.html	/^<a name="l00076"><\/a>00076 $/;"	a
l00081	doc/html/wdctl_8c-source.html	/^<a name="l00081"><\/a>00081 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00082	doc/html/wdctl_8c-source.html	/^<a name="l00082"><\/a>00082 init_config(<span class="keywordtype">void<\/span>)$/;"	a
l00083	doc/html/wdctl_8c-source.html	/^<a name="l00083"><\/a>00083 {$/;"	a
l00084	doc/html/wdctl_8c-source.html	/^<a name="l00084"><\/a>00084 $/;"	a
l00085	doc/html/wdctl_8c-source.html	/^<a name="l00085"><\/a>00085         config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a> = strdup(DEFAULT_SOCK);$/;"	a
l00086	doc/html/wdctl_8c-source.html	/^<a name="l00086"><\/a>00086         config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_UNDEF;$/;"	a
l00087	doc/html/wdctl_8c-source.html	/^<a name="l00087"><\/a>00087 }$/;"	a
l00088	doc/html/wdctl_8c-source.html	/^<a name="l00088"><\/a>00088 $/;"	a
l00093	doc/html/wdctl_8c-source.html	/^<a name="l00093"><\/a>00093 <span class="keywordtype">void<\/span>$/;"	a
l00094	doc/html/wdctl_8c-source.html	/^<a name="l00094"><\/a>00094 <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(<span class="keywordtype">int<\/span> argc, <span class="keywordtype">char<\/span> **argv)$/;"	a
l00095	doc/html/wdctl_8c-source.html	/^<a name="l00095"><\/a>00095 {$/;"	a
l00096	doc/html/wdctl_8c-source.html	/^<a name="l00096"><\/a>00096     <span class="keyword">extern<\/span> <span class="keywordtype">int<\/span> optind;$/;"	a
l00097	doc/html/wdctl_8c-source.html	/^<a name="l00097"><\/a>00097     <span class="keywordtype">int<\/span> c;$/;"	a
l00098	doc/html/wdctl_8c-source.html	/^<a name="l00098"><\/a>00098 $/;"	a
l00099	doc/html/wdctl_8c-source.html	/^<a name="l00099"><\/a>00099     <span class="keywordflow">while<\/span> (-1 != (c = getopt(argc, argv, <span class="stringliteral">"s:h"<\/span>))) {$/;"	a
l00100	doc/html/wdctl_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="keywordflow">switch<\/span>(c) {$/;"	a
l00101	doc/html/wdctl_8c-source.html	/^<a name="l00101"><\/a>00101             <span class="keywordflow">case<\/span> <span class="charliteral">'h'<\/span>:$/;"	a
l00102	doc/html/wdctl_8c-source.html	/^<a name="l00102"><\/a>00102                 usage();$/;"	a
l00103	doc/html/wdctl_8c-source.html	/^<a name="l00103"><\/a>00103                 exit(1);$/;"	a
l00104	doc/html/wdctl_8c-source.html	/^<a name="l00104"><\/a>00104                 <span class="keywordflow">break<\/span>;$/;"	a
l00105	doc/html/wdctl_8c-source.html	/^<a name="l00105"><\/a>00105 $/;"	a
l00106	doc/html/wdctl_8c-source.html	/^<a name="l00106"><\/a>00106             <span class="keywordflow">case<\/span> <span class="charliteral">'s'<\/span>:$/;"	a
l00107	doc/html/wdctl_8c-source.html	/^<a name="l00107"><\/a>00107                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00108	doc/html/wdctl_8c-source.html	/^<a name="l00108"><\/a>00108                     free(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00109	doc/html/wdctl_8c-source.html	/^<a name="l00109"><\/a>00109                     config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a> = strdup(optarg);$/;"	a
l00110	doc/html/wdctl_8c-source.html	/^<a name="l00110"><\/a>00110                 }$/;"	a
l00111	doc/html/wdctl_8c-source.html	/^<a name="l00111"><\/a>00111                 <span class="keywordflow">break<\/span>;$/;"	a
l00112	doc/html/wdctl_8c-source.html	/^<a name="l00112"><\/a>00112 $/;"	a
l00113	doc/html/wdctl_8c-source.html	/^<a name="l00113"><\/a>00113             <span class="keywordflow">default<\/span>:$/;"	a
l00114	doc/html/wdctl_8c-source.html	/^<a name="l00114"><\/a>00114                 usage();$/;"	a
l00115	doc/html/wdctl_8c-source.html	/^<a name="l00115"><\/a>00115                 exit(1);$/;"	a
l00116	doc/html/wdctl_8c-source.html	/^<a name="l00116"><\/a>00116                 <span class="keywordflow">break<\/span>;$/;"	a
l00117	doc/html/wdctl_8c-source.html	/^<a name="l00117"><\/a>00117         }$/;"	a
l00118	doc/html/wdctl_8c-source.html	/^<a name="l00118"><\/a>00118     }$/;"	a
l00119	doc/html/wdctl_8c-source.html	/^<a name="l00119"><\/a>00119 $/;"	a
l00120	doc/html/wdctl_8c-source.html	/^<a name="l00120"><\/a>00120     <span class="keywordflow">if<\/span> ((argc - optind) &lt;= 0) {$/;"	a
l00121	doc/html/wdctl_8c-source.html	/^<a name="l00121"><\/a>00121             usage();$/;"	a
l00122	doc/html/wdctl_8c-source.html	/^<a name="l00122"><\/a>00122             exit(1);$/;"	a
l00123	doc/html/wdctl_8c-source.html	/^<a name="l00123"><\/a>00123     }$/;"	a
l00124	doc/html/wdctl_8c-source.html	/^<a name="l00124"><\/a>00124 $/;"	a
l00125	doc/html/wdctl_8c-source.html	/^<a name="l00125"><\/a>00125     <span class="keywordflow">if<\/span> (strcmp(*(argv + optind), <span class="stringliteral">"status"<\/span>) == 0) {$/;"	a
l00126	doc/html/wdctl_8c-source.html	/^<a name="l00126"><\/a>00126             config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_STATUS;$/;"	a
l00127	doc/html/wdctl_8c-source.html	/^<a name="l00127"><\/a>00127     } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(*(argv + optind), <span class="stringliteral">"stop"<\/span>) == 0) {$/;"	a
l00128	doc/html/wdctl_8c-source.html	/^<a name="l00128"><\/a>00128             config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_STOP;$/;"	a
l00129	doc/html/wdctl_8c-source.html	/^<a name="l00129"><\/a>00129     } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(*(argv + optind), <span class="stringliteral">"reset"<\/span>) == 0) {$/;"	a
l00130	doc/html/wdctl_8c-source.html	/^<a name="l00130"><\/a>00130             config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_KILL;$/;"	a
l00131	doc/html/wdctl_8c-source.html	/^<a name="l00131"><\/a>00131             <span class="keywordflow">if<\/span> ((argc - (optind + 1)) &lt;= 0) {$/;"	a
l00132	doc/html/wdctl_8c-source.html	/^<a name="l00132"><\/a>00132                     fprintf(stderr, <span class="stringliteral">"wdctl: Error: You must specify an IP "<\/span>$/;"	a
l00133	doc/html/wdctl_8c-source.html	/^<a name="l00133"><\/a>00133                                     <span class="stringliteral">"or a Mac address to reset\\n"<\/span>);$/;"	a
l00134	doc/html/wdctl_8c-source.html	/^<a name="l00134"><\/a>00134                     usage();$/;"	a
l00135	doc/html/wdctl_8c-source.html	/^<a name="l00135"><\/a>00135                     exit(1);$/;"	a
l00136	doc/html/wdctl_8c-source.html	/^<a name="l00136"><\/a>00136             }$/;"	a
l00137	doc/html/wdctl_8c-source.html	/^<a name="l00137"><\/a>00137             config.<a class="code" href="structs__config.html#0d3b219bafe97bb489549dcdd334b074">param<\/a> = strdup(*(argv + optind + 1));$/;"	a
l00138	doc/html/wdctl_8c-source.html	/^<a name="l00138"><\/a>00138     } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(*(argv + optind), <span class="stringliteral">"restart"<\/span>) == 0) {$/;"	a
l00139	doc/html/wdctl_8c-source.html	/^<a name="l00139"><\/a>00139             config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_RESTART;$/;"	a
l00140	doc/html/wdctl_8c-source.html	/^<a name="l00140"><\/a>00140     }$/;"	a
l00141	doc/html/wdctl_8c-source.html	/^<a name="l00141"><\/a>00141          <span class="keywordflow">else<\/span> {$/;"	a
l00142	doc/html/wdctl_8c-source.html	/^<a name="l00142"><\/a>00142             fprintf(stderr, <span class="stringliteral">"wdctl: Error: Invalid command \\"%s\\"\\n"<\/span>, *(argv + optind));$/;"	a
l00143	doc/html/wdctl_8c-source.html	/^<a name="l00143"><\/a>00143             usage();$/;"	a
l00144	doc/html/wdctl_8c-source.html	/^<a name="l00144"><\/a>00144             exit(1);$/;"	a
l00145	doc/html/wdctl_8c-source.html	/^<a name="l00145"><\/a>00145     }$/;"	a
l00146	doc/html/wdctl_8c-source.html	/^<a name="l00146"><\/a>00146 }$/;"	a
l00147	doc/html/wdctl_8c-source.html	/^<a name="l00147"><\/a>00147 $/;"	a
l00148	doc/html/wdctl_8c-source.html	/^<a name="l00148"><\/a>00148 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span>$/;"	a
l00149	doc/html/wdctl_8c-source.html	/^<a name="l00149"><\/a>00149 connect_to_server(<span class="keywordtype">char<\/span> *sock_name)$/;"	a
l00150	doc/html/wdctl_8c-source.html	/^<a name="l00150"><\/a>00150 {$/;"	a
l00151	doc/html/wdctl_8c-source.html	/^<a name="l00151"><\/a>00151         <span class="keywordtype">int<\/span> sock;$/;"	a
l00152	doc/html/wdctl_8c-source.html	/^<a name="l00152"><\/a>00152         <span class="keyword">struct <\/span>sockaddr_un      sa_un;$/;"	a
l00153	doc/html/wdctl_8c-source.html	/^<a name="l00153"><\/a>00153         $/;"	a
l00154	doc/html/wdctl_8c-source.html	/^<a name="l00154"><\/a>00154         <span class="comment">\/* Connect to socket *\/<\/span>$/;"	a
l00155	doc/html/wdctl_8c-source.html	/^<a name="l00155"><\/a>00155         sock = socket(AF_UNIX, SOCK_STREAM, 0);$/;"	a
l00156	doc/html/wdctl_8c-source.html	/^<a name="l00156"><\/a>00156         memset(&amp;sa_un, 0, <span class="keyword">sizeof<\/span>(sa_un));$/;"	a
l00157	doc/html/wdctl_8c-source.html	/^<a name="l00157"><\/a>00157         sa_un.sun_family = AF_UNIX;$/;"	a
l00158	doc/html/wdctl_8c-source.html	/^<a name="l00158"><\/a>00158         strncpy(sa_un.sun_path, sock_name, (<span class="keyword">sizeof<\/span>(sa_un.sun_path) - 1));$/;"	a
l00159	doc/html/wdctl_8c-source.html	/^<a name="l00159"><\/a>00159 $/;"	a
l00160	doc/html/wdctl_8c-source.html	/^<a name="l00160"><\/a>00160         <span class="keywordflow">if<\/span> (connect(sock, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, $/;"	a
l00161	doc/html/wdctl_8c-source.html	/^<a name="l00161"><\/a>00161                         strlen(sa_un.sun_path) + <span class="keyword">sizeof<\/span>(sa_un.sun_family))) {$/;"	a
l00162	doc/html/wdctl_8c-source.html	/^<a name="l00162"><\/a>00162                 fprintf(stderr, <span class="stringliteral">"wdctl: wifidog probably not started (Error: %s)\\n"<\/span>, strerror(errno));$/;"	a
l00163	doc/html/wdctl_8c-source.html	/^<a name="l00163"><\/a>00163                 exit(1);$/;"	a
l00164	doc/html/wdctl_8c-source.html	/^<a name="l00164"><\/a>00164         }$/;"	a
l00165	doc/html/wdctl_8c-source.html	/^<a name="l00165"><\/a>00165 $/;"	a
l00166	doc/html/wdctl_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordflow">return<\/span> sock;$/;"	a
l00167	doc/html/wdctl_8c-source.html	/^<a name="l00167"><\/a>00167 }$/;"	a
l00168	doc/html/wdctl_8c-source.html	/^<a name="l00168"><\/a>00168 $/;"	a
l00169	doc/html/wdctl_8c-source.html	/^<a name="l00169"><\/a>00169 <span class="keyword">static<\/span> <span class="keywordtype">size_t<\/span>$/;"	a
l00170	doc/html/wdctl_8c-source.html	/^<a name="l00170"><\/a>00170 send_request(<span class="keywordtype">int<\/span> sock, <span class="keywordtype">char<\/span> *request)$/;"	a
l00171	doc/html/wdctl_8c-source.html	/^<a name="l00171"><\/a>00171 {$/;"	a
l00172	doc/html/wdctl_8c-source.html	/^<a name="l00172"><\/a>00172         <span class="keywordtype">size_t<\/span>  len;$/;"	a
l00173	doc/html/wdctl_8c-source.html	/^<a name="l00173"><\/a>00173         ssize_t written;$/;"	a
l00174	doc/html/wdctl_8c-source.html	/^<a name="l00174"><\/a>00174                 $/;"	a
l00175	doc/html/wdctl_8c-source.html	/^<a name="l00175"><\/a>00175         len = 0;$/;"	a
l00176	doc/html/wdctl_8c-source.html	/^<a name="l00176"><\/a>00176         <span class="keywordflow">while<\/span> (len != strlen(request)) {$/;"	a
l00177	doc/html/wdctl_8c-source.html	/^<a name="l00177"><\/a>00177                 written = write(sock, (request + len), strlen(request) - len);$/;"	a
l00178	doc/html/wdctl_8c-source.html	/^<a name="l00178"><\/a>00178                 <span class="keywordflow">if<\/span> (written == -1) {$/;"	a
l00179	doc/html/wdctl_8c-source.html	/^<a name="l00179"><\/a>00179                         fprintf(stderr, <span class="stringliteral">"Write to wifidog failed: %s\\n"<\/span>,$/;"	a
l00180	doc/html/wdctl_8c-source.html	/^<a name="l00180"><\/a>00180                                         strerror(errno));$/;"	a
l00181	doc/html/wdctl_8c-source.html	/^<a name="l00181"><\/a>00181                         exit(1);$/;"	a
l00182	doc/html/wdctl_8c-source.html	/^<a name="l00182"><\/a>00182                 }$/;"	a
l00183	doc/html/wdctl_8c-source.html	/^<a name="l00183"><\/a>00183                 len += written;$/;"	a
l00184	doc/html/wdctl_8c-source.html	/^<a name="l00184"><\/a>00184         }$/;"	a
l00185	doc/html/wdctl_8c-source.html	/^<a name="l00185"><\/a>00185 $/;"	a
l00186	doc/html/wdctl_8c-source.html	/^<a name="l00186"><\/a>00186         <span class="keywordflow">return<\/span> len;$/;"	a
l00187	doc/html/wdctl_8c-source.html	/^<a name="l00187"><\/a>00187 }$/;"	a
l00188	doc/html/wdctl_8c-source.html	/^<a name="l00188"><\/a>00188 $/;"	a
l00189	doc/html/wdctl_8c-source.html	/^<a name="l00189"><\/a>00189 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00190	doc/html/wdctl_8c-source.html	/^<a name="l00190"><\/a>00190 wdctl_status(<span class="keywordtype">void<\/span>)$/;"	a
l00191	doc/html/wdctl_8c-source.html	/^<a name="l00191"><\/a>00191 {$/;"	a
l00192	doc/html/wdctl_8c-source.html	/^<a name="l00192"><\/a>00192         <span class="keywordtype">int<\/span>     sock;$/;"	a
l00193	doc/html/wdctl_8c-source.html	/^<a name="l00193"><\/a>00193         <span class="keywordtype">char<\/span>    buffer[4096];$/;"	a
l00194	doc/html/wdctl_8c-source.html	/^<a name="l00194"><\/a>00194         <span class="keywordtype">char<\/span>    request[16];$/;"	a
l00195	doc/html/wdctl_8c-source.html	/^<a name="l00195"><\/a>00195         <span class="keywordtype">int<\/span>     len;$/;"	a
l00196	doc/html/wdctl_8c-source.html	/^<a name="l00196"><\/a>00196 $/;"	a
l00197	doc/html/wdctl_8c-source.html	/^<a name="l00197"><\/a>00197         sock = connect_to_server(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00198	doc/html/wdctl_8c-source.html	/^<a name="l00198"><\/a>00198                 $/;"	a
l00199	doc/html/wdctl_8c-source.html	/^<a name="l00199"><\/a>00199         strncpy(request, <span class="stringliteral">"status\\r\\n\\r\\n"<\/span>, 15);$/;"	a
l00200	doc/html/wdctl_8c-source.html	/^<a name="l00200"><\/a>00200 $/;"	a
l00201	doc/html/wdctl_8c-source.html	/^<a name="l00201"><\/a>00201         len = send_request(sock, request);$/;"	a
l00202	doc/html/wdctl_8c-source.html	/^<a name="l00202"><\/a>00202         $/;"	a
l00203	doc/html/wdctl_8c-source.html	/^<a name="l00203"><\/a>00203         <span class="keywordflow">while<\/span> ((len = read(sock, buffer, <span class="keyword">sizeof<\/span>(buffer))) &gt; 0) {$/;"	a
l00204	doc/html/wdctl_8c-source.html	/^<a name="l00204"><\/a>00204                 buffer[len] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00205	doc/html/wdctl_8c-source.html	/^<a name="l00205"><\/a>00205                 printf(<span class="stringliteral">"%s"<\/span>, buffer);$/;"	a
l00206	doc/html/wdctl_8c-source.html	/^<a name="l00206"><\/a>00206         }$/;"	a
l00207	doc/html/wdctl_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	doc/html/wdctl_8c-source.html	/^<a name="l00208"><\/a>00208         shutdown(sock, 2);$/;"	a
l00209	doc/html/wdctl_8c-source.html	/^<a name="l00209"><\/a>00209         close(sock);$/;"	a
l00210	doc/html/wdctl_8c-source.html	/^<a name="l00210"><\/a>00210 }$/;"	a
l00211	doc/html/wdctl_8c-source.html	/^<a name="l00211"><\/a>00211 $/;"	a
l00212	doc/html/wdctl_8c-source.html	/^<a name="l00212"><\/a>00212 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00213	doc/html/wdctl_8c-source.html	/^<a name="l00213"><\/a>00213 wdctl_stop(<span class="keywordtype">void<\/span>)$/;"	a
l00214	doc/html/wdctl_8c-source.html	/^<a name="l00214"><\/a>00214 {$/;"	a
l00215	doc/html/wdctl_8c-source.html	/^<a name="l00215"><\/a>00215         <span class="keywordtype">int<\/span>     sock;$/;"	a
l00216	doc/html/wdctl_8c-source.html	/^<a name="l00216"><\/a>00216         <span class="keywordtype">char<\/span>    buffer[4096];$/;"	a
l00217	doc/html/wdctl_8c-source.html	/^<a name="l00217"><\/a>00217         <span class="keywordtype">char<\/span>    request[16];$/;"	a
l00218	doc/html/wdctl_8c-source.html	/^<a name="l00218"><\/a>00218         <span class="keywordtype">int<\/span>     len;$/;"	a
l00219	doc/html/wdctl_8c-source.html	/^<a name="l00219"><\/a>00219 $/;"	a
l00220	doc/html/wdctl_8c-source.html	/^<a name="l00220"><\/a>00220         sock = connect_to_server(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00221	doc/html/wdctl_8c-source.html	/^<a name="l00221"><\/a>00221                 $/;"	a
l00222	doc/html/wdctl_8c-source.html	/^<a name="l00222"><\/a>00222         strncpy(request, <span class="stringliteral">"stop\\r\\n\\r\\n"<\/span>, 15);$/;"	a
l00223	doc/html/wdctl_8c-source.html	/^<a name="l00223"><\/a>00223 $/;"	a
l00224	doc/html/wdctl_8c-source.html	/^<a name="l00224"><\/a>00224         len = send_request(sock, request);$/;"	a
l00225	doc/html/wdctl_8c-source.html	/^<a name="l00225"><\/a>00225         $/;"	a
l00226	doc/html/wdctl_8c-source.html	/^<a name="l00226"><\/a>00226         <span class="keywordflow">while<\/span> ((len = read(sock, buffer, <span class="keyword">sizeof<\/span>(buffer))) &gt; 0) {$/;"	a
l00227	doc/html/wdctl_8c-source.html	/^<a name="l00227"><\/a>00227                 buffer[len] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00228	doc/html/wdctl_8c-source.html	/^<a name="l00228"><\/a>00228                 printf(<span class="stringliteral">"%s"<\/span>, buffer);$/;"	a
l00229	doc/html/wdctl_8c-source.html	/^<a name="l00229"><\/a>00229         }$/;"	a
l00230	doc/html/wdctl_8c-source.html	/^<a name="l00230"><\/a>00230 $/;"	a
l00231	doc/html/wdctl_8c-source.html	/^<a name="l00231"><\/a>00231         shutdown(sock, 2);$/;"	a
l00232	doc/html/wdctl_8c-source.html	/^<a name="l00232"><\/a>00232         close(sock);$/;"	a
l00233	doc/html/wdctl_8c-source.html	/^<a name="l00233"><\/a>00233 }$/;"	a
l00234	doc/html/wdctl_8c-source.html	/^<a name="l00234"><\/a>00234 $/;"	a
l00235	doc/html/wdctl_8c-source.html	/^<a name="l00235"><\/a>00235 <span class="keywordtype">void<\/span>$/;"	a
l00236	doc/html/wdctl_8c-source.html	/^<a name="l00236"><\/a>00236 wdctl_reset(<span class="keywordtype">void<\/span>)$/;"	a
l00237	doc/html/wdctl_8c-source.html	/^<a name="l00237"><\/a>00237 {$/;"	a
l00238	doc/html/wdctl_8c-source.html	/^<a name="l00238"><\/a>00238         <span class="keywordtype">int<\/span>     sock;$/;"	a
l00239	doc/html/wdctl_8c-source.html	/^<a name="l00239"><\/a>00239         <span class="keywordtype">char<\/span>    buffer[4096];$/;"	a
l00240	doc/html/wdctl_8c-source.html	/^<a name="l00240"><\/a>00240         <span class="keywordtype">char<\/span>    request[64];$/;"	a
l00241	doc/html/wdctl_8c-source.html	/^<a name="l00241"><\/a>00241         <span class="keywordtype">size_t<\/span>  len;$/;"	a
l00242	doc/html/wdctl_8c-source.html	/^<a name="l00242"><\/a>00242         <span class="keywordtype">int<\/span>     rlen;$/;"	a
l00243	doc/html/wdctl_8c-source.html	/^<a name="l00243"><\/a>00243 $/;"	a
l00244	doc/html/wdctl_8c-source.html	/^<a name="l00244"><\/a>00244         sock = connect_to_server(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00245	doc/html/wdctl_8c-source.html	/^<a name="l00245"><\/a>00245                 $/;"	a
l00246	doc/html/wdctl_8c-source.html	/^<a name="l00246"><\/a>00246         strncpy(request, <span class="stringliteral">"reset "<\/span>, 64);$/;"	a
l00247	doc/html/wdctl_8c-source.html	/^<a name="l00247"><\/a>00247         strncat(request, config.<a class="code" href="structs__config.html#0d3b219bafe97bb489549dcdd334b074">param<\/a>, (64 - strlen(request)));$/;"	a
l00248	doc/html/wdctl_8c-source.html	/^<a name="l00248"><\/a>00248         strncat(request, <span class="stringliteral">"\\r\\n\\r\\n"<\/span>, (64 - strlen(request)));$/;"	a
l00249	doc/html/wdctl_8c-source.html	/^<a name="l00249"><\/a>00249 $/;"	a
l00250	doc/html/wdctl_8c-source.html	/^<a name="l00250"><\/a>00250         len = send_request(sock, request);$/;"	a
l00251	doc/html/wdctl_8c-source.html	/^<a name="l00251"><\/a>00251         $/;"	a
l00252	doc/html/wdctl_8c-source.html	/^<a name="l00252"><\/a>00252         len = 0;$/;"	a
l00253	doc/html/wdctl_8c-source.html	/^<a name="l00253"><\/a>00253         memset(buffer, 0, <span class="keyword">sizeof<\/span>(buffer));$/;"	a
l00254	doc/html/wdctl_8c-source.html	/^<a name="l00254"><\/a>00254         <span class="keywordflow">while<\/span> ((len &lt; <span class="keyword">sizeof<\/span>(buffer)) &amp;&amp; ((rlen = read(sock, (buffer + len),$/;"	a
l00255	doc/html/wdctl_8c-source.html	/^<a name="l00255"><\/a>00255                                 (<span class="keyword">sizeof<\/span>(buffer) - len))) &gt; 0)){$/;"	a
l00256	doc/html/wdctl_8c-source.html	/^<a name="l00256"><\/a>00256                 len += rlen;$/;"	a
l00257	doc/html/wdctl_8c-source.html	/^<a name="l00257"><\/a>00257         }$/;"	a
l00258	doc/html/wdctl_8c-source.html	/^<a name="l00258"><\/a>00258 $/;"	a
l00259	doc/html/wdctl_8c-source.html	/^<a name="l00259"><\/a>00259         <span class="keywordflow">if<\/span> (strcmp(buffer, <span class="stringliteral">"Yes"<\/span>) == 0) {$/;"	a
l00260	doc/html/wdctl_8c-source.html	/^<a name="l00260"><\/a>00260                 printf(<span class="stringliteral">"Connection %s successfully reset.\\n"<\/span>, config.<a class="code" href="structs__config.html#0d3b219bafe97bb489549dcdd334b074">param<\/a>);$/;"	a
l00261	doc/html/wdctl_8c-source.html	/^<a name="l00261"><\/a>00261         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(buffer, <span class="stringliteral">"No"<\/span>) == 0) {$/;"	a
l00262	doc/html/wdctl_8c-source.html	/^<a name="l00262"><\/a>00262                 printf(<span class="stringliteral">"Connection %s was not active.\\n"<\/span>, config.<a class="code" href="structs__config.html#0d3b219bafe97bb489549dcdd334b074">param<\/a>);$/;"	a
l00263	doc/html/wdctl_8c-source.html	/^<a name="l00263"><\/a>00263         } <span class="keywordflow">else<\/span> {$/;"	a
l00264	doc/html/wdctl_8c-source.html	/^<a name="l00264"><\/a>00264                 fprintf(stderr, <span class="stringliteral">"wdctl: Error: WiFiDog sent an abnormal "<\/span>$/;"	a
l00265	doc/html/wdctl_8c-source.html	/^<a name="l00265"><\/a>00265                                 <span class="stringliteral">"reply.\\n"<\/span>);$/;"	a
l00266	doc/html/wdctl_8c-source.html	/^<a name="l00266"><\/a>00266         }$/;"	a
l00267	doc/html/wdctl_8c-source.html	/^<a name="l00267"><\/a>00267 $/;"	a
l00268	doc/html/wdctl_8c-source.html	/^<a name="l00268"><\/a>00268         shutdown(sock, 2);$/;"	a
l00269	doc/html/wdctl_8c-source.html	/^<a name="l00269"><\/a>00269         close(sock);$/;"	a
l00270	doc/html/wdctl_8c-source.html	/^<a name="l00270"><\/a>00270 }$/;"	a
l00271	doc/html/wdctl_8c-source.html	/^<a name="l00271"><\/a>00271 $/;"	a
l00272	doc/html/wdctl_8c-source.html	/^<a name="l00272"><\/a>00272 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00273	doc/html/wdctl_8c-source.html	/^<a name="l00273"><\/a>00273 wdctl_restart(<span class="keywordtype">void<\/span>)$/;"	a
l00274	doc/html/wdctl_8c-source.html	/^<a name="l00274"><\/a>00274 {$/;"	a
l00275	doc/html/wdctl_8c-source.html	/^<a name="l00275"><\/a>00275         <span class="keywordtype">int<\/span>     sock;$/;"	a
l00276	doc/html/wdctl_8c-source.html	/^<a name="l00276"><\/a>00276         <span class="keywordtype">char<\/span>    buffer[4096];$/;"	a
l00277	doc/html/wdctl_8c-source.html	/^<a name="l00277"><\/a>00277         <span class="keywordtype">char<\/span>    request[16];$/;"	a
l00278	doc/html/wdctl_8c-source.html	/^<a name="l00278"><\/a>00278         <span class="keywordtype">int<\/span>     len;$/;"	a
l00279	doc/html/wdctl_8c-source.html	/^<a name="l00279"><\/a>00279 $/;"	a
l00280	doc/html/wdctl_8c-source.html	/^<a name="l00280"><\/a>00280         sock = connect_to_server(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00281	doc/html/wdctl_8c-source.html	/^<a name="l00281"><\/a>00281                 $/;"	a
l00282	doc/html/wdctl_8c-source.html	/^<a name="l00282"><\/a>00282         strncpy(request, <span class="stringliteral">"restart\\r\\n\\r\\n"<\/span>, 15);$/;"	a
l00283	doc/html/wdctl_8c-source.html	/^<a name="l00283"><\/a>00283 $/;"	a
l00284	doc/html/wdctl_8c-source.html	/^<a name="l00284"><\/a>00284         len = send_request(sock, request);$/;"	a
l00285	doc/html/wdctl_8c-source.html	/^<a name="l00285"><\/a>00285         $/;"	a
l00286	doc/html/wdctl_8c-source.html	/^<a name="l00286"><\/a>00286         <span class="keywordflow">while<\/span> ((len = read(sock, buffer, <span class="keyword">sizeof<\/span>(buffer))) &gt; 0) {$/;"	a
l00287	doc/html/wdctl_8c-source.html	/^<a name="l00287"><\/a>00287                 buffer[len] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00288	doc/html/wdctl_8c-source.html	/^<a name="l00288"><\/a>00288                 printf(<span class="stringliteral">"%s"<\/span>, buffer);$/;"	a
l00289	doc/html/wdctl_8c-source.html	/^<a name="l00289"><\/a>00289         }$/;"	a
l00290	doc/html/wdctl_8c-source.html	/^<a name="l00290"><\/a>00290 $/;"	a
l00291	doc/html/wdctl_8c-source.html	/^<a name="l00291"><\/a>00291         shutdown(sock, 2);$/;"	a
l00292	doc/html/wdctl_8c-source.html	/^<a name="l00292"><\/a>00292         close(sock);$/;"	a
l00293	doc/html/wdctl_8c-source.html	/^<a name="l00293"><\/a>00293 }$/;"	a
l00294	doc/html/wdctl_8c-source.html	/^<a name="l00294"><\/a>00294 $/;"	a
l00295	doc/html/wdctl_8c-source.html	/^<a name="l00295"><\/a>00295 <span class="keywordtype">int<\/span>$/;"	a
l00296	doc/html/wdctl_8c-source.html	/^<a name="l00296"><\/a>00296 main(<span class="keywordtype">int<\/span> argc, <span class="keywordtype">char<\/span> **argv)$/;"	a
l00297	doc/html/wdctl_8c-source.html	/^<a name="l00297"><\/a>00297 {$/;"	a
l00298	doc/html/wdctl_8c-source.html	/^<a name="l00298"><\/a>00298 $/;"	a
l00299	doc/html/wdctl_8c-source.html	/^<a name="l00299"><\/a>00299         <span class="comment">\/* Init configuration *\/<\/span>$/;"	a
l00300	doc/html/wdctl_8c-source.html	/^<a name="l00300"><\/a>00300         init_config();$/;"	a
l00301	doc/html/wdctl_8c-source.html	/^<a name="l00301"><\/a>00301         <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(argc, argv);$/;"	a
l00302	doc/html/wdctl_8c-source.html	/^<a name="l00302"><\/a>00302 $/;"	a
l00303	doc/html/wdctl_8c-source.html	/^<a name="l00303"><\/a>00303         <span class="keywordflow">switch<\/span>(config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a>) {$/;"	a
l00304	doc/html/wdctl_8c-source.html	/^<a name="l00304"><\/a>00304         <span class="keywordflow">case<\/span> WDCTL_STATUS:$/;"	a
l00305	doc/html/wdctl_8c-source.html	/^<a name="l00305"><\/a>00305                 wdctl_status();$/;"	a
l00306	doc/html/wdctl_8c-source.html	/^<a name="l00306"><\/a>00306                 <span class="keywordflow">break<\/span>;$/;"	a
l00307	doc/html/wdctl_8c-source.html	/^<a name="l00307"><\/a>00307         $/;"	a
l00308	doc/html/wdctl_8c-source.html	/^<a name="l00308"><\/a>00308         <span class="keywordflow">case<\/span> WDCTL_STOP:$/;"	a
l00309	doc/html/wdctl_8c-source.html	/^<a name="l00309"><\/a>00309                 wdctl_stop();$/;"	a
l00310	doc/html/wdctl_8c-source.html	/^<a name="l00310"><\/a>00310                 <span class="keywordflow">break<\/span>;$/;"	a
l00311	doc/html/wdctl_8c-source.html	/^<a name="l00311"><\/a>00311 $/;"	a
l00312	doc/html/wdctl_8c-source.html	/^<a name="l00312"><\/a>00312         <span class="keywordflow">case<\/span> WDCTL_KILL:$/;"	a
l00313	doc/html/wdctl_8c-source.html	/^<a name="l00313"><\/a>00313                 wdctl_reset();$/;"	a
l00314	doc/html/wdctl_8c-source.html	/^<a name="l00314"><\/a>00314                 <span class="keywordflow">break<\/span>;$/;"	a
l00315	doc/html/wdctl_8c-source.html	/^<a name="l00315"><\/a>00315                 $/;"	a
l00316	doc/html/wdctl_8c-source.html	/^<a name="l00316"><\/a>00316         <span class="keywordflow">case<\/span> WDCTL_RESTART:$/;"	a
l00317	doc/html/wdctl_8c-source.html	/^<a name="l00317"><\/a>00317                 wdctl_restart();$/;"	a
l00318	doc/html/wdctl_8c-source.html	/^<a name="l00318"><\/a>00318                 <span class="keywordflow">break<\/span>;$/;"	a
l00319	doc/html/wdctl_8c-source.html	/^<a name="l00319"><\/a>00319 $/;"	a
l00320	doc/html/wdctl_8c-source.html	/^<a name="l00320"><\/a>00320         <span class="keywordflow">default<\/span>:$/;"	a
l00321	doc/html/wdctl_8c-source.html	/^<a name="l00321"><\/a>00321                 <span class="comment">\/* XXX NEVER REACHED *\/<\/span>$/;"	a
l00322	doc/html/wdctl_8c-source.html	/^<a name="l00322"><\/a>00322                 fprintf(stderr, <span class="stringliteral">"Oops\\n"<\/span>);$/;"	a
l00323	doc/html/wdctl_8c-source.html	/^<a name="l00323"><\/a>00323                 exit(1);$/;"	a
l00324	doc/html/wdctl_8c-source.html	/^<a name="l00324"><\/a>00324                 <span class="keywordflow">break<\/span>;$/;"	a
l00325	doc/html/wdctl_8c-source.html	/^<a name="l00325"><\/a>00325         }$/;"	a
l00326	doc/html/wdctl_8c-source.html	/^<a name="l00326"><\/a>00326         exit(0);$/;"	a
l00327	doc/html/wdctl_8c-source.html	/^<a name="l00327"><\/a>00327 }$/;"	a
0cebabb746a51732ec95bf81af215b63	doc/html/wdctl_8c.html	/^<a class="anchor" name="0cebabb746a51732ec95bf81af215b63"><\/a><!-- doxytag: member="wdctl.c::parse_commandline" ref="0cebabb746a51732ec95bf81af215b63" args="(int, char **)" -->$/;"	a
375ac45ca0dffcf271a45768e5352906	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="375ac45ca0dffcf271a45768e5352906"><\/a><!-- doxytag: member="wdctl.c::wdctl_restart" ref="375ac45ca0dffcf271a45768e5352906" args="(void)" -->$/;"	a
3c04138a5bfe5d72780bb7e82a18e627	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3c04138a5bfe5d72780bb7e82a18e627"><\/a><!-- doxytag: member="wdctl.c::main" ref="3c04138a5bfe5d72780bb7e82a18e627" args="(int argc, char **argv)" -->$/;"	a
43aef46781062865294dac3956f2cca8	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="43aef46781062865294dac3956f2cca8"><\/a><!-- doxytag: member="wdctl.c::wdctl_reset" ref="43aef46781062865294dac3956f2cca8" args="(void)" -->$/;"	a
5f7940ad2fedc85b0266e6cd36780676	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5f7940ad2fedc85b0266e6cd36780676"><\/a><!-- doxytag: member="wdctl.c::init_config" ref="5f7940ad2fedc85b0266e6cd36780676" args="(void)" -->$/;"	a
69f0abb3febeb6a1440a1c43c4299423	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="69f0abb3febeb6a1440a1c43c4299423"><\/a><!-- doxytag: member="wdctl.c::wdctl_stop" ref="69f0abb3febeb6a1440a1c43c4299423" args="(void)" -->$/;"	a
6afe179b832c95341f5426667994900d	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6afe179b832c95341f5426667994900d"><\/a><!-- doxytag: member="wdctl.c::connect_to_server" ref="6afe179b832c95341f5426667994900d" args="(char *)" -->$/;"	a
_details	doc/html/wdctl_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
ade5b00daf915be32d7f6cbf116cd9e6	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ade5b00daf915be32d7f6cbf116cd9e6"><\/a><!-- doxytag: member="wdctl.c::config" ref="ade5b00daf915be32d7f6cbf116cd9e6" args="" -->$/;"	a
d0dad603aebcd095087935bcb0c7c5d5	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d0dad603aebcd095087935bcb0c7c5d5"><\/a><!-- doxytag: member="wdctl.c::send_request" ref="d0dad603aebcd095087935bcb0c7c5d5" args="(int, char *)" -->$/;"	a
d92fb21abdced30198124c59c11024c3	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d92fb21abdced30198124c59c11024c3"><\/a><!-- doxytag: member="wdctl.c::wdctl_status" ref="d92fb21abdced30198124c59c11024c3" args="(void)" -->$/;"	a
d96d407a911fbb914fa8e4cfbf2faf0f	doc/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d96d407a911fbb914fa8e4cfbf2faf0f"><\/a><!-- doxytag: member="wdctl.c::usage" ref="d96d407a911fbb914fa8e4cfbf2faf0f" args="(void)" -->$/;"	a
l00001	doc/html/wdctl_8h-source.html	/^<h1>wdctl.h<\/h1><a href="wdctl_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/wdctl_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/wdctl_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/wdctl_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/wdctl_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/wdctl_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/wdctl_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/wdctl_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/wdctl_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/wdctl_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/wdctl_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/wdctl_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/wdctl_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/wdctl_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/wdctl_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/wdctl_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/wdctl_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/wdctl_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/wdctl_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/wdctl_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/wdctl_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: wdctl.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	doc/html/wdctl_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _WDCTL_H_<\/span>$/;"	a
l00028	doc/html/wdctl_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _WDCTL_H_<\/span>$/;"	a
l00029	doc/html/wdctl_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/wdctl_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define DEFAULT_SOCK    "\/tmp\/wdctl.sock"<\/span>$/;"	a
l00031	doc/html/wdctl_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor"><\/span>$/;"	a
l00032	doc/html/wdctl_8h-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#define WDCTL_UNDEF             0<\/span>$/;"	a
l00033	doc/html/wdctl_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor"><\/span><span class="preprocessor">#define WDCTL_STATUS            1<\/span>$/;"	a
l00034	doc/html/wdctl_8h-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor"><\/span><span class="preprocessor">#define WDCTL_STOP              2<\/span>$/;"	a
l00035	doc/html/wdctl_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor"><\/span><span class="preprocessor">#define WDCTL_KILL              3<\/span>$/;"	a
l00036	doc/html/wdctl_8h-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor"><\/span><span class="preprocessor">#define WDCTL_RESTART   4<\/span>$/;"	a
l00037	doc/html/wdctl_8h-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor"><\/span>$/;"	a
l00038	doc/html/wdctl_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span>{$/;"	a
l00039	doc/html/wdctl_8h-source.html	/^<a name="l00039"><\/a>00039         <span class="keywordtype">char<\/span>    *socket;$/;"	a
l00040	doc/html/wdctl_8h-source.html	/^<a name="l00040"><\/a>00040         <span class="keywordtype">int<\/span>     command;$/;"	a
l00041	doc/html/wdctl_8h-source.html	/^<a name="l00041"><\/a>00041         <span class="keywordtype">char<\/span>    *param;$/;"	a
l00042	doc/html/wdctl_8h-source.html	/^<a name="l00042"><\/a>00042 } <a class="code" href="structs__config.html">s_config<\/a>;$/;"	a
l00043	doc/html/wdctl_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#endif<\/span>$/;"	a
00739f1966cd0ef4de4a13c57694abca	doc/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="00739f1966cd0ef4de4a13c57694abca"><\/a><!-- doxytag: member="wdctl.h::WDCTL_RESTART" ref="00739f1966cd0ef4de4a13c57694abca" args="" -->$/;"	a
0901580654d5c856161afeb7a7a9eef1	doc/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0901580654d5c856161afeb7a7a9eef1"><\/a><!-- doxytag: member="wdctl.h::WDCTL_STATUS" ref="0901580654d5c856161afeb7a7a9eef1" args="" -->$/;"	a
4475d561ed3f25da45e2e709ab645d64	doc/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4475d561ed3f25da45e2e709ab645d64"><\/a><!-- doxytag: member="wdctl.h::WDCTL_UNDEF" ref="4475d561ed3f25da45e2e709ab645d64" args="" -->$/;"	a
8f370096143d35d05b7ad2e6d0a9e1a3	doc/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8f370096143d35d05b7ad2e6d0a9e1a3"><\/a><!-- doxytag: member="wdctl.h::WDCTL_KILL" ref="8f370096143d35d05b7ad2e6d0a9e1a3" args="" -->$/;"	a
_details	doc/html/wdctl_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a4d4cc98e8dc9966956db1ea4e726d6c	doc/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a4d4cc98e8dc9966956db1ea4e726d6c"><\/a><!-- doxytag: member="wdctl.h::DEFAULT_SOCK" ref="a4d4cc98e8dc9966956db1ea4e726d6c" args="" -->$/;"	a
ed6d0b6c2903117f0c0cf8be6d448b72	doc/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ed6d0b6c2903117f0c0cf8be6d448b72"><\/a><!-- doxytag: member="wdctl.h::WDCTL_STOP" ref="ed6d0b6c2903117f0c0cf8be6d448b72" args="" -->$/;"	a
l00001	doc/html/wdctl__thread_8c-source.html	/^<h1>wdctl_thread.c<\/h1><a href="wdctl__thread_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/wdctl__thread_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/wdctl__thread_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/wdctl__thread_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/wdctl__thread_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/wdctl__thread_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/wdctl__thread_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/wdctl__thread_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/wdctl__thread_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/wdctl__thread_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/wdctl__thread_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/wdctl__thread_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/wdctl__thread_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/wdctl__thread_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/wdctl__thread_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/wdctl__thread_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/wdctl__thread_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/wdctl__thread_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/wdctl__thread_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/wdctl__thread_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/wdctl__thread_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: wdctl_thread.c 1305 2007-11-01 20:04:20Z benoitg $ *\/<\/span>$/;"	a
l00027	doc/html/wdctl__thread_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00028	doc/html/wdctl__thread_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span>$/;"	a
l00029	doc/html/wdctl__thread_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00030	doc/html/wdctl__thread_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00031	doc/html/wdctl__thread_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00032	doc/html/wdctl__thread_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00033	doc/html/wdctl__thread_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00034	doc/html/wdctl__thread_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00035	doc/html/wdctl__thread_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00036	doc/html/wdctl__thread_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;sys\/un.h&gt;<\/span>$/;"	a
l00037	doc/html/wdctl__thread_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00038	doc/html/wdctl__thread_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00039	doc/html/wdctl__thread_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;signal.h&gt;<\/span>$/;"	a
l00040	doc/html/wdctl__thread_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00041	doc/html/wdctl__thread_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	doc/html/wdctl__thread_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00043	doc/html/wdctl__thread_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00044	doc/html/wdctl__thread_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00045	doc/html/wdctl__thread_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00046	doc/html/wdctl__thread_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00047	doc/html/wdctl__thread_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00048	doc/html/wdctl__thread_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00049	doc/html/wdctl__thread_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="fw__iptables_8h.html" title="Firewall iptables functions.">fw_iptables.h<\/a>"<\/span>$/;"	a
l00050	doc/html/wdctl__thread_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00051	doc/html/wdctl__thread_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00052	doc/html/wdctl__thread_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor">#include "<a class="code" href="wdctl__thread_8h.html" title="WiFiDog monitoring thread.">wdctl_thread.h<\/a>"<\/span>$/;"	a
l00053	doc/html/wdctl__thread_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#include "<a class="code" href="gateway_8h.html" title="Main loop.">gateway.h<\/a>"<\/span>$/;"	a
l00054	doc/html/wdctl__thread_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00055	doc/html/wdctl__thread_8c-source.html	/^<a name="l00055"><\/a>00055 $/;"	a
l00056	doc/html/wdctl__thread_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="comment">\/* Defined in clientlist.c *\/<\/span>$/;"	a
l00057	doc/html/wdctl__thread_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00058	doc/html/wdctl__thread_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a>;$/;"	a
l00059	doc/html/wdctl__thread_8c-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00060	doc/html/wdctl__thread_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="comment">\/* From commandline.c: *\/<\/span>$/;"	a
l00061	doc/html/wdctl__thread_8c-source.html	/^<a name="l00061"><\/a>00061 <span class="keyword">extern<\/span> <span class="keywordtype">char<\/span> ** restartargv;$/;"	a
l00062	doc/html/wdctl__thread_8c-source.html	/^<a name="l00062"><\/a>00062 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> *thread_wdctl_handler(<span class="keywordtype">void<\/span> *);$/;"	a
l00063	doc/html/wdctl__thread_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_status(<span class="keywordtype">int<\/span>);$/;"	a
l00064	doc/html/wdctl__thread_8c-source.html	/^<a name="l00064"><\/a>00064 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> <a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">wdctl_stop<\/a>(<span class="keywordtype">int<\/span>);$/;"	a
l00065	doc/html/wdctl__thread_8c-source.html	/^<a name="l00065"><\/a>00065 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_reset(<span class="keywordtype">int<\/span>, <span class="keywordtype">char<\/span> *);$/;"	a
l00066	doc/html/wdctl__thread_8c-source.html	/^<a name="l00066"><\/a>00066 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_restart(<span class="keywordtype">int<\/span>);$/;"	a
l00067	doc/html/wdctl__thread_8c-source.html	/^<a name="l00067"><\/a>00067 $/;"	a
l00072	doc/html/wdctl__thread_8c-source.html	/^<a name="l00072"><\/a>00072 <span class="keywordtype">void<\/span>$/;"	a
l00073	doc/html/wdctl__thread_8c-source.html	/^<a name="l00073"><\/a><a class="code" href="wdctl__thread_8h.html#620bac3ec925a104631e817432f8a04e">00073<\/a> <a class="code" href="wdctl__thread_8c.html#620bac3ec925a104631e817432f8a04e" title="Listen for WiFiDog control messages on a unix domain socket.">thread_wdctl<\/a>(<span class="keywordtype">void<\/span> *arg)$/;"	a
l00074	doc/html/wdctl__thread_8c-source.html	/^<a name="l00074"><\/a>00074 {$/;"	a
l00075	doc/html/wdctl__thread_8c-source.html	/^<a name="l00075"><\/a>00075         <span class="keywordtype">int<\/span>     fd;$/;"	a
l00076	doc/html/wdctl__thread_8c-source.html	/^<a name="l00076"><\/a>00076         <span class="keywordtype">char<\/span>    *sock_name;$/;"	a
l00077	doc/html/wdctl__thread_8c-source.html	/^<a name="l00077"><\/a>00077         <span class="keyword">struct  <\/span>sockaddr_un     sa_un;$/;"	a
l00078	doc/html/wdctl__thread_8c-source.html	/^<a name="l00078"><\/a>00078         <span class="keywordtype">int<\/span> result;$/;"	a
l00079	doc/html/wdctl__thread_8c-source.html	/^<a name="l00079"><\/a>00079         pthread_t       tid;$/;"	a
l00080	doc/html/wdctl__thread_8c-source.html	/^<a name="l00080"><\/a>00080         socklen_t len;$/;"	a
l00081	doc/html/wdctl__thread_8c-source.html	/^<a name="l00081"><\/a>00081 $/;"	a
l00082	doc/html/wdctl__thread_8c-source.html	/^<a name="l00082"><\/a>00082         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Starting wdctl."<\/span>);$/;"	a
l00083	doc/html/wdctl__thread_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	doc/html/wdctl__thread_8c-source.html	/^<a name="l00084"><\/a>00084         memset(&amp;sa_un, 0, <span class="keyword">sizeof<\/span>(sa_un));$/;"	a
l00085	doc/html/wdctl__thread_8c-source.html	/^<a name="l00085"><\/a>00085         sock_name = (<span class="keywordtype">char<\/span> *)arg;$/;"	a
l00086	doc/html/wdctl__thread_8c-source.html	/^<a name="l00086"><\/a>00086         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Socket name: %s"<\/span>, sock_name);$/;"	a
l00087	doc/html/wdctl__thread_8c-source.html	/^<a name="l00087"><\/a>00087 $/;"	a
l00088	doc/html/wdctl__thread_8c-source.html	/^<a name="l00088"><\/a>00088         <span class="keywordflow">if<\/span> (strlen(sock_name) &gt; (<span class="keyword">sizeof<\/span>(sa_un.sun_path) - 1)) {$/;"	a
l00089	doc/html/wdctl__thread_8c-source.html	/^<a name="l00089"><\/a>00089                 <span class="comment">\/* TODO: Die handler with logging.... *\/<\/span>$/;"	a
l00090	doc/html/wdctl__thread_8c-source.html	/^<a name="l00090"><\/a>00090                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"WDCTL socket name too long"<\/span>);$/;"	a
l00091	doc/html/wdctl__thread_8c-source.html	/^<a name="l00091"><\/a>00091                 exit(1);$/;"	a
l00092	doc/html/wdctl__thread_8c-source.html	/^<a name="l00092"><\/a>00092         }$/;"	a
l00093	doc/html/wdctl__thread_8c-source.html	/^<a name="l00093"><\/a>00093         $/;"	a
l00094	doc/html/wdctl__thread_8c-source.html	/^<a name="l00094"><\/a>00094 $/;"	a
l00095	doc/html/wdctl__thread_8c-source.html	/^<a name="l00095"><\/a>00095         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Creating socket"<\/span>);$/;"	a
l00096	doc/html/wdctl__thread_8c-source.html	/^<a name="l00096"><\/a>00096         wdctl_socket_server = socket(PF_UNIX, SOCK_STREAM, 0);$/;"	a
l00097	doc/html/wdctl__thread_8c-source.html	/^<a name="l00097"><\/a>00097 $/;"	a
l00098	doc/html/wdctl__thread_8c-source.html	/^<a name="l00098"><\/a>00098         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Got server socket %d"<\/span>, wdctl_socket_server);$/;"	a
l00099	doc/html/wdctl__thread_8c-source.html	/^<a name="l00099"><\/a>00099 $/;"	a
l00100	doc/html/wdctl__thread_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="comment">\/* If it exists, delete... Not the cleanest way to deal. *\/<\/span>$/;"	a
l00101	doc/html/wdctl__thread_8c-source.html	/^<a name="l00101"><\/a>00101         unlink(sock_name);$/;"	a
l00102	doc/html/wdctl__thread_8c-source.html	/^<a name="l00102"><\/a>00102 $/;"	a
l00103	doc/html/wdctl__thread_8c-source.html	/^<a name="l00103"><\/a>00103         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Filling sockaddr_un"<\/span>);$/;"	a
l00104	doc/html/wdctl__thread_8c-source.html	/^<a name="l00104"><\/a>00104         strcpy(sa_un.sun_path, sock_name); <span class="comment">\/* XXX No size check because we<\/span>$/;"	a
l00105	doc/html/wdctl__thread_8c-source.html	/^<a name="l00105"><\/a>00105 <span class="comment">                                            * check a few lines before. *\/<\/span>$/;"	a
l00106	doc/html/wdctl__thread_8c-source.html	/^<a name="l00106"><\/a>00106         sa_un.sun_family = AF_UNIX;$/;"	a
l00107	doc/html/wdctl__thread_8c-source.html	/^<a name="l00107"><\/a>00107         $/;"	a
l00108	doc/html/wdctl__thread_8c-source.html	/^<a name="l00108"><\/a>00108         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Binding socket (%s) (%d)"<\/span>, sa_un.sun_path,$/;"	a
l00109	doc/html/wdctl__thread_8c-source.html	/^<a name="l00109"><\/a>00109                         strlen(sock_name));$/;"	a
l00110	doc/html/wdctl__thread_8c-source.html	/^<a name="l00110"><\/a>00110         $/;"	a
l00111	doc/html/wdctl__thread_8c-source.html	/^<a name="l00111"><\/a>00111         <span class="comment">\/* Which to use, AF_UNIX, PF_UNIX, AF_LOCAL, PF_LOCAL? *\/<\/span>$/;"	a
l00112	doc/html/wdctl__thread_8c-source.html	/^<a name="l00112"><\/a>00112         <span class="keywordflow">if<\/span> (bind(wdctl_socket_server, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, strlen(sock_name) $/;"	a
l00113	doc/html/wdctl__thread_8c-source.html	/^<a name="l00113"><\/a>00113                                 + <span class="keyword">sizeof<\/span>(sa_un.sun_family))) {$/;"	a
l00114	doc/html/wdctl__thread_8c-source.html	/^<a name="l00114"><\/a>00114                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not bind control socket: %s"<\/span>,$/;"	a
l00115	doc/html/wdctl__thread_8c-source.html	/^<a name="l00115"><\/a>00115                                 strerror(errno));$/;"	a
l00116	doc/html/wdctl__thread_8c-source.html	/^<a name="l00116"><\/a>00116                 pthread_exit(NULL);$/;"	a
l00117	doc/html/wdctl__thread_8c-source.html	/^<a name="l00117"><\/a>00117         }$/;"	a
l00118	doc/html/wdctl__thread_8c-source.html	/^<a name="l00118"><\/a>00118 $/;"	a
l00119	doc/html/wdctl__thread_8c-source.html	/^<a name="l00119"><\/a>00119         <span class="keywordflow">if<\/span> (listen(wdctl_socket_server, 5)) {$/;"	a
l00120	doc/html/wdctl__thread_8c-source.html	/^<a name="l00120"><\/a>00120                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not listen on control socket: %s"<\/span>,$/;"	a
l00121	doc/html/wdctl__thread_8c-source.html	/^<a name="l00121"><\/a>00121                                 strerror(errno));$/;"	a
l00122	doc/html/wdctl__thread_8c-source.html	/^<a name="l00122"><\/a>00122                 pthread_exit(NULL);$/;"	a
l00123	doc/html/wdctl__thread_8c-source.html	/^<a name="l00123"><\/a>00123         }$/;"	a
l00124	doc/html/wdctl__thread_8c-source.html	/^<a name="l00124"><\/a>00124 $/;"	a
l00125	doc/html/wdctl__thread_8c-source.html	/^<a name="l00125"><\/a>00125         <span class="keywordflow">while<\/span> (1) {$/;"	a
l00126	doc/html/wdctl__thread_8c-source.html	/^<a name="l00126"><\/a>00126                 len = <span class="keyword">sizeof<\/span>(sa_un); $/;"	a
l00127	doc/html/wdctl__thread_8c-source.html	/^<a name="l00127"><\/a>00127                 memset(&amp;sa_un, 0, len);$/;"	a
l00128	doc/html/wdctl__thread_8c-source.html	/^<a name="l00128"><\/a>00128                 <span class="keywordflow">if<\/span> ((fd = accept(wdctl_socket_server, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, &amp;len)) == -1){$/;"	a
l00129	doc/html/wdctl__thread_8c-source.html	/^<a name="l00129"><\/a>00129                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Accept failed on control socket: %s"<\/span>,$/;"	a
l00130	doc/html/wdctl__thread_8c-source.html	/^<a name="l00130"><\/a>00130                                         strerror(errno));$/;"	a
l00131	doc/html/wdctl__thread_8c-source.html	/^<a name="l00131"><\/a>00131                 } <span class="keywordflow">else<\/span> {$/;"	a
l00132	doc/html/wdctl__thread_8c-source.html	/^<a name="l00132"><\/a>00132                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Accepted connection on wdctl socket %d (%s)"<\/span>, fd, sa_un.sun_path);$/;"	a
l00133	doc/html/wdctl__thread_8c-source.html	/^<a name="l00133"><\/a>00133                         result = pthread_create(&amp;tid, NULL, &amp;thread_wdctl_handler, (<span class="keywordtype">void<\/span> *)fd);$/;"	a
l00134	doc/html/wdctl__thread_8c-source.html	/^<a name="l00134"><\/a>00134                         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00135	doc/html/wdctl__thread_8c-source.html	/^<a name="l00135"><\/a>00135                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (wdctl handler) - exiting"<\/span>);$/;"	a
l00136	doc/html/wdctl__thread_8c-source.html	/^<a name="l00136"><\/a>00136                                 termination_handler(0);$/;"	a
l00137	doc/html/wdctl__thread_8c-source.html	/^<a name="l00137"><\/a>00137                         }$/;"	a
l00138	doc/html/wdctl__thread_8c-source.html	/^<a name="l00138"><\/a>00138                         pthread_detach(tid);$/;"	a
l00139	doc/html/wdctl__thread_8c-source.html	/^<a name="l00139"><\/a>00139                 }$/;"	a
l00140	doc/html/wdctl__thread_8c-source.html	/^<a name="l00140"><\/a>00140         }$/;"	a
l00141	doc/html/wdctl__thread_8c-source.html	/^<a name="l00141"><\/a>00141 }$/;"	a
l00142	doc/html/wdctl__thread_8c-source.html	/^<a name="l00142"><\/a>00142 $/;"	a
l00143	doc/html/wdctl__thread_8c-source.html	/^<a name="l00143"><\/a>00143 $/;"	a
l00144	doc/html/wdctl__thread_8c-source.html	/^<a name="l00144"><\/a>00144 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> *$/;"	a
l00145	doc/html/wdctl__thread_8c-source.html	/^<a name="l00145"><\/a>00145 thread_wdctl_handler(<span class="keywordtype">void<\/span> *arg)$/;"	a
l00146	doc/html/wdctl__thread_8c-source.html	/^<a name="l00146"><\/a>00146 {$/;"	a
l00147	doc/html/wdctl__thread_8c-source.html	/^<a name="l00147"><\/a>00147         <span class="keywordtype">int<\/span>     fd,$/;"	a
l00148	doc/html/wdctl__thread_8c-source.html	/^<a name="l00148"><\/a>00148                 done,$/;"	a
l00149	doc/html/wdctl__thread_8c-source.html	/^<a name="l00149"><\/a>00149                 i;$/;"	a
l00150	doc/html/wdctl__thread_8c-source.html	/^<a name="l00150"><\/a>00150         <span class="keywordtype">char<\/span>    request[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00151	doc/html/wdctl__thread_8c-source.html	/^<a name="l00151"><\/a>00151         ssize_t read_bytes,$/;"	a
l00152	doc/html/wdctl__thread_8c-source.html	/^<a name="l00152"><\/a>00152                 len;$/;"	a
l00153	doc/html/wdctl__thread_8c-source.html	/^<a name="l00153"><\/a>00153 $/;"	a
l00154	doc/html/wdctl__thread_8c-source.html	/^<a name="l00154"><\/a>00154         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Entering thread_wdctl_handler...."<\/span>);$/;"	a
l00155	doc/html/wdctl__thread_8c-source.html	/^<a name="l00155"><\/a>00155 $/;"	a
l00156	doc/html/wdctl__thread_8c-source.html	/^<a name="l00156"><\/a>00156         fd = (int)arg;$/;"	a
l00157	doc/html/wdctl__thread_8c-source.html	/^<a name="l00157"><\/a>00157         $/;"	a
l00158	doc/html/wdctl__thread_8c-source.html	/^<a name="l00158"><\/a>00158         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read bytes and stuff from %d"<\/span>, fd);$/;"	a
l00159	doc/html/wdctl__thread_8c-source.html	/^<a name="l00159"><\/a>00159 $/;"	a
l00160	doc/html/wdctl__thread_8c-source.html	/^<a name="l00160"><\/a>00160         <span class="comment">\/* Init variables *\/<\/span>$/;"	a
l00161	doc/html/wdctl__thread_8c-source.html	/^<a name="l00161"><\/a>00161         read_bytes = 0;$/;"	a
l00162	doc/html/wdctl__thread_8c-source.html	/^<a name="l00162"><\/a>00162         done = 0;$/;"	a
l00163	doc/html/wdctl__thread_8c-source.html	/^<a name="l00163"><\/a>00163         memset(request, 0, <span class="keyword">sizeof<\/span>(request));$/;"	a
l00164	doc/html/wdctl__thread_8c-source.html	/^<a name="l00164"><\/a>00164         $/;"	a
l00165	doc/html/wdctl__thread_8c-source.html	/^<a name="l00165"><\/a>00165         <span class="comment">\/* Read.... *\/<\/span>$/;"	a
l00166	doc/html/wdctl__thread_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordflow">while<\/span> (!done &amp;&amp; read_bytes &lt; (<span class="keyword">sizeof<\/span>(request) - 1)) {$/;"	a
l00167	doc/html/wdctl__thread_8c-source.html	/^<a name="l00167"><\/a>00167                 len = read(fd, request + read_bytes,$/;"	a
l00168	doc/html/wdctl__thread_8c-source.html	/^<a name="l00168"><\/a>00168                                 <span class="keyword">sizeof<\/span>(request) - read_bytes);$/;"	a
l00169	doc/html/wdctl__thread_8c-source.html	/^<a name="l00169"><\/a>00169 $/;"	a
l00170	doc/html/wdctl__thread_8c-source.html	/^<a name="l00170"><\/a>00170                 <span class="comment">\/* Have we gotten a command yet? *\/<\/span>$/;"	a
l00171	doc/html/wdctl__thread_8c-source.html	/^<a name="l00171"><\/a>00171                 <span class="keywordflow">for<\/span> (i = read_bytes; i &lt; (read_bytes + len); i++) {$/;"	a
l00172	doc/html/wdctl__thread_8c-source.html	/^<a name="l00172"><\/a>00172                         <span class="keywordflow">if<\/span> (request[i] == <span class="charliteral">'\\r'<\/span> || request[i] == <span class="charliteral">'\\n'<\/span>) {$/;"	a
l00173	doc/html/wdctl__thread_8c-source.html	/^<a name="l00173"><\/a>00173                                 request[i] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00174	doc/html/wdctl__thread_8c-source.html	/^<a name="l00174"><\/a>00174                                 done = 1;$/;"	a
l00175	doc/html/wdctl__thread_8c-source.html	/^<a name="l00175"><\/a>00175                         }$/;"	a
l00176	doc/html/wdctl__thread_8c-source.html	/^<a name="l00176"><\/a>00176                 }$/;"	a
l00177	doc/html/wdctl__thread_8c-source.html	/^<a name="l00177"><\/a>00177                 $/;"	a
l00178	doc/html/wdctl__thread_8c-source.html	/^<a name="l00178"><\/a>00178                 <span class="comment">\/* Increment position *\/<\/span>$/;"	a
l00179	doc/html/wdctl__thread_8c-source.html	/^<a name="l00179"><\/a>00179                 read_bytes += len;$/;"	a
l00180	doc/html/wdctl__thread_8c-source.html	/^<a name="l00180"><\/a>00180         }$/;"	a
l00181	doc/html/wdctl__thread_8c-source.html	/^<a name="l00181"><\/a>00181 $/;"	a
l00182	doc/html/wdctl__thread_8c-source.html	/^<a name="l00182"><\/a>00182         <span class="keywordflow">if<\/span> (strncmp(request, <span class="stringliteral">"status"<\/span>, 6) == 0) {$/;"	a
l00183	doc/html/wdctl__thread_8c-source.html	/^<a name="l00183"><\/a>00183                 wdctl_status(fd);$/;"	a
l00184	doc/html/wdctl__thread_8c-source.html	/^<a name="l00184"><\/a>00184         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strncmp(request, <span class="stringliteral">"stop"<\/span>, 4) == 0) {$/;"	a
l00185	doc/html/wdctl__thread_8c-source.html	/^<a name="l00185"><\/a>00185                 <a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">wdctl_stop<\/a>(fd);$/;"	a
l00186	doc/html/wdctl__thread_8c-source.html	/^<a name="l00186"><\/a>00186         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strncmp(request, <span class="stringliteral">"reset"<\/span>, 5) == 0) {$/;"	a
l00187	doc/html/wdctl__thread_8c-source.html	/^<a name="l00187"><\/a>00187                 wdctl_reset(fd, (request + 6));$/;"	a
l00188	doc/html/wdctl__thread_8c-source.html	/^<a name="l00188"><\/a>00188         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strncmp(request, <span class="stringliteral">"restart"<\/span>, 7) == 0) {$/;"	a
l00189	doc/html/wdctl__thread_8c-source.html	/^<a name="l00189"><\/a>00189                 wdctl_restart(fd);$/;"	a
l00190	doc/html/wdctl__thread_8c-source.html	/^<a name="l00190"><\/a>00190         }$/;"	a
l00191	doc/html/wdctl__thread_8c-source.html	/^<a name="l00191"><\/a>00191 $/;"	a
l00192	doc/html/wdctl__thread_8c-source.html	/^<a name="l00192"><\/a>00192         <span class="keywordflow">if<\/span> (!done) {$/;"	a
l00193	doc/html/wdctl__thread_8c-source.html	/^<a name="l00193"><\/a>00193                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid wdctl request."<\/span>);$/;"	a
l00194	doc/html/wdctl__thread_8c-source.html	/^<a name="l00194"><\/a>00194                 shutdown(fd, 2);$/;"	a
l00195	doc/html/wdctl__thread_8c-source.html	/^<a name="l00195"><\/a>00195                 close(fd);$/;"	a
l00196	doc/html/wdctl__thread_8c-source.html	/^<a name="l00196"><\/a>00196                 pthread_exit(NULL);$/;"	a
l00197	doc/html/wdctl__thread_8c-source.html	/^<a name="l00197"><\/a>00197         }$/;"	a
l00198	doc/html/wdctl__thread_8c-source.html	/^<a name="l00198"><\/a>00198 $/;"	a
l00199	doc/html/wdctl__thread_8c-source.html	/^<a name="l00199"><\/a>00199         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Request received: [%s]"<\/span>, request);$/;"	a
l00200	doc/html/wdctl__thread_8c-source.html	/^<a name="l00200"><\/a>00200         $/;"	a
l00201	doc/html/wdctl__thread_8c-source.html	/^<a name="l00201"><\/a>00201         shutdown(fd, 2);$/;"	a
l00202	doc/html/wdctl__thread_8c-source.html	/^<a name="l00202"><\/a>00202         close(fd);$/;"	a
l00203	doc/html/wdctl__thread_8c-source.html	/^<a name="l00203"><\/a>00203         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Exiting thread_wdctl_handler...."<\/span>);$/;"	a
l00204	doc/html/wdctl__thread_8c-source.html	/^<a name="l00204"><\/a>00204 $/;"	a
l00205	doc/html/wdctl__thread_8c-source.html	/^<a name="l00205"><\/a>00205         <span class="keywordflow">return<\/span> NULL;$/;"	a
l00206	doc/html/wdctl__thread_8c-source.html	/^<a name="l00206"><\/a>00206 }$/;"	a
l00207	doc/html/wdctl__thread_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	doc/html/wdctl__thread_8c-source.html	/^<a name="l00208"><\/a>00208 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00209	doc/html/wdctl__thread_8c-source.html	/^<a name="l00209"><\/a>00209 wdctl_status(<span class="keywordtype">int<\/span> fd)$/;"	a
l00210	doc/html/wdctl__thread_8c-source.html	/^<a name="l00210"><\/a>00210 {$/;"	a
l00211	doc/html/wdctl__thread_8c-source.html	/^<a name="l00211"><\/a>00211         <span class="keywordtype">char<\/span> * status = NULL;$/;"	a
l00212	doc/html/wdctl__thread_8c-source.html	/^<a name="l00212"><\/a>00212         <span class="keywordtype">int<\/span> len = 0;$/;"	a
l00213	doc/html/wdctl__thread_8c-source.html	/^<a name="l00213"><\/a>00213 $/;"	a
l00214	doc/html/wdctl__thread_8c-source.html	/^<a name="l00214"><\/a>00214         status = get_status_text();$/;"	a
l00215	doc/html/wdctl__thread_8c-source.html	/^<a name="l00215"><\/a>00215         len = strlen(status);$/;"	a
l00216	doc/html/wdctl__thread_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00217	doc/html/wdctl__thread_8c-source.html	/^<a name="l00217"><\/a>00217         write(fd, status, len);$/;"	a
l00218	doc/html/wdctl__thread_8c-source.html	/^<a name="l00218"><\/a>00218 $/;"	a
l00219	doc/html/wdctl__thread_8c-source.html	/^<a name="l00219"><\/a>00219         free(status);$/;"	a
l00220	doc/html/wdctl__thread_8c-source.html	/^<a name="l00220"><\/a>00220 }$/;"	a
l00221	doc/html/wdctl__thread_8c-source.html	/^<a name="l00221"><\/a>00221 $/;"	a
l00223	doc/html/wdctl__thread_8c-source.html	/^<a name="l00223"><\/a>00223 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00224	doc/html/wdctl__thread_8c-source.html	/^<a name="l00224"><\/a><a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">00224<\/a> <a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">wdctl_stop<\/a>(<span class="keywordtype">int<\/span> fd)$/;"	a
l00225	doc/html/wdctl__thread_8c-source.html	/^<a name="l00225"><\/a>00225 {$/;"	a
l00226	doc/html/wdctl__thread_8c-source.html	/^<a name="l00226"><\/a>00226         pid_t   pid;$/;"	a
l00227	doc/html/wdctl__thread_8c-source.html	/^<a name="l00227"><\/a>00227 $/;"	a
l00228	doc/html/wdctl__thread_8c-source.html	/^<a name="l00228"><\/a>00228         pid = getpid();$/;"	a
l00229	doc/html/wdctl__thread_8c-source.html	/^<a name="l00229"><\/a>00229         kill(pid, SIGINT);$/;"	a
l00230	doc/html/wdctl__thread_8c-source.html	/^<a name="l00230"><\/a>00230 }$/;"	a
l00231	doc/html/wdctl__thread_8c-source.html	/^<a name="l00231"><\/a>00231 $/;"	a
l00232	doc/html/wdctl__thread_8c-source.html	/^<a name="l00232"><\/a>00232 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00233	doc/html/wdctl__thread_8c-source.html	/^<a name="l00233"><\/a>00233 wdctl_restart(<span class="keywordtype">int<\/span> afd)$/;"	a
l00234	doc/html/wdctl__thread_8c-source.html	/^<a name="l00234"><\/a>00234 {$/;"	a
l00235	doc/html/wdctl__thread_8c-source.html	/^<a name="l00235"><\/a>00235         <span class="keywordtype">int<\/span>     sock,$/;"	a
l00236	doc/html/wdctl__thread_8c-source.html	/^<a name="l00236"><\/a>00236                 fd;$/;"	a
l00237	doc/html/wdctl__thread_8c-source.html	/^<a name="l00237"><\/a>00237         <span class="keywordtype">char<\/span>    *sock_name;$/;"	a
l00238	doc/html/wdctl__thread_8c-source.html	/^<a name="l00238"><\/a>00238         <span class="keyword">struct  <\/span>sockaddr_un     sa_un;$/;"	a
l00239	doc/html/wdctl__thread_8c-source.html	/^<a name="l00239"><\/a>00239         <a class="code" href="structs__config.html">s_config<\/a> * conf = NULL;$/;"	a
l00240	doc/html/wdctl__thread_8c-source.html	/^<a name="l00240"><\/a>00240         <a class="code" href="struct__t__client.html">t_client<\/a> * client = NULL;$/;"	a
l00241	doc/html/wdctl__thread_8c-source.html	/^<a name="l00241"><\/a>00241         <span class="keywordtype">char<\/span> * tempstring = NULL;$/;"	a
l00242	doc/html/wdctl__thread_8c-source.html	/^<a name="l00242"><\/a>00242         pid_t pid;$/;"	a
l00243	doc/html/wdctl__thread_8c-source.html	/^<a name="l00243"><\/a>00243         ssize_t written;$/;"	a
l00244	doc/html/wdctl__thread_8c-source.html	/^<a name="l00244"><\/a>00244         socklen_t len;$/;"	a
l00245	doc/html/wdctl__thread_8c-source.html	/^<a name="l00245"><\/a>00245 $/;"	a
l00246	doc/html/wdctl__thread_8c-source.html	/^<a name="l00246"><\/a>00246         conf = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00247	doc/html/wdctl__thread_8c-source.html	/^<a name="l00247"><\/a>00247 $/;"	a
l00248	doc/html/wdctl__thread_8c-source.html	/^<a name="l00248"><\/a>00248         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Will restart myself"<\/span>);$/;"	a
l00249	doc/html/wdctl__thread_8c-source.html	/^<a name="l00249"><\/a>00249 $/;"	a
l00250	doc/html/wdctl__thread_8c-source.html	/^<a name="l00250"><\/a>00250         <span class="comment">\/*<\/span>$/;"	a
l00251	doc/html/wdctl__thread_8c-source.html	/^<a name="l00251"><\/a>00251 <span class="comment">         * First, prepare the internal socket<\/span>$/;"	a
l00252	doc/html/wdctl__thread_8c-source.html	/^<a name="l00252"><\/a>00252 <span class="comment">         *\/<\/span>$/;"	a
l00253	doc/html/wdctl__thread_8c-source.html	/^<a name="l00253"><\/a>00253         memset(&amp;sa_un, 0, <span class="keyword">sizeof<\/span>(sa_un));$/;"	a
l00254	doc/html/wdctl__thread_8c-source.html	/^<a name="l00254"><\/a>00254         sock_name = conf-&gt;internal_sock;$/;"	a
l00255	doc/html/wdctl__thread_8c-source.html	/^<a name="l00255"><\/a>00255         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Socket name: %s"<\/span>, sock_name);$/;"	a
l00256	doc/html/wdctl__thread_8c-source.html	/^<a name="l00256"><\/a>00256 $/;"	a
l00257	doc/html/wdctl__thread_8c-source.html	/^<a name="l00257"><\/a>00257         <span class="keywordflow">if<\/span> (strlen(sock_name) &gt; (<span class="keyword">sizeof<\/span>(sa_un.sun_path) - 1)) {$/;"	a
l00258	doc/html/wdctl__thread_8c-source.html	/^<a name="l00258"><\/a>00258                 <span class="comment">\/* TODO: Die handler with logging.... *\/<\/span>$/;"	a
l00259	doc/html/wdctl__thread_8c-source.html	/^<a name="l00259"><\/a>00259                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"INTERNAL socket name too long"<\/span>);$/;"	a
l00260	doc/html/wdctl__thread_8c-source.html	/^<a name="l00260"><\/a>00260                 <span class="keywordflow">return<\/span>;$/;"	a
l00261	doc/html/wdctl__thread_8c-source.html	/^<a name="l00261"><\/a>00261         }$/;"	a
l00262	doc/html/wdctl__thread_8c-source.html	/^<a name="l00262"><\/a>00262 $/;"	a
l00263	doc/html/wdctl__thread_8c-source.html	/^<a name="l00263"><\/a>00263         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Creating socket"<\/span>);$/;"	a
l00264	doc/html/wdctl__thread_8c-source.html	/^<a name="l00264"><\/a>00264         sock = socket(PF_UNIX, SOCK_STREAM, 0);$/;"	a
l00265	doc/html/wdctl__thread_8c-source.html	/^<a name="l00265"><\/a>00265 $/;"	a
l00266	doc/html/wdctl__thread_8c-source.html	/^<a name="l00266"><\/a>00266         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Got internal socket %d"<\/span>, sock);$/;"	a
l00267	doc/html/wdctl__thread_8c-source.html	/^<a name="l00267"><\/a>00267 $/;"	a
l00268	doc/html/wdctl__thread_8c-source.html	/^<a name="l00268"><\/a>00268         <span class="comment">\/* If it exists, delete... Not the cleanest way to deal. *\/<\/span>$/;"	a
l00269	doc/html/wdctl__thread_8c-source.html	/^<a name="l00269"><\/a>00269         unlink(sock_name);$/;"	a
l00270	doc/html/wdctl__thread_8c-source.html	/^<a name="l00270"><\/a>00270 $/;"	a
l00271	doc/html/wdctl__thread_8c-source.html	/^<a name="l00271"><\/a>00271         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Filling sockaddr_un"<\/span>);$/;"	a
l00272	doc/html/wdctl__thread_8c-source.html	/^<a name="l00272"><\/a>00272         strcpy(sa_un.sun_path, sock_name); <span class="comment">\/* XXX No size check because we check a few lines before. *\/<\/span>$/;"	a
l00273	doc/html/wdctl__thread_8c-source.html	/^<a name="l00273"><\/a>00273         sa_un.sun_family = AF_UNIX;$/;"	a
l00274	doc/html/wdctl__thread_8c-source.html	/^<a name="l00274"><\/a>00274         $/;"	a
l00275	doc/html/wdctl__thread_8c-source.html	/^<a name="l00275"><\/a>00275         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Binding socket (%s) (%d)"<\/span>, sa_un.sun_path, strlen(sock_name));$/;"	a
l00276	doc/html/wdctl__thread_8c-source.html	/^<a name="l00276"><\/a>00276         $/;"	a
l00277	doc/html/wdctl__thread_8c-source.html	/^<a name="l00277"><\/a>00277         <span class="comment">\/* Which to use, AF_UNIX, PF_UNIX, AF_LOCAL, PF_LOCAL? *\/<\/span>$/;"	a
l00278	doc/html/wdctl__thread_8c-source.html	/^<a name="l00278"><\/a>00278         <span class="keywordflow">if<\/span> (bind(sock, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, strlen(sock_name) + <span class="keyword">sizeof<\/span>(sa_un.sun_family))) {$/;"	a
l00279	doc/html/wdctl__thread_8c-source.html	/^<a name="l00279"><\/a>00279                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not bind internal socket: %s"<\/span>, strerror(errno));$/;"	a
l00280	doc/html/wdctl__thread_8c-source.html	/^<a name="l00280"><\/a>00280                 <span class="keywordflow">return<\/span>;$/;"	a
l00281	doc/html/wdctl__thread_8c-source.html	/^<a name="l00281"><\/a>00281         }$/;"	a
l00282	doc/html/wdctl__thread_8c-source.html	/^<a name="l00282"><\/a>00282 $/;"	a
l00283	doc/html/wdctl__thread_8c-source.html	/^<a name="l00283"><\/a>00283         <span class="keywordflow">if<\/span> (listen(sock, 5)) {$/;"	a
l00284	doc/html/wdctl__thread_8c-source.html	/^<a name="l00284"><\/a>00284                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not listen on internal socket: %s"<\/span>, strerror(errno));$/;"	a
l00285	doc/html/wdctl__thread_8c-source.html	/^<a name="l00285"><\/a>00285                 <span class="keywordflow">return<\/span>;$/;"	a
l00286	doc/html/wdctl__thread_8c-source.html	/^<a name="l00286"><\/a>00286         }$/;"	a
l00287	doc/html/wdctl__thread_8c-source.html	/^<a name="l00287"><\/a>00287         $/;"	a
l00288	doc/html/wdctl__thread_8c-source.html	/^<a name="l00288"><\/a>00288         <span class="comment">\/*<\/span>$/;"	a
l00289	doc/html/wdctl__thread_8c-source.html	/^<a name="l00289"><\/a>00289 <span class="comment">         * The internal socket is ready, fork and exec ourselves<\/span>$/;"	a
l00290	doc/html/wdctl__thread_8c-source.html	/^<a name="l00290"><\/a>00290 <span class="comment">         *\/<\/span>$/;"	a
l00291	doc/html/wdctl__thread_8c-source.html	/^<a name="l00291"><\/a>00291         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Forking in preparation for exec()..."<\/span>);$/;"	a
l00292	doc/html/wdctl__thread_8c-source.html	/^<a name="l00292"><\/a>00292         pid = safe_fork();$/;"	a
l00293	doc/html/wdctl__thread_8c-source.html	/^<a name="l00293"><\/a>00293         <span class="keywordflow">if<\/span> (pid &gt; 0) {$/;"	a
l00294	doc/html/wdctl__thread_8c-source.html	/^<a name="l00294"><\/a>00294                 <span class="comment">\/* Parent *\/<\/span>$/;"	a
l00295	doc/html/wdctl__thread_8c-source.html	/^<a name="l00295"><\/a>00295 $/;"	a
l00296	doc/html/wdctl__thread_8c-source.html	/^<a name="l00296"><\/a>00296                 <span class="comment">\/* Wait for the child to connect to our socket :*\/<\/span>$/;"	a
l00297	doc/html/wdctl__thread_8c-source.html	/^<a name="l00297"><\/a>00297                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Waiting for child to connect on internal socket"<\/span>);$/;"	a
l00298	doc/html/wdctl__thread_8c-source.html	/^<a name="l00298"><\/a>00298                 len = <span class="keyword">sizeof<\/span>(sa_un);$/;"	a
l00299	doc/html/wdctl__thread_8c-source.html	/^<a name="l00299"><\/a>00299                 <span class="keywordflow">if<\/span> ((fd = accept(sock, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, &amp;len)) == -1){$/;"	a
l00300	doc/html/wdctl__thread_8c-source.html	/^<a name="l00300"><\/a>00300                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Accept failed on internal socket: %s"<\/span>, strerror(errno));$/;"	a
l00301	doc/html/wdctl__thread_8c-source.html	/^<a name="l00301"><\/a>00301                         close(sock);$/;"	a
l00302	doc/html/wdctl__thread_8c-source.html	/^<a name="l00302"><\/a>00302                         <span class="keywordflow">return<\/span>;$/;"	a
l00303	doc/html/wdctl__thread_8c-source.html	/^<a name="l00303"><\/a>00303                 }$/;"	a
l00304	doc/html/wdctl__thread_8c-source.html	/^<a name="l00304"><\/a>00304 $/;"	a
l00305	doc/html/wdctl__thread_8c-source.html	/^<a name="l00305"><\/a>00305                 close(sock);$/;"	a
l00306	doc/html/wdctl__thread_8c-source.html	/^<a name="l00306"><\/a>00306 $/;"	a
l00307	doc/html/wdctl__thread_8c-source.html	/^<a name="l00307"><\/a>00307                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Received connection from child.  Sending them all existing clients"<\/span>);$/;"	a
l00308	doc/html/wdctl__thread_8c-source.html	/^<a name="l00308"><\/a>00308 $/;"	a
l00309	doc/html/wdctl__thread_8c-source.html	/^<a name="l00309"><\/a>00309                 <span class="comment">\/* The child is connected. Send them over the socket the existing clients *\/<\/span>$/;"	a
l00310	doc/html/wdctl__thread_8c-source.html	/^<a name="l00310"><\/a>00310                 LOCK_CLIENT_LIST();$/;"	a
l00311	doc/html/wdctl__thread_8c-source.html	/^<a name="l00311"><\/a>00311                 client = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>();$/;"	a
l00312	doc/html/wdctl__thread_8c-source.html	/^<a name="l00312"><\/a>00312                 <span class="keywordflow">while<\/span> (client) {$/;"	a
l00313	doc/html/wdctl__thread_8c-source.html	/^<a name="l00313"><\/a>00313                         <span class="comment">\/* Send this client *\/<\/span>$/;"	a
l00314	doc/html/wdctl__thread_8c-source.html	/^<a name="l00314"><\/a>00314                         safe_asprintf(&amp;tempstring, <span class="stringliteral">"CLIENT|ip=%s|mac=%s|token=%s|fw_connection_state=%u|fd=%d|counters_incoming=%llu|counters_outgoing=%llu|counters_last_updated=%lu\\n"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>, client-&gt;<a class="code" href="struct__t__client.html#495baef8f1dc90c94c24561ebd61140d" title="Client HTTP socket (valid only during login before one of the _http_* function is...">fd<\/a>, client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>, client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>, client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>);$/;"	a
l00315	doc/html/wdctl__thread_8c-source.html	/^<a name="l00315"><\/a>00315                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Sending to child client data: %s"<\/span>, tempstring);$/;"	a
l00316	doc/html/wdctl__thread_8c-source.html	/^<a name="l00316"><\/a>00316                         len = 0;$/;"	a
l00317	doc/html/wdctl__thread_8c-source.html	/^<a name="l00317"><\/a>00317                         <span class="keywordflow">while<\/span> (len != strlen(tempstring)) {$/;"	a
l00318	doc/html/wdctl__thread_8c-source.html	/^<a name="l00318"><\/a>00318                                 written = write(fd, (tempstring + len), strlen(tempstring) - len);$/;"	a
l00319	doc/html/wdctl__thread_8c-source.html	/^<a name="l00319"><\/a>00319                                 <span class="keywordflow">if<\/span> (written == -1) {$/;"	a
l00320	doc/html/wdctl__thread_8c-source.html	/^<a name="l00320"><\/a>00320                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Failed to write client data to child: %s"<\/span>, strerror(errno));$/;"	a
l00321	doc/html/wdctl__thread_8c-source.html	/^<a name="l00321"><\/a>00321                                         free(tempstring);$/;"	a
l00322	doc/html/wdctl__thread_8c-source.html	/^<a name="l00322"><\/a>00322                                         <span class="keywordflow">break<\/span>;$/;"	a
l00323	doc/html/wdctl__thread_8c-source.html	/^<a name="l00323"><\/a>00323                                 }$/;"	a
l00324	doc/html/wdctl__thread_8c-source.html	/^<a name="l00324"><\/a>00324                                 <span class="keywordflow">else<\/span> {$/;"	a
l00325	doc/html/wdctl__thread_8c-source.html	/^<a name="l00325"><\/a>00325                                         len += written;$/;"	a
l00326	doc/html/wdctl__thread_8c-source.html	/^<a name="l00326"><\/a>00326                                 }$/;"	a
l00327	doc/html/wdctl__thread_8c-source.html	/^<a name="l00327"><\/a>00327                         }$/;"	a
l00328	doc/html/wdctl__thread_8c-source.html	/^<a name="l00328"><\/a>00328                         free(tempstring);$/;"	a
l00329	doc/html/wdctl__thread_8c-source.html	/^<a name="l00329"><\/a>00329                         client = client-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00330	doc/html/wdctl__thread_8c-source.html	/^<a name="l00330"><\/a>00330                 }$/;"	a
l00331	doc/html/wdctl__thread_8c-source.html	/^<a name="l00331"><\/a>00331                 UNLOCK_CLIENT_LIST();$/;"	a
l00332	doc/html/wdctl__thread_8c-source.html	/^<a name="l00332"><\/a>00332 $/;"	a
l00333	doc/html/wdctl__thread_8c-source.html	/^<a name="l00333"><\/a>00333                 close(fd);$/;"	a
l00334	doc/html/wdctl__thread_8c-source.html	/^<a name="l00334"><\/a>00334 $/;"	a
l00335	doc/html/wdctl__thread_8c-source.html	/^<a name="l00335"><\/a>00335                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Sent all existing clients to child.  Committing suicide!"<\/span>);$/;"	a
l00336	doc/html/wdctl__thread_8c-source.html	/^<a name="l00336"><\/a>00336 $/;"	a
l00337	doc/html/wdctl__thread_8c-source.html	/^<a name="l00337"><\/a>00337                 shutdown(afd, 2);$/;"	a
l00338	doc/html/wdctl__thread_8c-source.html	/^<a name="l00338"><\/a>00338                 close(afd);$/;"	a
l00339	doc/html/wdctl__thread_8c-source.html	/^<a name="l00339"><\/a>00339 $/;"	a
l00340	doc/html/wdctl__thread_8c-source.html	/^<a name="l00340"><\/a>00340                 <span class="comment">\/* Our job in life is done. Commit suicide! *\/<\/span>$/;"	a
l00341	doc/html/wdctl__thread_8c-source.html	/^<a name="l00341"><\/a>00341                 <a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">wdctl_stop<\/a>(afd);$/;"	a
l00342	doc/html/wdctl__thread_8c-source.html	/^<a name="l00342"><\/a>00342         }$/;"	a
l00343	doc/html/wdctl__thread_8c-source.html	/^<a name="l00343"><\/a>00343         <span class="keywordflow">else<\/span> {$/;"	a
l00344	doc/html/wdctl__thread_8c-source.html	/^<a name="l00344"><\/a>00344                 <span class="comment">\/* Child *\/<\/span>$/;"	a
l00345	doc/html/wdctl__thread_8c-source.html	/^<a name="l00345"><\/a>00345                 close(wdctl_socket_server);$/;"	a
l00346	doc/html/wdctl__thread_8c-source.html	/^<a name="l00346"><\/a>00346                 close(icmp_fd);$/;"	a
l00347	doc/html/wdctl__thread_8c-source.html	/^<a name="l00347"><\/a>00347                 close(sock);$/;"	a
l00348	doc/html/wdctl__thread_8c-source.html	/^<a name="l00348"><\/a>00348                 shutdown(afd, 2);$/;"	a
l00349	doc/html/wdctl__thread_8c-source.html	/^<a name="l00349"><\/a>00349                 close(afd);$/;"	a
l00350	doc/html/wdctl__thread_8c-source.html	/^<a name="l00350"><\/a>00350                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Re-executing myself (%s)"<\/span>, restartargv[0]);$/;"	a
l00351	doc/html/wdctl__thread_8c-source.html	/^<a name="l00351"><\/a>00351                 setsid();$/;"	a
l00352	doc/html/wdctl__thread_8c-source.html	/^<a name="l00352"><\/a>00352                 execvp(restartargv[0], restartargv);$/;"	a
l00353	doc/html/wdctl__thread_8c-source.html	/^<a name="l00353"><\/a>00353                 <span class="comment">\/* If we've reached here the exec() failed - die quickly and silently *\/<\/span>$/;"	a
l00354	doc/html/wdctl__thread_8c-source.html	/^<a name="l00354"><\/a>00354                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"I failed to re-execute myself: %s"<\/span>, strerror(errno));$/;"	a
l00355	doc/html/wdctl__thread_8c-source.html	/^<a name="l00355"><\/a>00355                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Exiting without cleanup"<\/span>);$/;"	a
l00356	doc/html/wdctl__thread_8c-source.html	/^<a name="l00356"><\/a>00356                 exit(1);$/;"	a
l00357	doc/html/wdctl__thread_8c-source.html	/^<a name="l00357"><\/a>00357         }$/;"	a
l00358	doc/html/wdctl__thread_8c-source.html	/^<a name="l00358"><\/a>00358 $/;"	a
l00359	doc/html/wdctl__thread_8c-source.html	/^<a name="l00359"><\/a>00359 }$/;"	a
l00360	doc/html/wdctl__thread_8c-source.html	/^<a name="l00360"><\/a>00360 $/;"	a
l00361	doc/html/wdctl__thread_8c-source.html	/^<a name="l00361"><\/a>00361 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00362	doc/html/wdctl__thread_8c-source.html	/^<a name="l00362"><\/a>00362 wdctl_reset(<span class="keywordtype">int<\/span> fd, <span class="keywordtype">char<\/span> *arg)$/;"	a
l00363	doc/html/wdctl__thread_8c-source.html	/^<a name="l00363"><\/a>00363 {$/;"	a
l00364	doc/html/wdctl__thread_8c-source.html	/^<a name="l00364"><\/a>00364         <a class="code" href="struct__t__client.html">t_client<\/a>        *node;$/;"	a
l00365	doc/html/wdctl__thread_8c-source.html	/^<a name="l00365"><\/a>00365 $/;"	a
l00366	doc/html/wdctl__thread_8c-source.html	/^<a name="l00366"><\/a>00366         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Entering wdctl_reset..."<\/span>);$/;"	a
l00367	doc/html/wdctl__thread_8c-source.html	/^<a name="l00367"><\/a>00367         $/;"	a
l00368	doc/html/wdctl__thread_8c-source.html	/^<a name="l00368"><\/a>00368         LOCK_CLIENT_LIST();$/;"	a
l00369	doc/html/wdctl__thread_8c-source.html	/^<a name="l00369"><\/a>00369         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Argument: %s (@%x)"<\/span>, arg, arg);$/;"	a
l00370	doc/html/wdctl__thread_8c-source.html	/^<a name="l00370"><\/a>00370         $/;"	a
l00371	doc/html/wdctl__thread_8c-source.html	/^<a name="l00371"><\/a>00371         <span class="comment">\/* We get the node or return... *\/<\/span>$/;"	a
l00372	doc/html/wdctl__thread_8c-source.html	/^<a name="l00372"><\/a>00372         <span class="keywordflow">if<\/span> ((node = <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(arg)) != NULL);$/;"	a
l00373	doc/html/wdctl__thread_8c-source.html	/^<a name="l00373"><\/a>00373         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((node = <a class="code" href="client__list_8c.html#5d741b8940ddeaa92f3b17c7fd1dab7b" title="Finds a client only by its Mac.">client_list_find_by_mac<\/a>(arg)) != NULL);$/;"	a
l00374	doc/html/wdctl__thread_8c-source.html	/^<a name="l00374"><\/a>00374         <span class="keywordflow">else<\/span> {$/;"	a
l00375	doc/html/wdctl__thread_8c-source.html	/^<a name="l00375"><\/a>00375                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Client not found."<\/span>);$/;"	a
l00376	doc/html/wdctl__thread_8c-source.html	/^<a name="l00376"><\/a>00376                 UNLOCK_CLIENT_LIST();$/;"	a
l00377	doc/html/wdctl__thread_8c-source.html	/^<a name="l00377"><\/a>00377                 write(fd, <span class="stringliteral">"No"<\/span>, 2);$/;"	a
l00378	doc/html/wdctl__thread_8c-source.html	/^<a name="l00378"><\/a>00378                 <span class="keywordflow">return<\/span>;$/;"	a
l00379	doc/html/wdctl__thread_8c-source.html	/^<a name="l00379"><\/a>00379         }$/;"	a
l00380	doc/html/wdctl__thread_8c-source.html	/^<a name="l00380"><\/a>00380 $/;"	a
l00381	doc/html/wdctl__thread_8c-source.html	/^<a name="l00381"><\/a>00381         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Got node %x."<\/span>, node);$/;"	a
l00382	doc/html/wdctl__thread_8c-source.html	/^<a name="l00382"><\/a>00382         $/;"	a
l00383	doc/html/wdctl__thread_8c-source.html	/^<a name="l00383"><\/a>00383         <span class="comment">\/* deny.... *\/<\/span>$/;"	a
l00384	doc/html/wdctl__thread_8c-source.html	/^<a name="l00384"><\/a>00384         <span class="comment">\/* TODO: maybe just deleting the connection is not best... But this<\/span>$/;"	a
l00385	doc/html/wdctl__thread_8c-source.html	/^<a name="l00385"><\/a>00385 <span class="comment">         * is a manual command, I don't anticipate it'll be that useful. *\/<\/span>$/;"	a
l00386	doc/html/wdctl__thread_8c-source.html	/^<a name="l00386"><\/a>00386         fw_deny(node-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, node-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, node-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00387	doc/html/wdctl__thread_8c-source.html	/^<a name="l00387"><\/a>00387         <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(node);$/;"	a
l00388	doc/html/wdctl__thread_8c-source.html	/^<a name="l00388"><\/a>00388         $/;"	a
l00389	doc/html/wdctl__thread_8c-source.html	/^<a name="l00389"><\/a>00389         UNLOCK_CLIENT_LIST();$/;"	a
l00390	doc/html/wdctl__thread_8c-source.html	/^<a name="l00390"><\/a>00390         $/;"	a
l00391	doc/html/wdctl__thread_8c-source.html	/^<a name="l00391"><\/a>00391         write(fd, <span class="stringliteral">"Yes"<\/span>, 3);$/;"	a
l00392	doc/html/wdctl__thread_8c-source.html	/^<a name="l00392"><\/a>00392         $/;"	a
l00393	doc/html/wdctl__thread_8c-source.html	/^<a name="l00393"><\/a>00393         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Exiting wdctl_reset..."<\/span>);$/;"	a
l00394	doc/html/wdctl__thread_8c-source.html	/^<a name="l00394"><\/a>00394 }$/;"	a
30059693a490a3b23934af7540fd73b2	doc/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="30059693a490a3b23934af7540fd73b2"><\/a><!-- doxytag: member="wdctl_thread.c::wdctl_status" ref="30059693a490a3b23934af7540fd73b2" args="(int)" -->$/;"	a
3c52dcc44643589b9f1039b576518dea	doc/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3c52dcc44643589b9f1039b576518dea"><\/a><!-- doxytag: member="wdctl_thread.c::restartargv" ref="3c52dcc44643589b9f1039b576518dea" args="" -->$/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	doc/html/wdctl__thread_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="wdctl_thread.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
620bac3ec925a104631e817432f8a04e	doc/html/wdctl__thread_8c.html	/^<a class="anchor" name="620bac3ec925a104631e817432f8a04e"><\/a><!-- doxytag: member="wdctl_thread.c::thread_wdctl" ref="620bac3ec925a104631e817432f8a04e" args="(void *arg)" -->$/;"	a
70c21ac1616554eacec70c64265dee7a	doc/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="70c21ac1616554eacec70c64265dee7a"><\/a><!-- doxytag: member="wdctl_thread.c::thread_wdctl_handler" ref="70c21ac1616554eacec70c64265dee7a" args="(void *)" -->$/;"	a
_details	doc/html/wdctl__thread_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b374ff230d9977e6b952612d61689f39	doc/html/wdctl__thread_8c.html	/^<a class="anchor" name="b374ff230d9977e6b952612d61689f39"><\/a><!-- doxytag: member="wdctl_thread.c::config_mutex" ref="b374ff230d9977e6b952612d61689f39" args="" -->$/;"	a
d9c67702f9c5c9eb3777aa371b6c6843	doc/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d9c67702f9c5c9eb3777aa371b6c6843"><\/a><!-- doxytag: member="wdctl_thread.c::wdctl_reset" ref="d9c67702f9c5c9eb3777aa371b6c6843" args="(int, char *)" -->$/;"	a
e95b8ccbd6c9d361d465a1619ab16733	doc/html/wdctl__thread_8c.html	/^<a class="anchor" name="e95b8ccbd6c9d361d465a1619ab16733"><\/a><!-- doxytag: member="wdctl_thread.c::wdctl_stop" ref="e95b8ccbd6c9d361d465a1619ab16733" args="(int)" -->$/;"	a
ebc06723bffbc74d76c0444d51405fad	doc/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ebc06723bffbc74d76c0444d51405fad"><\/a><!-- doxytag: member="wdctl_thread.c::wdctl_restart" ref="ebc06723bffbc74d76c0444d51405fad" args="(int)" -->$/;"	a
l00001	doc/html/wdctl__thread_8h-source.html	/^<h1>wdctl_thread.h<\/h1><a href="wdctl__thread_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	doc/html/wdctl__thread_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	doc/html/wdctl__thread_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	doc/html/wdctl__thread_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	doc/html/wdctl__thread_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	doc/html/wdctl__thread_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	doc/html/wdctl__thread_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	doc/html/wdctl__thread_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	doc/html/wdctl__thread_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	doc/html/wdctl__thread_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	doc/html/wdctl__thread_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	doc/html/wdctl__thread_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	doc/html/wdctl__thread_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	doc/html/wdctl__thread_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	doc/html/wdctl__thread_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	doc/html/wdctl__thread_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	doc/html/wdctl__thread_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	doc/html/wdctl__thread_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	doc/html/wdctl__thread_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	doc/html/wdctl__thread_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	doc/html/wdctl__thread_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: wdctl_thread.h 1241 2007-06-24 04:13:13Z benoitg $ *\/<\/span>$/;"	a
l00027	doc/html/wdctl__thread_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _WDCTL_THREAD_H_<\/span>$/;"	a
l00028	doc/html/wdctl__thread_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _WDCTL_THREAD_H_<\/span>$/;"	a
l00029	doc/html/wdctl__thread_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	doc/html/wdctl__thread_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define DEFAULT_WDCTL_SOCK      "\/tmp\/wdctl.sock"<\/span>$/;"	a
l00031	doc/html/wdctl__thread_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor"><\/span>$/;"	a
l00032	doc/html/wdctl__thread_8h-source.html	/^<a name="l00032"><\/a>00032 <span class="keywordtype">int<\/span> wdctl_socket_server;$/;"	a
l00033	doc/html/wdctl__thread_8h-source.html	/^<a name="l00033"><\/a>00033 $/;"	a
l00035	doc/html/wdctl__thread_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="keywordtype">void<\/span> <a class="code" href="wdctl__thread_8c.html#620bac3ec925a104631e817432f8a04e" title="Listen for WiFiDog control messages on a unix domain socket.">thread_wdctl<\/a>(<span class="keywordtype">void<\/span> *arg);$/;"	a
l00036	doc/html/wdctl__thread_8h-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	doc/html/wdctl__thread_8h-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#endif<\/span>$/;"	a
620bac3ec925a104631e817432f8a04e	doc/html/wdctl__thread_8h.html	/^<a class="anchor" name="620bac3ec925a104631e817432f8a04e"><\/a><!-- doxytag: member="wdctl_thread.h::thread_wdctl" ref="620bac3ec925a104631e817432f8a04e" args="(void *arg)" -->$/;"	a
857429d3a578c49322a70e6dfd833bf2	doc/html/wdctl__thread_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="857429d3a578c49322a70e6dfd833bf2"><\/a><!-- doxytag: member="wdctl_thread.h::wdctl_socket_server" ref="857429d3a578c49322a70e6dfd833bf2" args="" -->$/;"	a
_details	doc/html/wdctl__thread_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
cee7c0173f525e29800b87222b407386	doc/html/wdctl__thread_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cee7c0173f525e29800b87222b407386"><\/a><!-- doxytag: member="wdctl_thread.h::DEFAULT_WDCTL_SOCK" ref="cee7c0173f525e29800b87222b407386" args="" -->$/;"	a
!_TAG_PROGRAM_URL	http://ctags.sourceforge.net	/official site/
HTTP_ACL_DENY	install/include/wifidog/httpd.h	91;"	d
HTTP_ACL_PERMIT	install/include/wifidog/httpd.h	90;"	d
HTTP_ANY_ADDR	install/include/wifidog/httpd.h	68;"	d
HTTP_C_FUNCT	install/include/wifidog/httpd.h	77;"	d
HTTP_C_WILDCARD	install/include/wifidog/httpd.h	81;"	d
HTTP_EMBER_FUNCT	install/include/wifidog/httpd.h	78;"	d
HTTP_FALSE	install/include/wifidog/httpd.h	74;"	d
HTTP_FILE	install/include/wifidog/httpd.h	76;"	d
HTTP_GET	install/include/wifidog/httpd.h	70;"	d
HTTP_IP_ADDR_LEN	install/include/wifidog/httpd.h	65;"	d
HTTP_MAX_AUTH	install/include/wifidog/httpd.h	64;"	d
HTTP_MAX_HEADERS	install/include/wifidog/httpd.h	63;"	d
HTTP_MAX_LEN	install/include/wifidog/httpd.h	61;"	d
HTTP_MAX_URL	install/include/wifidog/httpd.h	62;"	d
HTTP_METHOD_ERROR	install/include/wifidog/httpd.h	83;"	d
HTTP_PORT	install/include/wifidog/httpd.h	60;"	d
HTTP_POST	install/include/wifidog/httpd.h	71;"	d
HTTP_READ_BUF_LEN	install/include/wifidog/httpd.h	67;"	d
HTTP_STATIC	install/include/wifidog/httpd.h	79;"	d
HTTP_TIME_STRING_LEN	install/include/wifidog/httpd.h	66;"	d
HTTP_TRUE	install/include/wifidog/httpd.h	73;"	d
HTTP_WILDCARD	install/include/wifidog/httpd.h	80;"	d
LIB_HTTPD_H	install/include/wifidog/httpd.h	33;"	d
__ANSI_PROTO	install/include/wifidog/httpd.h	39;"	d
__ANSI_PROTO	install/include/wifidog/httpd.h	41;"	d
_httpd_404	install/include/wifidog/httpd.h	/^typedef struct _httpd_404 {$/;"	s
_httpd_content	install/include/wifidog/httpd.h	/^typedef struct _httpd_content{$/;"	s
_httpd_dir	install/include/wifidog/httpd.h	/^typedef struct _httpd_dir{$/;"	s
_httpd_var	install/include/wifidog/httpd.h	/^typedef struct _httpd_var{$/;"	s
accessLog	install/include/wifidog/httpd.h	/^	FILE	*accessLog,$/;"	m	struct:__anon7
action	install/include/wifidog/httpd.h	/^                action;$/;"	m	struct:ip_acl_s
addr	install/include/wifidog/httpd.h	/^        int     addr;$/;"	m	struct:ip_acl_s
authLength	install/include/wifidog/httpd.h	/^		authLength;$/;"	m	struct:__anon5
authPassword	install/include/wifidog/httpd.h	/^	char	authPassword[HTTP_MAX_AUTH];$/;"	m	struct:__anon5
authUser	install/include/wifidog/httpd.h	/^	char	authUser[HTTP_MAX_AUTH];$/;"	m	struct:__anon5
children	install/include/wifidog/httpd.h	/^	struct	_httpd_dir *children,$/;"	m	struct:_httpd_dir	typeref:struct:_httpd_dir::_httpd_dir
clientAddr	install/include/wifidog/httpd.h	/^		clientAddr[HTTP_IP_ADDR_LEN];$/;"	m	struct:__anon8
clientSock	install/include/wifidog/httpd.h	/^	int	clientSock,$/;"	m	struct:__anon8
content	install/include/wifidog/httpd.h	/^	httpContent	*content;$/;"	m	struct:__anon6
content	install/include/wifidog/httpd.h	/^	httpDir	*content;$/;"	m	struct:__anon7
contentLength	install/include/wifidog/httpd.h	/^		contentLength,$/;"	m	struct:__anon5
contentType	install/include/wifidog/httpd.h	/^			contentType[HTTP_MAX_URL];$/;"	m	struct:__anon6
contentType	install/include/wifidog/httpd.h	/^		contentType[HTTP_MAX_URL],$/;"	m	struct:__anon5
data	install/include/wifidog/httpd.h	/^	char	*data,$/;"	m	struct:_httpd_content
defaultAcl	install/include/wifidog/httpd.h	/^	httpAcl	*defaultAcl;$/;"	m	struct:__anon7
entries	install/include/wifidog/httpd.h	/^	struct	_httpd_content *entries;$/;"	m	struct:_httpd_dir	typeref:struct:_httpd_dir::_httpd_content
errorLog	install/include/wifidog/httpd.h	/^		*errorLog;$/;"	m	struct:__anon7
fileBasePath	install/include/wifidog/httpd.h	/^	char	fileBasePath[HTTP_MAX_URL],$/;"	m	struct:__anon7
function	install/include/wifidog/httpd.h	/^	void	(*function)();$/;"	m	struct:_httpd_404
function	install/include/wifidog/httpd.h	/^	void	(*function)();$/;"	m	struct:_httpd_content
handle404	install/include/wifidog/httpd.h	/^	http404  *handle404;$/;"	m	struct:__anon7
headers	install/include/wifidog/httpd.h	/^			headers[HTTP_MAX_HEADERS],$/;"	m	struct:__anon6
headersSent	install/include/wifidog/httpd.h	/^	char		headersSent,$/;"	m	struct:__anon6
host	install/include/wifidog/httpd.h	/^		*host;$/;"	m	struct:__anon7
host	install/include/wifidog/httpd.h	/^	        host[HTTP_MAX_URL], \/* acv@acv.ca\/wifidog: Added decoding$/;"	m	struct:__anon5
http404	install/include/wifidog/httpd.h	/^} http404;$/;"	t	typeref:struct:_httpd_404
httpAcl	install/include/wifidog/httpd.h	/^} httpAcl;$/;"	t	typeref:struct:ip_acl_s
httpContent	install/include/wifidog/httpd.h	/^} httpContent;$/;"	t	typeref:struct:_httpd_content
httpDir	install/include/wifidog/httpd.h	/^} httpDir;$/;"	t	typeref:struct:_httpd_dir
httpReq	install/include/wifidog/httpd.h	/^} httpReq;$/;"	t	typeref:struct:__anon5
httpRes	install/include/wifidog/httpd.h	/^} httpRes;$/;"	t	typeref:struct:__anon6
httpVar	install/include/wifidog/httpd.h	/^} httpVar;$/;"	t	typeref:struct:_httpd_var
httpd	install/include/wifidog/httpd.h	/^} httpd;$/;"	t	typeref:struct:__anon7
httpdRequestContentLength	install/include/wifidog/httpd.h	88;"	d
httpdRequestContentType	install/include/wifidog/httpd.h	87;"	d
httpdRequestMethod	install/include/wifidog/httpd.h	85;"	d
httpdRequestPath	install/include/wifidog/httpd.h	86;"	d
ifModified	install/include/wifidog/httpd.h	/^	        ifModified[HTTP_MAX_URL];$/;"	m	struct:__anon5
indexFlag	install/include/wifidog/httpd.h	/^		indexFlag;$/;"	m	struct:_httpd_content
ip_acl_s	install/include/wifidog/httpd.h	/^typedef struct ip_acl_s{$/;"	s
lastError	install/include/wifidog/httpd.h	/^		lastError;$/;"	m	struct:__anon7
len	install/include/wifidog/httpd.h	/^        char    len,$/;"	m	struct:ip_acl_s
method	install/include/wifidog/httpd.h	/^	int	method,$/;"	m	struct:__anon5
name	install/include/wifidog/httpd.h	/^	char	*name,$/;"	m	struct:_httpd_var
name	install/include/wifidog/httpd.h	/^	char	*name;$/;"	m	struct:_httpd_content
name	install/include/wifidog/httpd.h	/^	char	*name;$/;"	m	struct:_httpd_dir
next	install/include/wifidog/httpd.h	/^			*next;$/;"	m	struct:_httpd_dir	typeref:struct:_httpd_dir::
next	install/include/wifidog/httpd.h	/^	struct	_httpd_content 	*next;$/;"	m	struct:_httpd_content	typeref:struct:_httpd_content::_httpd_content
next	install/include/wifidog/httpd.h	/^        struct  ip_acl_s *next;$/;"	m	struct:ip_acl_s	typeref:struct:ip_acl_s::ip_acl_s
nextValue	install/include/wifidog/httpd.h	/^	struct	_httpd_var 	*nextValue,$/;"	m	struct:_httpd_var	typeref:struct:_httpd_var::_httpd_var
nextVariable	install/include/wifidog/httpd.h	/^				*nextVariable;$/;"	m	struct:_httpd_var	typeref:struct:_httpd_var::
path	install/include/wifidog/httpd.h	/^		*path;$/;"	m	struct:_httpd_content
path	install/include/wifidog/httpd.h	/^	char	path[HTTP_MAX_URL],$/;"	m	struct:__anon5
port	install/include/wifidog/httpd.h	/^	int	port,$/;"	m	struct:__anon7
preload	install/include/wifidog/httpd.h	/^	int	(*preload)();$/;"	m	struct:_httpd_content
query	install/include/wifidog/httpd.h	/^		query[HTTP_MAX_URL],$/;"	m	struct:__anon5
readBuf	install/include/wifidog/httpd.h	/^	char	readBuf[HTTP_READ_BUF_LEN + 1],$/;"	m	struct:__anon8
readBufPtr	install/include/wifidog/httpd.h	/^		*readBufPtr,$/;"	m	struct:__anon8
readBufRemain	install/include/wifidog/httpd.h	/^		readBufRemain;$/;"	m	struct:__anon8
referer	install/include/wifidog/httpd.h	/^		referer[HTTP_MAX_URL],$/;"	m	struct:__anon5
request	install/include/wifidog/httpd.h	/^	httpReq	request;$/;"	m	struct:__anon8
request	install/include/wifidog/httpd.h	/^} request;$/;"	t	typeref:struct:__anon8
response	install/include/wifidog/httpd.h	/^			response[HTTP_MAX_URL],$/;"	m	struct:__anon6
response	install/include/wifidog/httpd.h	/^	httpRes response;$/;"	m	struct:__anon8
responseLength	install/include/wifidog/httpd.h	/^	int		responseLength;$/;"	m	struct:__anon6
serverSock	install/include/wifidog/httpd.h	/^		serverSock,$/;"	m	struct:__anon7
startTime	install/include/wifidog/httpd.h	/^		startTime,$/;"	m	struct:__anon7
type	install/include/wifidog/httpd.h	/^	int	type,$/;"	m	struct:_httpd_content
userAgent	install/include/wifidog/httpd.h	/^		userAgent[HTTP_MAX_URL],$/;"	m	struct:__anon5
value	install/include/wifidog/httpd.h	/^		*value;$/;"	m	struct:_httpd_var
variables	install/include/wifidog/httpd.h	/^	httpVar	*variables;$/;"	m	struct:__anon8
l00001	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<h1>auth.c<\/h1><a href="auth_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: auth.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00038"><\/a>00038 $/;"	a
l00039	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include "<a class="code" href="http_8h.html" title="HTTP IO functions.">http.h<\/a>"<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="fw__iptables_8h.html" title="Firewall iptables functions.">fw_iptables.h<\/a>"<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00050"><\/a>00050 $/;"	a
l00051	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="comment">\/* Defined in clientlist.c *\/<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00053	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00053"><\/a>00053 $/;"	a
l00054	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="comment">\/* Defined in util.c *\/<\/span>$/;"	a
l00055	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="keyword">extern<\/span> <span class="keywordtype">long<\/span> served_this_session;$/;"	a
l00056	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00056"><\/a>00056 $/;"	a
l00062	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00062"><\/a>00062 <span class="keywordtype">void<\/span>$/;"	a
l00063	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00063"><\/a><a class="code" href="auth_8h.html#0d343be361ec134828fe457a4d4b94e7">00063<\/a> <a class="code" href="auth_8c.html#0d343be361ec134828fe457a4d4b94e7" title="Periodically check if connections expired.">thread_client_timeout_check<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">void<\/span> *arg)$/;"	a
l00064	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00064"><\/a>00064 {$/;"	a
l00065	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00065"><\/a>00065         pthread_cond_t          cond = PTHREAD_COND_INITIALIZER;$/;"	a
l00066	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00066"><\/a>00066         pthread_mutex_t         cond_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00067	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00067"><\/a>00067         <span class="keyword">struct  <\/span>timespec        timeout;$/;"	a
l00068	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00068"><\/a>00068         $/;"	a
l00069	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00069"><\/a>00069         <span class="keywordflow">while<\/span> (1) {$/;"	a
l00070	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00070"><\/a>00070                 <span class="comment">\/* Sleep for config.checkinterval seconds... *\/<\/span>$/;"	a
l00071	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00071"><\/a>00071                 timeout.tv_sec = time(NULL) + <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a>;$/;"	a
l00072	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00072"><\/a>00072                 timeout.tv_nsec = 0;$/;"	a
l00073	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00073"><\/a>00073 $/;"	a
l00074	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00074"><\/a>00074                 <span class="comment">\/* Mutex must be locked for pthread_cond_timedwait... *\/<\/span>$/;"	a
l00075	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00075"><\/a>00075                 pthread_mutex_lock(&amp;cond_mutex);$/;"	a
l00076	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00076"><\/a>00076                 $/;"	a
l00077	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00077"><\/a>00077                 <span class="comment">\/* Thread safe "sleep" *\/<\/span>$/;"	a
l00078	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00078"><\/a>00078                 pthread_cond_timedwait(&amp;cond, &amp;cond_mutex, &amp;timeout);$/;"	a
l00079	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00079"><\/a>00079 $/;"	a
l00080	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00080"><\/a>00080                 <span class="comment">\/* No longer needs to be locked *\/<\/span>$/;"	a
l00081	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00081"><\/a>00081                 pthread_mutex_unlock(&amp;cond_mutex);$/;"	a
l00082	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00082"><\/a>00082         $/;"	a
l00083	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00083"><\/a>00083                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Running fw_counter()"<\/span>);$/;"	a
l00084	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00084"><\/a>00084         $/;"	a
l00085	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00085"><\/a>00085                 fw_sync_with_authserver();$/;"	a
l00086	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00086"><\/a>00086         }$/;"	a
l00087	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00087"><\/a>00087 }$/;"	a
l00088	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00088"><\/a>00088 $/;"	a
l00093	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00093"><\/a>00093 <span class="keywordtype">void<\/span>$/;"	a
l00094	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00094"><\/a><a class="code" href="auth_8h.html#99776c0fc887b87928dce05a9760ed3d">00094<\/a> <a class="code" href="auth_8c.html#88932f2cd4b44875ef888e2fc0817da5" title="Authenticate a single client against the central server.">authenticate_client<\/a>(request *r)$/;"	a
l00095	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00095"><\/a>00095 {$/;"	a
l00096	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00096"><\/a>00096         <a class="code" href="struct__t__client.html">t_client<\/a>        *client;$/;"	a
l00097	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00097"><\/a>00097         <a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a>  auth_response;$/;"	a
l00098	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00098"><\/a>00098         <span class="keywordtype">char<\/span>    *mac,$/;"	a
l00099	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00099"><\/a>00099                 *token;$/;"	a
l00100	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="keywordtype">char<\/span> *urlFragment = NULL;$/;"	a
l00101	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00101"><\/a>00101         <a class="code" href="structs__config.html">s_config<\/a>        *config = NULL;$/;"	a
l00102	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00102"><\/a>00102         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = NULL;$/;"	a
l00103	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00103"><\/a>00103 $/;"	a
l00104	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00104"><\/a>00104         LOCK_CLIENT_LIST();$/;"	a
l00105	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00105"><\/a>00105 $/;"	a
l00106	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00106"><\/a>00106         client = <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(r-&gt;clientAddr);$/;"	a
l00107	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00107"><\/a>00107 $/;"	a
l00108	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00108"><\/a>00108         <span class="keywordflow">if<\/span> (client == NULL) {$/;"	a
l00109	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00109"><\/a>00109                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not find client for %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00110	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00110"><\/a>00110                 UNLOCK_CLIENT_LIST();$/;"	a
l00111	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00111"><\/a>00111                 <span class="keywordflow">return<\/span>;$/;"	a
l00112	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00112"><\/a>00112         }$/;"	a
l00113	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00113"><\/a>00113         $/;"	a
l00114	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00114"><\/a>00114         mac = safe_strdup(client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00115	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00115"><\/a>00115         token = safe_strdup(client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00116	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00116"><\/a>00116         $/;"	a
l00117	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00117"><\/a>00117         UNLOCK_CLIENT_LIST();$/;"	a
l00118	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00118"><\/a>00118         $/;"	a
l00119	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00119"><\/a>00119         <span class="comment">\/* <\/span>$/;"	a
l00120	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00120"><\/a>00120 <span class="comment">         * At this point we've released the lock while we do an HTTP request since it could<\/span>$/;"	a
l00121	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00121"><\/a>00121 <span class="comment">         * take multiple seconds to do and the gateway would effectively be frozen if we<\/span>$/;"	a
l00122	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00122"><\/a>00122 <span class="comment">         * kept the lock.<\/span>$/;"	a
l00123	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00123"><\/a>00123 <span class="comment">         *\/<\/span>$/;"	a
l00124	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00124"><\/a>00124         <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(&amp;auth_response, <a class="code" href="centralserver_8h.html#6fc858ffaac7b85a57a262f86febf5bf" title="Ask the central server to login a client.">REQUEST_TYPE_LOGIN<\/a>, r-&gt;clientAddr, mac, token, 0, 0);$/;"	a
l00125	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00125"><\/a>00125         $/;"	a
l00126	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00126"><\/a>00126         LOCK_CLIENT_LIST();$/;"	a
l00127	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00127"><\/a>00127         $/;"	a
l00128	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00128"><\/a>00128         <span class="comment">\/* can't trust the client to still exist after n seconds have passed *\/<\/span>$/;"	a
l00129	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00129"><\/a>00129         client = <a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(r-&gt;clientAddr, mac);$/;"	a
l00130	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00130"><\/a>00130         $/;"	a
l00131	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00131"><\/a>00131         <span class="keywordflow">if<\/span> (client == NULL) {$/;"	a
l00132	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00132"><\/a>00132                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not find client node for %s (%s)"<\/span>, r-&gt;clientAddr, mac);$/;"	a
l00133	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00133"><\/a>00133                 UNLOCK_CLIENT_LIST();$/;"	a
l00134	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00134"><\/a>00134                 free(token);$/;"	a
l00135	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00135"><\/a>00135                 free(mac);$/;"	a
l00136	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00136"><\/a>00136                 <span class="keywordflow">return<\/span>;$/;"	a
l00137	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00137"><\/a>00137         }$/;"	a
l00138	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00138"><\/a>00138         $/;"	a
l00139	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00139"><\/a>00139         free(token);$/;"	a
l00140	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00140"><\/a>00140         free(mac);$/;"	a
l00141	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00141"><\/a>00141 $/;"	a
l00142	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00142"><\/a>00142         <span class="comment">\/* Prepare some variables we'll need below *\/<\/span>$/;"	a
l00143	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00143"><\/a>00143         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00144	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00144"><\/a>00144         auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00145	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00145"><\/a>00145 $/;"	a
l00146	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00146"><\/a>00146         <span class="keywordflow">switch<\/span>(auth_response.<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>) {$/;"	a
l00147	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00147"><\/a>00147 $/;"	a
l00148	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00148"><\/a>00148         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>:$/;"	a
l00149	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00149"><\/a>00149                 <span class="comment">\/* Error talking to central server *\/<\/span>$/;"	a
l00150	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00150"><\/a>00150                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Got %d from central server authenticating token %s from %s at %s"<\/span>, auth_response, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00151	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00151"><\/a>00151                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"Error!"<\/span>, <span class="stringliteral">"Error: We did not get a valid answer from the central server"<\/span>);$/;"	a
l00152	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00152"><\/a>00152                 <span class="keywordflow">break<\/span>;$/;"	a
l00153	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00153"><\/a>00153 $/;"	a
l00154	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00154"><\/a>00154         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75">AUTH_DENIED<\/a>:$/;"	a
l00155	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00155"><\/a>00155                 <span class="comment">\/* Central server said invalid token *\/<\/span>$/;"	a
l00156	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00156"><\/a>00156                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got DENIED from central server authenticating token %s from %s at %s - redirecting them to denied message"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00157	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00157"><\/a>00157                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%smessage=%s"<\/span>,$/;"	a
l00158	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00158"><\/a>00158                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>,$/;"	a
l00159	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00159"><\/a>00159                         <a class="code" href="centralserver_8h.html#becb4a093d3aaf41645172f373acb4d7" title="Sent when the user&amp;#39;s token is denied by the central server.">GATEWAY_MESSAGE_DENIED<\/a>$/;"	a
l00160	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00160"><\/a>00160                 );$/;"	a
l00161	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00161"><\/a>00161                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to denied message"<\/span>);$/;"	a
l00162	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00162"><\/a>00162                 free(urlFragment);$/;"	a
l00163	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00163"><\/a>00163                 <span class="keywordflow">break<\/span>;$/;"	a
l00164	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00164"><\/a>00164 $/;"	a
l00165	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00165"><\/a>00165     <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae">AUTH_VALIDATION<\/a>:$/;"	a
l00166	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00166"><\/a>00166                 <span class="comment">\/* They just got validated for X minutes to check their email *\/<\/span>$/;"	a
l00167	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00167"><\/a>00167                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got VALIDATION from central server authenticating token %s from %s at %s"<\/span>$/;"	a
l00168	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00168"><\/a>00168                                 <span class="stringliteral">"- adding to firewall and redirecting them to activate message"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>,$/;"	a
l00169	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00169"><\/a>00169                                 client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00170	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00170"><\/a>00170                 client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> = <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>;$/;"	a
l00171	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00171"><\/a>00171                 fw_allow(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>);$/;"	a
l00172	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00172"><\/a>00172                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%smessage=%s"<\/span>,$/;"	a
l00173	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00173"><\/a>00173                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>,$/;"	a
l00174	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00174"><\/a>00174                         <a class="code" href="centralserver_8h.html#46de6b10ed6b0269da637b1e6c96d128" title="Sent when the user&amp;#39;s token is accepted, but user is on probation.">GATEWAY_MESSAGE_ACTIVATE_ACCOUNT<\/a>$/;"	a
l00175	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00175"><\/a>00175                 );$/;"	a
l00176	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00176"><\/a>00176                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to activate message"<\/span>);$/;"	a
l00177	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00177"><\/a>00177                 free(urlFragment);$/;"	a
l00178	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00178"><\/a>00178             <span class="keywordflow">break<\/span>;$/;"	a
l00179	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00179"><\/a>00179 $/;"	a
l00180	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00180"><\/a>00180     <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926">AUTH_ALLOWED<\/a>:$/;"	a
l00181	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00181"><\/a>00181                 <span class="comment">\/* Logged in successfully as a regular account *\/<\/span>$/;"	a
l00182	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00182"><\/a>00182                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got ALLOWED from central server authenticating token %s from %s at %s - "<\/span>$/;"	a
l00183	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00183"><\/a>00183                                 <span class="stringliteral">"adding to firewall and redirecting them to portal"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00184	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00184"><\/a>00184                 client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> = <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>;$/;"	a
l00185	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00185"><\/a>00185                 fw_allow(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>);$/;"	a
l00186	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00186"><\/a>00186         served_this_session++;$/;"	a
l00187	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00187"><\/a>00187                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%sgw_id=%s"<\/span>,$/;"	a
l00188	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00188"><\/a>00188                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bcf430ab833dd65830904abf5793e1c6" title="This is the script the user will be sent to after a successfull login.">authserv_portal_script_path_fragment<\/a>,$/;"	a
l00189	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00189"><\/a>00189                         config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>$/;"	a
l00190	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00190"><\/a>00190                 );$/;"	a
l00191	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00191"><\/a>00191                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to portal"<\/span>);$/;"	a
l00192	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00192"><\/a>00192                 free(urlFragment);$/;"	a
l00193	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00193"><\/a>00193             <span class="keywordflow">break<\/span>;$/;"	a
l00194	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00194"><\/a>00194 $/;"	a
l00195	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00195"><\/a>00195     <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb">AUTH_VALIDATION_FAILED<\/a>:$/;"	a
l00196	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00196"><\/a>00196                  <span class="comment">\/* Client had X minutes to validate account by email and didn't = too late *\/<\/span>$/;"	a
l00197	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00197"><\/a>00197                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got VALIDATION_FAILED from central server authenticating token %s from %s at %s "<\/span>$/;"	a
l00198	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00198"><\/a>00198                                 <span class="stringliteral">"- redirecting them to failed_validation message"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00199	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00199"><\/a>00199                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%smessage=%s"<\/span>,$/;"	a
l00200	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00200"><\/a>00200                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>,$/;"	a
l00201	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00201"><\/a>00201                         <a class="code" href="centralserver_8h.html#1a829447172cc69e643e77a2a64eaf23" title="Sent when the user&amp;#39;s token is denied by the central server because the probation...">GATEWAY_MESSAGE_ACCOUNT_VALIDATION_FAILED<\/a>$/;"	a
l00202	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00202"><\/a>00202                 );$/;"	a
l00203	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00203"><\/a>00203                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to failed validation message"<\/span>);$/;"	a
l00204	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00204"><\/a>00204                 free(urlFragment);$/;"	a
l00205	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00205"><\/a>00205             <span class="keywordflow">break<\/span>;$/;"	a
l00206	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00206"><\/a>00206 $/;"	a
l00207	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00207"><\/a>00207     <span class="keywordflow">default<\/span>:$/;"	a
l00208	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00208"><\/a>00208                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"I don't know what the validation code %d means for token %s from %s at %s - sending error message"<\/span>, auth_response.<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00209	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00209"><\/a>00209                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"Internal Error"<\/span>, <span class="stringliteral">"We can not validate your request at this time"<\/span>);$/;"	a
l00210	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00210"><\/a>00210             <span class="keywordflow">break<\/span>;$/;"	a
l00211	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00211"><\/a>00211 $/;"	a
l00212	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00212"><\/a>00212         }$/;"	a
l00213	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00213"><\/a>00213 $/;"	a
l00214	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00214"><\/a>00214         UNLOCK_CLIENT_LIST();$/;"	a
l00215	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00215"><\/a>00215         <span class="keywordflow">return<\/span>;$/;"	a
l00216	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00216"><\/a>00216 }$/;"	a
l00217	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00217"><\/a>00217 $/;"	a
l00218	install/share/doc/wifidog-20090925/html/auth_8c-source.html	/^<a name="l00218"><\/a>00218 $/;"	a
0d343be361ec134828fe457a4d4b94e7	install/share/doc/wifidog-20090925/html/auth_8c.html	/^<a class="anchor" name="0d343be361ec134828fe457a4d4b94e7"><\/a><!-- doxytag: member="auth.c::thread_client_timeout_check" ref="0d343be361ec134828fe457a4d4b94e7" args="(const void *arg)" -->$/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	install/share/doc/wifidog-20090925/html/auth_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="auth.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
88932f2cd4b44875ef888e2fc0817da5	install/share/doc/wifidog-20090925/html/auth_8c.html	/^<a class="anchor" name="88932f2cd4b44875ef888e2fc0817da5"><\/a><!-- doxytag: member="auth.c::authenticate_client" ref="88932f2cd4b44875ef888e2fc0817da5" args="(request *r)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/auth_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
d309c457ebb918832a3f7910ba2c7b3a	install/share/doc/wifidog-20090925/html/auth_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d309c457ebb918832a3f7910ba2c7b3a"><\/a><!-- doxytag: member="auth.c::served_this_session" ref="d309c457ebb918832a3f7910ba2c7b3a" args="" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<h1>auth.h<\/h1><a href="auth_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: auth.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _AUTH_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _AUTH_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00038	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00038"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0">00038<\/a> <span class="keyword">typedef<\/span> <span class="keyword">enum<\/span> {$/;"	a
l00039	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00039"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">00039<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a> = -1, $/;"	a
l00040	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00040"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75">00040<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75">AUTH_DENIED<\/a> = 0, $/;"	a
l00041	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00041"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926">00041<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926">AUTH_ALLOWED<\/a> = 1, $/;"	a
l00042	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae">00042<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae">AUTH_VALIDATION<\/a> = 5, $/;"	a
l00043	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00043"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb">00043<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb">AUTH_VALIDATION_FAILED<\/a> = 6, $/;"	a
l00044	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00044"><\/a><a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce">00044<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce">AUTH_LOCKED<\/a> = 254 $/;"	a
l00045	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00045"><\/a>00045 } <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0" title="Authentication codes returned by auth server.">t_authcode<\/a>;$/;"	a
l00046	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00046"><\/a>00046 $/;"	a
l00050	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00050"><\/a><a class="code" href="struct__t__authresponse.html">00050<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">_t_authresponse<\/a> {$/;"	a
l00051	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00051"><\/a><a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">00051<\/a>     <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0" title="Authentication codes returned by auth server.">t_authcode<\/a> <a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>; $/;"	a
l00052	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00052"><\/a>00052 } <a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a>;$/;"	a
l00053	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00053"><\/a>00053 $/;"	a
l00054	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00056	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00056"><\/a>00056 <span class="keywordtype">void<\/span> <a class="code" href="auth_8c.html#88932f2cd4b44875ef888e2fc0817da5" title="Authenticate a single client against the central server.">authenticate_client<\/a>(request *);$/;"	a
l00057	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00059	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00059"><\/a>00059 <span class="keywordtype">void<\/span> <a class="code" href="auth_8c.html#0d343be361ec134828fe457a4d4b94e7" title="Periodically check if connections expired.">thread_client_timeout_check<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">void<\/span> *arg);$/;"	a
l00060	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00060"><\/a>00060 $/;"	a
l00061	install/share/doc/wifidog-20090925/html/auth_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="preprocessor">#endif<\/span>$/;"	a
0d343be361ec134828fe457a4d4b94e7	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<a class="anchor" name="0d343be361ec134828fe457a4d4b94e7"><\/a><!-- doxytag: member="auth.h::thread_client_timeout_check" ref="0d343be361ec134828fe457a4d4b94e7" args="(const void *arg)" -->$/;"	a
99776c0fc887b87928dce05a9760ed3d	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<a class="anchor" name="99776c0fc887b87928dce05a9760ed3d"><\/a><!-- doxytag: member="auth.h::authenticate_client" ref="99776c0fc887b87928dce05a9760ed3d" args="(request *)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
bf7b8d37cbbecff9af70c46566b7c11c	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bf7b8d37cbbecff9af70c46566b7c11c"><\/a><!-- doxytag: member="auth.h::t_authresponse" ref="bf7b8d37cbbecff9af70c46566b7c11c" args="" -->$/;"	a
ddcddbad4007d50702fdad951f611db0	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<a class="anchor" name="ddcddbad4007d50702fdad951f611db0"><\/a><!-- doxytag: member="auth.h::t_authcode" ref="ddcddbad4007d50702fdad951f611db0" args="" -->$/;"	a
ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75"><\/a><!-- doxytag: member="AUTH_DENIED" ref="ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75" args="" -->AUTH_DENIED<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce"><\/a><!-- doxytag: member="AUTH_LOCKED" ref="ddcddbad4007d50702fdad951f611db076ebf7bef147687e83c45df10b1e89ce" args="" -->AUTH_LOCKED<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392"><\/a><!-- doxytag: member="AUTH_ERROR" ref="ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392" args="" -->AUTH_ERROR<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb"><\/a><!-- doxytag: member="AUTH_VALIDATION_FAILED" ref="ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb" args="" -->AUTH_VALIDATION_FAILED<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926"><\/a><!-- doxytag: member="AUTH_ALLOWED" ref="ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926" args="" -->AUTH_ALLOWED<\/em>&nbsp;<\/td><td>$/;"	a
ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae	install/share/doc/wifidog-20090925/html/auth_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae"><\/a><!-- doxytag: member="AUTH_VALIDATION" ref="ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae" args="" -->AUTH_VALIDATION<\/em>&nbsp;<\/td><td>$/;"	a
l00001	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<h1>centralserver.c<\/h1><a href="centralserver_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: centralserver.c 1377 2008-09-30 10:36:25Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;sys\/stat.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00040	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00051"><\/a>00051 $/;"	a
l00052	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="keyword">extern<\/span> pthread_mutex_t  <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a>;$/;"	a
l00053	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00053"><\/a>00053 $/;"	a
l00064	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00064"><\/a>00064 <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0" title="Authentication codes returned by auth server.">t_authcode<\/a>$/;"	a
l00065	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00065"><\/a><a class="code" href="centralserver_8h.html#5c562f637bd218d2f397e8b1d9eae656">00065<\/a> <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(<a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a> *authresponse, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *request_type, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *token, <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> incoming, <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> outgoing)$/;"	a
l00066	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00066"><\/a>00066 {$/;"	a
l00067	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00067"><\/a>00067         <span class="keywordtype">int<\/span> sockfd;$/;"	a
l00068	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00068"><\/a>00068         ssize_t numbytes;$/;"	a
l00069	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00069"><\/a>00069         <span class="keywordtype">size_t<\/span> totalbytes;$/;"	a
l00070	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00070"><\/a>00070         <span class="keywordtype">char<\/span> buf[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00071	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00071"><\/a>00071         <span class="keywordtype">char<\/span> *tmp;$/;"	a
l00072	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00072"><\/a>00072         <span class="keywordtype">char<\/span> *safe_token;$/;"	a
l00073	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00073"><\/a>00073         <span class="keywordtype">int<\/span> done, nfds;$/;"	a
l00074	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00074"><\/a>00074         fd_set                  readfds;$/;"	a
l00075	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00075"><\/a>00075         <span class="keyword">struct <\/span>timeval          timeout;$/;"	a
l00076	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00076"><\/a>00076         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = NULL;$/;"	a
l00077	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00077"><\/a>00077         auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00078	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00078"><\/a>00078         $/;"	a
l00079	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00079"><\/a>00079         <span class="comment">\/* Blanket default is error. *\/<\/span>$/;"	a
l00080	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00080"><\/a>00080         authresponse-&gt;<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a> = <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>;$/;"	a
l00081	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00081"><\/a>00081         $/;"	a
l00082	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00082"><\/a>00082         sockfd = <a class="code" href="centralserver_8c.html#168b78813319c6f409394019fcf45f62" title="Tries really hard to connect to an auth server. Returns a connected file descriptor...">connect_auth_server<\/a>();$/;"	a
l00083	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00083"><\/a>00083         <span class="keywordflow">if<\/span> (sockfd == -1) {$/;"	a
l00084	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00084"><\/a>00084                 <span class="comment">\/* Could not connect to any auth server *\/<\/span>$/;"	a
l00085	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00085"><\/a>00085                 <span class="keywordflow">return<\/span> (<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00086	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00086"><\/a>00086         }$/;"	a
l00087	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00087"><\/a>00087 $/;"	a
l00092	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00092"><\/a>00092         memset(buf, 0, <span class="keyword">sizeof<\/span>(buf));$/;"	a
l00093	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00093"><\/a>00093         safe_token=httpdUrlEncode(token);$/;"	a
l00094	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00094"><\/a>00094         snprintf(buf, (<span class="keyword">sizeof<\/span>(buf) - 1),$/;"	a
l00095	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00095"><\/a>00095                 <span class="stringliteral">"GET %s%sstage=%s&amp;ip=%s&amp;mac=%s&amp;token=%s&amp;incoming=%llu&amp;outgoing=%llu&amp;gw_id=%s HTTP\/1.0\\r\\n"<\/span>$/;"	a
l00096	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00096"><\/a>00096                 <span class="stringliteral">"User-Agent: WiFiDog %s\\r\\n"<\/span>$/;"	a
l00097	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00097"><\/a>00097                 <span class="stringliteral">"Host: %s\\r\\n"<\/span>$/;"	a
l00098	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00098"><\/a>00098                 <span class="stringliteral">"\\r\\n"<\/span>,$/;"	a
l00099	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00099"><\/a>00099                 auth_server-&gt;authserv_path,$/;"	a
l00100	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00100"><\/a>00100                 auth_server-&gt;authserv_auth_script_path_fragment,$/;"	a
l00101	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00101"><\/a>00101                 request_type,$/;"	a
l00102	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00102"><\/a>00102                 ip,$/;"	a
l00103	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00103"><\/a>00103                 mac,$/;"	a
l00104	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00104"><\/a>00104                 safe_token,$/;"	a
l00105	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00105"><\/a>00105                 incoming,$/;"	a
l00106	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00106"><\/a>00106                 outgoing,$/;"	a
l00107	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00107"><\/a>00107                 <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;gw_id,$/;"	a
l00108	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00108"><\/a>00108                 VERSION,$/;"	a
l00109	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00109"><\/a>00109                 auth_server-&gt;authserv_hostname$/;"	a
l00110	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00110"><\/a>00110         );$/;"	a
l00111	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00111"><\/a>00111 $/;"	a
l00112	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00112"><\/a>00112         free(safe_token);$/;"	a
l00113	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00113"><\/a>00113 $/;"	a
l00114	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00114"><\/a>00114         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Sending HTTP request to auth server: [%s]\\n"<\/span>, buf);$/;"	a
l00115	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00115"><\/a>00115         send(sockfd, buf, strlen(buf), 0);$/;"	a
l00116	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00116"><\/a>00116 $/;"	a
l00117	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00117"><\/a>00117         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Reading response"<\/span>);$/;"	a
l00118	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00118"><\/a>00118         numbytes = totalbytes = 0;$/;"	a
l00119	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00119"><\/a>00119         done = 0;$/;"	a
l00120	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00120"><\/a>00120         <span class="keywordflow">do<\/span> {$/;"	a
l00121	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00121"><\/a>00121                 FD_ZERO(&amp;readfds);$/;"	a
l00122	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00122"><\/a>00122                 FD_SET(sockfd, &amp;readfds);$/;"	a
l00123	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00123"><\/a>00123                 timeout.tv_sec = 30; <span class="comment">\/* XXX magic... 30 second is as good a timeout as any *\/<\/span>$/;"	a
l00124	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00124"><\/a>00124                 timeout.tv_usec = 0;$/;"	a
l00125	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00125"><\/a>00125                 nfds = sockfd + 1;$/;"	a
l00126	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00126"><\/a>00126 $/;"	a
l00127	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00127"><\/a>00127                 nfds = select(nfds, &amp;readfds, NULL, NULL, &amp;timeout);$/;"	a
l00128	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00128"><\/a>00128 $/;"	a
l00129	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00129"><\/a>00129                 <span class="keywordflow">if<\/span> (nfds &gt; 0) {$/;"	a
l00132	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00132"><\/a>00132                         numbytes = read(sockfd, buf + totalbytes, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - (totalbytes + 1));$/;"	a
l00133	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00133"><\/a>00133                         <span class="keywordflow">if<\/span> (numbytes &lt; 0) {$/;"	a
l00134	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00134"><\/a>00134                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"An error occurred while reading from auth server: %s"<\/span>, strerror(errno));$/;"	a
l00135	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00135"><\/a>00135                                 <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00136	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00136"><\/a>00136                                 close(sockfd);$/;"	a
l00137	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00137"><\/a>00137                                 <span class="keywordflow">return<\/span> (<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00138	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00138"><\/a>00138                         }$/;"	a
l00139	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00139"><\/a>00139                         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (numbytes == 0) {$/;"	a
l00140	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00140"><\/a>00140                                 done = 1;$/;"	a
l00141	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00141"><\/a>00141                         }$/;"	a
l00142	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00142"><\/a>00142                         <span class="keywordflow">else<\/span> {$/;"	a
l00143	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00143"><\/a>00143                                 totalbytes += numbytes;$/;"	a
l00144	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00144"><\/a>00144                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read %d bytes, total now %d"<\/span>, numbytes, totalbytes);$/;"	a
l00145	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00145"><\/a>00145                         }$/;"	a
l00146	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00146"><\/a>00146                 }$/;"	a
l00147	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00147"><\/a>00147                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (nfds == 0) {$/;"	a
l00148	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00148"><\/a>00148                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Timed out reading data via select() from auth server"<\/span>);$/;"	a
l00149	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00149"><\/a>00149                         <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00150	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00150"><\/a>00150                         close(sockfd);$/;"	a
l00151	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00151"><\/a>00151                         <span class="keywordflow">return<\/span> (<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00152	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00152"><\/a>00152                 }$/;"	a
l00153	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00153"><\/a>00153                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (nfds &lt; 0) {$/;"	a
l00154	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00154"><\/a>00154                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Error reading data via select() from auth server: %s"<\/span>, strerror(errno));$/;"	a
l00155	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00155"><\/a>00155                         <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00156	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00156"><\/a>00156                         close(sockfd);$/;"	a
l00157	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00157"><\/a>00157                         <span class="keywordflow">return<\/span> (<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00158	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00158"><\/a>00158                 }$/;"	a
l00159	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00159"><\/a>00159         } <span class="keywordflow">while<\/span> (!done);$/;"	a
l00160	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00160"><\/a>00160 $/;"	a
l00161	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00161"><\/a>00161         close(sockfd);$/;"	a
l00162	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00162"><\/a>00162 $/;"	a
l00163	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00163"><\/a>00163         buf[totalbytes] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00164	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00164"><\/a>00164         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"HTTP Response from Server: [%s]"<\/span>, buf);$/;"	a
l00165	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00165"><\/a>00165         $/;"	a
l00166	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordflow">if<\/span> ((tmp = strstr(buf, <span class="stringliteral">"Auth: "<\/span>))) {$/;"	a
l00167	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00167"><\/a>00167                 <span class="keywordflow">if<\/span> (sscanf(tmp, <span class="stringliteral">"Auth: %d"<\/span>, (<span class="keywordtype">int<\/span> *)&amp;authresponse-&gt;<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>) == 1) {$/;"	a
l00168	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00168"><\/a>00168                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Auth server returned authentication code %d"<\/span>, authresponse-&gt;<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>);$/;"	a
l00169	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00169"><\/a>00169                         <span class="keywordflow">return<\/span>(authresponse-&gt;<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>);$/;"	a
l00170	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00170"><\/a>00170                 } <span class="keywordflow">else<\/span> {$/;"	a
l00171	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00171"><\/a>00171                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"Auth server did not return expected authentication code"<\/span>);$/;"	a
l00172	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00172"><\/a>00172                         <span class="keywordflow">return<\/span>(<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00173	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00173"><\/a>00173                 }$/;"	a
l00174	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00174"><\/a>00174         }$/;"	a
l00175	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00175"><\/a>00175         <span class="keywordflow">else<\/span> {$/;"	a
l00176	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00176"><\/a>00176                 <span class="keywordflow">return<\/span>(<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00177	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00177"><\/a>00177         }$/;"	a
l00178	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00178"><\/a>00178 $/;"	a
l00179	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00179"><\/a>00179         <span class="comment">\/* XXX Never reached because of the above if()\/else pair. *\/<\/span>$/;"	a
l00180	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00180"><\/a>00180         <span class="keywordflow">return<\/span>(<a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>);$/;"	a
l00181	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00181"><\/a>00181 }$/;"	a
l00182	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00182"><\/a>00182 $/;"	a
l00183	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00183"><\/a>00183 <span class="comment">\/* Tries really hard to connect to an auth server. Returns a file descriptor, -1 on error<\/span>$/;"	a
l00184	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00184"><\/a>00184 <span class="comment"> *\/<\/span>$/;"	a
l00185	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00185"><\/a><a class="code" href="centralserver_8h.html#168b78813319c6f409394019fcf45f62">00185<\/a> <span class="keywordtype">int<\/span> <a class="code" href="centralserver_8c.html#168b78813319c6f409394019fcf45f62" title="Tries really hard to connect to an auth server. Returns a connected file descriptor...">connect_auth_server<\/a>() {$/;"	a
l00186	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00186"><\/a>00186         <span class="keywordtype">int<\/span> sockfd;$/;"	a
l00187	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00187"><\/a>00187 $/;"	a
l00188	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00188"><\/a>00188         LOCK_CONFIG();$/;"	a
l00189	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00189"><\/a>00189         sockfd = <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(0);$/;"	a
l00190	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00190"><\/a>00190         UNLOCK_CONFIG();$/;"	a
l00191	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00191"><\/a>00191 $/;"	a
l00192	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00192"><\/a>00192         <span class="keywordflow">if<\/span> (sockfd == -1) {$/;"	a
l00193	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00193"><\/a>00193                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Failed to connect to any of the auth servers"<\/span>);$/;"	a
l00194	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00194"><\/a>00194                 mark_auth_offline();$/;"	a
l00195	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00195"><\/a>00195         }$/;"	a
l00196	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00196"><\/a>00196         <span class="keywordflow">else<\/span> {$/;"	a
l00197	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00197"><\/a>00197                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Connected to auth server"<\/span>);$/;"	a
l00198	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00198"><\/a>00198                 mark_auth_online();$/;"	a
l00199	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00199"><\/a>00199         }$/;"	a
l00200	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00200"><\/a>00200         <span class="keywordflow">return<\/span> (sockfd);$/;"	a
l00201	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00201"><\/a>00201 }$/;"	a
l00202	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00202"><\/a>00202 $/;"	a
l00203	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00203"><\/a>00203 <span class="comment">\/* Helper function called by connect_auth_server() to do the actual work including recursion<\/span>$/;"	a
l00204	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00204"><\/a>00204 <span class="comment"> * DO NOT CALL DIRECTLY<\/span>$/;"	a
l00205	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00205"><\/a>00205 <span class="comment"> @param level recursion level indicator must be 0 when not called by _connect_auth_server()<\/span>$/;"	a
l00206	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00206"><\/a>00206 <span class="comment"> *\/<\/span>$/;"	a
l00207	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00207"><\/a><a class="code" href="centralserver_8h.html#e19e5fef3df77ca03ce69852f016fdc6">00207<\/a> <span class="keywordtype">int<\/span> <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(<span class="keywordtype">int<\/span> level) {$/;"	a
l00208	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00208"><\/a>00208         <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00209	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00209"><\/a>00209         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_server = NULL;$/;"	a
l00210	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00210"><\/a>00210         <span class="keyword">struct <\/span>in_addr *h_addr;$/;"	a
l00211	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00211"><\/a>00211         <span class="keywordtype">int<\/span> num_servers = 0;$/;"	a
l00212	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00212"><\/a>00212         <span class="keywordtype">char<\/span> * hostname = NULL;$/;"	a
l00213	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00213"><\/a>00213         <span class="keywordtype">char<\/span> * popular_servers[] = {$/;"	a
l00214	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00214"><\/a>00214                   <span class="stringliteral">"www.google.com"<\/span>,$/;"	a
l00215	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00215"><\/a>00215                   <span class="stringliteral">"www.yahoo.com"<\/span>,$/;"	a
l00216	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00216"><\/a>00216                   NULL$/;"	a
l00217	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00217"><\/a>00217         };$/;"	a
l00218	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00218"><\/a>00218         <span class="keywordtype">char<\/span> ** popularserver;$/;"	a
l00219	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00219"><\/a>00219         <span class="keywordtype">char<\/span> * ip;$/;"	a
l00220	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00220"><\/a>00220         <span class="keyword">struct <\/span>sockaddr_in their_addr;$/;"	a
l00221	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00221"><\/a>00221         <span class="keywordtype">int<\/span> sockfd;$/;"	a
l00222	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00222"><\/a>00222 $/;"	a
l00223	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00223"><\/a>00223         <span class="comment">\/* XXX level starts out at 0 and gets incremented by every iterations. *\/<\/span>$/;"	a
l00224	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00224"><\/a>00224         level++;$/;"	a
l00225	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00225"><\/a>00225 $/;"	a
l00226	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00226"><\/a>00226         <span class="comment">\/*<\/span>$/;"	a
l00227	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00227"><\/a>00227 <span class="comment">         * Let's calculate the number of servers we have<\/span>$/;"	a
l00228	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00228"><\/a>00228 <span class="comment">         *\/<\/span>$/;"	a
l00229	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00229"><\/a>00229         <span class="keywordflow">for<\/span> (auth_server = config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; auth_server; auth_server = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>) {$/;"	a
l00230	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00230"><\/a>00230                 num_servers++;$/;"	a
l00231	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00231"><\/a>00231         }$/;"	a
l00232	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00232"><\/a>00232         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Calculated %d auth servers in list"<\/span>, level, num_servers);$/;"	a
l00233	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00233"><\/a>00233 $/;"	a
l00234	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00234"><\/a>00234         <span class="keywordflow">if<\/span> (level &gt; num_servers) {$/;"	a
l00235	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00235"><\/a>00235                 <span class="comment">\/*<\/span>$/;"	a
l00236	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00236"><\/a>00236 <span class="comment">                 * We've called ourselves too many times<\/span>$/;"	a
l00237	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00237"><\/a>00237 <span class="comment">                 * This means we've cycled through all the servers in the server list<\/span>$/;"	a
l00238	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00238"><\/a>00238 <span class="comment">                 * at least once and none are accessible<\/span>$/;"	a
l00239	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00239"><\/a>00239 <span class="comment">                 *\/<\/span>$/;"	a
l00240	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00240"><\/a>00240                 <span class="keywordflow">return<\/span> (-1);$/;"	a
l00241	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00241"><\/a>00241         }$/;"	a
l00242	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00242"><\/a>00242 $/;"	a
l00243	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00243"><\/a>00243         <span class="comment">\/*<\/span>$/;"	a
l00244	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00244"><\/a>00244 <span class="comment">         * Let's resolve the hostname of the top server to an IP address<\/span>$/;"	a
l00245	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00245"><\/a>00245 <span class="comment">         *\/<\/span>$/;"	a
l00246	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00246"><\/a>00246         auth_server = config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>;$/;"	a
l00247	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00247"><\/a>00247         hostname = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>;$/;"	a
l00248	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00248"><\/a>00248         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving auth server [%s]"<\/span>, level, hostname);$/;"	a
l00249	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00249"><\/a>00249         h_addr = wd_gethostbyname(hostname);$/;"	a
l00250	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00250"><\/a>00250         <span class="keywordflow">if<\/span> (!h_addr) {$/;"	a
l00251	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00251"><\/a>00251                 <span class="comment">\/*<\/span>$/;"	a
l00252	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00252"><\/a>00252 <span class="comment">                 * DNS resolving it failed<\/span>$/;"	a
l00253	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00253"><\/a>00253 <span class="comment">                 *<\/span>$/;"	a
l00254	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00254"><\/a>00254 <span class="comment">                 * Can we resolve any of the popular servers ?<\/span>$/;"	a
l00255	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00255"><\/a>00255 <span class="comment">                 *\/<\/span>$/;"	a
l00256	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00256"><\/a>00256                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving auth server [%s] failed"<\/span>, level, hostname);$/;"	a
l00257	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00257"><\/a>00257 $/;"	a
l00258	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00258"><\/a>00258                 <span class="keywordflow">for<\/span> (popularserver = popular_servers; *popularserver; popularserver++) {$/;"	a
l00259	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00259"><\/a>00259                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving popular server [%s]"<\/span>, level, *popularserver);$/;"	a
l00260	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00260"><\/a>00260                         h_addr = wd_gethostbyname(*popularserver);$/;"	a
l00261	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00261"><\/a>00261                         <span class="keywordflow">if<\/span> (h_addr) {$/;"	a
l00262	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00262"><\/a>00262                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving popular server [%s] succeeded = [%s]"<\/span>, level, *popularserver, inet_ntoa(*h_addr));$/;"	a
l00263	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00263"><\/a>00263                                 <span class="keywordflow">break<\/span>;$/;"	a
l00264	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00264"><\/a>00264                         }$/;"	a
l00265	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00265"><\/a>00265                         <span class="keywordflow">else<\/span> {$/;"	a
l00266	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00266"><\/a>00266                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving popular server [%s] failed"<\/span>, level, *popularserver);$/;"	a
l00267	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00267"><\/a>00267                         }$/;"	a
l00268	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00268"><\/a>00268                 }$/;"	a
l00269	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00269"><\/a>00269 $/;"	a
l00270	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00270"><\/a>00270                 <span class="comment">\/* <\/span>$/;"	a
l00271	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00271"><\/a>00271 <span class="comment">                 * If we got any h_addr buffer for one of the popular servers, in other<\/span>$/;"	a
l00272	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00272"><\/a>00272 <span class="comment">                 * words, if one of the popular servers resolved, we'll assume the DNS<\/span>$/;"	a
l00273	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00273"><\/a>00273 <span class="comment">                 * works, otherwise we'll deal with net connection or DNS failure.<\/span>$/;"	a
l00274	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00274"><\/a>00274 <span class="comment">                 *\/<\/span>$/;"	a
l00275	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00275"><\/a>00275                 <span class="keywordflow">if<\/span> (h_addr) {$/;"	a
l00276	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00276"><\/a>00276                         free (h_addr);$/;"	a
l00277	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00277"><\/a>00277                         <span class="comment">\/*<\/span>$/;"	a
l00278	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00278"><\/a>00278 <span class="comment">                         * Yes<\/span>$/;"	a
l00279	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00279"><\/a>00279 <span class="comment">                         *<\/span>$/;"	a
l00280	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00280"><\/a>00280 <span class="comment">                         * The auth server's DNS server is probably dead. Try the next auth server<\/span>$/;"	a
l00281	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00281"><\/a>00281 <span class="comment">                         *\/<\/span>$/;"	a
l00282	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00282"><\/a>00282                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Marking auth server [%s] as bad and trying next if possible"<\/span>, level, hostname);$/;"	a
l00283	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00283"><\/a>00283                         <span class="keywordflow">if<\/span> (auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>) {$/;"	a
l00284	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00284"><\/a>00284                                 free(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00285	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00285"><\/a>00285                                 auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a> = NULL;$/;"	a
l00286	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00286"><\/a>00286                         }$/;"	a
l00287	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00287"><\/a>00287                         <a class="code" href="conf_8c.html#d1e677696fcef826740ca906587af8ac" title="Bump server to bottom of the list.">mark_auth_server_bad<\/a>(auth_server);$/;"	a
l00288	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00288"><\/a>00288                         <span class="keywordflow">return<\/span> <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(level);$/;"	a
l00289	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00289"><\/a>00289                 }$/;"	a
l00290	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00290"><\/a>00290                 <span class="keywordflow">else<\/span> {$/;"	a
l00291	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00291"><\/a>00291                         <span class="comment">\/*<\/span>$/;"	a
l00292	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00292"><\/a>00292 <span class="comment">                         * No<\/span>$/;"	a
l00293	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00293"><\/a>00293 <span class="comment">                         *<\/span>$/;"	a
l00294	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00294"><\/a>00294 <span class="comment">                         * It's probably safe to assume that the internet connection is malfunctioning<\/span>$/;"	a
l00295	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00295"><\/a>00295 <span class="comment">                         * and nothing we can do will make it work<\/span>$/;"	a
l00296	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00296"><\/a>00296 <span class="comment">                         *\/<\/span>$/;"	a
l00297	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00297"><\/a>00297                         mark_offline();$/;"	a
l00298	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00298"><\/a>00298                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Failed to resolve auth server and all popular servers. "<\/span>$/;"	a
l00299	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00299"><\/a>00299                                         <span class="stringliteral">"The internet connection is probably down"<\/span>, level);$/;"	a
l00300	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00300"><\/a>00300                         <span class="keywordflow">return<\/span>(-1);$/;"	a
l00301	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00301"><\/a>00301                 }$/;"	a
l00302	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00302"><\/a>00302         }$/;"	a
l00303	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00303"><\/a>00303         <span class="keywordflow">else<\/span> {$/;"	a
l00304	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00304"><\/a>00304                 <span class="comment">\/*<\/span>$/;"	a
l00305	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00305"><\/a>00305 <span class="comment">                 * DNS resolving was successful<\/span>$/;"	a
l00306	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00306"><\/a>00306 <span class="comment">                 *\/<\/span>$/;"	a
l00307	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00307"><\/a>00307                 ip = safe_strdup(inet_ntoa(*h_addr));$/;"	a
l00308	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00308"><\/a>00308                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Resolving auth server [%s] succeeded = [%s]"<\/span>, level, hostname, ip);$/;"	a
l00309	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00309"><\/a>00309 $/;"	a
l00310	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00310"><\/a>00310                 <span class="keywordflow">if<\/span> (!auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a> || strcmp(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>, ip) != 0) {$/;"	a
l00311	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00311"><\/a>00311                         <span class="comment">\/*<\/span>$/;"	a
l00312	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00312"><\/a>00312 <span class="comment">                         * But the IP address is different from the last one we knew<\/span>$/;"	a
l00313	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00313"><\/a>00313 <span class="comment">                         * Update it<\/span>$/;"	a
l00314	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00314"><\/a>00314 <span class="comment">                         *\/<\/span>$/;"	a
l00315	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00315"><\/a>00315                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Updating last_ip IP of server [%s] to [%s]"<\/span>, level, hostname, ip);$/;"	a
l00316	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00316"><\/a>00316                         <span class="keywordflow">if<\/span> (auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>) free(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00317	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00317"><\/a>00317                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a> = ip;$/;"	a
l00318	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00318"><\/a>00318 $/;"	a
l00319	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00319"><\/a>00319                         <span class="comment">\/* Update firewall rules *\/<\/span>$/;"	a
l00320	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00320"><\/a>00320                         fw_clear_authservers();$/;"	a
l00321	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00321"><\/a>00321                         fw_set_authservers();$/;"	a
l00322	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00322"><\/a>00322                 }$/;"	a
l00323	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00323"><\/a>00323                 <span class="keywordflow">else<\/span> {$/;"	a
l00324	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00324"><\/a>00324                         <span class="comment">\/*<\/span>$/;"	a
l00325	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00325"><\/a>00325 <span class="comment">                         * IP is the same as last time<\/span>$/;"	a
l00326	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00326"><\/a>00326 <span class="comment">                         *\/<\/span>$/;"	a
l00327	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00327"><\/a>00327                         free(ip);$/;"	a
l00328	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00328"><\/a>00328                 }$/;"	a
l00329	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00329"><\/a>00329 $/;"	a
l00330	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00330"><\/a>00330                 <span class="comment">\/*<\/span>$/;"	a
l00331	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00331"><\/a>00331 <span class="comment">                 * Connect to it<\/span>$/;"	a
l00332	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00332"><\/a>00332 <span class="comment">                 *\/<\/span>$/;"	a
l00333	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00333"><\/a>00333                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Connecting to auth server %s:%d"<\/span>, level, hostname, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>);$/;"	a
l00334	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00334"><\/a>00334                 their_addr.sin_family = AF_INET;$/;"	a
l00335	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00335"><\/a>00335                 their_addr.sin_port = htons(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>);$/;"	a
l00336	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00336"><\/a>00336                 their_addr.sin_addr = *h_addr;$/;"	a
l00337	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00337"><\/a>00337                 memset(&amp;(their_addr.sin_zero), <span class="charliteral">'\\0'<\/span>, <span class="keyword">sizeof<\/span>(their_addr.sin_zero));$/;"	a
l00338	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00338"><\/a>00338                 free (h_addr);$/;"	a
l00339	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00339"><\/a>00339 $/;"	a
l00340	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00340"><\/a>00340                 <span class="keywordflow">if<\/span> ((sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1) {$/;"	a
l00341	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00341"><\/a>00341                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Level %d: Failed to create a new SOCK_STREAM socket: %s"<\/span>, strerror(errno));$/;"	a
l00342	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00342"><\/a>00342                         <span class="keywordflow">return<\/span>(-1);$/;"	a
l00343	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00343"><\/a>00343                 }$/;"	a
l00344	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00344"><\/a>00344 $/;"	a
l00345	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00345"><\/a>00345                 <span class="keywordflow">if<\/span> (connect(sockfd, (<span class="keyword">struct<\/span> sockaddr *)&amp;their_addr, <span class="keyword">sizeof<\/span>(<span class="keyword">struct<\/span> sockaddr)) == -1) {$/;"	a
l00346	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00346"><\/a>00346                         <span class="comment">\/*<\/span>$/;"	a
l00347	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00347"><\/a>00347 <span class="comment">                         * Failed to connect<\/span>$/;"	a
l00348	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00348"><\/a>00348 <span class="comment">                         * Mark the server as bad and try the next one<\/span>$/;"	a
l00349	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00349"><\/a>00349 <span class="comment">                         *\/<\/span>$/;"	a
l00350	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00350"><\/a>00350                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Failed to connect to auth server %s:%d (%s). Marking it as bad and trying next if possible"<\/span>, level, hostname, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>, strerror(errno));$/;"	a
l00351	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00351"><\/a>00351                         close(sockfd);$/;"	a
l00352	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00352"><\/a>00352                         <a class="code" href="conf_8c.html#d1e677696fcef826740ca906587af8ac" title="Bump server to bottom of the list.">mark_auth_server_bad<\/a>(auth_server);$/;"	a
l00353	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00353"><\/a>00353                         <span class="keywordflow">return<\/span> <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(level); <span class="comment">\/* Yay recursion! *\/<\/span>$/;"	a
l00354	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00354"><\/a>00354                 }$/;"	a
l00355	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00355"><\/a>00355                 <span class="keywordflow">else<\/span> {$/;"	a
l00356	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00356"><\/a>00356                         <span class="comment">\/*<\/span>$/;"	a
l00357	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00357"><\/a>00357 <span class="comment">                         * We have successfully connected<\/span>$/;"	a
l00358	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00358"><\/a>00358 <span class="comment">                         *\/<\/span>$/;"	a
l00359	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00359"><\/a>00359                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Level %d: Successfully connected to auth server %s:%d"<\/span>, level, hostname, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>);$/;"	a
l00360	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00360"><\/a>00360                         <span class="keywordflow">return<\/span> sockfd;$/;"	a
l00361	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00361"><\/a>00361                 }$/;"	a
l00362	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00362"><\/a>00362         }$/;"	a
l00363	install/share/doc/wifidog-20090925/html/centralserver_8c-source.html	/^<a name="l00363"><\/a>00363 }$/;"	a
168b78813319c6f409394019fcf45f62	install/share/doc/wifidog-20090925/html/centralserver_8c.html	/^<a class="anchor" name="168b78813319c6f409394019fcf45f62"><\/a><!-- doxytag: member="centralserver.c::connect_auth_server" ref="168b78813319c6f409394019fcf45f62" args="()" -->$/;"	a
5c562f637bd218d2f397e8b1d9eae656	install/share/doc/wifidog-20090925/html/centralserver_8c.html	/^<a class="anchor" name="5c562f637bd218d2f397e8b1d9eae656"><\/a><!-- doxytag: member="centralserver.c::auth_server_request" ref="5c562f637bd218d2f397e8b1d9eae656" args="(t_authresponse *authresponse, const char *request_type, const char *ip, const char *mac, const char *token, unsigned long long int incoming, unsigned long long int outgoing)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/centralserver_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b374ff230d9977e6b952612d61689f39	install/share/doc/wifidog-20090925/html/centralserver_8c.html	/^<a class="anchor" name="b374ff230d9977e6b952612d61689f39"><\/a><!-- doxytag: member="centralserver.c::config_mutex" ref="b374ff230d9977e6b952612d61689f39" args="" -->$/;"	a
e19e5fef3df77ca03ce69852f016fdc6	install/share/doc/wifidog-20090925/html/centralserver_8c.html	/^<a class="anchor" name="e19e5fef3df77ca03ce69852f016fdc6"><\/a><!-- doxytag: member="centralserver.c::_connect_auth_server" ref="e19e5fef3df77ca03ce69852f016fdc6" args="(int level)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<h1>centralserver.h<\/h1><a href="centralserver_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: centralserver.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _CENTRALSERVER_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _CENTRALSERVER_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00033	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00033"><\/a><a class="code" href="centralserver_8h.html#6fc858ffaac7b85a57a262f86febf5bf">00033<\/a> <span class="preprocessor">#define REQUEST_TYPE_LOGIN     "login"<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor"><\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00035"><\/a><a class="code" href="centralserver_8h.html#b262747ac931a0a8c357448e7a2cf301">00035<\/a> <span class="preprocessor">#define REQUEST_TYPE_LOGOUT    "logout"<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor"><\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="centralserver_8h.html#3ebb2c04a3ef087a8956e171068759f7">00037<\/a> <span class="preprocessor">#define REQUEST_TYPE_COUNTERS  "counters"<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor"><\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00040"><\/a><a class="code" href="centralserver_8h.html#becb4a093d3aaf41645172f373acb4d7">00040<\/a> <span class="preprocessor">#define GATEWAY_MESSAGE_DENIED     "denied"<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor"><\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="centralserver_8h.html#46de6b10ed6b0269da637b1e6c96d128">00042<\/a> <span class="preprocessor">#define GATEWAY_MESSAGE_ACTIVATE_ACCOUNT     "activate"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor"><\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00044"><\/a><a class="code" href="centralserver_8h.html#1a829447172cc69e643e77a2a64eaf23">00044<\/a> <span class="preprocessor">#define GATEWAY_MESSAGE_ACCOUNT_VALIDATION_FAILED     "failed_validation"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor"><\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00046"><\/a><a class="code" href="centralserver_8h.html#9aa808dd68665d6af8a050e22bb9e1c4">00046<\/a> <span class="preprocessor">#define GATEWAY_MESSAGE_ACCOUNT_LOGGED_OUT     "logged-out"<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor"><\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00049"><\/a>00049 <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0" title="Authentication codes returned by auth server.">t_authcode<\/a> <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(<a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a> *authresponse,$/;"	a
l00050	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00050"><\/a>00050                         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *request_type,$/;"	a
l00051	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00051"><\/a>00051                         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip,$/;"	a
l00052	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00052"><\/a>00052                         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac,$/;"	a
l00053	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00053"><\/a>00053                         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *token,$/;"	a
l00054	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00054"><\/a>00054                         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> incoming,$/;"	a
l00055	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00055"><\/a>00055                         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> outgoing);$/;"	a
l00056	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00056"><\/a>00056 $/;"	a
l00058	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00058"><\/a>00058 <span class="keywordtype">int<\/span> <a class="code" href="centralserver_8c.html#168b78813319c6f409394019fcf45f62" title="Tries really hard to connect to an auth server. Returns a connected file descriptor...">connect_auth_server<\/a>();$/;"	a
l00059	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00061	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="keywordtype">int<\/span> <a class="code" href="centralserver_8c.html#e19e5fef3df77ca03ce69852f016fdc6" title="Helper function called by connect_auth_server() to do the actual work including recursion...">_connect_auth_server<\/a>(<span class="keywordtype">int<\/span> level);$/;"	a
l00062	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00063	install/share/doc/wifidog-20090925/html/centralserver_8h-source.html	/^<a name="l00063"><\/a>00063 <span class="preprocessor">#endif <\/span><span class="comment">\/* _CENTRALSERVER_H_ *\/<\/span>$/;"	a
168b78813319c6f409394019fcf45f62	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="168b78813319c6f409394019fcf45f62"><\/a><!-- doxytag: member="centralserver.h::connect_auth_server" ref="168b78813319c6f409394019fcf45f62" args="()" -->$/;"	a
1a829447172cc69e643e77a2a64eaf23	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="1a829447172cc69e643e77a2a64eaf23"><\/a><!-- doxytag: member="centralserver.h::GATEWAY_MESSAGE_ACCOUNT_VALIDATION_FAILED" ref="1a829447172cc69e643e77a2a64eaf23" args="" -->$/;"	a
3ebb2c04a3ef087a8956e171068759f7	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="3ebb2c04a3ef087a8956e171068759f7"><\/a><!-- doxytag: member="centralserver.h::REQUEST_TYPE_COUNTERS" ref="3ebb2c04a3ef087a8956e171068759f7" args="" -->$/;"	a
46de6b10ed6b0269da637b1e6c96d128	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="46de6b10ed6b0269da637b1e6c96d128"><\/a><!-- doxytag: member="centralserver.h::GATEWAY_MESSAGE_ACTIVATE_ACCOUNT" ref="46de6b10ed6b0269da637b1e6c96d128" args="" -->$/;"	a
5c562f637bd218d2f397e8b1d9eae656	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="5c562f637bd218d2f397e8b1d9eae656"><\/a><!-- doxytag: member="centralserver.h::auth_server_request" ref="5c562f637bd218d2f397e8b1d9eae656" args="(t_authresponse *authresponse, const char *request_type, const char *ip, const char *mac, const char *token, unsigned long long int incoming, unsigned long long int outgoing)" -->$/;"	a
6fc858ffaac7b85a57a262f86febf5bf	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="6fc858ffaac7b85a57a262f86febf5bf"><\/a><!-- doxytag: member="centralserver.h::REQUEST_TYPE_LOGIN" ref="6fc858ffaac7b85a57a262f86febf5bf" args="" -->$/;"	a
9aa808dd68665d6af8a050e22bb9e1c4	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="9aa808dd68665d6af8a050e22bb9e1c4"><\/a><!-- doxytag: member="centralserver.h::GATEWAY_MESSAGE_ACCOUNT_LOGGED_OUT" ref="9aa808dd68665d6af8a050e22bb9e1c4" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b262747ac931a0a8c357448e7a2cf301	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="b262747ac931a0a8c357448e7a2cf301"><\/a><!-- doxytag: member="centralserver.h::REQUEST_TYPE_LOGOUT" ref="b262747ac931a0a8c357448e7a2cf301" args="" -->$/;"	a
becb4a093d3aaf41645172f373acb4d7	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="becb4a093d3aaf41645172f373acb4d7"><\/a><!-- doxytag: member="centralserver.h::GATEWAY_MESSAGE_DENIED" ref="becb4a093d3aaf41645172f373acb4d7" args="" -->$/;"	a
e19e5fef3df77ca03ce69852f016fdc6	install/share/doc/wifidog-20090925/html/centralserver_8h.html	/^<a class="anchor" name="e19e5fef3df77ca03ce69852f016fdc6"><\/a><!-- doxytag: member="centralserver.h::_connect_auth_server" ref="e19e5fef3df77ca03ce69852f016fdc6" args="(int level)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<h1>client_list.c<\/h1><a href="client__list_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/*<\/span>$/;"	a
l00022	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00022"><\/a>00022 <span class="comment"> * $Id: client_list.c 1373 2008-09-30 09:27:40Z wichert $<\/span>$/;"	a
l00023	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00023"><\/a>00023 <span class="comment"> *\/<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor"><\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;sys\/wait.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;sys\/unistd.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00040	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00046"><\/a>00046 $/;"	a
l00048	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00048"><\/a><a class="code" href="wdctl__thread_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">00048<\/a> pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a> = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00049	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00049"><\/a>00049 $/;"	a
l00053	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00053"><\/a>00053 <a class="code" href="struct__t__client.html">t_client<\/a>         *firstclient = NULL;$/;"	a
l00054	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00057	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00057"><\/a>00057 <a class="code" href="struct__t__client.html">t_client<\/a> *$/;"	a
l00058	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00058"><\/a><a class="code" href="client__list_8h.html#4d619ca71763380120ec60d4f9c7d084">00058<\/a> <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00059	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00059"><\/a>00059 {$/;"	a
l00060	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00060"><\/a>00060     <span class="keywordflow">return<\/span> firstclient;$/;"	a
l00061	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00061"><\/a>00061 }$/;"	a
l00062	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00066	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00066"><\/a>00066 <span class="keywordtype">void<\/span>$/;"	a
l00067	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00067"><\/a><a class="code" href="client__list_8h.html#d624b5c33e086131f3af7b52589f5fd1">00067<\/a> <a class="code" href="client__list_8c.html#d624b5c33e086131f3af7b52589f5fd1" title="Initializes the client list.">client_list_init<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00068	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00068"><\/a>00068 {$/;"	a
l00069	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00069"><\/a>00069     firstclient = NULL;$/;"	a
l00070	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00070"><\/a>00070 }$/;"	a
l00071	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00071"><\/a>00071 $/;"	a
l00079	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00079"><\/a>00079 <a class="code" href="struct__t__client.html">t_client<\/a>         *$/;"	a
l00080	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00080"><\/a><a class="code" href="client__list_8h.html#65ad84da2af952d86d9ea8c326951911">00080<\/a> <a class="code" href="client__list_8c.html#65ad84da2af952d86d9ea8c326951911" title="Adds a new client to the connections list.">client_list_append<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *token)$/;"	a
l00081	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00081"><\/a>00081 {$/;"	a
l00082	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00082"><\/a>00082     <a class="code" href="struct__t__client.html">t_client<\/a>         *curclient, *prevclient;$/;"	a
l00083	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00084"><\/a>00084     prevclient = NULL;$/;"	a
l00085	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00085"><\/a>00085     curclient = firstclient;$/;"	a
l00086	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00086"><\/a>00086 $/;"	a
l00087	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00087"><\/a>00087     <span class="keywordflow">while<\/span> (curclient != NULL) {$/;"	a
l00088	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00088"><\/a>00088         prevclient = curclient;$/;"	a
l00089	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00089"><\/a>00089         curclient = curclient-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00090	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00090"><\/a>00090     }$/;"	a
l00091	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00091"><\/a>00091 $/;"	a
l00092	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00092"><\/a>00092     curclient = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__t__client.html">t_client<\/a>));$/;"	a
l00093	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00093"><\/a>00093     memset(curclient, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__t__client.html">t_client<\/a>));$/;"	a
l00094	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00094"><\/a>00094 $/;"	a
l00095	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00095"><\/a>00095     curclient-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a> = safe_strdup(ip);$/;"	a
l00096	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00096"><\/a>00096     curclient-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a> = safe_strdup(mac);$/;"	a
l00097	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00097"><\/a>00097     curclient-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a> = safe_strdup(token);$/;"	a
l00098	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00098"><\/a>00098     curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> = curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a> = curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> = curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a> = 0;$/;"	a
l00099	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00099"><\/a>00099     curclient-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a> = time(NULL);$/;"	a
l00100	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00100"><\/a>00100 $/;"	a
l00101	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00101"><\/a>00101     <span class="keywordflow">if<\/span> (prevclient == NULL) {$/;"	a
l00102	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00102"><\/a>00102         firstclient = curclient;$/;"	a
l00103	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00103"><\/a>00103     } <span class="keywordflow">else<\/span> {$/;"	a
l00104	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00104"><\/a>00104         prevclient-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> = curclient;$/;"	a
l00105	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00105"><\/a>00105     }$/;"	a
l00106	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00106"><\/a>00106 $/;"	a
l00107	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00107"><\/a>00107     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Added a new client to linked list: IP: %s Token: %s"<\/span>,$/;"	a
l00108	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00108"><\/a>00108           ip, token);$/;"	a
l00109	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00109"><\/a>00109 $/;"	a
l00110	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00110"><\/a>00110     <span class="keywordflow">return<\/span> curclient;$/;"	a
l00111	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00111"><\/a>00111 }$/;"	a
l00112	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00112"><\/a>00112 $/;"	a
l00119	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00119"><\/a>00119 <a class="code" href="struct__t__client.html">t_client<\/a>         *$/;"	a
l00120	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00120"><\/a><a class="code" href="client__list_8h.html#6ef7c0e44163b7ad9ed0353b095c1bbb">00120<\/a> <a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac)$/;"	a
l00121	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00121"><\/a>00121 {$/;"	a
l00122	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00122"><\/a>00122     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00123	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00123"><\/a>00123 $/;"	a
l00124	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00124"><\/a>00124     ptr = firstclient;$/;"	a
l00125	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00125"><\/a>00125     <span class="keywordflow">while<\/span> (NULL != ptr) {$/;"	a
l00126	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00126"><\/a>00126         <span class="keywordflow">if<\/span> (0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, ip) &amp;&amp; 0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, mac))$/;"	a
l00127	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00127"><\/a>00127             <span class="keywordflow">return<\/span> ptr;$/;"	a
l00128	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00128"><\/a>00128         ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00129	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00129"><\/a>00129     }$/;"	a
l00130	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00130"><\/a>00130 $/;"	a
l00131	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00131"><\/a>00131     <span class="keywordflow">return<\/span> NULL;$/;"	a
l00132	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00132"><\/a>00132 }$/;"	a
l00133	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00133"><\/a>00133 $/;"	a
l00140	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00140"><\/a>00140 <a class="code" href="struct__t__client.html">t_client<\/a>         *$/;"	a
l00141	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00141"><\/a><a class="code" href="client__list_8h.html#8d47e246eaa43b7e6216b0d698143dd3">00141<\/a> <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip)$/;"	a
l00142	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00142"><\/a>00142 {$/;"	a
l00143	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00143"><\/a>00143     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00144	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00144"><\/a>00144 $/;"	a
l00145	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00145"><\/a>00145     ptr = firstclient;$/;"	a
l00146	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00146"><\/a>00146     <span class="keywordflow">while<\/span> (NULL != ptr) {$/;"	a
l00147	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00147"><\/a>00147         <span class="keywordflow">if<\/span> (0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, ip))$/;"	a
l00148	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00148"><\/a>00148             <span class="keywordflow">return<\/span> ptr;$/;"	a
l00149	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00149"><\/a>00149         ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00150	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00150"><\/a>00150     }$/;"	a
l00151	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00151"><\/a>00151 $/;"	a
l00152	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00152"><\/a>00152     <span class="keywordflow">return<\/span> NULL;$/;"	a
l00153	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00153"><\/a>00153 }$/;"	a
l00154	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00154"><\/a>00154 $/;"	a
l00161	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00161"><\/a>00161 <a class="code" href="struct__t__client.html">t_client<\/a>         *$/;"	a
l00162	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00162"><\/a><a class="code" href="client__list_8h.html#5d741b8940ddeaa92f3b17c7fd1dab7b">00162<\/a> <a class="code" href="client__list_8c.html#5d741b8940ddeaa92f3b17c7fd1dab7b" title="Finds a client only by its Mac.">client_list_find_by_mac<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac)$/;"	a
l00163	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00163"><\/a>00163 {$/;"	a
l00164	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00164"><\/a>00164     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00165	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00165"><\/a>00165 $/;"	a
l00166	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00166"><\/a>00166     ptr = firstclient;$/;"	a
l00167	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00167"><\/a>00167     <span class="keywordflow">while<\/span> (NULL != ptr) {$/;"	a
l00168	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00168"><\/a>00168         <span class="keywordflow">if<\/span> (0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, mac))$/;"	a
l00169	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00169"><\/a>00169             <span class="keywordflow">return<\/span> ptr;$/;"	a
l00170	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00170"><\/a>00170         ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00171	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00171"><\/a>00171     }$/;"	a
l00172	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00172"><\/a>00172 $/;"	a
l00173	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00173"><\/a>00173     <span class="keywordflow">return<\/span> NULL;$/;"	a
l00174	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00174"><\/a>00174 }$/;"	a
l00175	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00175"><\/a>00175 $/;"	a
l00180	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00180"><\/a>00180 <a class="code" href="struct__t__client.html">t_client<\/a> *$/;"	a
l00181	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00181"><\/a><a class="code" href="client__list_8h.html#23155a3173c5be5b646686b61414ca62">00181<\/a> <a class="code" href="client__list_8c.html#23155a3173c5be5b646686b61414ca62" title="Finds a client by its token.">client_list_find_by_token<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *token)$/;"	a
l00182	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00182"><\/a>00182 {$/;"	a
l00183	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00183"><\/a>00183     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00184	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00184"><\/a>00184 $/;"	a
l00185	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00185"><\/a>00185     ptr = firstclient;$/;"	a
l00186	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00186"><\/a>00186     <span class="keywordflow">while<\/span> (NULL != ptr) {$/;"	a
l00187	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00187"><\/a>00187         <span class="keywordflow">if<\/span> (0 == strcmp(ptr-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, token))$/;"	a
l00188	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00188"><\/a>00188             <span class="keywordflow">return<\/span> ptr;$/;"	a
l00189	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00189"><\/a>00189         ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00190	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00190"><\/a>00190     }$/;"	a
l00191	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00191"><\/a>00191 $/;"	a
l00192	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00192"><\/a>00192     <span class="keywordflow">return<\/span> NULL;$/;"	a
l00193	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00193"><\/a>00193 }$/;"	a
l00194	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00194"><\/a>00194 $/;"	a
l00201	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00201"><\/a>00201 <span class="keywordtype">void<\/span>$/;"	a
l00202	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00202"><\/a>00202 _client_list_free_node(<a class="code" href="struct__t__client.html">t_client<\/a> * client)$/;"	a
l00203	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00203"><\/a>00203 {$/;"	a
l00204	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00204"><\/a>00204 $/;"	a
l00205	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00205"><\/a>00205     <span class="keywordflow">if<\/span> (client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a> != NULL)$/;"	a
l00206	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00206"><\/a>00206         free(client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00207	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00208"><\/a>00208     <span class="keywordflow">if<\/span> (client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a> != NULL)$/;"	a
l00209	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00209"><\/a>00209         free(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00210	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00210"><\/a>00210 $/;"	a
l00211	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00211"><\/a>00211     <span class="keywordflow">if<\/span> (client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a> != NULL)$/;"	a
l00212	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00212"><\/a>00212         free(client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00213	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00213"><\/a>00213 $/;"	a
l00214	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00214"><\/a>00214     free(client);$/;"	a
l00215	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00215"><\/a>00215 }$/;"	a
l00216	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00224	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00224"><\/a>00224 <span class="keywordtype">void<\/span>$/;"	a
l00225	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00225"><\/a><a class="code" href="client__list_8h.html#6cb127e61a08a2910438c8d91272616a">00225<\/a> <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(<a class="code" href="struct__t__client.html">t_client<\/a> * client)$/;"	a
l00226	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00226"><\/a>00226 {$/;"	a
l00227	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00227"><\/a>00227     <a class="code" href="struct__t__client.html">t_client<\/a>         *ptr;$/;"	a
l00228	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00228"><\/a>00228 $/;"	a
l00229	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00229"><\/a>00229     ptr = firstclient;$/;"	a
l00230	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00230"><\/a>00230 $/;"	a
l00231	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00231"><\/a>00231     <span class="keywordflow">if<\/span> (ptr == NULL) {$/;"	a
l00232	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00232"><\/a>00232         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Node list empty!"<\/span>);$/;"	a
l00233	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00233"><\/a>00233     } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (ptr == client) {$/;"	a
l00234	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00234"><\/a>00234         firstclient = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00235	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00235"><\/a>00235         _client_list_free_node(client);$/;"	a
l00236	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00236"><\/a>00236     } <span class="keywordflow">else<\/span> {$/;"	a
l00237	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00237"><\/a>00237         <span class="comment">\/* Loop forward until we reach our point in the list. *\/<\/span>$/;"	a
l00238	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00238"><\/a>00238         <span class="keywordflow">while<\/span> (ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> != NULL &amp;&amp; ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> != client) {$/;"	a
l00239	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00239"><\/a>00239             ptr = ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00240	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00240"><\/a>00240         }$/;"	a
l00241	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00241"><\/a>00241         <span class="comment">\/* If we reach the end before finding out element, complain. *\/<\/span>$/;"	a
l00242	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00242"><\/a>00242         <span class="keywordflow">if<\/span> (ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> == NULL) {$/;"	a
l00243	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00243"><\/a>00243             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Node to delete could not be found."<\/span>);$/;"	a
l00244	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00244"><\/a>00244         <span class="comment">\/* Free element. *\/<\/span>$/;"	a
l00245	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00245"><\/a>00245         } <span class="keywordflow">else<\/span> {$/;"	a
l00246	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00246"><\/a>00246             ptr-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> = client-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00247	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00247"><\/a>00247             _client_list_free_node(client);$/;"	a
l00248	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00248"><\/a>00248         }$/;"	a
l00249	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00249"><\/a>00249     }$/;"	a
l00250	install/share/doc/wifidog-20090925/html/client__list_8c-source.html	/^<a name="l00250"><\/a>00250 }$/;"	a
23155a3173c5be5b646686b61414ca62	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="23155a3173c5be5b646686b61414ca62"><\/a><!-- doxytag: member="client_list.c::client_list_find_by_token" ref="23155a3173c5be5b646686b61414ca62" args="(const char *token)" -->$/;"	a
2ed4f40f55bdc1314fe84ad835708be9	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2ed4f40f55bdc1314fe84ad835708be9"><\/a><!-- doxytag: member="client_list.c::firstclient" ref="2ed4f40f55bdc1314fe84ad835708be9" args="" -->$/;"	a
4d619ca71763380120ec60d4f9c7d084	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="4d619ca71763380120ec60d4f9c7d084"><\/a><!-- doxytag: member="client_list.c::client_get_first_client" ref="4d619ca71763380120ec60d4f9c7d084" args="(void)" -->$/;"	a
5d741b8940ddeaa92f3b17c7fd1dab7b	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="5d741b8940ddeaa92f3b17c7fd1dab7b"><\/a><!-- doxytag: member="client_list.c::client_list_find_by_mac" ref="5d741b8940ddeaa92f3b17c7fd1dab7b" args="(const char *mac)" -->$/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="client_list.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
65ad84da2af952d86d9ea8c326951911	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="65ad84da2af952d86d9ea8c326951911"><\/a><!-- doxytag: member="client_list.c::client_list_append" ref="65ad84da2af952d86d9ea8c326951911" args="(const char *ip, const char *mac, const char *token)" -->$/;"	a
6cb127e61a08a2910438c8d91272616a	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="6cb127e61a08a2910438c8d91272616a"><\/a><!-- doxytag: member="client_list.c::client_list_delete" ref="6cb127e61a08a2910438c8d91272616a" args="(t_client *client)" -->$/;"	a
6ef7c0e44163b7ad9ed0353b095c1bbb	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="6ef7c0e44163b7ad9ed0353b095c1bbb"><\/a><!-- doxytag: member="client_list.c::client_list_find" ref="6ef7c0e44163b7ad9ed0353b095c1bbb" args="(const char *ip, const char *mac)" -->$/;"	a
8d47e246eaa43b7e6216b0d698143dd3	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="8d47e246eaa43b7e6216b0d698143dd3"><\/a><!-- doxytag: member="client_list.c::client_list_find_by_ip" ref="8d47e246eaa43b7e6216b0d698143dd3" args="(const char *ip)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
cf3a49fca65510729cdefb2be7c1c45e	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cf3a49fca65510729cdefb2be7c1c45e"><\/a><!-- doxytag: member="client_list.c::_client_list_free_node" ref="cf3a49fca65510729cdefb2be7c1c45e" args="(t_client *client)" -->$/;"	a
d624b5c33e086131f3af7b52589f5fd1	install/share/doc/wifidog-20090925/html/client__list_8c.html	/^<a class="anchor" name="d624b5c33e086131f3af7b52589f5fd1"><\/a><!-- doxytag: member="client_list.c::client_list_init" ref="d624b5c33e086131f3af7b52589f5fd1" args="(void)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<h1>client_list.h<\/h1><a href="client__list_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: client_list.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _CLIENT_LIST_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _CLIENT_LIST_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00032"><\/a><a class="code" href="struct__t__counters.html">00032<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__t__counters.html">_t_counters<\/a> {$/;"	a
l00033	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00033"><\/a><a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063">00033<\/a>     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>  <a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>;       $/;"	a
l00034	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00034"><\/a><a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d">00034<\/a>     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>  <a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>;       $/;"	a
l00035	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00035"><\/a><a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9">00035<\/a>     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>  <a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a>;       $/;"	a
l00036	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00036"><\/a><a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba">00036<\/a>     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>  <a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a>;       $/;"	a
l00037	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1">00037<\/a>     time_t      <a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>;   $/;"	a
l00038	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00038"><\/a>00038 } <a class="code" href="struct__t__counters.html">t_counters<\/a>;$/;"	a
l00039	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00042	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="struct__t__client.html">00042<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct  <\/span><a class="code" href="struct__t__client.html">_t_client<\/a> {$/;"	a
l00043	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00043"><\/a><a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082">00043<\/a>   <span class="keyword">struct        <\/span><a class="code" href="struct__t__client.html">_t_client<\/a> *<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;        $/;"	a
l00044	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00044"><\/a><a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82">00044<\/a>         <span class="keywordtype">char<\/span>    *<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>;                    $/;"	a
l00045	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00045"><\/a><a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b">00045<\/a>         <span class="keywordtype">char<\/span>    *<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>;                   $/;"	a
l00046	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00046"><\/a><a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad">00046<\/a>         <span class="keywordtype">char<\/span>    *<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>;                 $/;"	a
l00047	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00047"><\/a><a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15">00047<\/a>         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span> <a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>; $/;"	a
l00049	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00049"><\/a><a class="code" href="struct__t__client.html#495baef8f1dc90c94c24561ebd61140d">00049<\/a>         <span class="keywordtype">int<\/span>     <a class="code" href="struct__t__client.html#495baef8f1dc90c94c24561ebd61140d" title="Client HTTP socket (valid only during login before one of the _http_* function is...">fd<\/a>;                     $/;"	a
l00052	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00052"><\/a><a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1">00052<\/a>         <a class="code" href="struct__t__counters.html">t_counters<\/a>      <a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>;       $/;"	a
l00054	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00054"><\/a>00054 } <a class="code" href="struct__t__client.html">t_client<\/a>;$/;"	a
l00055	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00055"><\/a>00055 $/;"	a
l00058	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00058"><\/a>00058 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00059	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00061	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="keywordtype">void<\/span> <a class="code" href="client__list_8c.html#d624b5c33e086131f3af7b52589f5fd1" title="Initializes the client list.">client_list_init<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00062	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00064	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00064"><\/a>00064 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#65ad84da2af952d86d9ea8c326951911" title="Adds a new client to the connections list.">client_list_append<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00065	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00065"><\/a>00065 $/;"	a
l00067	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00067"><\/a>00067 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00068	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00068"><\/a>00068 $/;"	a
l00070	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00070"><\/a>00070 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>); <span class="comment">\/* needed by fw_iptables.c, auth.c <\/span>$/;"	a
l00071	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00071"><\/a>00071 <span class="comment">                                             * and wdctl_thread.c *\/<\/span>$/;"	a
l00072	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00072"><\/a>00072 $/;"	a
l00074	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00074"><\/a>00074 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#5d741b8940ddeaa92f3b17c7fd1dab7b" title="Finds a client only by its Mac.">client_list_find_by_mac<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>); <span class="comment">\/* needed by wdctl_thread.c *\/<\/span>$/;"	a
l00075	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00075"><\/a>00075 $/;"	a
l00077	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00077"><\/a>00077 <a class="code" href="struct__t__client.html">t_client<\/a> *<a class="code" href="client__list_8c.html#23155a3173c5be5b646686b61414ca62" title="Finds a client by its token.">client_list_find_by_token<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00078	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00078"><\/a>00078 $/;"	a
l00080	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00080"><\/a>00080 <span class="keywordtype">void<\/span> <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(<a class="code" href="struct__t__client.html">t_client<\/a> *client);$/;"	a
l00081	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00081"><\/a>00081 $/;"	a
l00082	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00082"><\/a>00082 <span class="preprocessor">#define LOCK_CLIENT_LIST() do { \\<\/span>$/;"	a
l00083	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00083"><\/a>00083 <span class="preprocessor">        debug(LOG_DEBUG, "Locking client list"); \\<\/span>$/;"	a
l00084	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00084"><\/a>00084 <span class="preprocessor">        pthread_mutex_lock(&amp;client_list_mutex); \\<\/span>$/;"	a
l00085	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00085"><\/a>00085 <span class="preprocessor">        debug(LOG_DEBUG, "Client list locked"); \\<\/span>$/;"	a
l00086	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00086"><\/a>00086 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00087	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00087"><\/a>00087 <span class="preprocessor"><\/span>$/;"	a
l00088	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00088"><\/a>00088 <span class="preprocessor">#define UNLOCK_CLIENT_LIST() do { \\<\/span>$/;"	a
l00089	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00089"><\/a>00089 <span class="preprocessor">        debug(LOG_DEBUG, "Unlocking client list"); \\<\/span>$/;"	a
l00090	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00090"><\/a>00090 <span class="preprocessor">        pthread_mutex_unlock(&amp;client_list_mutex); \\<\/span>$/;"	a
l00091	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00091"><\/a>00091 <span class="preprocessor">        debug(LOG_DEBUG, "Client list unlocked"); \\<\/span>$/;"	a
l00092	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00092"><\/a>00092 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00093	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00093"><\/a>00093 <span class="preprocessor"><\/span>$/;"	a
l00094	install/share/doc/wifidog-20090925/html/client__list_8h-source.html	/^<a name="l00094"><\/a>00094 <span class="preprocessor">#endif <\/span><span class="comment">\/* _CLIENT_LIST_H_ *\/<\/span>$/;"	a
010e96c8cbdfb080d09b5822c5cccbf7	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="010e96c8cbdfb080d09b5822c5cccbf7"><\/a><!-- doxytag: member="client_list.h::t_client" ref="010e96c8cbdfb080d09b5822c5cccbf7" args="" -->$/;"	a
23155a3173c5be5b646686b61414ca62	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="23155a3173c5be5b646686b61414ca62"><\/a><!-- doxytag: member="client_list.h::client_list_find_by_token" ref="23155a3173c5be5b646686b61414ca62" args="(const char *token)" -->$/;"	a
4d619ca71763380120ec60d4f9c7d084	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="4d619ca71763380120ec60d4f9c7d084"><\/a><!-- doxytag: member="client_list.h::client_get_first_client" ref="4d619ca71763380120ec60d4f9c7d084" args="(void)" -->$/;"	a
4f5775440c8c60a619bb0dc6eefd9955	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="4f5775440c8c60a619bb0dc6eefd9955"><\/a><!-- doxytag: member="client_list.h::UNLOCK_CLIENT_LIST" ref="4f5775440c8c60a619bb0dc6eefd9955" args="()" -->$/;"	a
5d741b8940ddeaa92f3b17c7fd1dab7b	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="5d741b8940ddeaa92f3b17c7fd1dab7b"><\/a><!-- doxytag: member="client_list.h::client_list_find_by_mac" ref="5d741b8940ddeaa92f3b17c7fd1dab7b" args="(const char *mac)" -->$/;"	a
65ad84da2af952d86d9ea8c326951911	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="65ad84da2af952d86d9ea8c326951911"><\/a><!-- doxytag: member="client_list.h::client_list_append" ref="65ad84da2af952d86d9ea8c326951911" args="(const char *ip, const char *mac, const char *token)" -->$/;"	a
6cb127e61a08a2910438c8d91272616a	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="6cb127e61a08a2910438c8d91272616a"><\/a><!-- doxytag: member="client_list.h::client_list_delete" ref="6cb127e61a08a2910438c8d91272616a" args="(t_client *client)" -->$/;"	a
6ef7c0e44163b7ad9ed0353b095c1bbb	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="6ef7c0e44163b7ad9ed0353b095c1bbb"><\/a><!-- doxytag: member="client_list.h::client_list_find" ref="6ef7c0e44163b7ad9ed0353b095c1bbb" args="(const char *ip, const char *mac)" -->$/;"	a
854b711d92cda6b6567b46e5ba5585da	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="854b711d92cda6b6567b46e5ba5585da"><\/a><!-- doxytag: member="client_list.h::t_counters" ref="854b711d92cda6b6567b46e5ba5585da" args="" -->$/;"	a
8d47e246eaa43b7e6216b0d698143dd3	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="8d47e246eaa43b7e6216b0d698143dd3"><\/a><!-- doxytag: member="client_list.h::client_list_find_by_ip" ref="8d47e246eaa43b7e6216b0d698143dd3" args="(const char *ip)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
c5c31895744019997451a4f325a59cd1	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="c5c31895744019997451a4f325a59cd1"><\/a><!-- doxytag: member="client_list.h::LOCK_CLIENT_LIST" ref="c5c31895744019997451a4f325a59cd1" args="()" -->$/;"	a
d624b5c33e086131f3af7b52589f5fd1	install/share/doc/wifidog-20090925/html/client__list_8h.html	/^<a class="anchor" name="d624b5c33e086131f3af7b52589f5fd1"><\/a><!-- doxytag: member="client_list.h::client_list_init" ref="d624b5c33e086131f3af7b52589f5fd1" args="(void)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<h1>commandline.c<\/h1><a href="commandline_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: commandline.c 935 2006-02-01 03:22:04Z benoitg $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00032"><\/a>00032 $/;"	a
l00033	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00038"><\/a>00038 $/;"	a
l00039	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="comment">\/*<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="comment"> * Holds an argv that could be passed to exec*() if we restart ourselves<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="comment"> *\/<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="keywordtype">char<\/span> ** restartargv = NULL;$/;"	a
l00043	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00043"><\/a>00043 $/;"	a
l00044	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> usage(<span class="keywordtype">void<\/span>);$/;"	a
l00045	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="comment">\/*<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="comment"> * A flag to denote whether we were restarted via a parent wifidog, or started normally<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="comment"> * 0 means normally, otherwise it will be populated by the PID of the parent<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="comment"> *\/<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00050"><\/a>00050 pid_t restart_orig_pid = 0;$/;"	a
l00051	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00051"><\/a>00051 $/;"	a
l00057	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00058	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00058"><\/a>00058 usage(<span class="keywordtype">void<\/span>)$/;"	a
l00059	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00059"><\/a>00059 {$/;"	a
l00060	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00060"><\/a>00060     printf(<span class="stringliteral">"Usage: wifidog [options]\\n"<\/span>);$/;"	a
l00061	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00061"><\/a>00061     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00062	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00062"><\/a>00062     printf(<span class="stringliteral">"  -c [filename] Use this config file\\n"<\/span>);$/;"	a
l00063	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00063"><\/a>00063     printf(<span class="stringliteral">"  -f            Run in foreground\\n"<\/span>);$/;"	a
l00064	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00064"><\/a>00064     printf(<span class="stringliteral">"  -d &lt;level&gt;    Debug level\\n"<\/span>);$/;"	a
l00065	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00065"><\/a>00065     printf(<span class="stringliteral">"  -s            Log to syslog\\n"<\/span>);$/;"	a
l00066	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00066"><\/a>00066     printf(<span class="stringliteral">"  -w &lt;path&gt;     Wdctl socket path\\n"<\/span>);$/;"	a
l00067	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00067"><\/a>00067     printf(<span class="stringliteral">"  -h            Print usage\\n"<\/span>);$/;"	a
l00068	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00068"><\/a>00068     printf(<span class="stringliteral">"  -v            Print version information\\n"<\/span>);$/;"	a
l00069	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00069"><\/a>00069     printf(<span class="stringliteral">"  -x pid        Used internally by WiFiDog when re-starting itself *DO NOT ISSUE THIS SWITCH MANUAlLY*\\n"<\/span>);$/;"	a
l00070	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00070"><\/a>00070     printf(<span class="stringliteral">"  -i &lt;path&gt;     Internal socket path used when re-starting self\\n"<\/span>);$/;"	a
l00071	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00071"><\/a>00071     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00072	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00072"><\/a>00072 }$/;"	a
l00073	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00073"><\/a>00073 $/;"	a
l00077	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00077"><\/a><a class="code" href="wdctl_8c.html#0cebabb746a51732ec95bf81af215b63">00077<\/a> <span class="keywordtype">void<\/span> <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(<span class="keywordtype">int<\/span> argc, <span class="keywordtype">char<\/span> **argv) {$/;"	a
l00078	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00078"><\/a>00078     <span class="keywordtype">int<\/span> c;$/;"	a
l00079	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00079"><\/a>00079          <span class="keywordtype">int<\/span> skiponrestart;$/;"	a
l00080	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00080"><\/a>00080          <span class="keywordtype">int<\/span> i;$/;"	a
l00081	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00081"><\/a>00081 $/;"	a
l00082	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00082"><\/a>00082     <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00083	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00084"><\/a>00084         <span class="comment">\/\/MAGIC 3: Our own -x, the pid, and NULL :<\/span>$/;"	a
l00085	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00085"><\/a>00085         restartargv = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>((argc + 3) * <span class="keyword">sizeof<\/span>(<span class="keywordtype">char<\/span>*));$/;"	a
l00086	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00086"><\/a>00086         i=0;$/;"	a
l00087	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00087"><\/a>00087         restartargv[i++] = safe_strdup(argv[0]);$/;"	a
l00088	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00088"><\/a>00088 $/;"	a
l00089	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00089"><\/a>00089     <span class="keywordflow">while<\/span> (-1 != (c = getopt(argc, argv, <span class="stringliteral">"c:hfd:sw:vx:i:"<\/span>))) {$/;"	a
l00090	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00090"><\/a>00090 $/;"	a
l00091	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00091"><\/a>00091                 skiponrestart = 0;$/;"	a
l00092	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00092"><\/a>00092 $/;"	a
l00093	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00093"><\/a>00093                 <span class="keywordflow">switch<\/span>(c) {$/;"	a
l00094	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00094"><\/a>00094 $/;"	a
l00095	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00095"><\/a>00095                         <span class="keywordflow">case<\/span> <span class="charliteral">'h'<\/span>:$/;"	a
l00096	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00096"><\/a>00096                                 usage();$/;"	a
l00097	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00097"><\/a>00097                                 exit(1);$/;"	a
l00098	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00098"><\/a>00098                                 <span class="keywordflow">break<\/span>;$/;"	a
l00099	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00099"><\/a>00099 $/;"	a
l00100	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00100"><\/a>00100                         <span class="keywordflow">case<\/span> <span class="charliteral">'c'<\/span>:$/;"	a
l00101	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00101"><\/a>00101                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00102	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00102"><\/a>00102                                         strncpy(config-&gt;<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>, optarg, <span class="keyword">sizeof<\/span>(config-&gt;<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>));$/;"	a
l00103	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00103"><\/a>00103                                 }$/;"	a
l00104	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00104"><\/a>00104                                 <span class="keywordflow">break<\/span>;$/;"	a
l00105	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00105"><\/a>00105 $/;"	a
l00106	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00106"><\/a>00106                         <span class="keywordflow">case<\/span> <span class="charliteral">'w'<\/span>:$/;"	a
l00107	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00107"><\/a>00107                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00108	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00108"><\/a>00108                                         free(config-&gt;<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a>);$/;"	a
l00109	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00109"><\/a>00109                                         config-&gt;<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a> = safe_strdup(optarg);$/;"	a
l00110	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00110"><\/a>00110                                 }$/;"	a
l00111	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00111"><\/a>00111                                 <span class="keywordflow">break<\/span>;$/;"	a
l00112	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00112"><\/a>00112 $/;"	a
l00113	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00113"><\/a>00113                         <span class="keywordflow">case<\/span> <span class="charliteral">'f'<\/span>:$/;"	a
l00114	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00114"><\/a>00114                                 skiponrestart = 1;$/;"	a
l00115	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00115"><\/a>00115                                 config-&gt;<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> = 0;$/;"	a
l00116	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00116"><\/a>00116                                 <span class="keywordflow">break<\/span>;$/;"	a
l00117	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00117"><\/a>00117 $/;"	a
l00118	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00118"><\/a>00118                         <span class="keywordflow">case<\/span> <span class="charliteral">'d'<\/span>:$/;"	a
l00119	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00119"><\/a>00119                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00120	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00120"><\/a>00120                                         config-&gt;<a class="code" href="structs__config.html#72a375118114359c8fcf890bba1e77fb" title="Debug information verbosity.">debuglevel<\/a> = atoi(optarg);$/;"	a
l00121	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00121"><\/a>00121                                 }$/;"	a
l00122	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00122"><\/a>00122                                 <span class="keywordflow">break<\/span>;$/;"	a
l00123	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00123"><\/a>00123 $/;"	a
l00124	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00124"><\/a>00124                         <span class="keywordflow">case<\/span> <span class="charliteral">'s'<\/span>:$/;"	a
l00125	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00125"><\/a>00125                                 config-&gt;<a class="code" href="structs__config.html#784dd5fa3d27b3d1311b18f23e919362" title="boolean, wether to log to syslog">log_syslog<\/a> = 1;$/;"	a
l00126	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00126"><\/a>00126                                 <span class="keywordflow">break<\/span>;$/;"	a
l00127	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00127"><\/a>00127 $/;"	a
l00128	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00128"><\/a>00128                         <span class="keywordflow">case<\/span> <span class="charliteral">'v'<\/span>:$/;"	a
l00129	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00129"><\/a>00129                                 printf(<span class="stringliteral">"This is WiFiDog version "<\/span> VERSION <span class="stringliteral">"\\n"<\/span>);$/;"	a
l00130	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00130"><\/a>00130                                 exit(1);$/;"	a
l00131	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00131"><\/a>00131                                 <span class="keywordflow">break<\/span>;$/;"	a
l00132	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00132"><\/a>00132 $/;"	a
l00133	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00133"><\/a>00133                         <span class="keywordflow">case<\/span> <span class="charliteral">'x'<\/span>:$/;"	a
l00134	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00134"><\/a>00134                                 skiponrestart = 1;$/;"	a
l00135	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00135"><\/a>00135                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00136	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00136"><\/a>00136                                         restart_orig_pid = atoi(optarg);$/;"	a
l00137	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00137"><\/a>00137                                 }$/;"	a
l00138	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00138"><\/a>00138                                 <span class="keywordflow">else<\/span> {$/;"	a
l00139	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00139"><\/a>00139                                         printf(<span class="stringliteral">"The expected PID to the -x switch was not supplied!"<\/span>);$/;"	a
l00140	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00140"><\/a>00140                                         exit(1);$/;"	a
l00141	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00141"><\/a>00141                                 }$/;"	a
l00142	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00142"><\/a>00142                                 <span class="keywordflow">break<\/span>;$/;"	a
l00143	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00143"><\/a>00143 $/;"	a
l00144	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00144"><\/a>00144                         <span class="keywordflow">case<\/span> <span class="charliteral">'i'<\/span>:$/;"	a
l00145	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00145"><\/a>00145                                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00146	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00146"><\/a>00146                                         free(config-&gt;<a class="code" href="structs__config.html#132360d3c982b91fe0cdff6622eee1f1" title="internal path to socket">internal_sock<\/a>);$/;"	a
l00147	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00147"><\/a>00147                                         config-&gt;<a class="code" href="structs__config.html#132360d3c982b91fe0cdff6622eee1f1" title="internal path to socket">internal_sock<\/a> = safe_strdup(optarg);$/;"	a
l00148	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00148"><\/a>00148                                 }$/;"	a
l00149	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00149"><\/a>00149                                 <span class="keywordflow">break<\/span>;$/;"	a
l00150	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00150"><\/a>00150 $/;"	a
l00151	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00151"><\/a>00151                         <span class="keywordflow">default<\/span>:$/;"	a
l00152	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00152"><\/a>00152                                 usage();$/;"	a
l00153	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00153"><\/a>00153                                 exit(1);$/;"	a
l00154	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00154"><\/a>00154                                 <span class="keywordflow">break<\/span>;$/;"	a
l00155	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00155"><\/a>00155 $/;"	a
l00156	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00156"><\/a>00156                 }$/;"	a
l00157	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00157"><\/a>00157 $/;"	a
l00158	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00158"><\/a>00158                 <span class="keywordflow">if<\/span> (!skiponrestart) {$/;"	a
l00159	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00159"><\/a>00159                         <span class="comment">\/* Add it to restartargv *\/<\/span>$/;"	a
l00160	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00160"><\/a>00160                         safe_asprintf(&amp;(restartargv[i++]), <span class="stringliteral">"-%c"<\/span>, c);$/;"	a
l00161	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00161"><\/a>00161                         <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00162	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00162"><\/a>00162                                 restartargv[i++] = safe_strdup(optarg);$/;"	a
l00163	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00163"><\/a>00163                         }$/;"	a
l00164	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00164"><\/a>00164                 }$/;"	a
l00165	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00165"><\/a>00165 $/;"	a
l00166	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00166"><\/a>00166         }$/;"	a
l00167	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00167"><\/a>00167 $/;"	a
l00168	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00168"><\/a>00168         <span class="comment">\/* Finally, we should add  the -x, pid and NULL to restartargv<\/span>$/;"	a
l00169	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00169"><\/a>00169 <span class="comment">         * HOWEVER we cannot do it here, since this is called before we fork to background<\/span>$/;"	a
l00170	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00170"><\/a>00170 <span class="comment">         * so we'll leave this job to gateway.c after forking is completed<\/span>$/;"	a
l00171	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00171"><\/a>00171 <span class="comment">         * so that the correct PID is assigned<\/span>$/;"	a
l00172	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00172"><\/a>00172 <span class="comment">         *<\/span>$/;"	a
l00173	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00173"><\/a>00173 <span class="comment">         * We add 3 nulls, and the first 2 will be overridden later<\/span>$/;"	a
l00174	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00174"><\/a>00174 <span class="comment">         *\/<\/span>$/;"	a
l00175	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00175"><\/a>00175         restartargv[i++] = NULL;$/;"	a
l00176	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00176"><\/a>00176         restartargv[i++] = NULL;$/;"	a
l00177	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00177"><\/a>00177         restartargv[i++] = NULL;$/;"	a
l00178	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00178"><\/a>00178 $/;"	a
l00179	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00179"><\/a>00179 }$/;"	a
l00180	install/share/doc/wifidog-20090925/html/commandline_8c-source.html	/^<a name="l00180"><\/a>00180 $/;"	a
3c52dcc44643589b9f1039b576518dea	install/share/doc/wifidog-20090925/html/commandline_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3c52dcc44643589b9f1039b576518dea"><\/a><!-- doxytag: member="commandline.c::restartargv" ref="3c52dcc44643589b9f1039b576518dea" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/commandline_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b55a47ffb38b07a1c8d865c4821d52cc	install/share/doc/wifidog-20090925/html/commandline_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b55a47ffb38b07a1c8d865c4821d52cc"><\/a><!-- doxytag: member="commandline.c::restart_orig_pid" ref="b55a47ffb38b07a1c8d865c4821d52cc" args="" -->$/;"	a
d96d407a911fbb914fa8e4cfbf2faf0f	install/share/doc/wifidog-20090925/html/commandline_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d96d407a911fbb914fa8e4cfbf2faf0f"><\/a><!-- doxytag: member="commandline.c::usage" ref="d96d407a911fbb914fa8e4cfbf2faf0f" args="(void)" -->$/;"	a
e24d4b7fe84e05687b4c390ed8096b8a	install/share/doc/wifidog-20090925/html/commandline_8c.html	/^<a class="anchor" name="e24d4b7fe84e05687b4c390ed8096b8a"><\/a><!-- doxytag: member="commandline.c::parse_commandline" ref="e24d4b7fe84e05687b4c390ed8096b8a" args="(int argc, char **argv)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<h1>commandline.h<\/h1><a href="commandline_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: commandline.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _COMMANDLINE_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _COMMANDLINE_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="keywordtype">void<\/span> <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(<span class="keywordtype">int<\/span>, <span class="keywordtype">char<\/span>**);$/;"	a
l00032	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00032"><\/a>00032 $/;"	a
l00033	install/share/doc/wifidog-20090925/html/commandline_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#endif <\/span><span class="comment">\/* _COMMANDLINE_H_ *\/<\/span>$/;"	a
03b7907514bb723dea446381dbdf696d	install/share/doc/wifidog-20090925/html/commandline_8h.html	/^<a class="anchor" name="03b7907514bb723dea446381dbdf696d"><\/a><!-- doxytag: member="commandline.h::parse_commandline" ref="03b7907514bb723dea446381dbdf696d" args="(int, char **)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/commandline_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<h1>common.h<\/h1><a href="common_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: common.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _COMMON_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _COMMON_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00031"><\/a><a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc">00031<\/a> <span class="preprocessor">#define MAX_BUF 4096<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor"><\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/common_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#endif <\/span><span class="comment">\/* _COMMON_H_ *\/<\/span>$/;"	a
2491303d0fe260aaba8f46717cda66cc	install/share/doc/wifidog-20090925/html/common_8h.html	/^<a class="anchor" name="2491303d0fe260aaba8f46717cda66cc"><\/a><!-- doxytag: member="common.h::MAX_BUF" ref="2491303d0fe260aaba8f46717cda66cc" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/common_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<h1>conf.c<\/h1><a href="conf_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: conf.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00033"><\/a>00033 $/;"	a
l00034	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00035"><\/a>00035 $/;"	a
l00036	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;ctype.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00038"><\/a>00038 $/;"	a
l00039	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="http_8h.html" title="HTTP IO functions.">http.h<\/a>"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00046"><\/a>00046 $/;"	a
l00047	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00048"><\/a>00048 $/;"	a
l00051	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="keyword">static<\/span> <a class="code" href="structs__config.html">s_config<\/a> config;$/;"	a
l00052	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00056	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00056"><\/a><a class="code" href="wdctl__thread_8c.html#b374ff230d9977e6b952612d61689f39">00056<\/a> pthread_mutex_t <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a> = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00057	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00061	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00061"><\/a>00061 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> missing_parms;$/;"	a
l00062	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00065	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00065"><\/a>00065 <span class="keyword">typedef<\/span> <span class="keyword">enum<\/span> {$/;"	a
l00066	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00066"><\/a>00066         oBadOption,$/;"	a
l00067	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00067"><\/a>00067         oDaemon,$/;"	a
l00068	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00068"><\/a>00068         oDebugLevel,$/;"	a
l00069	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00069"><\/a>00069         oExternalInterface,$/;"	a
l00070	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00070"><\/a>00070         oGatewayID,$/;"	a
l00071	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00071"><\/a>00071         oGatewayInterface,$/;"	a
l00072	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00072"><\/a>00072         oGatewayAddress,$/;"	a
l00073	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00073"><\/a>00073         oGatewayPort,$/;"	a
l00074	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00074"><\/a>00074         oAuthServer,$/;"	a
l00075	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00075"><\/a>00075         oAuthServHostname,$/;"	a
l00076	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00076"><\/a>00076         oAuthServSSLAvailable,$/;"	a
l00077	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00077"><\/a>00077         oAuthServSSLPort,$/;"	a
l00078	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00078"><\/a>00078         oAuthServHTTPPort,$/;"	a
l00079	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00079"><\/a>00079         oAuthServPath,$/;"	a
l00080	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00080"><\/a>00080         oAuthServLoginScriptPathFragment,$/;"	a
l00081	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00081"><\/a>00081         oAuthServPortalScriptPathFragment,$/;"	a
l00082	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00082"><\/a>00082         oAuthServMsgScriptPathFragment,$/;"	a
l00083	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00083"><\/a>00083         oAuthServPingScriptPathFragment,$/;"	a
l00084	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00084"><\/a>00084         oAuthServAuthScriptPathFragment,$/;"	a
l00085	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00085"><\/a>00085         oHTTPDMaxConn,$/;"	a
l00086	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00086"><\/a>00086         oHTTPDName,$/;"	a
l00087	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00087"><\/a>00087         oHTTPDRealm,$/;"	a
l00088	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00088"><\/a>00088         oHTTPDUsername,$/;"	a
l00089	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00089"><\/a>00089         oHTTPDPassword,$/;"	a
l00090	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00090"><\/a>00090         oClientTimeout,$/;"	a
l00091	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00091"><\/a>00091         oCheckInterval,$/;"	a
l00092	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00092"><\/a>00092         oWdctlSocket,$/;"	a
l00093	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00093"><\/a>00093         oSyslogFacility,$/;"	a
l00094	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00094"><\/a>00094         oFirewallRule,$/;"	a
l00095	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00095"><\/a>00095         oFirewallRuleSet,$/;"	a
l00096	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00096"><\/a>00096         oTrustedMACList,$/;"	a
l00097	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00097"><\/a>00097         oHtmlMessageFile,$/;"	a
l00098	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00098"><\/a>00098 } OpCodes;$/;"	a
l00099	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00099"><\/a>00099 $/;"	a
l00102	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00102"><\/a>00102 <span class="keyword">static<\/span> <span class="keyword">const<\/span> <span class="keyword">struct <\/span>{$/;"	a
l00103	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00103"><\/a>00103         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *name;$/;"	a
l00104	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00104"><\/a>00104         OpCodes opcode;$/;"	a
l00105	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00105"><\/a>00105 } keywords[] = {$/;"	a
l00106	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00106"><\/a>00106         { <span class="stringliteral">"daemon"<\/span>,                     oDaemon },$/;"	a
l00107	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00107"><\/a>00107         { <span class="stringliteral">"debuglevel"<\/span>,                 oDebugLevel },$/;"	a
l00108	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00108"><\/a>00108         { <span class="stringliteral">"externalinterface"<\/span>,          oExternalInterface },$/;"	a
l00109	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00109"><\/a>00109         { <span class="stringliteral">"gatewayid"<\/span>,                  oGatewayID },$/;"	a
l00110	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00110"><\/a>00110         { <span class="stringliteral">"gatewayinterface"<\/span>,           oGatewayInterface },$/;"	a
l00111	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00111"><\/a>00111         { <span class="stringliteral">"gatewayaddress"<\/span>,             oGatewayAddress },$/;"	a
l00112	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00112"><\/a>00112         { <span class="stringliteral">"gatewayport"<\/span>,                oGatewayPort },$/;"	a
l00113	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00113"><\/a>00113         { <span class="stringliteral">"authserver"<\/span>,                 oAuthServer },$/;"	a
l00114	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00114"><\/a>00114         { <span class="stringliteral">"httpdmaxconn"<\/span>,               oHTTPDMaxConn },$/;"	a
l00115	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00115"><\/a>00115         { <span class="stringliteral">"httpdname"<\/span>,                  oHTTPDName },$/;"	a
l00116	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00116"><\/a>00116         { <span class="stringliteral">"httpdrealm"<\/span>,                 oHTTPDRealm },$/;"	a
l00117	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00117"><\/a>00117         { <span class="stringliteral">"httpdusername"<\/span>,              oHTTPDUsername },$/;"	a
l00118	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00118"><\/a>00118         { <span class="stringliteral">"httpdpassword"<\/span>,              oHTTPDPassword },$/;"	a
l00119	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00119"><\/a>00119         { <span class="stringliteral">"clienttimeout"<\/span>,              oClientTimeout },$/;"	a
l00120	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00120"><\/a>00120         { <span class="stringliteral">"checkinterval"<\/span>,              oCheckInterval },$/;"	a
l00121	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00121"><\/a>00121         { <span class="stringliteral">"syslogfacility"<\/span>,             oSyslogFacility },$/;"	a
l00122	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00122"><\/a>00122         { <span class="stringliteral">"wdctlsocket"<\/span>,                oWdctlSocket },$/;"	a
l00123	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00123"><\/a>00123         { <span class="stringliteral">"hostname"<\/span>,                   oAuthServHostname },$/;"	a
l00124	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00124"><\/a>00124         { <span class="stringliteral">"sslavailable"<\/span>,               oAuthServSSLAvailable },$/;"	a
l00125	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00125"><\/a>00125         { <span class="stringliteral">"sslport"<\/span>,                    oAuthServSSLPort },$/;"	a
l00126	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00126"><\/a>00126         { <span class="stringliteral">"httpport"<\/span>,                   oAuthServHTTPPort },$/;"	a
l00127	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00127"><\/a>00127         { <span class="stringliteral">"path"<\/span>,                       oAuthServPath },$/;"	a
l00128	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00128"><\/a>00128         { <span class="stringliteral">"loginscriptpathfragment"<\/span>,    oAuthServLoginScriptPathFragment },$/;"	a
l00129	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00129"><\/a>00129         { <span class="stringliteral">"portalscriptpathfragment"<\/span>,   oAuthServPortalScriptPathFragment },$/;"	a
l00130	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00130"><\/a>00130         { <span class="stringliteral">"msgscriptpathfragment"<\/span>,      oAuthServMsgScriptPathFragment },$/;"	a
l00131	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00131"><\/a>00131         { <span class="stringliteral">"pingscriptpathfragment"<\/span>,     oAuthServPingScriptPathFragment },$/;"	a
l00132	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00132"><\/a>00132         { <span class="stringliteral">"authscriptpathfragment"<\/span>,     oAuthServAuthScriptPathFragment },$/;"	a
l00133	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00133"><\/a>00133         { <span class="stringliteral">"firewallruleset"<\/span>,            oFirewallRuleSet },$/;"	a
l00134	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00134"><\/a>00134         { <span class="stringliteral">"firewallrule"<\/span>,               oFirewallRule },$/;"	a
l00135	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00135"><\/a>00135         { <span class="stringliteral">"trustedmaclist"<\/span>,             oTrustedMACList },$/;"	a
l00136	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00136"><\/a>00136         { <span class="stringliteral">"htmlmessagefile"<\/span>,            oHtmlMessageFile },$/;"	a
l00137	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00137"><\/a>00137         { NULL,                         oBadOption },$/;"	a
l00138	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00138"><\/a>00138 };$/;"	a
l00139	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00139"><\/a>00139 $/;"	a
l00140	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00140"><\/a>00140 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> config_notnull(<span class="keyword">const<\/span> <span class="keywordtype">void<\/span> *parm, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *parmname);$/;"	a
l00141	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00141"><\/a>00141 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> parse_boolean_value(<span class="keywordtype">char<\/span> *);$/;"	a
l00142	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00142"><\/a>00142 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> parse_auth_server(FILE *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keywordtype">int<\/span> *);$/;"	a
l00143	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00143"><\/a>00143 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> <a class="code" href="conf_8c.html#c10ca895b5a20b458c1599f8a9766f4d">_parse_firewall_rule<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset, <span class="keywordtype">char<\/span> *leftover);$/;"	a
l00144	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00144"><\/a>00144 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> parse_firewall_ruleset(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, FILE *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keywordtype">int<\/span> *);$/;"	a
l00145	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00145"><\/a>00145 $/;"	a
l00146	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00146"><\/a>00146 <span class="keyword">static<\/span> OpCodes config_parse_token(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *cp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> linenum);$/;"	a
l00147	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00147"><\/a>00147 $/;"	a
l00151	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00151"><\/a>00151 <a class="code" href="structs__config.html">s_config<\/a> *$/;"	a
l00152	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00152"><\/a><a class="code" href="conf_8h.html#64e73012596dd6628c18742c8046069f">00152<\/a> <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00153	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00153"><\/a>00153 {$/;"	a
l00154	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00154"><\/a>00154     <span class="keywordflow">return<\/span> &amp;config;$/;"	a
l00155	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00155"><\/a>00155 }$/;"	a
l00156	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00156"><\/a>00156 $/;"	a
l00158	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00158"><\/a>00158 <span class="keywordtype">void<\/span>$/;"	a
l00159	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00159"><\/a><a class="code" href="conf_8h.html#068a358868c409bbd99d7eef3c988866">00159<\/a> <a class="code" href="conf_8c.html#068a358868c409bbd99d7eef3c988866" title="Initialise the conf system.">config_init<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00160	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00160"><\/a>00160 {$/;"	a
l00161	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00161"><\/a>00161         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Setting default config parameters"<\/span>);$/;"	a
l00162	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00162"><\/a>00162         strncpy(config.<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>, <a class="code" href="conf_8h.html#0ec3017454ea7a8398d25c8ab83890fd">DEFAULT_CONFIGFILE<\/a>, <span class="keyword">sizeof<\/span>(config.<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>));$/;"	a
l00163	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00163"><\/a>00163         config.<a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6" title="name of the HTML file used for messages">htmlmsgfile<\/a> = safe_strdup(<a class="code" href="conf_8h.html#16581929d818bc322bbebce8a7a12117">DEFAULT_HTMLMSGFILE<\/a>);$/;"	a
l00164	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00164"><\/a>00164         config.<a class="code" href="structs__config.html#72a375118114359c8fcf890bba1e77fb" title="Debug information verbosity.">debuglevel<\/a> = <a class="code" href="conf_8h.html#32198b3d9cda9e7ea18d9680f805dc87">DEFAULT_DEBUGLEVEL<\/a>;$/;"	a
l00165	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00165"><\/a>00165         config.<a class="code" href="structs__config.html#7a24ca5b2cc1ff099bda0af17e654a95" title="Used by libhttpd, not sure what it does.">httpdmaxconn<\/a> = <a class="code" href="conf_8h.html#ca85302a5a857716f3b0275fbbff135f">DEFAULT_HTTPDMAXCONN<\/a>;$/;"	a
l00166	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00166"><\/a>00166         config.<a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62" title="External network interface name for firewall rules.">external_interface<\/a> = NULL;$/;"	a
l00167	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00167"><\/a>00167         config.<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a> = <a class="code" href="conf_8h.html#e38786151577e46b298b7baf0ca0fe96">DEFAULT_GATEWAYID<\/a>;$/;"	a
l00168	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00168"><\/a>00168         config.<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a> = NULL;$/;"	a
l00169	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00169"><\/a>00169         config.<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a> = NULL;$/;"	a
l00170	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00170"><\/a>00170         config.<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a> = <a class="code" href="conf_8h.html#f14cf5aa96a948b2d23a1ff0aeba3e48">DEFAULT_GATEWAYPORT<\/a>;$/;"	a
l00171	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00171"><\/a>00171         config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> = NULL;$/;"	a
l00172	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00172"><\/a>00172         config.<a class="code" href="structs__config.html#2ed9a59507be060fe0e1deae7fcc077b" title="Name the web server will return when replying to a request.">httpdname<\/a> = NULL;$/;"	a
l00173	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00173"><\/a>00173         config.<a class="code" href="structs__config.html#283515007953f307a7b599ee480b743d" title="HTTP Authentication realm.">httpdrealm<\/a> = <a class="code" href="conf_8h.html#af813a168a0bd5a77aa515073950a135">DEFAULT_HTTPDNAME<\/a>;$/;"	a
l00174	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00174"><\/a>00174         config.<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a> = NULL;$/;"	a
l00175	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00175"><\/a>00175         config.<a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5" title="Password for HTTP authentication.">httpdpassword<\/a> = NULL;$/;"	a
l00176	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00176"><\/a>00176         config.<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a> = <a class="code" href="conf_8h.html#1ea67d2117d4f50445d1c9428bac5a64">DEFAULT_CLIENTTIMEOUT<\/a>;$/;"	a
l00177	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00177"><\/a>00177         config.<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a> = <a class="code" href="conf_8h.html#9bcb72263ba584b1da18d3b2f2b65e6a">DEFAULT_CHECKINTERVAL<\/a>;$/;"	a
l00178	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00178"><\/a>00178         config.<a class="code" href="structs__config.html#eaad87f73a87a2f752b111dad813902d" title="facility to use when using syslog for logging">syslog_facility<\/a> = <a class="code" href="conf_8h.html#66cff01e093b0b7d5335a7939f839341">DEFAULT_SYSLOG_FACILITY<\/a>;$/;"	a
l00179	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00179"><\/a>00179         config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> = -1;$/;"	a
l00180	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00180"><\/a>00180         config.<a class="code" href="structs__config.html#784dd5fa3d27b3d1311b18f23e919362" title="boolean, wether to log to syslog">log_syslog<\/a> = <a class="code" href="conf_8h.html#41ce987eea16297a459249b1e4c69ed7">DEFAULT_LOG_SYSLOG<\/a>;$/;"	a
l00181	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00181"><\/a>00181         config.<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a> = safe_strdup(<a class="code" href="conf_8h.html#cee7c0173f525e29800b87222b407386">DEFAULT_WDCTL_SOCK<\/a>);$/;"	a
l00182	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00182"><\/a>00182         config.<a class="code" href="structs__config.html#132360d3c982b91fe0cdff6622eee1f1" title="internal path to socket">internal_sock<\/a> = safe_strdup(<a class="code" href="conf_8h.html#ea1d1da1ff4c9161109a81a0b1d6fd2c">DEFAULT_INTERNAL_SOCK<\/a>);$/;"	a
l00183	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00183"><\/a>00183         config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a> = NULL;$/;"	a
l00184	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00184"><\/a>00184         config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a> = NULL;$/;"	a
l00185	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00185"><\/a>00185 }$/;"	a
l00186	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00186"><\/a>00186 $/;"	a
l00190	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00190"><\/a>00190 <span class="keywordtype">void<\/span>$/;"	a
l00191	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00191"><\/a><a class="code" href="conf_8h.html#17b6b425f18de3865e44b534c1f1f1cc">00191<\/a> <a class="code" href="conf_8c.html#17b6b425f18de3865e44b534c1f1f1cc" title="Initialize the variables we override with the command line.">config_init_override<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00192	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00192"><\/a>00192 {$/;"	a
l00193	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00193"><\/a>00193     <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> == -1) config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> = <a class="code" href="conf_8h.html#c71029bbf7b0ee40ad72b17ff77f7896">DEFAULT_DAEMON<\/a>;$/;"	a
l00194	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00194"><\/a>00194 }$/;"	a
l00195	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00195"><\/a>00195 $/;"	a
l00199	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00199"><\/a>00199 <span class="keyword">static<\/span> OpCodes$/;"	a
l00200	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00200"><\/a>00200 config_parse_token(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *cp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> linenum)$/;"	a
l00201	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00201"><\/a>00201 {$/;"	a
l00202	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00202"><\/a>00202         <span class="keywordtype">int<\/span> i;$/;"	a
l00203	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00203"><\/a>00203 $/;"	a
l00204	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00204"><\/a>00204         <span class="keywordflow">for<\/span> (i = 0; keywords[i].name; i++)$/;"	a
l00205	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00205"><\/a>00205                 <span class="keywordflow">if<\/span> (strcasecmp(cp, keywords[i].name) == 0)$/;"	a
l00206	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00206"><\/a>00206                         <span class="keywordflow">return<\/span> keywords[i].opcode;$/;"	a
l00207	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00208"><\/a>00208         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"%s: line %d: Bad configuration option: %s"<\/span>, $/;"	a
l00209	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00209"><\/a>00209                         filename, linenum, cp);$/;"	a
l00210	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00210"><\/a>00210         <span class="keywordflow">return<\/span> oBadOption;$/;"	a
l00211	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00211"><\/a>00211 }$/;"	a
l00212	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00212"><\/a>00212 $/;"	a
l00216	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00216"><\/a>00216 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00217	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00217"><\/a>00217 parse_auth_server(FILE *file, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> *linenum)$/;"	a
l00218	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00218"><\/a>00218 {$/;"	a
l00219	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00219"><\/a>00219         <span class="keywordtype">char<\/span>            *host = NULL,$/;"	a
l00220	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00220"><\/a>00220                         *path = NULL,$/;"	a
l00221	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00221"><\/a>00221                         *loginscriptpathfragment = NULL,$/;"	a
l00222	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00222"><\/a>00222                         *portalscriptpathfragment = NULL,$/;"	a
l00223	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00223"><\/a>00223                         *msgscriptpathfragment = NULL,$/;"	a
l00224	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00224"><\/a>00224                         *pingscriptpathfragment = NULL,$/;"	a
l00225	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00225"><\/a>00225                         *authscriptpathfragment = NULL,$/;"	a
l00226	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00226"><\/a>00226                         line[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>],$/;"	a
l00227	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00227"><\/a>00227                         *p1,$/;"	a
l00228	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00228"><\/a>00228                         *p2;$/;"	a
l00229	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00229"><\/a>00229         <span class="keywordtype">int<\/span>             http_port,$/;"	a
l00230	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00230"><\/a>00230                         ssl_port,$/;"	a
l00231	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00231"><\/a>00231                         ssl_available,$/;"	a
l00232	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00232"><\/a>00232                         opcode;$/;"	a
l00233	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00233"><\/a>00233         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *<span class="keyword">new<\/span>,$/;"	a
l00234	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00234"><\/a>00234                         *tmp;$/;"	a
l00235	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00235"><\/a>00235 $/;"	a
l00236	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00236"><\/a>00236         <span class="comment">\/* Defaults *\/<\/span>$/;"	a
l00237	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00237"><\/a>00237         path = safe_strdup(<a class="code" href="conf_8h.html#d1127f95cef99fe1384a30fca8b9c392">DEFAULT_AUTHSERVPATH<\/a>);$/;"	a
l00238	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00238"><\/a>00238         loginscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#12e10b7db61ec0a23264d2a7762c6ef3">DEFAULT_AUTHSERVLOGINPATHFRAGMENT<\/a>);$/;"	a
l00239	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00239"><\/a>00239         portalscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#29ca3acd6665cd70286185f3dd4ab09d">DEFAULT_AUTHSERVPORTALPATHFRAGMENT<\/a>);$/;"	a
l00240	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00240"><\/a>00240         msgscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#d26385411b1807104fa1504dff7bfb0d">DEFAULT_AUTHSERVMSGPATHFRAGMENT<\/a>);$/;"	a
l00241	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00241"><\/a>00241         pingscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#11ea6dd746ca0526817bdd6515cbcc29">DEFAULT_AUTHSERVPINGPATHFRAGMENT<\/a>);$/;"	a
l00242	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00242"><\/a>00242         authscriptpathfragment = safe_strdup(<a class="code" href="conf_8h.html#f83da39ab6845671d9b1a2bf635951fa">DEFAULT_AUTHSERVAUTHPATHFRAGMENT<\/a>);$/;"	a
l00243	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00243"><\/a>00243         http_port = <a class="code" href="conf_8h.html#4468d0b44b441d03ea8270e09de86f65">DEFAULT_AUTHSERVPORT<\/a>;$/;"	a
l00244	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00244"><\/a>00244         ssl_port = <a class="code" href="conf_8h.html#eecec081c6ba90900777bc8db01f774f">DEFAULT_AUTHSERVSSLPORT<\/a>;$/;"	a
l00245	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00245"><\/a>00245         ssl_available = <a class="code" href="conf_8h.html#784fe164c1e4d1e62365a2505460592a">DEFAULT_AUTHSERVSSLAVAILABLE<\/a>;$/;"	a
l00246	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00246"><\/a>00246         $/;"	a
l00247	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00247"><\/a>00247         <span class="comment">\/* Read first line *\/<\/span>   $/;"	a
l00248	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00248"><\/a>00248         memset(line, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00249	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00249"><\/a>00249         fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - 1, file);$/;"	a
l00250	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00250"><\/a>00250         (*linenum)++; <span class="comment">\/* increment line counter. *\/<\/span>$/;"	a
l00251	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00251"><\/a>00251 $/;"	a
l00252	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00252"><\/a>00252         <span class="comment">\/* Parsing loop *\/<\/span>$/;"	a
l00253	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00253"><\/a>00253         <span class="keywordflow">while<\/span> ((line[0] != <span class="charliteral">'\\0'<\/span>) &amp;&amp; (strchr(line, <span class="charliteral">'}'<\/span>) == NULL)) {$/;"	a
l00254	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00254"><\/a>00254                 <span class="comment">\/* skip leading blank spaces *\/<\/span>$/;"	a
l00255	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00255"><\/a>00255                 <span class="keywordflow">for<\/span> (p1 = line; isblank(*p1); p1++);$/;"	a
l00256	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00256"><\/a>00256 $/;"	a
l00257	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00257"><\/a>00257                 <span class="comment">\/* End at end of line *\/<\/span>$/;"	a
l00258	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00258"><\/a>00258                 <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'#'<\/span>)) != NULL) {$/;"	a
l00259	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00259"><\/a>00259                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00260	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00260"><\/a>00260                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\r'<\/span>)) != NULL) {$/;"	a
l00261	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00261"><\/a>00261                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00262	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00262"><\/a>00262                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\n'<\/span>)) != NULL) {$/;"	a
l00263	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00263"><\/a>00263                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00264	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00264"><\/a>00264                 }$/;"	a
l00265	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00265"><\/a>00265 $/;"	a
l00266	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00266"><\/a>00266                 <span class="comment">\/* next, we coopt the parsing of the regular config *\/<\/span>$/;"	a
l00267	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00267"><\/a>00267                 <span class="keywordflow">if<\/span> (strlen(p1) &gt; 0) {$/;"	a
l00268	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00268"><\/a>00268                         p2 = p1;$/;"	a
l00269	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00269"><\/a>00269                         <span class="comment">\/* keep going until word boundary is found. *\/<\/span>$/;"	a
l00270	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00270"><\/a>00270                         <span class="keywordflow">while<\/span> ((*p2 != <span class="charliteral">'\\0'<\/span>) &amp;&amp; (!isblank(*p2)))$/;"	a
l00271	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00271"><\/a>00271                                 p2++;$/;"	a
l00272	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00272"><\/a>00272 $/;"	a
l00273	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00273"><\/a>00273                         <span class="comment">\/* Terminate first word. *\/<\/span>$/;"	a
l00274	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00274"><\/a>00274                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00275	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00275"><\/a>00275                         p2++;$/;"	a
l00276	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00276"><\/a>00276 $/;"	a
l00277	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00277"><\/a>00277                         <span class="comment">\/* skip all further blanks. *\/<\/span>$/;"	a
l00278	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00278"><\/a>00278                         <span class="keywordflow">while<\/span> (isblank(*p2))$/;"	a
l00279	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00279"><\/a>00279                                 p2++;$/;"	a
l00280	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00280"><\/a>00280                         $/;"	a
l00281	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00281"><\/a>00281                         <span class="comment">\/* Get opcode *\/<\/span>$/;"	a
l00282	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00282"><\/a>00282                         opcode = config_parse_token(p1, filename, *linenum);$/;"	a
l00283	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00283"><\/a>00283                         $/;"	a
l00284	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00284"><\/a>00284                         <span class="keywordflow">switch<\/span> (opcode) {$/;"	a
l00285	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00285"><\/a>00285                                 <span class="keywordflow">case<\/span> oAuthServHostname:$/;"	a
l00286	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00286"><\/a>00286                                         host = safe_strdup(p2);$/;"	a
l00287	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00287"><\/a>00287                                         <span class="keywordflow">break<\/span>;$/;"	a
l00288	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00288"><\/a>00288                                 <span class="keywordflow">case<\/span> oAuthServPath:$/;"	a
l00289	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00289"><\/a>00289                                         free(path);$/;"	a
l00290	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00290"><\/a>00290                                         path = safe_strdup(p2);$/;"	a
l00291	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00291"><\/a>00291                                         <span class="keywordflow">break<\/span>;$/;"	a
l00292	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00292"><\/a>00292                                 <span class="keywordflow">case<\/span> oAuthServLoginScriptPathFragment:$/;"	a
l00293	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00293"><\/a>00293                                         free(loginscriptpathfragment);$/;"	a
l00294	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00294"><\/a>00294                                         loginscriptpathfragment = safe_strdup(p2);$/;"	a
l00295	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00295"><\/a>00295                                         <span class="keywordflow">break<\/span>;                                  $/;"	a
l00296	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00296"><\/a>00296                                 <span class="keywordflow">case<\/span> oAuthServPortalScriptPathFragment:$/;"	a
l00297	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00297"><\/a>00297                                         free(portalscriptpathfragment);$/;"	a
l00298	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00298"><\/a>00298                                         portalscriptpathfragment = safe_strdup(p2);$/;"	a
l00299	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00299"><\/a>00299                                         <span class="keywordflow">break<\/span>;$/;"	a
l00300	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00300"><\/a>00300                                 <span class="keywordflow">case<\/span> oAuthServMsgScriptPathFragment:$/;"	a
l00301	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00301"><\/a>00301                                         free(msgscriptpathfragment);$/;"	a
l00302	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00302"><\/a>00302                                         msgscriptpathfragment = safe_strdup(p2);$/;"	a
l00303	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00303"><\/a>00303                                         <span class="keywordflow">break<\/span>;$/;"	a
l00304	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00304"><\/a>00304                                 <span class="keywordflow">case<\/span> oAuthServPingScriptPathFragment:$/;"	a
l00305	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00305"><\/a>00305                                         free(pingscriptpathfragment);$/;"	a
l00306	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00306"><\/a>00306                                         pingscriptpathfragment = safe_strdup(p2);$/;"	a
l00307	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00307"><\/a>00307                                         <span class="keywordflow">break<\/span>;                                  $/;"	a
l00308	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00308"><\/a>00308                                 <span class="keywordflow">case<\/span> oAuthServAuthScriptPathFragment:$/;"	a
l00309	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00309"><\/a>00309                                         free(authscriptpathfragment);$/;"	a
l00310	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00310"><\/a>00310                                         authscriptpathfragment = safe_strdup(p2);$/;"	a
l00311	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00311"><\/a>00311                                         <span class="keywordflow">break<\/span>;$/;"	a
l00312	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00312"><\/a>00312                                 <span class="keywordflow">case<\/span> oAuthServSSLPort:$/;"	a
l00313	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00313"><\/a>00313                                         ssl_port = atoi(p2);$/;"	a
l00314	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00314"><\/a>00314                                         <span class="keywordflow">break<\/span>;$/;"	a
l00315	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00315"><\/a>00315                                 <span class="keywordflow">case<\/span> oAuthServHTTPPort:$/;"	a
l00316	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00316"><\/a>00316                                         http_port = atoi(p2);$/;"	a
l00317	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00317"><\/a>00317                                         <span class="keywordflow">break<\/span>;$/;"	a
l00318	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00318"><\/a>00318                                 <span class="keywordflow">case<\/span> oAuthServSSLAvailable:$/;"	a
l00319	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00319"><\/a>00319                                         ssl_available = parse_boolean_value(p2);$/;"	a
l00320	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00320"><\/a>00320                                         <span class="keywordflow">if<\/span> (ssl_available &lt; 0)$/;"	a
l00321	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00321"><\/a>00321                                                 ssl_available = 0;$/;"	a
l00322	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00322"><\/a>00322                                         <span class="keywordflow">break<\/span>;$/;"	a
l00323	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00323"><\/a>00323                                 <span class="keywordflow">case<\/span> oBadOption:$/;"	a
l00324	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00324"><\/a>00324                                 <span class="keywordflow">default<\/span>:$/;"	a
l00325	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00325"><\/a>00325                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Bad option on line %d "<\/span>$/;"	a
l00326	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00326"><\/a>00326                                                         <span class="stringliteral">"in %s."<\/span>, *linenum,$/;"	a
l00327	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00327"><\/a>00327                                                         filename);$/;"	a
l00328	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00328"><\/a>00328                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Exiting..."<\/span>);$/;"	a
l00329	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00329"><\/a>00329                                         exit(-1);$/;"	a
l00330	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00330"><\/a>00330                                         <span class="keywordflow">break<\/span>;$/;"	a
l00331	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00331"><\/a>00331                         }$/;"	a
l00332	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00332"><\/a>00332                 }$/;"	a
l00333	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00333"><\/a>00333 $/;"	a
l00334	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00334"><\/a>00334                 <span class="comment">\/* Read next line *\/<\/span>$/;"	a
l00335	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00335"><\/a>00335                 memset(line, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00336	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00336"><\/a>00336                 fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - 1, file);$/;"	a
l00337	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00337"><\/a>00337                 (*linenum)++; <span class="comment">\/* increment line counter. *\/<\/span>$/;"	a
l00338	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00338"><\/a>00338         }$/;"	a
l00339	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00339"><\/a>00339 $/;"	a
l00340	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00340"><\/a>00340         <span class="comment">\/* only proceed if we have an host and a path *\/<\/span>$/;"	a
l00341	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00341"><\/a>00341         <span class="keywordflow">if<\/span> (host == NULL)$/;"	a
l00342	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00342"><\/a>00342                 <span class="keywordflow">return<\/span>;$/;"	a
l00343	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00343"><\/a>00343         $/;"	a
l00344	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00344"><\/a>00344         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Adding %s:%d (SSL: %d) %s to the auth server list"<\/span>,$/;"	a
l00345	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00345"><\/a>00345                         host, http_port, ssl_port, path);$/;"	a
l00346	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00346"><\/a>00346 $/;"	a
l00347	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00347"><\/a>00347         <span class="comment">\/* Allocate memory *\/<\/span>$/;"	a
l00348	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00348"><\/a>00348         <span class="keyword">new<\/span> = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>));$/;"	a
l00349	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00349"><\/a>00349         $/;"	a
l00350	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00350"><\/a>00350         <span class="comment">\/* Fill in struct *\/<\/span>$/;"	a
l00351	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00351"><\/a>00351         memset(<span class="keyword">new<\/span>, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>)); <span class="comment">\/*&lt; Fill all with NULL *\/<\/span>$/;"	a
l00352	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00352"><\/a>00352         <span class="keyword">new<\/span>-&gt;authserv_hostname = host;$/;"	a
l00353	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00353"><\/a>00353         <span class="keyword">new<\/span>-&gt;authserv_use_ssl = ssl_available;$/;"	a
l00354	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00354"><\/a>00354         <span class="keyword">new<\/span>-&gt;authserv_path = path;$/;"	a
l00355	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00355"><\/a>00355         <span class="keyword">new<\/span>-&gt;authserv_login_script_path_fragment = loginscriptpathfragment;$/;"	a
l00356	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00356"><\/a>00356         <span class="keyword">new<\/span>-&gt;authserv_portal_script_path_fragment = portalscriptpathfragment;$/;"	a
l00357	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00357"><\/a>00357         <span class="keyword">new<\/span>-&gt;authserv_msg_script_path_fragment = msgscriptpathfragment;    $/;"	a
l00358	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00358"><\/a>00358         <span class="keyword">new<\/span>-&gt;authserv_ping_script_path_fragment = pingscriptpathfragment;  $/;"	a
l00359	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00359"><\/a>00359         <span class="keyword">new<\/span>-&gt;authserv_auth_script_path_fragment = authscriptpathfragment;  $/;"	a
l00360	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00360"><\/a>00360         <span class="keyword">new<\/span>-&gt;authserv_http_port = http_port;$/;"	a
l00361	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00361"><\/a>00361         <span class="keyword">new<\/span>-&gt;authserv_ssl_port = ssl_port;$/;"	a
l00362	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00362"><\/a>00362         $/;"	a
l00363	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00363"><\/a>00363         <span class="comment">\/* If it's the first, add to config, else append to last server *\/<\/span>$/;"	a
l00364	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00364"><\/a>00364         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> == NULL) {$/;"	a
l00365	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00365"><\/a>00365                 config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> = <span class="keyword">new<\/span>;$/;"	a
l00366	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00366"><\/a>00366         } <span class="keywordflow">else<\/span> {$/;"	a
l00367	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00367"><\/a>00367                 <span class="keywordflow">for<\/span> (tmp = config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> != NULL;$/;"	a
l00368	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00368"><\/a>00368                                 tmp = tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>);$/;"	a
l00369	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00369"><\/a>00369                 tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> = <span class="keyword">new<\/span>;$/;"	a
l00370	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00370"><\/a>00370         }$/;"	a
l00371	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00371"><\/a>00371         $/;"	a
l00372	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00372"><\/a>00372         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Auth server added"<\/span>);$/;"	a
l00373	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00373"><\/a>00373 }$/;"	a
l00374	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00374"><\/a>00374 $/;"	a
l00384	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00384"><\/a><a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">00384<\/a> <span class="preprocessor">#define TO_NEXT_WORD(s, e) do { \\<\/span>$/;"	a
l00385	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00385"><\/a>00385 <span class="preprocessor">        while (*s != '\\0' &amp;&amp; !isblank(*s)) { \\<\/span>$/;"	a
l00386	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00386"><\/a>00386 <span class="preprocessor">                s++; \\<\/span>$/;"	a
l00387	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00387"><\/a>00387 <span class="preprocessor">        } \\<\/span>$/;"	a
l00388	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00388"><\/a>00388 <span class="preprocessor">        if (*s != '\\0') { \\<\/span>$/;"	a
l00389	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00389"><\/a>00389 <span class="preprocessor">                *s = '\\0'; \\<\/span>$/;"	a
l00390	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00390"><\/a>00390 <span class="preprocessor">                s++; \\<\/span>$/;"	a
l00391	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00391"><\/a>00391 <span class="preprocessor">                while (isblank(*s)) \\<\/span>$/;"	a
l00392	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00392"><\/a>00392 <span class="preprocessor">                        s++; \\<\/span>$/;"	a
l00393	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00393"><\/a>00393 <span class="preprocessor">        } else { \\<\/span>$/;"	a
l00394	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00394"><\/a>00394 <span class="preprocessor">                e = 1; \\<\/span>$/;"	a
l00395	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00395"><\/a>00395 <span class="preprocessor">        } \\<\/span>$/;"	a
l00396	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00396"><\/a>00396 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00397	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00397"><\/a>00397 <span class="preprocessor"><\/span>$/;"	a
l00401	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00401"><\/a>00401 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00402	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00402"><\/a>00402 parse_firewall_ruleset(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset, FILE *file, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> *linenum)$/;"	a
l00403	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00403"><\/a>00403 {$/;"	a
l00404	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00404"><\/a>00404         <span class="keywordtype">char<\/span>            line[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>],$/;"	a
l00405	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00405"><\/a>00405                         *p1,$/;"	a
l00406	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00406"><\/a>00406                         *p2;$/;"	a
l00407	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00407"><\/a>00407         <span class="keywordtype">int<\/span>             opcode;$/;"	a
l00408	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00408"><\/a>00408 $/;"	a
l00409	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00409"><\/a>00409         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Adding Firewall Rule Set %s"<\/span>, ruleset);$/;"	a
l00410	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00410"><\/a>00410         $/;"	a
l00411	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00411"><\/a>00411         <span class="comment">\/* Read first line *\/<\/span>   $/;"	a
l00412	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00412"><\/a>00412         memset(line, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00413	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00413"><\/a>00413         fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - 1, file);$/;"	a
l00414	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00414"><\/a>00414         (*linenum)++; <span class="comment">\/* increment line counter. *\/<\/span>$/;"	a
l00415	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00415"><\/a>00415 $/;"	a
l00416	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00416"><\/a>00416         <span class="comment">\/* Parsing loop *\/<\/span>$/;"	a
l00417	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00417"><\/a>00417         <span class="keywordflow">while<\/span> ((line[0] != <span class="charliteral">'\\0'<\/span>) &amp;&amp; (strchr(line, <span class="charliteral">'}'<\/span>) == NULL)) {$/;"	a
l00418	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00418"><\/a>00418                 <span class="comment">\/* skip leading blank spaces *\/<\/span>$/;"	a
l00419	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00419"><\/a>00419                 <span class="keywordflow">for<\/span> (p1 = line; isblank(*p1); p1++);$/;"	a
l00420	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00420"><\/a>00420 $/;"	a
l00421	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00421"><\/a>00421                 <span class="comment">\/* End at end of line *\/<\/span>$/;"	a
l00422	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00422"><\/a>00422                 <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'#'<\/span>)) != NULL) {$/;"	a
l00423	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00423"><\/a>00423                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00424	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00424"><\/a>00424                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\r'<\/span>)) != NULL) {$/;"	a
l00425	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00425"><\/a>00425                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00426	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00426"><\/a>00426                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\n'<\/span>)) != NULL) {$/;"	a
l00427	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00427"><\/a>00427                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00428	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00428"><\/a>00428                 }$/;"	a
l00429	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00429"><\/a>00429 $/;"	a
l00430	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00430"><\/a>00430                 <span class="comment">\/* next, we coopt the parsing of the regular config *\/<\/span>$/;"	a
l00431	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00431"><\/a>00431                 <span class="keywordflow">if<\/span> (strlen(p1) &gt; 0) {$/;"	a
l00432	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00432"><\/a>00432                         p2 = p1;$/;"	a
l00433	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00433"><\/a>00433                         <span class="comment">\/* keep going until word boundary is found. *\/<\/span>$/;"	a
l00434	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00434"><\/a>00434                         <span class="keywordflow">while<\/span> ((*p2 != <span class="charliteral">'\\0'<\/span>) &amp;&amp; (!isblank(*p2)))$/;"	a
l00435	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00435"><\/a>00435                                 p2++;$/;"	a
l00436	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00436"><\/a>00436 $/;"	a
l00437	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00437"><\/a>00437                         <span class="comment">\/* Terminate first word. *\/<\/span>$/;"	a
l00438	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00438"><\/a>00438                         *p2 = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00439	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00439"><\/a>00439                         p2++;$/;"	a
l00440	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00440"><\/a>00440 $/;"	a
l00441	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00441"><\/a>00441                         <span class="comment">\/* skip all further blanks. *\/<\/span>$/;"	a
l00442	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00442"><\/a>00442                         <span class="keywordflow">while<\/span> (isblank(*p2))$/;"	a
l00443	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00443"><\/a>00443                                 p2++;$/;"	a
l00444	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00444"><\/a>00444                         $/;"	a
l00445	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00445"><\/a>00445                         <span class="comment">\/* Get opcode *\/<\/span>$/;"	a
l00446	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00446"><\/a>00446                         opcode = config_parse_token(p1, filename, *linenum);$/;"	a
l00447	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00447"><\/a>00447 $/;"	a
l00448	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00448"><\/a>00448                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"p1 = [%s]; p2 = [%s]"<\/span>, p1, p2);$/;"	a
l00449	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00449"><\/a>00449                         $/;"	a
l00450	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00450"><\/a>00450                         <span class="keywordflow">switch<\/span> (opcode) {$/;"	a
l00451	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00451"><\/a>00451                                 <span class="keywordflow">case<\/span> oFirewallRule:$/;"	a
l00452	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00452"><\/a>00452                                         <a class="code" href="conf_8c.html#c10ca895b5a20b458c1599f8a9766f4d">_parse_firewall_rule<\/a>(ruleset, p2);$/;"	a
l00453	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00453"><\/a>00453                                         <span class="keywordflow">break<\/span>;$/;"	a
l00454	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00454"><\/a>00454 $/;"	a
l00455	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00455"><\/a>00455                                 <span class="keywordflow">case<\/span> oBadOption:$/;"	a
l00456	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00456"><\/a>00456                                 <span class="keywordflow">default<\/span>:$/;"	a
l00457	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00457"><\/a>00457                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Bad option on line %d "<\/span>$/;"	a
l00458	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00458"><\/a>00458                                                         <span class="stringliteral">"in %s."<\/span>, *linenum,$/;"	a
l00459	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00459"><\/a>00459                                                         filename);$/;"	a
l00460	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00460"><\/a>00460                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Exiting..."<\/span>);$/;"	a
l00461	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00461"><\/a>00461                                         exit(-1);$/;"	a
l00462	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00462"><\/a>00462                                         <span class="keywordflow">break<\/span>;$/;"	a
l00463	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00463"><\/a>00463                         }$/;"	a
l00464	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00464"><\/a>00464                 }$/;"	a
l00465	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00465"><\/a>00465 $/;"	a
l00466	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00466"><\/a>00466                 <span class="comment">\/* Read next line *\/<\/span>$/;"	a
l00467	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00467"><\/a>00467                 memset(line, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00468	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00468"><\/a>00468                 fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - 1, file);$/;"	a
l00469	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00469"><\/a>00469                 (*linenum)++; <span class="comment">\/* increment line counter. *\/<\/span>$/;"	a
l00470	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00470"><\/a>00470         }$/;"	a
l00471	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00471"><\/a>00471 $/;"	a
l00472	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00472"><\/a>00472         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Firewall Rule Set %s added."<\/span>, ruleset);$/;"	a
l00473	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00473"><\/a>00473 }$/;"	a
l00474	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00474"><\/a>00474 $/;"	a
l00478	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00478"><\/a>00478 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span>$/;"	a
l00479	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00479"><\/a><a class="code" href="conf_8c.html#c10ca895b5a20b458c1599f8a9766f4d">00479<\/a> <a class="code" href="conf_8c.html#c10ca895b5a20b458c1599f8a9766f4d">_parse_firewall_rule<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset, <span class="keywordtype">char<\/span> *leftover)$/;"	a
l00480	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00480"><\/a>00480 {$/;"	a
l00481	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00481"><\/a>00481         <span class="keywordtype">int<\/span> i;$/;"	a
l00482	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00482"><\/a>00482         <span class="keywordtype">int<\/span> block_allow = 0; $/;"	a
l00483	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00483"><\/a>00483         <span class="keywordtype">int<\/span> all_nums = 1; $/;"	a
l00484	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00484"><\/a>00484         <span class="keywordtype">int<\/span> finished = 0; $/;"	a
l00485	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00485"><\/a>00485         <span class="keywordtype">char<\/span> *token = NULL; $/;"	a
l00486	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00486"><\/a>00486         <span class="keywordtype">char<\/span> *port = NULL; $/;"	a
l00487	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00487"><\/a>00487         <span class="keywordtype">char<\/span> *protocol = NULL; $/;"	a
l00488	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00488"><\/a>00488         <span class="keywordtype">char<\/span> *mask = NULL; $/;"	a
l00489	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00489"><\/a>00489         <span class="keywordtype">char<\/span> *other_kw = NULL; $/;"	a
l00490	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00490"><\/a>00490         <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a> *tmpr;$/;"	a
l00491	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00491"><\/a>00491         <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a> *tmpr2;$/;"	a
l00492	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00492"><\/a>00492         <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *tmp;$/;"	a
l00493	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00493"><\/a>00493         <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *tmp2;$/;"	a
l00494	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00494"><\/a>00494 $/;"	a
l00495	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00495"><\/a>00495         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"leftover: %s"<\/span>, leftover);$/;"	a
l00496	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00496"><\/a>00496 $/;"	a
l00497	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00497"><\/a>00497         <span class="comment">\/* lower case *\/<\/span>$/;"	a
l00498	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00498"><\/a>00498         <span class="keywordflow">for<\/span> (i = 0; *(leftover + i) != <span class="charliteral">'\\0'<\/span>$/;"	a
l00499	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00499"><\/a>00499                         &amp;&amp; (*(leftover + i) = tolower((<span class="keywordtype">unsigned<\/span> <span class="keywordtype">char<\/span>)*(leftover + i))); i++);$/;"	a
l00500	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00500"><\/a>00500         $/;"	a
l00501	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00501"><\/a>00501         token = leftover;$/;"	a
l00502	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00502"><\/a>00502         <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00503	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00503"><\/a>00503         $/;"	a
l00504	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00504"><\/a>00504         <span class="comment">\/* Parse token *\/<\/span>$/;"	a
l00505	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00505"><\/a>00505         <span class="keywordflow">if<\/span> (!strcasecmp(token, <span class="stringliteral">"block"<\/span>) || finished) {$/;"	a
l00506	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00506"><\/a>00506                 block_allow = 0;$/;"	a
l00507	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00507"><\/a>00507         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (!strcasecmp(token, <span class="stringliteral">"allow"<\/span>)) {$/;"	a
l00508	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00508"><\/a>00508                 block_allow = 1;$/;"	a
l00509	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00509"><\/a>00509         } <span class="keywordflow">else<\/span> {$/;"	a
l00510	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00510"><\/a>00510                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid rule type %s, expecting "<\/span>$/;"	a
l00511	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00511"><\/a>00511                                 <span class="stringliteral">"\\"block\\" or \\"allow\\""<\/span>, token);$/;"	a
l00512	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00512"><\/a>00512                 <span class="keywordflow">return<\/span> -1;$/;"	a
l00513	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00513"><\/a>00513         }$/;"	a
l00514	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00514"><\/a>00514 $/;"	a
l00515	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00515"><\/a>00515         <span class="comment">\/* Parse the remainder *\/<\/span>$/;"	a
l00516	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00516"><\/a>00516         <span class="comment">\/* Get the protocol *\/<\/span>$/;"	a
l00517	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00517"><\/a>00517         <span class="keywordflow">if<\/span> (strncmp(leftover, <span class="stringliteral">"tcp"<\/span>, 3) == 0$/;"	a
l00518	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00518"><\/a>00518                         || strncmp(leftover, <span class="stringliteral">"udp"<\/span>, 3) == 0$/;"	a
l00519	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00519"><\/a>00519                         || strncmp(leftover, <span class="stringliteral">"icmp"<\/span>, 4) == 0) {$/;"	a
l00520	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00520"><\/a>00520                 protocol = leftover;$/;"	a
l00521	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00521"><\/a>00521                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00522	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00522"><\/a>00522         }$/;"	a
l00523	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00523"><\/a>00523 $/;"	a
l00524	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00524"><\/a>00524         <span class="comment">\/* should be exactly "port" *\/<\/span>$/;"	a
l00525	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00525"><\/a>00525         <span class="keywordflow">if<\/span> (strncmp(leftover, <span class="stringliteral">"port"<\/span>, 4) == 0) {$/;"	a
l00526	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00526"><\/a>00526                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00527	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00527"><\/a>00527                 <span class="comment">\/* Get port now *\/<\/span>$/;"	a
l00528	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00528"><\/a>00528                 port = leftover;$/;"	a
l00529	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00529"><\/a>00529                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00530	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00530"><\/a>00530                 <span class="keywordflow">for<\/span> (i = 0; *(port + i) != <span class="charliteral">'\\0'<\/span>; i++)$/;"	a
l00531	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00531"><\/a>00531                         <span class="keywordflow">if<\/span> (!isdigit((<span class="keywordtype">unsigned<\/span> <span class="keywordtype">char<\/span>)*(port + i)))$/;"	a
l00532	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00532"><\/a>00532                                 all_nums = 0; <span class="comment">\/*&lt; No longer only digits *\/<\/span>$/;"	a
l00533	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00533"><\/a>00533                 <span class="keywordflow">if<\/span> (!all_nums) {$/;"	a
l00534	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00534"><\/a>00534                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid port %s"<\/span>, port);$/;"	a
l00535	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00535"><\/a>00535                         <span class="keywordflow">return<\/span> -3; <span class="comment">\/*&lt; Fail *\/<\/span>$/;"	a
l00536	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00536"><\/a>00536                 }$/;"	a
l00537	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00537"><\/a>00537         }$/;"	a
l00538	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00538"><\/a>00538 $/;"	a
l00539	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00539"><\/a>00539         <span class="comment">\/* Now, further stuff is optional *\/<\/span>$/;"	a
l00540	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00540"><\/a>00540         <span class="keywordflow">if<\/span> (!finished) {$/;"	a
l00541	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00541"><\/a>00541                 <span class="comment">\/* should be exactly "to" *\/<\/span>$/;"	a
l00542	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00542"><\/a>00542                 other_kw = leftover;$/;"	a
l00543	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00543"><\/a>00543                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00544	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00544"><\/a>00544                 <span class="keywordflow">if<\/span> (strcmp(other_kw, <span class="stringliteral">"to"<\/span>) || finished) {$/;"	a
l00545	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00545"><\/a>00545                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid or unexpected keyword %s, "<\/span>$/;"	a
l00546	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00546"><\/a>00546                                         <span class="stringliteral">"expecting \\"to\\""<\/span>, other_kw);$/;"	a
l00547	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00547"><\/a>00547                         <span class="keywordflow">return<\/span> -4; <span class="comment">\/*&lt; Fail *\/<\/span>$/;"	a
l00548	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00548"><\/a>00548                 }$/;"	a
l00549	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00549"><\/a>00549 $/;"	a
l00550	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00550"><\/a>00550                 <span class="comment">\/* Get port now *\/<\/span>$/;"	a
l00551	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00551"><\/a>00551                 mask = leftover;$/;"	a
l00552	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00552"><\/a>00552                 <a class="code" href="conf_8c.html#9934c7def687e5ed242049cb2a46eb73">TO_NEXT_WORD<\/a>(leftover, finished);$/;"	a
l00553	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00553"><\/a>00553                 all_nums = 1;$/;"	a
l00554	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00554"><\/a>00554                 <span class="keywordflow">for<\/span> (i = 0; *(mask + i) != <span class="charliteral">'\\0'<\/span>; i++)$/;"	a
l00555	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00555"><\/a>00555                         <span class="keywordflow">if<\/span> (!isdigit((<span class="keywordtype">unsigned<\/span> <span class="keywordtype">char<\/span>)*(mask + i)) &amp;&amp; (*(mask + i) != <span class="charliteral">'.'<\/span>)$/;"	a
l00556	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00556"><\/a>00556                                         &amp;&amp; (*(mask + i) != <span class="charliteral">'\/'<\/span>))$/;"	a
l00557	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00557"><\/a>00557                                 all_nums = 0; <span class="comment">\/*&lt; No longer only digits *\/<\/span>$/;"	a
l00558	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00558"><\/a>00558                 <span class="keywordflow">if<\/span> (!all_nums) {$/;"	a
l00559	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00559"><\/a>00559                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid mask %s"<\/span>, mask);$/;"	a
l00560	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00560"><\/a>00560                         <span class="keywordflow">return<\/span> -3; <span class="comment">\/*&lt; Fail *\/<\/span>$/;"	a
l00561	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00561"><\/a>00561                 }$/;"	a
l00562	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00562"><\/a>00562         }$/;"	a
l00563	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00563"><\/a>00563 $/;"	a
l00564	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00564"><\/a>00564         <span class="comment">\/* Generate rule record *\/<\/span>$/;"	a
l00565	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00565"><\/a>00565         tmp = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>));$/;"	a
l00566	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00566"><\/a>00566         memset((<span class="keywordtype">void<\/span> *)tmp, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>));$/;"	a
l00567	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00567"><\/a>00567         tmp-&gt;block_allow = block_allow;$/;"	a
l00568	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00568"><\/a>00568         <span class="keywordflow">if<\/span> (protocol != NULL)$/;"	a
l00569	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00569"><\/a>00569                 tmp-&gt;protocol = safe_strdup(protocol);$/;"	a
l00570	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00570"><\/a>00570         <span class="keywordflow">if<\/span> (port != NULL)$/;"	a
l00571	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00571"><\/a>00571                 tmp-&gt;port = safe_strdup(port);$/;"	a
l00572	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00572"><\/a>00572         <span class="keywordflow">if<\/span> (mask == NULL)$/;"	a
l00573	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00573"><\/a>00573                 tmp-&gt;mask = safe_strdup(<span class="stringliteral">"0.0.0.0\/0"<\/span>);$/;"	a
l00574	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00574"><\/a>00574         <span class="keywordflow">else<\/span>$/;"	a
l00575	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00575"><\/a>00575                 tmp-&gt;mask = safe_strdup(mask);$/;"	a
l00576	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00576"><\/a>00576 $/;"	a
l00577	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00577"><\/a>00577         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Adding Firewall Rule %s %s port %s to %s"<\/span>, token, tmp-&gt;protocol, tmp-&gt;port, tmp-&gt;mask);$/;"	a
l00578	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00578"><\/a>00578         $/;"	a
l00579	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00579"><\/a>00579         <span class="comment">\/* Append the rule record *\/<\/span>$/;"	a
l00580	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00580"><\/a>00580         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a> == NULL) {$/;"	a
l00581	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00581"><\/a>00581                 config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a> = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>));$/;"	a
l00582	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00582"><\/a>00582                 memset(config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>));$/;"	a
l00583	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00583"><\/a>00583                 config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>-&gt;<a class="code" href="struct__firewall__ruleset__t.html#01cf836d509e646ac7fee6d5ac791ead">name<\/a> = safe_strdup(ruleset);$/;"	a
l00584	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00584"><\/a>00584                 tmpr = config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>;$/;"	a
l00585	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00585"><\/a>00585         } <span class="keywordflow">else<\/span> {$/;"	a
l00586	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00586"><\/a>00586                 tmpr2 = tmpr = config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>;$/;"	a
l00587	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00587"><\/a>00587                 <span class="keywordflow">while<\/span> (tmpr != NULL &amp;&amp; (strcmp(tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#01cf836d509e646ac7fee6d5ac791ead">name<\/a>, ruleset) != 0)) {$/;"	a
l00588	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00588"><\/a>00588                         tmpr2 = tmpr;$/;"	a
l00589	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00589"><\/a>00589                         tmpr = tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#51556fca7d717b95a9b53695bfd0c07a">next<\/a>;$/;"	a
l00590	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00590"><\/a>00590                 }$/;"	a
l00591	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00591"><\/a>00591                 <span class="keywordflow">if<\/span> (tmpr == NULL) {$/;"	a
l00592	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00592"><\/a>00592                         <span class="comment">\/* Rule did not exist *\/<\/span>$/;"	a
l00593	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00593"><\/a>00593                         tmpr = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>));$/;"	a
l00594	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00594"><\/a>00594                         memset(tmpr, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>));$/;"	a
l00595	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00595"><\/a>00595                         tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#01cf836d509e646ac7fee6d5ac791ead">name<\/a> = safe_strdup(ruleset);$/;"	a
l00596	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00596"><\/a>00596                         tmpr2-&gt;<a class="code" href="struct__firewall__ruleset__t.html#51556fca7d717b95a9b53695bfd0c07a">next<\/a> = tmpr;$/;"	a
l00597	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00597"><\/a>00597                 }$/;"	a
l00598	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00598"><\/a>00598         }$/;"	a
l00599	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00599"><\/a>00599 $/;"	a
l00600	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00600"><\/a>00600         <span class="comment">\/* At this point, tmpr == current ruleset *\/<\/span>$/;"	a
l00601	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00601"><\/a>00601         <span class="keywordflow">if<\/span> (tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#ee34ad9758267b6ae770681d6017a4a7">rules<\/a> == NULL) {$/;"	a
l00602	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00602"><\/a>00602                 <span class="comment">\/* No rules... *\/<\/span>$/;"	a
l00603	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00603"><\/a>00603                 tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#ee34ad9758267b6ae770681d6017a4a7">rules<\/a> = tmp;$/;"	a
l00604	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00604"><\/a>00604         } <span class="keywordflow">else<\/span> {$/;"	a
l00605	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00605"><\/a>00605                 tmp2 = tmpr-&gt;<a class="code" href="struct__firewall__ruleset__t.html#ee34ad9758267b6ae770681d6017a4a7">rules<\/a>;$/;"	a
l00606	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00606"><\/a>00606                 <span class="keywordflow">while<\/span> (tmp2-&gt;<a class="code" href="struct__firewall__rule__t.html#46cf31ace7a4781cd8f67fbf3c8f75de">next<\/a> != NULL)$/;"	a
l00607	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00607"><\/a>00607                         tmp2 = tmp2-&gt;<a class="code" href="struct__firewall__rule__t.html#46cf31ace7a4781cd8f67fbf3c8f75de">next<\/a>;$/;"	a
l00608	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00608"><\/a>00608                 tmp2-&gt;<a class="code" href="struct__firewall__rule__t.html#46cf31ace7a4781cd8f67fbf3c8f75de">next<\/a> = tmp;$/;"	a
l00609	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00609"><\/a>00609         }$/;"	a
l00610	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00610"><\/a>00610         $/;"	a
l00611	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00611"><\/a>00611         <span class="keywordflow">return<\/span> 1;$/;"	a
l00612	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00612"><\/a>00612 }$/;"	a
l00613	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00613"><\/a>00613 $/;"	a
l00614	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00614"><\/a>00614 <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *$/;"	a
l00615	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00615"><\/a><a class="code" href="conf_8h.html#545ee1dadc18a259ffd0d798f999ddc3">00615<\/a> <a class="code" href="conf_8c.html#617ad9199f2b10b95498f4f15c67c66d" title="Fetch a firewall rule set.">get_ruleset<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset)$/;"	a
l00616	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00616"><\/a>00616 {$/;"	a
l00617	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00617"><\/a>00617         <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>      *tmp;$/;"	a
l00618	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00618"><\/a>00618 $/;"	a
l00619	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00619"><\/a>00619         <span class="keywordflow">for<\/span> (tmp = config.<a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4" title="firewall rules">rulesets<\/a>; tmp != NULL$/;"	a
l00620	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00620"><\/a>00620                         &amp;&amp; strcmp(tmp-&gt;<a class="code" href="struct__firewall__ruleset__t.html#01cf836d509e646ac7fee6d5ac791ead">name<\/a>, ruleset) != 0; tmp = tmp-&gt;<a class="code" href="struct__firewall__ruleset__t.html#51556fca7d717b95a9b53695bfd0c07a">next<\/a>);$/;"	a
l00621	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00621"><\/a>00621 $/;"	a
l00622	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00622"><\/a>00622         <span class="keywordflow">if<\/span> (tmp == NULL)$/;"	a
l00623	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00623"><\/a>00623                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00624	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00624"><\/a>00624 $/;"	a
l00625	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00625"><\/a>00625         <span class="keywordflow">return<\/span>(tmp-&gt;<a class="code" href="struct__firewall__ruleset__t.html#ee34ad9758267b6ae770681d6017a4a7">rules<\/a>);$/;"	a
l00626	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00626"><\/a>00626 }$/;"	a
l00627	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00627"><\/a>00627 $/;"	a
l00631	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00631"><\/a>00631 <span class="keywordtype">void<\/span>$/;"	a
l00632	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00632"><\/a><a class="code" href="conf_8h.html#d3faac0efa0ac4c1032c0c54f7e93711">00632<\/a> <a class="code" href="conf_8c.html#d3faac0efa0ac4c1032c0c54f7e93711" title="Reads the configuration file.">config_read<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename)$/;"	a
l00633	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00633"><\/a>00633 {$/;"	a
l00634	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00634"><\/a>00634         FILE *fd;$/;"	a
l00635	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00635"><\/a>00635         <span class="keywordtype">char<\/span> line[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>], *s, *p1, *p2;$/;"	a
l00636	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00636"><\/a>00636         <span class="keywordtype">int<\/span> linenum = 0, opcode, value;$/;"	a
l00637	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00637"><\/a>00637 $/;"	a
l00638	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00638"><\/a>00638         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Reading configuration file '%s'"<\/span>, filename);$/;"	a
l00639	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00639"><\/a>00639 $/;"	a
l00640	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00640"><\/a>00640         <span class="keywordflow">if<\/span> (!(fd = fopen(filename, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00641	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00641"><\/a>00641                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not open configuration file '%s', "<\/span>$/;"	a
l00642	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00642"><\/a>00642                                 <span class="stringliteral">"exiting..."<\/span>, filename);$/;"	a
l00643	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00643"><\/a>00643                 exit(1);$/;"	a
l00644	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00644"><\/a>00644         }$/;"	a
l00645	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00645"><\/a>00645 $/;"	a
l00646	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00646"><\/a>00646         <span class="keywordflow">while<\/span> (!feof(fd) &amp;&amp; fgets(line, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>, fd)) {$/;"	a
l00647	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00647"><\/a>00647                 linenum++;$/;"	a
l00648	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00648"><\/a>00648                 s = line;$/;"	a
l00649	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00649"><\/a>00649 $/;"	a
l00650	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00650"><\/a>00650                 <span class="keywordflow">if<\/span> (s[strlen(s) - 1] == <span class="charliteral">'\\n'<\/span>)$/;"	a
l00651	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00651"><\/a>00651                         s[strlen(s) - 1] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00652	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00652"><\/a>00652 $/;"	a
l00653	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00653"><\/a>00653                 <span class="keywordflow">if<\/span> ((p1 = strchr(s, <span class="charliteral">' '<\/span>))) {$/;"	a
l00654	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00654"><\/a>00654                         p1[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00655	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00655"><\/a>00655                 } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p1 = strchr(s, <span class="charliteral">'\\t'<\/span>))) {$/;"	a
l00656	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00656"><\/a>00656                         p1[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00657	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00657"><\/a>00657                 }$/;"	a
l00658	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00658"><\/a>00658 $/;"	a
l00659	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00659"><\/a>00659                 <span class="keywordflow">if<\/span> (p1) {$/;"	a
l00660	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00660"><\/a>00660                         p1++;$/;"	a
l00661	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00661"><\/a>00661 $/;"	a
l00662	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00662"><\/a>00662                         <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">' '<\/span>))) {$/;"	a
l00663	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00663"><\/a>00663                                 p2[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00664	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00664"><\/a>00664                         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strstr(p1, <span class="stringliteral">"\\r\\n"<\/span>))) {$/;"	a
l00665	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00665"><\/a>00665                                 p2[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00666	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00666"><\/a>00666                         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((p2 = strchr(p1, <span class="charliteral">'\\n'<\/span>))) {$/;"	a
l00667	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00667"><\/a>00667                                 p2[0] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00668	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00668"><\/a>00668                         }$/;"	a
l00669	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00669"><\/a>00669                 }$/;"	a
l00670	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00670"><\/a>00670 $/;"	a
l00671	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00671"><\/a>00671                 <span class="keywordflow">if<\/span> (p1 &amp;&amp; p1[0] != <span class="charliteral">'\\0'<\/span>) {$/;"	a
l00672	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00672"><\/a>00672                         <span class="comment">\/* Strip trailing spaces *\/<\/span>$/;"	a
l00673	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00673"><\/a>00673 $/;"	a
l00674	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00674"><\/a>00674                         <span class="keywordflow">if<\/span> ((strncmp(s, <span class="stringliteral">"#"<\/span>, 1)) != 0) {$/;"	a
l00675	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00675"><\/a>00675                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Parsing token: %s, "<\/span>$/;"	a
l00676	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00676"><\/a>00676                                                 <span class="stringliteral">"value: %s"<\/span>, s, p1);$/;"	a
l00677	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00677"><\/a>00677                                 opcode = config_parse_token(s, filename, linenum);$/;"	a
l00678	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00678"><\/a>00678 $/;"	a
l00679	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00679"><\/a>00679                                 <span class="keywordflow">switch<\/span>(opcode) {$/;"	a
l00680	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00680"><\/a>00680                                 <span class="keywordflow">case<\/span> oDaemon:$/;"	a
l00681	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00681"><\/a>00681                                         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> == -1 &amp;&amp; ((value = parse_boolean_value(p1)) != -1)) {$/;"	a
l00682	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00682"><\/a>00682                                                 config.<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a> = value;$/;"	a
l00683	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00683"><\/a>00683                                         }$/;"	a
l00684	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00684"><\/a>00684                                         <span class="keywordflow">break<\/span>;$/;"	a
l00685	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00685"><\/a>00685                                 <span class="keywordflow">case<\/span> oExternalInterface:$/;"	a
l00686	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00686"><\/a>00686                                         config.<a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62" title="External network interface name for firewall rules.">external_interface<\/a> = safe_strdup(p1);$/;"	a
l00687	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00687"><\/a>00687                                         <span class="keywordflow">break<\/span>;$/;"	a
l00688	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00688"><\/a>00688                                 <span class="keywordflow">case<\/span> oGatewayID:$/;"	a
l00689	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00689"><\/a>00689                                         config.<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a> = safe_strdup(p1);$/;"	a
l00690	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00690"><\/a>00690                                         <span class="keywordflow">break<\/span>;$/;"	a
l00691	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00691"><\/a>00691                                 <span class="keywordflow">case<\/span> oGatewayInterface:$/;"	a
l00692	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00692"><\/a>00692                                         config.<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a> = safe_strdup(p1);$/;"	a
l00693	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00693"><\/a>00693                                         <span class="keywordflow">break<\/span>;$/;"	a
l00694	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00694"><\/a>00694                                 <span class="keywordflow">case<\/span> oGatewayAddress:$/;"	a
l00695	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00695"><\/a>00695                                         config.<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a> = safe_strdup(p1);$/;"	a
l00696	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00696"><\/a>00696                                         <span class="keywordflow">break<\/span>;$/;"	a
l00697	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00697"><\/a>00697                                 <span class="keywordflow">case<\/span> oGatewayPort:$/;"	a
l00698	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00698"><\/a>00698                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>);$/;"	a
l00699	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00699"><\/a>00699                                         <span class="keywordflow">break<\/span>;$/;"	a
l00700	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00700"><\/a>00700                                 <span class="keywordflow">case<\/span> oAuthServer:$/;"	a
l00701	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00701"><\/a>00701                                         parse_auth_server(fd, filename,$/;"	a
l00702	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00702"><\/a>00702                                                         &amp;linenum);$/;"	a
l00703	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00703"><\/a>00703                                         <span class="keywordflow">break<\/span>;$/;"	a
l00704	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00704"><\/a>00704                                 <span class="keywordflow">case<\/span> oFirewallRuleSet:$/;"	a
l00705	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00705"><\/a>00705                                         parse_firewall_ruleset(p1, fd, filename, &amp;linenum);$/;"	a
l00706	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00706"><\/a>00706                                         <span class="keywordflow">break<\/span>;$/;"	a
l00707	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00707"><\/a>00707                                 <span class="keywordflow">case<\/span> oTrustedMACList:$/;"	a
l00708	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00708"><\/a>00708                                         parse_trusted_mac_list(p1);$/;"	a
l00709	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00709"><\/a>00709                                         <span class="keywordflow">break<\/span>;$/;"	a
l00710	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00710"><\/a>00710                                 <span class="keywordflow">case<\/span> oHTTPDName:$/;"	a
l00711	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00711"><\/a>00711                                         config.<a class="code" href="structs__config.html#2ed9a59507be060fe0e1deae7fcc077b" title="Name the web server will return when replying to a request.">httpdname<\/a> = safe_strdup(p1);$/;"	a
l00712	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00712"><\/a>00712                                         <span class="keywordflow">break<\/span>;$/;"	a
l00713	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00713"><\/a>00713                                 <span class="keywordflow">case<\/span> oHTTPDMaxConn:$/;"	a
l00714	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00714"><\/a>00714                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#7a24ca5b2cc1ff099bda0af17e654a95" title="Used by libhttpd, not sure what it does.">httpdmaxconn<\/a>);$/;"	a
l00715	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00715"><\/a>00715                                         <span class="keywordflow">break<\/span>;$/;"	a
l00716	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00716"><\/a>00716                                 <span class="keywordflow">case<\/span> oHTTPDRealm:$/;"	a
l00717	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00717"><\/a>00717                                         config.<a class="code" href="structs__config.html#283515007953f307a7b599ee480b743d" title="HTTP Authentication realm.">httpdrealm<\/a> = safe_strdup(p1);$/;"	a
l00718	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00718"><\/a>00718                                         <span class="keywordflow">break<\/span>;$/;"	a
l00719	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00719"><\/a>00719                                 <span class="keywordflow">case<\/span> oHTTPDUsername:$/;"	a
l00720	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00720"><\/a>00720                                         config.<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a> = safe_strdup(p1);$/;"	a
l00721	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00721"><\/a>00721                                         <span class="keywordflow">break<\/span>;$/;"	a
l00722	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00722"><\/a>00722                                 <span class="keywordflow">case<\/span> oHTTPDPassword:$/;"	a
l00723	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00723"><\/a>00723                                         config.<a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5" title="Password for HTTP authentication.">httpdpassword<\/a> = safe_strdup(p1);$/;"	a
l00724	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00724"><\/a>00724                                         <span class="keywordflow">break<\/span>;$/;"	a
l00725	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00725"><\/a>00725                                 <span class="keywordflow">case<\/span> oBadOption:$/;"	a
l00726	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00726"><\/a>00726                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Bad option on line %d "<\/span>$/;"	a
l00727	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00727"><\/a>00727                                                         <span class="stringliteral">"in %s."<\/span>, linenum,$/;"	a
l00728	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00728"><\/a>00728                                                         filename);$/;"	a
l00729	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00729"><\/a>00729                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Exiting..."<\/span>);$/;"	a
l00730	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00730"><\/a>00730                                         exit(-1);$/;"	a
l00731	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00731"><\/a>00731                                         <span class="keywordflow">break<\/span>;$/;"	a
l00732	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00732"><\/a>00732                                 <span class="keywordflow">case<\/span> oCheckInterval:$/;"	a
l00733	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00733"><\/a>00733                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a>);$/;"	a
l00734	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00734"><\/a>00734                                         <span class="keywordflow">break<\/span>;$/;"	a
l00735	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00735"><\/a>00735                                 <span class="keywordflow">case<\/span> oWdctlSocket:$/;"	a
l00736	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00736"><\/a>00736                                         free(config.<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a>);$/;"	a
l00737	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00737"><\/a>00737                                         config.<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a> = safe_strdup(p1);$/;"	a
l00738	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00738"><\/a>00738                                         <span class="keywordflow">break<\/span>;$/;"	a
l00739	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00739"><\/a>00739                                 <span class="keywordflow">case<\/span> oClientTimeout:$/;"	a
l00740	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00740"><\/a>00740                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a>);$/;"	a
l00741	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00741"><\/a>00741                                         <span class="keywordflow">break<\/span>;$/;"	a
l00742	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00742"><\/a>00742                                 <span class="keywordflow">case<\/span> oSyslogFacility:$/;"	a
l00743	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00743"><\/a>00743                                         sscanf(p1, <span class="stringliteral">"%d"<\/span>, &amp;config.<a class="code" href="structs__config.html#eaad87f73a87a2f752b111dad813902d" title="facility to use when using syslog for logging">syslog_facility<\/a>);$/;"	a
l00744	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00744"><\/a>00744                                         <span class="keywordflow">break<\/span>;$/;"	a
l00745	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00745"><\/a>00745                                 <span class="keywordflow">case<\/span> oHtmlMessageFile:$/;"	a
l00746	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00746"><\/a>00746                                         config.<a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6" title="name of the HTML file used for messages">htmlmsgfile<\/a> = safe_strdup(p1);$/;"	a
l00747	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00747"><\/a>00747                                         <span class="keywordflow">break<\/span>;$/;"	a
l00748	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00748"><\/a>00748 $/;"	a
l00749	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00749"><\/a>00749                                 }$/;"	a
l00750	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00750"><\/a>00750                         }$/;"	a
l00751	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00751"><\/a>00751                 }$/;"	a
l00752	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00752"><\/a>00752         }$/;"	a
l00753	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00753"><\/a>00753 $/;"	a
l00754	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00754"><\/a>00754         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a> &amp;&amp; !config.<a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5" title="Password for HTTP authentication.">httpdpassword<\/a>) {$/;"	a
l00755	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00755"><\/a>00755                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"HTTPDUserName requires a HTTPDPassword to be set."<\/span>);$/;"	a
l00756	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00756"><\/a>00756                 exit(-1);$/;"	a
l00757	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00757"><\/a>00757         }$/;"	a
l00758	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00758"><\/a>00758 $/;"	a
l00759	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00759"><\/a>00759         fclose(fd);$/;"	a
l00760	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00760"><\/a>00760 }$/;"	a
l00761	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00761"><\/a>00761 $/;"	a
l00765	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00765"><\/a>00765 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span>$/;"	a
l00766	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00766"><\/a>00766 parse_boolean_value(<span class="keywordtype">char<\/span> *line)$/;"	a
l00767	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00767"><\/a>00767 {$/;"	a
l00768	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00768"><\/a>00768         <span class="keywordflow">if<\/span> (strcasecmp(line, <span class="stringliteral">"yes"<\/span>) == 0) {$/;"	a
l00769	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00769"><\/a>00769                 <span class="keywordflow">return<\/span> 1;$/;"	a
l00770	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00770"><\/a>00770         }$/;"	a
l00771	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00771"><\/a>00771         <span class="keywordflow">if<\/span> (strcasecmp(line, <span class="stringliteral">"no"<\/span>) == 0) {$/;"	a
l00772	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00772"><\/a>00772                 <span class="keywordflow">return<\/span> 0;$/;"	a
l00773	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00773"><\/a>00773         }$/;"	a
l00774	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00774"><\/a>00774         <span class="keywordflow">if<\/span> (strcmp(line, <span class="stringliteral">"1"<\/span>) == 0) {$/;"	a
l00775	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00775"><\/a>00775                 <span class="keywordflow">return<\/span> 1;$/;"	a
l00776	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00776"><\/a>00776         }$/;"	a
l00777	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00777"><\/a>00777         <span class="keywordflow">if<\/span> (strcmp(line, <span class="stringliteral">"0"<\/span>) == 0) {$/;"	a
l00778	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00778"><\/a>00778                 <span class="keywordflow">return<\/span> 0;$/;"	a
l00779	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00779"><\/a>00779         }$/;"	a
l00780	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00780"><\/a>00780 $/;"	a
l00781	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00781"><\/a>00781         <span class="keywordflow">return<\/span> -1;$/;"	a
l00782	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00782"><\/a>00782 }$/;"	a
l00783	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00783"><\/a>00783 $/;"	a
l00784	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00784"><\/a>00784 <span class="keywordtype">void<\/span> parse_trusted_mac_list(<span class="keywordtype">char<\/span> *ptr) {$/;"	a
l00785	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00785"><\/a>00785         <span class="keywordtype">char<\/span> *ptrcopy = NULL;$/;"	a
l00786	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00786"><\/a>00786         <span class="keywordtype">char<\/span> *possiblemac = NULL;$/;"	a
l00787	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00787"><\/a>00787         <span class="keywordtype">char<\/span> *mac = NULL;$/;"	a
l00788	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00788"><\/a>00788         <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a> *p = NULL;$/;"	a
l00789	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00789"><\/a>00789 $/;"	a
l00790	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00790"><\/a>00790         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Parsing string [%s] for trusted MAC addresses"<\/span>, ptr);$/;"	a
l00791	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00791"><\/a>00791 $/;"	a
l00792	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00792"><\/a>00792         mac = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(18);$/;"	a
l00793	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00793"><\/a>00793 $/;"	a
l00794	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00794"><\/a>00794         <span class="comment">\/* strsep modifies original, so let's make a copy *\/<\/span>$/;"	a
l00795	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00795"><\/a>00795         ptrcopy = safe_strdup(ptr);$/;"	a
l00796	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00796"><\/a>00796 $/;"	a
l00797	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00797"><\/a>00797         <span class="keywordflow">while<\/span> ((possiblemac = strsep(&amp;ptrcopy, <span class="stringliteral">", "<\/span>))) {$/;"	a
l00798	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00798"><\/a>00798                 <span class="keywordflow">if<\/span> (sscanf(possiblemac, <span class="stringliteral">" %17[A-Fa-f0-9:]"<\/span>, mac) == 1) {$/;"	a
l00799	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00799"><\/a>00799                         <span class="comment">\/* Copy mac to the list *\/<\/span>$/;"	a
l00800	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00800"><\/a>00800 $/;"	a
l00801	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00801"><\/a>00801                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Adding MAC address [%s] to trusted list"<\/span>, mac);$/;"	a
l00802	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00802"><\/a>00802 $/;"	a
l00803	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00803"><\/a>00803                         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a> == NULL) {$/;"	a
l00804	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00804"><\/a>00804                                 config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a> = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a>));$/;"	a
l00805	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00805"><\/a>00805                                 config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>-&gt;<a class="code" href="struct__trusted__mac__t.html#4e4381cfff2bbfbd9455640102b21f14">mac<\/a> = safe_strdup(mac);$/;"	a
l00806	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00806"><\/a>00806                                 config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a> = NULL;$/;"	a
l00807	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00807"><\/a>00807                         }$/;"	a
l00808	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00808"><\/a>00808                         <span class="keywordflow">else<\/span> {$/;"	a
l00809	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00809"><\/a>00809                                 <span class="comment">\/* Advance to the last entry *\/<\/span>$/;"	a
l00810	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00810"><\/a>00810                                 <span class="keywordflow">for<\/span> (p = config.<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>; p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a> != NULL; p = p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a>);$/;"	a
l00811	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00811"><\/a>00811                                 p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a> = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a>));$/;"	a
l00812	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00812"><\/a>00812                                 p = p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a>;$/;"	a
l00813	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00813"><\/a>00813                                 p-&gt;<a class="code" href="struct__trusted__mac__t.html#4e4381cfff2bbfbd9455640102b21f14">mac<\/a> = safe_strdup(mac);$/;"	a
l00814	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00814"><\/a>00814                                 p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a> = NULL;$/;"	a
l00815	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00815"><\/a>00815                         }$/;"	a
l00816	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00816"><\/a>00816 $/;"	a
l00817	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00817"><\/a>00817                 }$/;"	a
l00818	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00818"><\/a>00818         }$/;"	a
l00819	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00819"><\/a>00819 $/;"	a
l00820	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00820"><\/a>00820         free(ptrcopy);$/;"	a
l00821	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00821"><\/a>00821 $/;"	a
l00822	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00822"><\/a>00822         free(mac);$/;"	a
l00823	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00823"><\/a>00823 $/;"	a
l00824	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00824"><\/a>00824 }$/;"	a
l00825	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00825"><\/a>00825 $/;"	a
l00827	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00827"><\/a>00827 <span class="keywordtype">void<\/span>$/;"	a
l00828	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00828"><\/a><a class="code" href="conf_8h.html#0f9540b3f729ba3b3d31b613d3eca364">00828<\/a> <a class="code" href="conf_8c.html#0f9540b3f729ba3b3d31b613d3eca364" title="Check that the configuration is valid.">config_validate<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00829	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00829"><\/a>00829 {$/;"	a
l00830	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00830"><\/a>00830         config_notnull(config.<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>, <span class="stringliteral">"GatewayInterface"<\/span>);$/;"	a
l00831	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00831"><\/a>00831         config_notnull(config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>, <span class="stringliteral">"AuthServer"<\/span>);$/;"	a
l00832	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00832"><\/a>00832 $/;"	a
l00833	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00833"><\/a>00833         <span class="keywordflow">if<\/span> (missing_parms) {$/;"	a
l00834	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00834"><\/a>00834                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Configuration is not complete, exiting..."<\/span>);$/;"	a
l00835	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00835"><\/a>00835                 exit(-1);$/;"	a
l00836	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00836"><\/a>00836         }$/;"	a
l00837	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00837"><\/a>00837 }$/;"	a
l00838	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00838"><\/a>00838 $/;"	a
l00842	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00842"><\/a>00842 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00843	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00843"><\/a>00843 config_notnull(<span class="keyword">const<\/span> <span class="keywordtype">void<\/span> *parm, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *parmname)$/;"	a
l00844	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00844"><\/a>00844 {$/;"	a
l00845	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00845"><\/a>00845         <span class="keywordflow">if<\/span> (parm == NULL) {$/;"	a
l00846	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00846"><\/a>00846                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"%s is not set"<\/span>, parmname);$/;"	a
l00847	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00847"><\/a>00847                 missing_parms = 1;$/;"	a
l00848	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00848"><\/a>00848         }$/;"	a
l00849	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00849"><\/a>00849 }$/;"	a
l00850	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00850"><\/a>00850 $/;"	a
l00854	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00854"><\/a>00854 <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *$/;"	a
l00855	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00855"><\/a><a class="code" href="conf_8h.html#82ffcd3c683aadc31aca9c53a2d2739a">00855<\/a> <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00856	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00856"><\/a>00856 {$/;"	a
l00857	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00857"><\/a>00857 $/;"	a
l00858	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00858"><\/a>00858         <span class="comment">\/* This is as good as atomic *\/<\/span>$/;"	a
l00859	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00859"><\/a>00859         <span class="keywordflow">return<\/span> config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>;$/;"	a
l00860	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00860"><\/a>00860 }$/;"	a
l00861	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00861"><\/a>00861 $/;"	a
l00866	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00866"><\/a>00866 <span class="keywordtype">void<\/span>$/;"	a
l00867	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00867"><\/a><a class="code" href="conf_8h.html#9d674c58e3d919b7cd55aa12ed52be3c">00867<\/a> <a class="code" href="conf_8c.html#d1e677696fcef826740ca906587af8ac" title="Bump server to bottom of the list.">mark_auth_server_bad<\/a>(<a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *bad_server)$/;"	a
l00868	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00868"><\/a>00868 {$/;"	a
l00869	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00869"><\/a>00869         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *tmp;$/;"	a
l00870	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00870"><\/a>00870 $/;"	a
l00871	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00871"><\/a>00871         <span class="keywordflow">if<\/span> (config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> == bad_server &amp;&amp; bad_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> != NULL) {$/;"	a
l00872	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00872"><\/a>00872                 <span class="comment">\/* Go to the last *\/<\/span>$/;"	a
l00873	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00873"><\/a>00873                 <span class="keywordflow">for<\/span> (tmp = config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> != NULL; tmp = tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>);$/;"	a
l00874	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00874"><\/a>00874                 <span class="comment">\/* Set bad server as last *\/<\/span>$/;"	a
l00875	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00875"><\/a>00875                 tmp-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> = bad_server;$/;"	a
l00876	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00876"><\/a>00876                 <span class="comment">\/* Remove bad server from start of list *\/<\/span>$/;"	a
l00877	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00877"><\/a>00877                 config.<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> = bad_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>;$/;"	a
l00878	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00878"><\/a>00878                 <span class="comment">\/* Set the next pointe to NULL in the last element *\/<\/span>$/;"	a
l00879	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00879"><\/a>00879                 bad_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a> = NULL;$/;"	a
l00880	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00880"><\/a>00880         }$/;"	a
l00881	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00881"><\/a>00881 $/;"	a
l00882	install/share/doc/wifidog-20090925/html/conf_8c-source.html	/^<a name="l00882"><\/a>00882 }$/;"	a
0448e8e7c5a3c78addbd7f855e2dbecf	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0448e8e7c5a3c78addbd7f855e2dbecf"><\/a><!-- doxytag: member="conf.c::parse_firewall_ruleset" ref="0448e8e7c5a3c78addbd7f855e2dbecf" args="(const char *, FILE *, const char *, int *)" -->$/;"	a
068a358868c409bbd99d7eef3c988866	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="068a358868c409bbd99d7eef3c988866"><\/a><!-- doxytag: member="conf.c::config_init" ref="068a358868c409bbd99d7eef3c988866" args="(void)" -->$/;"	a
0f9540b3f729ba3b3d31b613d3eca364	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="0f9540b3f729ba3b3d31b613d3eca364"><\/a><!-- doxytag: member="conf.c::config_validate" ref="0f9540b3f729ba3b3d31b613d3eca364" args="(void)" -->$/;"	a
17b6b425f18de3865e44b534c1f1f1cc	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="17b6b425f18de3865e44b534c1f1f1cc"><\/a><!-- doxytag: member="conf.c::config_init_override" ref="17b6b425f18de3865e44b534c1f1f1cc" args="(void)" -->$/;"	a
19f5257e157a21ebe192c121aa8b44fd	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="19f5257e157a21ebe192c121aa8b44fd"><\/a><!-- doxytag: member="conf.c::parse_boolean_value" ref="19f5257e157a21ebe192c121aa8b44fd" args="(char *)" -->$/;"	a
369266c24eacffb87046522897a570d5	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="369266c24eacffb87046522897a570d5"><\/a><!-- doxytag: member="conf.c::_GNU_SOURCE" ref="369266c24eacffb87046522897a570d5" args="" -->$/;"	a
5190981355166bf58be20ad91d979ebd	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5190981355166bf58be20ad91d979ebd"><\/a><!-- doxytag: member="conf.c::config_parse_token" ref="5190981355166bf58be20ad91d979ebd" args="(const char *cp, const char *filename, int linenum)" -->$/;"	a
617ad9199f2b10b95498f4f15c67c66d	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="617ad9199f2b10b95498f4f15c67c66d"><\/a><!-- doxytag: member="conf.c::get_ruleset" ref="617ad9199f2b10b95498f4f15c67c66d" args="(const char *ruleset)" -->$/;"	a
64e73012596dd6628c18742c8046069f	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="64e73012596dd6628c18742c8046069f"><\/a><!-- doxytag: member="conf.c::config_get_config" ref="64e73012596dd6628c18742c8046069f" args="(void)" -->$/;"	a
7c1094749f55aab015c5c408def95216	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7c1094749f55aab015c5c408def95216"><\/a><!-- doxytag: member="conf.c::missing_parms" ref="7c1094749f55aab015c5c408def95216" args="" -->$/;"	a
82ffcd3c683aadc31aca9c53a2d2739a	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="82ffcd3c683aadc31aca9c53a2d2739a"><\/a><!-- doxytag: member="conf.c::get_auth_server" ref="82ffcd3c683aadc31aca9c53a2d2739a" args="(void)" -->$/;"	a
9934c7def687e5ed242049cb2a46eb73	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="9934c7def687e5ed242049cb2a46eb73"><\/a><!-- doxytag: member="conf.c::TO_NEXT_WORD" ref="9934c7def687e5ed242049cb2a46eb73" args="(s, e)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a8666c914d96b286c9efe27de4268003	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a8666c914d96b286c9efe27de4268003"><\/a><!-- doxytag: member="conf.c::config_notnull" ref="a8666c914d96b286c9efe27de4268003" args="(const void *parm, const char *parmname)" -->$/;"	a
ade5b00daf915be32d7f6cbf116cd9e6	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ade5b00daf915be32d7f6cbf116cd9e6"><\/a><!-- doxytag: member="conf.c::config" ref="ade5b00daf915be32d7f6cbf116cd9e6" args="" -->$/;"	a
b374ff230d9977e6b952612d61689f39	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="b374ff230d9977e6b952612d61689f39"><\/a><!-- doxytag: member="conf.c::config_mutex" ref="b374ff230d9977e6b952612d61689f39" args="" -->$/;"	a
c10ca895b5a20b458c1599f8a9766f4d	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="c10ca895b5a20b458c1599f8a9766f4d"><\/a><!-- doxytag: member="conf.c::_parse_firewall_rule" ref="c10ca895b5a20b458c1599f8a9766f4d" args="(const char *ruleset, char *leftover)" -->$/;"	a
c4c300aeb846c6b85325f91e89268af1	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap><a class="anchor" name="c4c300aeb846c6b85325f91e89268af1"><\/a><!-- doxytag: member="conf.c::keywords" ref="c4c300aeb846c6b85325f91e89268af1" args="[]" -->$/;"	a
d1e677696fcef826740ca906587af8ac	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="d1e677696fcef826740ca906587af8ac"><\/a><!-- doxytag: member="conf.c::mark_auth_server_bad" ref="d1e677696fcef826740ca906587af8ac" args="(t_auth_serv *bad_server)" -->$/;"	a
d3faac0efa0ac4c1032c0c54f7e93711	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<a class="anchor" name="d3faac0efa0ac4c1032c0c54f7e93711"><\/a><!-- doxytag: member="conf.c::config_read" ref="d3faac0efa0ac4c1032c0c54f7e93711" args="(const char *filename)" -->$/;"	a
ec9c053484cb6677e992d3c1511eeb51	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ec9c053484cb6677e992d3c1511eeb51"><\/a><!-- doxytag: member="conf.c::parse_auth_server" ref="ec9c053484cb6677e992d3c1511eeb51" args="(FILE *, const char *, int *)" -->$/;"	a
f692869bbba0cdc3c04480a40af3395e	install/share/doc/wifidog-20090925/html/conf_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f692869bbba0cdc3c04480a40af3395e"><\/a><!-- doxytag: member="conf.c::parse_trusted_mac_list" ref="f692869bbba0cdc3c04480a40af3395e" args="(char *ptr)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<h1>conf.h<\/h1><a href="conf_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: conf.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _CONFIG_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _CONFIG_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00034"><\/a><a class="code" href="conf_8h.html#771a6a60dbaa6c7532ab6cd31b397f7d">00034<\/a> <span class="preprocessor">#define NUM_EXT_INTERFACE_DETECT_RETRY 0<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor"><\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="conf_8h.html#b67c119b3d066438d4c3405b518bb289">00037<\/a> <span class="preprocessor">#define EXT_INTERFACE_DETECT_RETRY_INTERVAL 1<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor"><\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#ifndef SYSCONFDIR<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00041"><\/a><a class="code" href="conf_8h.html#0ec3017454ea7a8398d25c8ab83890fd">00041<\/a> <span class="preprocessor"><\/span><span class="preprocessor">        #define DEFAULT_CONFIGFILE "\/etc\/wifidog.conf"<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="conf_8h.html#16581929d818bc322bbebce8a7a12117">00042<\/a> <span class="preprocessor"><\/span><span class="preprocessor">        #define DEFAULT_HTMLMSGFILE "\/etc\/wifidog-msg.html"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor"><\/span><span class="preprocessor">#else<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor"><\/span><span class="preprocessor">        #define DEFAULT_CONFIGFILE SYSCONFDIR"\/wifidog.conf"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor"><\/span><span class="preprocessor">        #define DEFAULT_HTMLMSGFILE SYSCONFDIR"\/wifidog-msg.html"<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor"><\/span><span class="preprocessor">#endif  <\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00047"><\/a><a class="code" href="conf_8h.html#c71029bbf7b0ee40ad72b17ff77f7896">00047<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_DAEMON 1<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00048"><\/a><a class="code" href="conf_8h.html#32198b3d9cda9e7ea18d9680f805dc87">00048<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_DEBUGLEVEL LOG_INFO<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00049"><\/a><a class="code" href="conf_8h.html#ca85302a5a857716f3b0275fbbff135f">00049<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_HTTPDMAXCONN 10<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00050"><\/a><a class="code" href="conf_8h.html#e38786151577e46b298b7baf0ca0fe96">00050<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_GATEWAYID NULL<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00051"><\/a><a class="code" href="conf_8h.html#f14cf5aa96a948b2d23a1ff0aeba3e48">00051<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_GATEWAYPORT 2060<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00052"><\/a><a class="code" href="conf_8h.html#af813a168a0bd5a77aa515073950a135">00052<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_HTTPDNAME "WiFiDog"<\/span>$/;"	a
l00053	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00053"><\/a><a class="code" href="conf_8h.html#1ea67d2117d4f50445d1c9428bac5a64">00053<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_CLIENTTIMEOUT 5<\/span>$/;"	a
l00054	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00054"><\/a><a class="code" href="conf_8h.html#9bcb72263ba584b1da18d3b2f2b65e6a">00054<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_CHECKINTERVAL 60<\/span>$/;"	a
l00055	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00055"><\/a><a class="code" href="conf_8h.html#41ce987eea16297a459249b1e4c69ed7">00055<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_LOG_SYSLOG 0<\/span>$/;"	a
l00056	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00056"><\/a><a class="code" href="conf_8h.html#66cff01e093b0b7d5335a7939f839341">00056<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_SYSLOG_FACILITY LOG_DAEMON<\/span>$/;"	a
l00057	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00057"><\/a><a class="code" href="conf_8h.html#cee7c0173f525e29800b87222b407386">00057<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_WDCTL_SOCK "\/tmp\/wdctl.sock"<\/span>$/;"	a
l00058	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00058"><\/a><a class="code" href="conf_8h.html#ea1d1da1ff4c9161109a81a0b1d6fd2c">00058<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_INTERNAL_SOCK "\/tmp\/wifidog.sock"<\/span>$/;"	a
l00059	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00059"><\/a><a class="code" href="conf_8h.html#4468d0b44b441d03ea8270e09de86f65">00059<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVPORT 80<\/span>$/;"	a
l00060	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00060"><\/a><a class="code" href="conf_8h.html#eecec081c6ba90900777bc8db01f774f">00060<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVSSLPORT 443<\/span>$/;"	a
l00061	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="preprocessor"><\/span>$/;"	a
l00062	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00062"><\/a><a class="code" href="conf_8h.html#784fe164c1e4d1e62365a2505460592a">00062<\/a> <span class="preprocessor">#define DEFAULT_AUTHSERVSSLAVAILABLE 0<\/span>$/;"	a
l00063	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00063"><\/a>00063 <span class="preprocessor"><\/span>$/;"	a
l00064	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00064"><\/a><a class="code" href="conf_8h.html#d1127f95cef99fe1384a30fca8b9c392">00064<\/a> <span class="preprocessor">#define DEFAULT_AUTHSERVPATH "\/wifidog\/"<\/span>$/;"	a
l00065	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00065"><\/a><a class="code" href="conf_8h.html#12e10b7db61ec0a23264d2a7762c6ef3">00065<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVLOGINPATHFRAGMENT "login\/?"<\/span>$/;"	a
l00066	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00066"><\/a><a class="code" href="conf_8h.html#29ca3acd6665cd70286185f3dd4ab09d">00066<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVPORTALPATHFRAGMENT "portal\/?"<\/span>$/;"	a
l00067	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00067"><\/a><a class="code" href="conf_8h.html#d26385411b1807104fa1504dff7bfb0d">00067<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVMSGPATHFRAGMENT "gw_message.php?"<\/span>$/;"	a
l00068	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00068"><\/a><a class="code" href="conf_8h.html#11ea6dd746ca0526817bdd6515cbcc29">00068<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVPINGPATHFRAGMENT "ping\/?"<\/span>$/;"	a
l00069	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00069"><\/a><a class="code" href="conf_8h.html#f83da39ab6845671d9b1a2bf635951fa">00069<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define DEFAULT_AUTHSERVAUTHPATHFRAGMENT "auth\/?"<\/span>$/;"	a
l00070	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00070"><\/a>00070 <span class="preprocessor"><\/span>$/;"	a
l00075	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00075"><\/a><a class="code" href="struct__auth__serv__t.html">00075<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__auth__serv__t.html">_auth_serv_t<\/a> {$/;"	a
l00076	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00076"><\/a><a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3">00076<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>;    $/;"	a
l00077	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00077"><\/a><a class="code" href="struct__auth__serv__t.html#ff64f568944bbf0b01bb379b17ae2161">00077<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#ff64f568944bbf0b01bb379b17ae2161" title="Path where wifidog resides.">authserv_path<\/a>;        $/;"	a
l00078	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00078"><\/a><a class="code" href="struct__auth__serv__t.html#0752c3da9e2be08ca6d19449fa4cf425">00078<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#0752c3da9e2be08ca6d19449fa4cf425" title="This is the script the user will be sent to for login.">authserv_login_script_path_fragment<\/a>;  $/;"	a
l00079	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00079"><\/a><a class="code" href="struct__auth__serv__t.html#bcf430ab833dd65830904abf5793e1c6">00079<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#bcf430ab833dd65830904abf5793e1c6" title="This is the script the user will be sent to after a successfull login.">authserv_portal_script_path_fragment<\/a>; $/;"	a
l00080	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00080"><\/a><a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10">00080<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>;    $/;"	a
l00081	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00081"><\/a><a class="code" href="struct__auth__serv__t.html#b33784964244174aef057fa405f76756">00081<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#b33784964244174aef057fa405f76756" title="This is the ping heartbeating script.">authserv_ping_script_path_fragment<\/a>;   $/;"	a
l00082	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00082"><\/a><a class="code" href="struct__auth__serv__t.html#c1144ccb4a8c9418fe1b92a13aa701e8">00082<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#c1144ccb4a8c9418fe1b92a13aa701e8" title="This is the script that talks the wifidog gateway protocol.">authserv_auth_script_path_fragment<\/a>;   $/;"	a
l00083	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00083"><\/a><a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb">00083<\/a>     <span class="keywordtype">int<\/span> <a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>;     $/;"	a
l00085	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00085"><\/a><a class="code" href="struct__auth__serv__t.html#f4d82be7a680c24437a91ed1467f8921">00085<\/a>     <span class="keywordtype">int<\/span> <a class="code" href="struct__auth__serv__t.html#f4d82be7a680c24437a91ed1467f8921" title="Https port the central server listens on.">authserv_ssl_port<\/a>;      $/;"	a
l00087	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00087"><\/a><a class="code" href="struct__auth__serv__t.html#87bde1ef8a18890d18858a360d276098">00087<\/a>     <span class="keywordtype">int<\/span> <a class="code" href="struct__auth__serv__t.html#87bde1ef8a18890d18858a360d276098" title="Use SSL or not.">authserv_use_ssl<\/a>;       $/;"	a
l00088	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00088"><\/a><a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e">00088<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>;      $/;"	a
l00089	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00089"><\/a>00089     <span class="keyword">struct <\/span><a class="code" href="struct__auth__serv__t.html">_auth_serv_t<\/a> *next;$/;"	a
l00090	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00090"><\/a>00090 } <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>;$/;"	a
l00091	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00091"><\/a>00091 $/;"	a
l00095	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00095"><\/a><a class="code" href="struct__firewall__rule__t.html">00095<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__firewall__rule__t.html">_firewall_rule_t<\/a> {$/;"	a
l00096	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00096"><\/a><a class="code" href="struct__firewall__rule__t.html#4319185967c4252ced90b2d440034b47">00096<\/a>     <span class="keywordtype">int<\/span> <a class="code" href="struct__firewall__rule__t.html#4319185967c4252ced90b2d440034b47" title="1 = Allow rule, 0 = Block rule">block_allow<\/a>;            $/;"	a
l00097	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00097"><\/a><a class="code" href="struct__firewall__rule__t.html#de917f67daf277f81767a9ca7cb6ac1e">00097<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__firewall__rule__t.html#de917f67daf277f81767a9ca7cb6ac1e" title="tcp, udp, etc ...">protocol<\/a>;             $/;"	a
l00098	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00098"><\/a><a class="code" href="struct__firewall__rule__t.html#172be165ac52a92dfe57e0911678698d">00098<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__firewall__rule__t.html#172be165ac52a92dfe57e0911678698d" title="Port to block\/allow.">port<\/a>;                 $/;"	a
l00099	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00099"><\/a><a class="code" href="struct__firewall__rule__t.html#71fecaae85673b8c3d00a7c14f528f73">00099<\/a>     <span class="keywordtype">char<\/span> *<a class="code" href="struct__firewall__rule__t.html#71fecaae85673b8c3d00a7c14f528f73" title="Mask for the rule *destination*.">mask<\/a>;                 $/;"	a
l00100	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00100"><\/a>00100     <span class="keyword">struct <\/span><a class="code" href="struct__firewall__rule__t.html">_firewall_rule_t<\/a> *next;$/;"	a
l00101	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00101"><\/a>00101 } <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>;$/;"	a
l00102	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00102"><\/a>00102 $/;"	a
l00106	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00106"><\/a><a class="code" href="struct__firewall__ruleset__t.html">00106<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__firewall__ruleset__t.html">_firewall_ruleset_t<\/a> {$/;"	a
l00107	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00107"><\/a>00107     <span class="keywordtype">char<\/span>                        *name;$/;"	a
l00108	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00108"><\/a>00108     <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>             *rules;$/;"	a
l00109	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00109"><\/a>00109     <span class="keyword">struct <\/span><a class="code" href="struct__firewall__ruleset__t.html">_firewall_ruleset_t<\/a>  *next;$/;"	a
l00110	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00110"><\/a>00110 } <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>;$/;"	a
l00111	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00111"><\/a>00111 $/;"	a
l00115	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00115"><\/a><a class="code" href="struct__trusted__mac__t.html">00115<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span><a class="code" href="struct__trusted__mac__t.html">_trusted_mac_t<\/a> {$/;"	a
l00116	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00116"><\/a>00116     <span class="keywordtype">char<\/span>   *mac;$/;"	a
l00117	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00117"><\/a>00117     <span class="keyword">struct <\/span><a class="code" href="struct__trusted__mac__t.html">_trusted_mac_t<\/a> *next;$/;"	a
l00118	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00118"><\/a>00118 } <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a>;$/;"	a
l00119	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00119"><\/a>00119 $/;"	a
l00123	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00123"><\/a><a class="code" href="structs__config.html">00123<\/a> <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span>{$/;"	a
l00124	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00124"><\/a><a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81">00124<\/a>     <span class="keywordtype">char<\/span> configfile[255];       $/;"	a
l00125	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00125"><\/a><a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6">00125<\/a>     <span class="keywordtype">char<\/span> *htmlmsgfile;          $/;"	a
l00126	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00126"><\/a><a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d">00126<\/a>     <span class="keywordtype">char<\/span> *wdctl_sock;           $/;"	a
l00127	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00127"><\/a><a class="code" href="structs__config.html#132360d3c982b91fe0cdff6622eee1f1">00127<\/a>     <span class="keywordtype">char<\/span> *internal_sock;                $/;"	a
l00128	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00128"><\/a><a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389">00128<\/a>     <span class="keywordtype">int<\/span> daemon;                 $/;"	a
l00129	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00129"><\/a><a class="code" href="structs__config.html#72a375118114359c8fcf890bba1e77fb">00129<\/a>     <span class="keywordtype">int<\/span> debuglevel;             $/;"	a
l00130	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00130"><\/a><a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62">00130<\/a>     <span class="keywordtype">char<\/span> *external_interface;   $/;"	a
l00132	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00132"><\/a><a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8">00132<\/a>     <span class="keywordtype">char<\/span> *gw_id;                $/;"	a
l00134	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00134"><\/a><a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c">00134<\/a>     <span class="keywordtype">char<\/span> *gw_interface;         $/;"	a
l00135	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00135"><\/a><a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0">00135<\/a>     <span class="keywordtype">char<\/span> *gw_address;           $/;"	a
l00137	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00137"><\/a><a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189">00137<\/a>     <span class="keywordtype">int<\/span> gw_port;                $/;"	a
l00139	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00139"><\/a><a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e">00139<\/a>     <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_servers;  $/;"	a
l00140	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00140"><\/a><a class="code" href="structs__config.html#2ed9a59507be060fe0e1deae7fcc077b">00140<\/a>     <span class="keywordtype">char<\/span> *httpdname;            $/;"	a
l00142	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00142"><\/a><a class="code" href="structs__config.html#7a24ca5b2cc1ff099bda0af17e654a95">00142<\/a>     <span class="keywordtype">int<\/span> httpdmaxconn;           $/;"	a
l00144	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00144"><\/a><a class="code" href="structs__config.html#283515007953f307a7b599ee480b743d">00144<\/a>     <span class="keywordtype">char<\/span> *httpdrealm;           $/;"	a
l00145	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00145"><\/a><a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d">00145<\/a>     <span class="keywordtype">char<\/span> *httpdusername;        $/;"	a
l00146	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00146"><\/a><a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5">00146<\/a>     <span class="keywordtype">char<\/span> *httpdpassword;        $/;"	a
l00147	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00147"><\/a><a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c">00147<\/a>     <span class="keywordtype">int<\/span> clienttimeout;          $/;"	a
l00149	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00149"><\/a><a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7">00149<\/a>     <span class="keywordtype">int<\/span> checkinterval;          $/;"	a
l00151	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00151"><\/a><a class="code" href="structs__config.html#784dd5fa3d27b3d1311b18f23e919362">00151<\/a>     <span class="keywordtype">int<\/span> log_syslog;             $/;"	a
l00152	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00152"><\/a><a class="code" href="structs__config.html#eaad87f73a87a2f752b111dad813902d">00152<\/a>     <span class="keywordtype">int<\/span> syslog_facility;        $/;"	a
l00154	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00154"><\/a><a class="code" href="structs__config.html#93ffa58b6d61d2a8eb6dd31dc4346fd4">00154<\/a>     <a class="code" href="struct__firewall__ruleset__t.html">t_firewall_ruleset<\/a>  *rulesets;      $/;"	a
l00155	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00155"><\/a><a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64">00155<\/a>     <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a> *trustedmaclist; $/;"	a
l00156	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00156"><\/a>00156 } <a class="code" href="structs__config.html">s_config<\/a>;$/;"	a
l00157	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00157"><\/a>00157 $/;"	a
l00159	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00159"><\/a>00159 <a class="code" href="structs__config.html">s_config<\/a> *<a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00160	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00160"><\/a>00160 $/;"	a
l00162	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00162"><\/a>00162 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#068a358868c409bbd99d7eef3c988866" title="Initialise the conf system.">config_init<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00163	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00163"><\/a>00163 $/;"	a
l00165	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00165"><\/a>00165 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#17b6b425f18de3865e44b534c1f1f1cc" title="Initialize the variables we override with the command line.">config_init_override<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00166	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00166"><\/a>00166 $/;"	a
l00168	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00168"><\/a>00168 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#d3faac0efa0ac4c1032c0c54f7e93711" title="Reads the configuration file.">config_read<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *filename);$/;"	a
l00169	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00169"><\/a>00169 $/;"	a
l00171	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00171"><\/a>00171 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#0f9540b3f729ba3b3d31b613d3eca364" title="Check that the configuration is valid.">config_validate<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00172	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00172"><\/a>00172 $/;"	a
l00174	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00174"><\/a>00174 <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *<a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00175	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00175"><\/a>00175 $/;"	a
l00177	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00177"><\/a>00177 <span class="keywordtype">void<\/span> <a class="code" href="conf_8c.html#d1e677696fcef826740ca906587af8ac" title="Bump server to bottom of the list.">mark_auth_server_bad<\/a>(<a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *);$/;"	a
l00178	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00178"><\/a>00178 $/;"	a
l00180	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00180"><\/a>00180 <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *<a class="code" href="conf_8c.html#617ad9199f2b10b95498f4f15c67c66d" title="Fetch a firewall rule set.">get_ruleset<\/a>(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *);$/;"	a
l00181	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00181"><\/a>00181 $/;"	a
l00182	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00182"><\/a>00182 <span class="keywordtype">void<\/span> parse_trusted_mac_list(<span class="keywordtype">char<\/span> *);$/;"	a
l00183	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00183"><\/a>00183 $/;"	a
l00184	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00184"><\/a>00184 <span class="preprocessor">#define LOCK_CONFIG() do { \\<\/span>$/;"	a
l00185	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00185"><\/a>00185 <span class="preprocessor">        debug(LOG_DEBUG, "Locking config"); \\<\/span>$/;"	a
l00186	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00186"><\/a>00186 <span class="preprocessor">        pthread_mutex_lock(&amp;config_mutex); \\<\/span>$/;"	a
l00187	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00187"><\/a>00187 <span class="preprocessor">        debug(LOG_DEBUG, "Config locked"); \\<\/span>$/;"	a
l00188	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00188"><\/a>00188 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00189	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00189"><\/a>00189 <span class="preprocessor"><\/span>$/;"	a
l00190	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00190"><\/a>00190 <span class="preprocessor">#define UNLOCK_CONFIG() do { \\<\/span>$/;"	a
l00191	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00191"><\/a>00191 <span class="preprocessor">        debug(LOG_DEBUG, "Unlocking config"); \\<\/span>$/;"	a
l00192	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00192"><\/a>00192 <span class="preprocessor">        pthread_mutex_unlock(&amp;config_mutex); \\<\/span>$/;"	a
l00193	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00193"><\/a>00193 <span class="preprocessor">        debug(LOG_DEBUG, "Config unlocked"); \\<\/span>$/;"	a
l00194	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00194"><\/a>00194 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00195	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00195"><\/a>00195 <span class="preprocessor"><\/span>$/;"	a
l00196	install/share/doc/wifidog-20090925/html/conf_8h-source.html	/^<a name="l00196"><\/a>00196 <span class="preprocessor">#endif <\/span><span class="comment">\/* _CONFIG_H_ *\/<\/span>$/;"	a
068a358868c409bbd99d7eef3c988866	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="068a358868c409bbd99d7eef3c988866"><\/a><!-- doxytag: member="conf.h::config_init" ref="068a358868c409bbd99d7eef3c988866" args="(void)" -->$/;"	a
0ec3017454ea7a8398d25c8ab83890fd	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="0ec3017454ea7a8398d25c8ab83890fd"><\/a><!-- doxytag: member="conf.h::DEFAULT_CONFIGFILE" ref="0ec3017454ea7a8398d25c8ab83890fd" args="" -->$/;"	a
0f9540b3f729ba3b3d31b613d3eca364	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="0f9540b3f729ba3b3d31b613d3eca364"><\/a><!-- doxytag: member="conf.h::config_validate" ref="0f9540b3f729ba3b3d31b613d3eca364" args="(void)" -->$/;"	a
0fd56151aad780327b8968df38695580	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0fd56151aad780327b8968df38695580"><\/a><!-- doxytag: member="conf.h::t_firewall_ruleset" ref="0fd56151aad780327b8968df38695580" args="" -->$/;"	a
11ea6dd746ca0526817bdd6515cbcc29	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="11ea6dd746ca0526817bdd6515cbcc29"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVPINGPATHFRAGMENT" ref="11ea6dd746ca0526817bdd6515cbcc29" args="" -->$/;"	a
12e10b7db61ec0a23264d2a7762c6ef3	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="12e10b7db61ec0a23264d2a7762c6ef3"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVLOGINPATHFRAGMENT" ref="12e10b7db61ec0a23264d2a7762c6ef3" args="" -->$/;"	a
16581929d818bc322bbebce8a7a12117	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="16581929d818bc322bbebce8a7a12117"><\/a><!-- doxytag: member="conf.h::DEFAULT_HTMLMSGFILE" ref="16581929d818bc322bbebce8a7a12117" args="" -->$/;"	a
17b6b425f18de3865e44b534c1f1f1cc	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="17b6b425f18de3865e44b534c1f1f1cc"><\/a><!-- doxytag: member="conf.h::config_init_override" ref="17b6b425f18de3865e44b534c1f1f1cc" args="(void)" -->$/;"	a
1ea67d2117d4f50445d1c9428bac5a64	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="1ea67d2117d4f50445d1c9428bac5a64"><\/a><!-- doxytag: member="conf.h::DEFAULT_CLIENTTIMEOUT" ref="1ea67d2117d4f50445d1c9428bac5a64" args="" -->$/;"	a
29ca3acd6665cd70286185f3dd4ab09d	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="29ca3acd6665cd70286185f3dd4ab09d"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVPORTALPATHFRAGMENT" ref="29ca3acd6665cd70286185f3dd4ab09d" args="" -->$/;"	a
32198b3d9cda9e7ea18d9680f805dc87	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="32198b3d9cda9e7ea18d9680f805dc87"><\/a><!-- doxytag: member="conf.h::DEFAULT_DEBUGLEVEL" ref="32198b3d9cda9e7ea18d9680f805dc87" args="" -->$/;"	a
41ce987eea16297a459249b1e4c69ed7	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="41ce987eea16297a459249b1e4c69ed7"><\/a><!-- doxytag: member="conf.h::DEFAULT_LOG_SYSLOG" ref="41ce987eea16297a459249b1e4c69ed7" args="" -->$/;"	a
4468d0b44b441d03ea8270e09de86f65	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="4468d0b44b441d03ea8270e09de86f65"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVPORT" ref="4468d0b44b441d03ea8270e09de86f65" args="" -->$/;"	a
545ee1dadc18a259ffd0d798f999ddc3	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="545ee1dadc18a259ffd0d798f999ddc3"><\/a><!-- doxytag: member="conf.h::get_ruleset" ref="545ee1dadc18a259ffd0d798f999ddc3" args="(const char *)" -->$/;"	a
64e73012596dd6628c18742c8046069f	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="64e73012596dd6628c18742c8046069f"><\/a><!-- doxytag: member="conf.h::config_get_config" ref="64e73012596dd6628c18742c8046069f" args="(void)" -->$/;"	a
66cff01e093b0b7d5335a7939f839341	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="66cff01e093b0b7d5335a7939f839341"><\/a><!-- doxytag: member="conf.h::DEFAULT_SYSLOG_FACILITY" ref="66cff01e093b0b7d5335a7939f839341" args="" -->$/;"	a
771a6a60dbaa6c7532ab6cd31b397f7d	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="771a6a60dbaa6c7532ab6cd31b397f7d"><\/a><!-- doxytag: member="conf.h::NUM_EXT_INTERFACE_DETECT_RETRY" ref="771a6a60dbaa6c7532ab6cd31b397f7d" args="" -->$/;"	a
784fe164c1e4d1e62365a2505460592a	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="784fe164c1e4d1e62365a2505460592a"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVSSLAVAILABLE" ref="784fe164c1e4d1e62365a2505460592a" args="" -->$/;"	a
82ffcd3c683aadc31aca9c53a2d2739a	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="82ffcd3c683aadc31aca9c53a2d2739a"><\/a><!-- doxytag: member="conf.h::get_auth_server" ref="82ffcd3c683aadc31aca9c53a2d2739a" args="(void)" -->$/;"	a
90dfc8bedb1f49c67ee6aa006b73843b	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="90dfc8bedb1f49c67ee6aa006b73843b"><\/a><!-- doxytag: member="conf.h::t_firewall_rule" ref="90dfc8bedb1f49c67ee6aa006b73843b" args="" -->$/;"	a
9bcb72263ba584b1da18d3b2f2b65e6a	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="9bcb72263ba584b1da18d3b2f2b65e6a"><\/a><!-- doxytag: member="conf.h::DEFAULT_CHECKINTERVAL" ref="9bcb72263ba584b1da18d3b2f2b65e6a" args="" -->$/;"	a
9d674c58e3d919b7cd55aa12ed52be3c	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="9d674c58e3d919b7cd55aa12ed52be3c"><\/a><!-- doxytag: member="conf.h::mark_auth_server_bad" ref="9d674c58e3d919b7cd55aa12ed52be3c" args="(t_auth_serv *)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
af3b14d87ff5b04067f3f0911905c560	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="af3b14d87ff5b04067f3f0911905c560"><\/a><!-- doxytag: member="conf.h::parse_trusted_mac_list" ref="af3b14d87ff5b04067f3f0911905c560" args="(char *)" -->$/;"	a
af813a168a0bd5a77aa515073950a135	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="af813a168a0bd5a77aa515073950a135"><\/a><!-- doxytag: member="conf.h::DEFAULT_HTTPDNAME" ref="af813a168a0bd5a77aa515073950a135" args="" -->$/;"	a
b67c119b3d066438d4c3405b518bb289	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="b67c119b3d066438d4c3405b518bb289"><\/a><!-- doxytag: member="conf.h::EXT_INTERFACE_DETECT_RETRY_INTERVAL" ref="b67c119b3d066438d4c3405b518bb289" args="" -->$/;"	a
c71029bbf7b0ee40ad72b17ff77f7896	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="c71029bbf7b0ee40ad72b17ff77f7896"><\/a><!-- doxytag: member="conf.h::DEFAULT_DAEMON" ref="c71029bbf7b0ee40ad72b17ff77f7896" args="" -->$/;"	a
ca85302a5a857716f3b0275fbbff135f	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="ca85302a5a857716f3b0275fbbff135f"><\/a><!-- doxytag: member="conf.h::DEFAULT_HTTPDMAXCONN" ref="ca85302a5a857716f3b0275fbbff135f" args="" -->$/;"	a
cc46f3e3f6b7dbbf1f4e7a31553d9797	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cc46f3e3f6b7dbbf1f4e7a31553d9797"><\/a><!-- doxytag: member="conf.h::t_trusted_mac" ref="cc46f3e3f6b7dbbf1f4e7a31553d9797" args="" -->$/;"	a
cee7c0173f525e29800b87222b407386	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="cee7c0173f525e29800b87222b407386"><\/a><!-- doxytag: member="conf.h::DEFAULT_WDCTL_SOCK" ref="cee7c0173f525e29800b87222b407386" args="" -->$/;"	a
d1127f95cef99fe1384a30fca8b9c392	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="d1127f95cef99fe1384a30fca8b9c392"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVPATH" ref="d1127f95cef99fe1384a30fca8b9c392" args="" -->$/;"	a
d26385411b1807104fa1504dff7bfb0d	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="d26385411b1807104fa1504dff7bfb0d"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVMSGPATHFRAGMENT" ref="d26385411b1807104fa1504dff7bfb0d" args="" -->$/;"	a
d3faac0efa0ac4c1032c0c54f7e93711	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="d3faac0efa0ac4c1032c0c54f7e93711"><\/a><!-- doxytag: member="conf.h::config_read" ref="d3faac0efa0ac4c1032c0c54f7e93711" args="(const char *filename)" -->$/;"	a
d76ac64532ff817e332a6361a59231cb	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="d76ac64532ff817e332a6361a59231cb"><\/a><!-- doxytag: member="conf.h::LOCK_CONFIG" ref="d76ac64532ff817e332a6361a59231cb" args="()" -->$/;"	a
dd3fb3e4a4d675d452c3c7926f60fac2	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dd3fb3e4a4d675d452c3c7926f60fac2"><\/a><!-- doxytag: member="conf.h::t_auth_serv" ref="dd3fb3e4a4d675d452c3c7926f60fac2" args="" -->$/;"	a
e38786151577e46b298b7baf0ca0fe96	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="e38786151577e46b298b7baf0ca0fe96"><\/a><!-- doxytag: member="conf.h::DEFAULT_GATEWAYID" ref="e38786151577e46b298b7baf0ca0fe96" args="" -->$/;"	a
ea1d1da1ff4c9161109a81a0b1d6fd2c	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="ea1d1da1ff4c9161109a81a0b1d6fd2c"><\/a><!-- doxytag: member="conf.h::DEFAULT_INTERNAL_SOCK" ref="ea1d1da1ff4c9161109a81a0b1d6fd2c" args="" -->$/;"	a
eecec081c6ba90900777bc8db01f774f	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="eecec081c6ba90900777bc8db01f774f"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVSSLPORT" ref="eecec081c6ba90900777bc8db01f774f" args="" -->$/;"	a
f14cf5aa96a948b2d23a1ff0aeba3e48	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="f14cf5aa96a948b2d23a1ff0aeba3e48"><\/a><!-- doxytag: member="conf.h::DEFAULT_GATEWAYPORT" ref="f14cf5aa96a948b2d23a1ff0aeba3e48" args="" -->$/;"	a
f83da39ab6845671d9b1a2bf635951fa	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="f83da39ab6845671d9b1a2bf635951fa"><\/a><!-- doxytag: member="conf.h::DEFAULT_AUTHSERVAUTHPATHFRAGMENT" ref="f83da39ab6845671d9b1a2bf635951fa" args="" -->$/;"	a
fac07fdf02de5cace1687c411ee42d56	install/share/doc/wifidog-20090925/html/conf_8h.html	/^<a class="anchor" name="fac07fdf02de5cace1687c411ee42d56"><\/a><!-- doxytag: member="conf.h::UNLOCK_CONFIG" ref="fac07fdf02de5cace1687c411ee42d56" args="()" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<h1>debug.c<\/h1><a href="debug_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: debug.c 1305 2007-11-01 20:04:20Z benoitg $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;time.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00033"><\/a>00033 $/;"	a
l00034	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00035"><\/a>00035 $/;"	a
l00038	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="keywordtype">void<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00039"><\/a>00039 _debug(<span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> line, <span class="keywordtype">int<\/span> level, <span class="keywordtype">char<\/span> *format, ...)$/;"	a
l00040	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00040"><\/a>00040 {$/;"	a
l00041	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00041"><\/a>00041     <span class="keywordtype">char<\/span> buf[28];$/;"	a
l00042	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00042"><\/a>00042     va_list vlist;$/;"	a
l00043	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00043"><\/a>00043     <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00044	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00044"><\/a>00044     time_t ts;$/;"	a
l00045	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00046"><\/a>00046     time(&amp;ts);$/;"	a
l00047	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00047"><\/a>00047 $/;"	a
l00048	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00048"><\/a>00048     <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#72a375118114359c8fcf890bba1e77fb" title="Debug information verbosity.">debuglevel<\/a> &gt;= level) {$/;"	a
l00049	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00049"><\/a>00049         va_start(vlist, format);$/;"	a
l00050	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00050"><\/a>00050 $/;"	a
l00051	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00051"><\/a>00051         <span class="keywordflow">if<\/span> (level &lt;= LOG_WARNING) {$/;"	a
l00052	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00052"><\/a>00052             fprintf(stderr, <span class="stringliteral">"[%d][%.24s][%u](%s:%d) "<\/span>, level, ctime_r(&amp;ts, buf), getpid(),$/;"	a
l00053	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00053"><\/a>00053                             filename, line);$/;"	a
l00054	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00054"><\/a>00054             vfprintf(stderr, format, vlist);$/;"	a
l00055	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00055"><\/a>00055             fputc(<span class="charliteral">'\\n'<\/span>, stderr);$/;"	a
l00056	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00056"><\/a>00056         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (!config-&gt;<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a>) {$/;"	a
l00057	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00057"><\/a>00057             fprintf(stdout, <span class="stringliteral">"[%d][%.24s][%u](%s:%d) "<\/span>, level, ctime_r(&amp;ts, buf), getpid(),$/;"	a
l00058	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00058"><\/a>00058                             filename, line);$/;"	a
l00059	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00059"><\/a>00059             vfprintf(stdout, format, vlist);$/;"	a
l00060	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00060"><\/a>00060             fputc(<span class="charliteral">'\\n'<\/span>, stdout);$/;"	a
l00061	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00061"><\/a>00061             fflush(stdout);$/;"	a
l00062	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00062"><\/a>00062         }$/;"	a
l00063	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00063"><\/a>00063 $/;"	a
l00064	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00064"><\/a>00064         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#784dd5fa3d27b3d1311b18f23e919362" title="boolean, wether to log to syslog">log_syslog<\/a>) {$/;"	a
l00065	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00065"><\/a>00065             openlog(<span class="stringliteral">"wifidog"<\/span>, LOG_PID, config-&gt;<a class="code" href="structs__config.html#eaad87f73a87a2f752b111dad813902d" title="facility to use when using syslog for logging">syslog_facility<\/a>);$/;"	a
l00066	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00066"><\/a>00066             vsyslog(level, format, vlist);$/;"	a
l00067	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00067"><\/a>00067             closelog();$/;"	a
l00068	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00068"><\/a>00068         }$/;"	a
l00069	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00069"><\/a>00069     }$/;"	a
l00070	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00070"><\/a>00070 }$/;"	a
l00071	install/share/doc/wifidog-20090925/html/debug_8c-source.html	/^<a name="l00071"><\/a>00071 $/;"	a
_details	install/share/doc/wifidog-20090925/html/debug_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a7c17e74bfc56c95b5eb2a9f45b289e7	install/share/doc/wifidog-20090925/html/debug_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a7c17e74bfc56c95b5eb2a9f45b289e7"><\/a><!-- doxytag: member="debug.c::_debug" ref="a7c17e74bfc56c95b5eb2a9f45b289e7" args="(char *filename, int line, int level, char *format,...)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<h1>debug.h<\/h1><a href="debug_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: debug.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _DEBUG_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _DEBUG_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00033"><\/a><a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a">00033<\/a> <span class="preprocessor">#define debug(level, format...) _debug(__FILE__, __LINE__, level, format)<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor"><\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00036"><\/a>00036 <span class="keywordtype">void<\/span> _debug(<span class="keywordtype">char<\/span> *filename, <span class="keywordtype">int<\/span> line, <span class="keywordtype">int<\/span> level, <span class="keywordtype">char<\/span> *format, ...);$/;"	a
l00037	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00037"><\/a>00037 $/;"	a
l00038	install/share/doc/wifidog-20090925/html/debug_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#endif <\/span><span class="comment">\/* _DEBUG_H_ *\/<\/span>$/;"	a
522ebc0c3c064e7ddf37eda0ee8c3f8a	install/share/doc/wifidog-20090925/html/debug_8h.html	/^<a class="anchor" name="522ebc0c3c064e7ddf37eda0ee8c3f8a"><\/a><!-- doxytag: member="debug.h::debug" ref="522ebc0c3c064e7ddf37eda0ee8c3f8a" args="(level, format...)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/debug_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a7c17e74bfc56c95b5eb2a9f45b289e7	install/share/doc/wifidog-20090925/html/debug_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a7c17e74bfc56c95b5eb2a9f45b289e7"><\/a><!-- doxytag: member="debug.h::_debug" ref="a7c17e74bfc56c95b5eb2a9f45b289e7" args="(char *filename, int line, int level, char *format,...)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<h1>firewall.c<\/h1><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/*<\/span>$/;"	a
l00022	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00022"><\/a>00022 <span class="comment"> * $Id: firewall.c 1389 2009-02-27 17:39:30Z benoitg $<\/span>$/;"	a
l00023	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00023"><\/a>00023 <span class="comment"> *\/<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor"><\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;sys\/wait.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;sys\/unistd.h&gt;<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00043"><\/a>00043 $/;"	a
l00044	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include &lt;sys\/uio.h&gt;<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include &lt;fcntl.h&gt;<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include &lt;netdb.h&gt;<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include &lt;sys\/time.h&gt;<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00053	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#ifdef __linux__<\/span>$/;"	a
l00054	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor"><\/span><span class="preprocessor">#include &lt;net\/ethernet.h&gt;<\/span>$/;"	a
l00055	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="preprocessor">#include &lt;netinet\/ip.h&gt;<\/span>$/;"	a
l00056	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="preprocessor">#include &lt;netinet\/ip_icmp.h&gt;<\/span>$/;"	a
l00057	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="preprocessor">#include &lt;netpacket\/packet.h&gt;<\/span>$/;"	a
l00058	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="preprocessor">#endif<\/span>$/;"	a
l00059	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00059"><\/a>00059 <span class="preprocessor"><\/span>$/;"	a
l00060	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="preprocessor">#if defined(__NetBSD__)<\/span>$/;"	a
l00061	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00061"><\/a>00061 <span class="preprocessor"><\/span><span class="preprocessor">#include &lt;netinet\/in_systm.h&gt;<\/span>$/;"	a
l00062	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00062"><\/a>00062 <span class="preprocessor">#include &lt;netinet\/ip.h&gt;<\/span>$/;"	a
l00063	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="preprocessor">#include &lt;netinet\/ip_icmp.h&gt;<\/span>$/;"	a
l00064	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00064"><\/a>00064 <span class="preprocessor">#endif<\/span>$/;"	a
l00065	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00065"><\/a>00065 <span class="preprocessor"><\/span>$/;"	a
l00066	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00066"><\/a>00066 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00067	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00067"><\/a>00067 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00068	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00068"><\/a>00068 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00069	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00069"><\/a>00069 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00070	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00070"><\/a>00070 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00071	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00071"><\/a>00071 <span class="preprocessor">#include "<a class="code" href="fw__iptables_8h.html" title="Firewall iptables functions.">fw_iptables.h<\/a>"<\/span>$/;"	a
l00072	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00072"><\/a>00072 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00073	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00073"><\/a>00073 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00074	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00074"><\/a>00074 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00075	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00075"><\/a>00075 $/;"	a
l00076	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00076"><\/a>00076 <span class="keyword">extern<\/span> pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00077	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00077"><\/a>00077 $/;"	a
l00078	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00078"><\/a>00078 <span class="comment">\/* from commandline.c *\/<\/span>$/;"	a
l00079	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00079"><\/a>00079 <span class="keyword">extern<\/span> pid_t restart_orig_pid;$/;"	a
l00080	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00080"><\/a>00080 $/;"	a
l00081	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00081"><\/a>00081 $/;"	a
l00082	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00082"><\/a>00082 $/;"	a
l00091	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00091"><\/a>00091 <span class="keywordtype">int<\/span>$/;"	a
l00092	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00092"><\/a><a class="code" href="firewall_8h.html#fa99884d38b776bf412e4b5f4cdce1ea">00092<\/a> fw_allow(<span class="keywordtype">char<\/span> *ip, <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> fw_connection_state)$/;"	a
l00093	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00093"><\/a>00093 {$/;"	a
l00094	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00094"><\/a>00094     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Allowing %s %s with fw_connection_state %d"<\/span>, ip, mac, fw_connection_state);$/;"	a
l00095	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00095"><\/a>00095 $/;"	a
l00096	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00096"><\/a>00096     <span class="keywordflow">return<\/span> iptables_fw_access(FW_ACCESS_ALLOW, ip, mac, fw_connection_state);$/;"	a
l00097	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00097"><\/a>00097 }$/;"	a
l00098	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00098"><\/a>00098 $/;"	a
l00106	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00106"><\/a>00106 <span class="keywordtype">int<\/span>$/;"	a
l00107	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00107"><\/a><a class="code" href="firewall_8h.html#642fc7cfa3f52cf80d63c704030c2119">00107<\/a> fw_deny(<span class="keywordtype">char<\/span> *ip, <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> fw_connection_state)$/;"	a
l00108	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00108"><\/a>00108 {$/;"	a
l00109	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00109"><\/a>00109     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Denying %s %s with fw_connection_state %d"<\/span>, ip, mac, fw_connection_state);$/;"	a
l00110	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00110"><\/a>00110 $/;"	a
l00111	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00111"><\/a>00111     <span class="keywordflow">return<\/span> iptables_fw_access(FW_ACCESS_DENY, ip, mac, fw_connection_state);$/;"	a
l00112	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00112"><\/a>00112 }$/;"	a
l00113	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00113"><\/a>00113 $/;"	a
l00114	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00114"><\/a>00114 <span class="comment">\/* XXX DCY *\/<\/span>$/;"	a
l00121	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00121"><\/a>00121 <span class="keywordtype">char<\/span>           *$/;"	a
l00122	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00122"><\/a><a class="code" href="firewall_8h.html#9870ce36f7e300bf9930a77a69a9bf1a">00122<\/a> arp_get(<span class="keywordtype">char<\/span> *req_ip)$/;"	a
l00123	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00123"><\/a>00123 {$/;"	a
l00124	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00124"><\/a>00124     FILE           *proc;$/;"	a
l00125	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00125"><\/a>00125          <span class="keywordtype">char<\/span> ip[16];$/;"	a
l00126	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00126"><\/a>00126          <span class="keywordtype">char<\/span> mac[18];$/;"	a
l00127	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00127"><\/a>00127          <span class="keywordtype">char<\/span> * reply = NULL;$/;"	a
l00128	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00128"><\/a>00128 $/;"	a
l00129	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00129"><\/a>00129     <span class="keywordflow">if<\/span> (!(proc = fopen(<span class="stringliteral">"\/proc\/net\/arp"<\/span>, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00130	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00130"><\/a>00130         <span class="keywordflow">return<\/span> NULL;$/;"	a
l00131	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00131"><\/a>00131     }$/;"	a
l00132	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00132"><\/a>00132 $/;"	a
l00133	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00133"><\/a>00133     <span class="comment">\/* Skip first line *\/<\/span>$/;"	a
l00134	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00134"><\/a>00134          <span class="keywordflow">while<\/span> (!feof(proc) &amp;&amp; fgetc(proc) != <span class="charliteral">'\\n'<\/span>);$/;"	a
l00135	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00135"><\/a>00135 $/;"	a
l00136	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00136"><\/a>00136          <span class="comment">\/* Find ip, copy mac in reply *\/<\/span>$/;"	a
l00137	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00137"><\/a>00137          reply = NULL;$/;"	a
l00138	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00138"><\/a>00138     <span class="keywordflow">while<\/span> (!feof(proc) &amp;&amp; (fscanf(proc, <span class="stringliteral">" %15[0-9.] %*s %*s %17[A-Fa-f0-9:] %*s %*s"<\/span>, ip, mac) == 2)) {$/;"	a
l00139	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00139"><\/a>00139                   <span class="keywordflow">if<\/span> (strcmp(ip, req_ip) == 0) {$/;"	a
l00140	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00140"><\/a>00140                                 reply = safe_strdup(mac);$/;"	a
l00141	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00141"><\/a>00141                                 <span class="keywordflow">break<\/span>;$/;"	a
l00142	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00142"><\/a>00142                   }$/;"	a
l00143	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00143"><\/a>00143     }$/;"	a
l00144	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00144"><\/a>00144 $/;"	a
l00145	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00145"><\/a>00145     fclose(proc);$/;"	a
l00146	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00146"><\/a>00146 $/;"	a
l00147	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00147"><\/a>00147     <span class="keywordflow">return<\/span> reply;$/;"	a
l00148	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00148"><\/a>00148 }$/;"	a
l00149	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00149"><\/a>00149 $/;"	a
l00152	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00152"><\/a>00152 <span class="keywordtype">int<\/span>$/;"	a
l00153	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00153"><\/a><a class="code" href="firewall_8h.html#e30eaa22b5a8ae0e8915d398743db211">00153<\/a> fw_init(<span class="keywordtype">void<\/span>)$/;"	a
l00154	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00154"><\/a>00154 {$/;"	a
l00155	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00155"><\/a>00155     <span class="keywordtype">int<\/span> flags, oneopt = 1, zeroopt = 0;$/;"	a
l00156	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00156"><\/a>00156          <span class="keywordtype">int<\/span> result = 0;$/;"	a
l00157	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00157"><\/a>00157          <a class="code" href="struct__t__client.html">t_client<\/a> * client = NULL;$/;"	a
l00158	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00158"><\/a>00158 $/;"	a
l00159	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00159"><\/a>00159     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Creating ICMP socket"<\/span>);$/;"	a
l00160	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00160"><\/a>00160     <span class="keywordflow">if<\/span> ((icmp_fd = socket (AF_INET, SOCK_RAW, IPPROTO_ICMP)) == -1 ||$/;"	a
l00161	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00161"><\/a>00161             (flags = fcntl(icmp_fd, F_GETFL, 0)) == -1 ||$/;"	a
l00162	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00162"><\/a>00162              fcntl(icmp_fd, F_SETFL, flags | O_NONBLOCK) == -1 ||$/;"	a
l00163	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00163"><\/a>00163              setsockopt(icmp_fd, SOL_SOCKET, SO_RCVBUF, &amp;oneopt, <span class="keyword">sizeof<\/span>(oneopt)) ||$/;"	a
l00164	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00164"><\/a>00164              setsockopt(icmp_fd, SOL_SOCKET, SO_DONTROUTE, &amp;zeroopt, <span class="keyword">sizeof<\/span>(zeroopt)) == -1) {$/;"	a
l00165	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00165"><\/a>00165         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Cannot create ICMP raw socket."<\/span>);$/;"	a
l00166	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordflow">return<\/span> 0;$/;"	a
l00167	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00167"><\/a>00167     }$/;"	a
l00168	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00168"><\/a>00168 $/;"	a
l00169	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00169"><\/a>00169     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Initializing Firewall"<\/span>);$/;"	a
l00170	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00170"><\/a>00170     result = iptables_fw_init();$/;"	a
l00171	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00171"><\/a>00171 $/;"	a
l00172	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00172"><\/a>00172          <span class="keywordflow">if<\/span> (restart_orig_pid) {$/;"	a
l00173	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00173"><\/a>00173                  <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Restoring firewall rules for clients inherited from parent"<\/span>);$/;"	a
l00174	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00174"><\/a>00174                  LOCK_CLIENT_LIST();$/;"	a
l00175	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00175"><\/a>00175                  client = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>();$/;"	a
l00176	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00176"><\/a>00176                  <span class="keywordflow">while<\/span> (client) {$/;"	a
l00177	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00177"><\/a>00177                          fw_allow(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00178	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00178"><\/a>00178                          client = client-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00179	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00179"><\/a>00179                  }$/;"	a
l00180	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00180"><\/a>00180                  UNLOCK_CLIENT_LIST();$/;"	a
l00181	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00181"><\/a>00181          }$/;"	a
l00182	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00182"><\/a>00182 $/;"	a
l00183	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00183"><\/a>00183          <span class="keywordflow">return<\/span> result;$/;"	a
l00184	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00184"><\/a>00184 }$/;"	a
l00185	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00185"><\/a>00185 $/;"	a
l00188	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00188"><\/a>00188 <span class="keywordtype">void<\/span>$/;"	a
l00189	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00189"><\/a><a class="code" href="firewall_8h.html#a8905d925b83283cdbf028243c6ed026">00189<\/a> fw_clear_authservers(<span class="keywordtype">void<\/span>)$/;"	a
l00190	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00190"><\/a>00190 {$/;"	a
l00191	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00191"><\/a>00191         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Clearing the authservers list"<\/span>);$/;"	a
l00192	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00192"><\/a>00192         iptables_fw_clear_authservers();$/;"	a
l00193	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00193"><\/a>00193 }$/;"	a
l00194	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00194"><\/a>00194 $/;"	a
l00197	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00197"><\/a>00197 <span class="keywordtype">void<\/span>$/;"	a
l00198	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00198"><\/a><a class="code" href="firewall_8h.html#b1fc844e7144f2bc3d6672db0964a31c">00198<\/a> fw_set_authservers(<span class="keywordtype">void<\/span>)$/;"	a
l00199	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00199"><\/a>00199 {$/;"	a
l00200	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00200"><\/a>00200         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Setting the authservers list"<\/span>);$/;"	a
l00201	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00201"><\/a>00201         iptables_fw_set_authservers();$/;"	a
l00202	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00202"><\/a>00202 }$/;"	a
l00203	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00203"><\/a>00203 $/;"	a
l00208	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00208"><\/a>00208 <span class="keywordtype">int<\/span>$/;"	a
l00209	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00209"><\/a><a class="code" href="firewall_8h.html#7202b7d511de9238c91d8d68ef78815f">00209<\/a> fw_destroy(<span class="keywordtype">void<\/span>)$/;"	a
l00210	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00210"><\/a>00210 {$/;"	a
l00211	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00211"><\/a>00211     <span class="keywordflow">if<\/span> (icmp_fd != 0) {$/;"	a
l00212	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00212"><\/a>00212         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Closing ICMP socket"<\/span>);$/;"	a
l00213	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00213"><\/a>00213         close(icmp_fd);$/;"	a
l00214	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00214"><\/a>00214     }$/;"	a
l00215	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00215"><\/a>00215 $/;"	a
l00216	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00216"><\/a>00216     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Removing Firewall rules"<\/span>);$/;"	a
l00217	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00217"><\/a>00217     <span class="keywordflow">return<\/span> iptables_fw_destroy();$/;"	a
l00218	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00218"><\/a>00218 }$/;"	a
l00219	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00219"><\/a>00219 $/;"	a
l00223	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00223"><\/a>00223 <span class="keywordtype">void<\/span>$/;"	a
l00224	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00224"><\/a><a class="code" href="firewall_8h.html#f9c7aefe796696e20e52955a80fff57f">00224<\/a> fw_sync_with_authserver(<span class="keywordtype">void<\/span>)$/;"	a
l00225	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00225"><\/a>00225 {$/;"	a
l00226	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00226"><\/a>00226     <a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a>  authresponse;$/;"	a
l00227	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00227"><\/a>00227     <span class="keywordtype">char<\/span>            *token, *ip, *mac;$/;"	a
l00228	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00228"><\/a>00228     <a class="code" href="struct__t__client.html">t_client<\/a>        *p1, *p2;$/;"	a
l00229	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00229"><\/a>00229     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span>      incoming, outgoing;$/;"	a
l00230	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00230"><\/a>00230     <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00231	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00231"><\/a>00231 $/;"	a
l00232	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00232"><\/a>00232     <span class="keywordflow">if<\/span> (-1 == iptables_fw_counters_update()) {$/;"	a
l00233	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00233"><\/a>00233         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not get counters from firewall!"<\/span>);$/;"	a
l00234	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00234"><\/a>00234         <span class="keywordflow">return<\/span>;$/;"	a
l00235	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00235"><\/a>00235     }$/;"	a
l00236	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00236"><\/a>00236 $/;"	a
l00237	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00237"><\/a>00237     LOCK_CLIENT_LIST();$/;"	a
l00238	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00238"><\/a>00238 $/;"	a
l00239	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00239"><\/a>00239     <span class="keywordflow">for<\/span> (p1 = p2 = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>(); NULL != p1; p1 = p2) {$/;"	a
l00240	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00240"><\/a>00240         p2 = p1-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00241	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00241"><\/a>00241 $/;"	a
l00242	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00242"><\/a>00242         ip = safe_strdup(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00243	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00243"><\/a>00243         token = safe_strdup(p1-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00244	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00244"><\/a>00244         mac = safe_strdup(p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00245	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00245"><\/a>00245             outgoing = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>;$/;"	a
l00246	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00246"><\/a>00246             incoming = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>;$/;"	a
l00247	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00247"><\/a>00247 $/;"	a
l00248	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00248"><\/a>00248             UNLOCK_CLIENT_LIST();$/;"	a
l00249	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00249"><\/a>00249         <span class="comment">\/* Ping the client, if he responds it'll keep activity on the link.<\/span>$/;"	a
l00250	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00250"><\/a>00250 <span class="comment">         * However, if the firewall blocks it, it will not help.  The suggested<\/span>$/;"	a
l00251	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00251"><\/a>00251 <span class="comment">         * way to deal witht his is to keep the DHCP lease time extremely<\/span>$/;"	a
l00252	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00252"><\/a>00252 <span class="comment">         * short:  Shorter than config-&gt;checkinterval * config-&gt;clienttimeout *\/<\/span>$/;"	a
l00253	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00253"><\/a>00253         icmp_ping(ip);$/;"	a
l00254	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00254"><\/a>00254         <span class="comment">\/* Update the counters on the remote server only if we have an auth server *\/<\/span>$/;"	a
l00255	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00255"><\/a>00255         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> != NULL) {$/;"	a
l00256	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00256"><\/a>00256             <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(&amp;authresponse, <a class="code" href="centralserver_8h.html#3ebb2c04a3ef087a8956e171068759f7" title="Update the central server&amp;#39;s traffic counters.">REQUEST_TYPE_COUNTERS<\/a>, ip, mac, token, incoming, outgoing);$/;"	a
l00257	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00257"><\/a>00257         }$/;"	a
l00258	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00258"><\/a>00258             LOCK_CLIENT_LIST();$/;"	a
l00259	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00259"><\/a>00259 $/;"	a
l00260	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00260"><\/a>00260         <span class="keywordflow">if<\/span> (!(p1 = <a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(ip, mac))) {$/;"	a
l00261	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00261"><\/a>00261             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Node %s was freed while being re-validated!"<\/span>, ip);$/;"	a
l00262	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00262"><\/a>00262         } <span class="keywordflow">else<\/span> {$/;"	a
l00263	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00263"><\/a>00263                 time_t  current_time=time(NULL);$/;"	a
l00264	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00264"><\/a>00264                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Checking client %s for timeout:  Last updated %ld (%ld seconds ago), timeout delay %ld seconds, current time %ld, "<\/span>,$/;"	a
l00265	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00265"><\/a>00265                         p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>, current_time-p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>, config-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a> * config-&gt;<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a>, current_time);$/;"	a
l00266	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00266"><\/a>00266             <span class="keywordflow">if<\/span> (p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a> +$/;"	a
l00267	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00267"><\/a>00267                                 (config-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a> * config-&gt;<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a>)$/;"	a
l00268	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00268"><\/a>00268                                 &lt;= current_time) {$/;"	a
l00269	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00269"><\/a>00269                 <span class="comment">\/* Timing out user *\/<\/span>$/;"	a
l00270	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00270"><\/a>00270                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"%s - Inactive for more than %ld seconds, removing client and denying in firewall"<\/span>,$/;"	a
l00271	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00271"><\/a>00271                         p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, config-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a> * config-&gt;<a class="code" href="structs__config.html#9284ae2f338cce20da86aa74916df38c" title="How many CheckIntervals before a client must be re-authenticated.">clienttimeout<\/a>);$/;"	a
l00272	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00272"><\/a>00272                 fw_deny(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00273	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00273"><\/a>00273                 <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(p1);$/;"	a
l00274	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00274"><\/a>00274 $/;"	a
l00275	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00275"><\/a>00275                 <span class="comment">\/* Advertise the logout if we have an auth server *\/<\/span>$/;"	a
l00276	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00276"><\/a>00276                 <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> != NULL) {$/;"	a
l00277	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00277"><\/a>00277                                         UNLOCK_CLIENT_LIST();$/;"	a
l00278	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00278"><\/a>00278                                         <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(&amp;authresponse, <a class="code" href="centralserver_8h.html#b262747ac931a0a8c357448e7a2cf301" title="Notify the the central server of a client logout.">REQUEST_TYPE_LOGOUT<\/a>, ip, mac, token, 0, 0);$/;"	a
l00279	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00279"><\/a>00279                                         LOCK_CLIENT_LIST();$/;"	a
l00280	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00280"><\/a>00280                 }$/;"	a
l00281	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00281"><\/a>00281             } <span class="keywordflow">else<\/span> {$/;"	a
l00282	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00282"><\/a>00282                 <span class="comment">\/*<\/span>$/;"	a
l00283	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00283"><\/a>00283 <span class="comment">                 * This handles any change in<\/span>$/;"	a
l00284	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00284"><\/a>00284 <span class="comment">                 * the status this allows us<\/span>$/;"	a
l00285	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00285"><\/a>00285 <span class="comment">                 * to change the status of a<\/span>$/;"	a
l00286	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00286"><\/a>00286 <span class="comment">                 * user while he's connected<\/span>$/;"	a
l00287	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00287"><\/a>00287 <span class="comment">                 *<\/span>$/;"	a
l00288	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00288"><\/a>00288 <span class="comment">                 * Only run if we have an auth server<\/span>$/;"	a
l00289	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00289"><\/a>00289 <span class="comment">                 * configured!<\/span>$/;"	a
l00290	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00290"><\/a>00290 <span class="comment">                 *\/<\/span>$/;"	a
l00291	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00291"><\/a>00291                 <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> != NULL) {$/;"	a
l00292	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00292"><\/a>00292                     <span class="keywordflow">switch<\/span> (authresponse.<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>) {$/;"	a
l00293	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00293"><\/a>00293                         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0292d9a8170f682225413fde8eb0b4e75">AUTH_DENIED<\/a>:$/;"	a
l00294	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00294"><\/a>00294                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"%s - Denied. Removing client and firewall rules"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00295	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00295"><\/a>00295                             fw_deny(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00296	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00296"><\/a>00296                             <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(p1);$/;"	a
l00297	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00297"><\/a>00297                             <span class="keywordflow">break<\/span>;$/;"	a
l00298	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00298"><\/a>00298 $/;"	a
l00299	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00299"><\/a>00299                         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3cd61356acf42a9e90cbd2eb7eae8bb">AUTH_VALIDATION_FAILED<\/a>:$/;"	a
l00300	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00300"><\/a>00300                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"%s - Validation timeout, now denied. Removing client and firewall rules"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00301	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00301"><\/a>00301                             fw_deny(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00302	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00302"><\/a>00302                             <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(p1);$/;"	a
l00303	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00303"><\/a>00303                             <span class="keywordflow">break<\/span>;$/;"	a
l00304	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00304"><\/a>00304 $/;"	a
l00305	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00305"><\/a>00305                         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c3f3f3844b1980a12e714b5142283926">AUTH_ALLOWED<\/a>:$/;"	a
l00306	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00306"><\/a>00306                             <span class="keywordflow">if<\/span> (p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> != <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>) {$/;"	a
l00307	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00307"><\/a>00307                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"%s - Access has changed to allowed, refreshing firewall and clearing counters"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00308	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00308"><\/a>00308                                 <span class="comment">\/\/WHY did we deny, then allow!?!? benoitg 2007-06-21<\/span>$/;"	a
l00309	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00309"><\/a>00309                                 <span class="comment">\/\/fw_deny(p1-&gt;ip, p1-&gt;mac, p1-&gt;fw_connection_state);<\/span>$/;"	a
l00310	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00310"><\/a>00310 $/;"	a
l00311	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00311"><\/a>00311                                 <span class="keywordflow">if<\/span> (p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> != <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>) {$/;"	a
l00312	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00312"><\/a>00312      p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> = 0;$/;"	a
l00313	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00313"><\/a>00313                                 }$/;"	a
l00314	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00314"><\/a>00314                                 <span class="keywordflow">else<\/span> {$/;"	a
l00315	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00315"><\/a>00315                                         <span class="comment">\/\/We don't want to clear counters if the user was in validation, it probably already transmitted data..<\/span>$/;"	a
l00316	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00316"><\/a>00316                                     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"%s - Skipped clearing counters after all, the user was previously in validation"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00317	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00317"><\/a>00317                                 }$/;"	a
l00318	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00318"><\/a>00318                                 p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> = <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>;$/;"	a
l00319	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00319"><\/a>00319                                 fw_allow(p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, p1-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00320	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00320"><\/a>00320                             }$/;"	a
l00321	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00321"><\/a>00321                             <span class="keywordflow">break<\/span>;$/;"	a
l00322	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00322"><\/a>00322 $/;"	a
l00323	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00323"><\/a>00323                         <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0c8fc6529d16fe0f89af0382f83841aae">AUTH_VALIDATION<\/a>:$/;"	a
l00324	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00324"><\/a>00324                             <span class="comment">\/*<\/span>$/;"	a
l00325	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00325"><\/a>00325 <span class="comment">                             * Do nothing, user<\/span>$/;"	a
l00326	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00326"><\/a>00326 <span class="comment">                             * is in validation<\/span>$/;"	a
l00327	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00327"><\/a>00327 <span class="comment">                             * period<\/span>$/;"	a
l00328	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00328"><\/a>00328 <span class="comment">                             *\/<\/span>$/;"	a
l00329	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00329"><\/a>00329                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"%s - User in validation period"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00330	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00330"><\/a>00330                             <span class="keywordflow">break<\/span>;$/;"	a
l00331	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00331"><\/a>00331 $/;"	a
l00332	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00332"><\/a>00332                               <span class="keywordflow">case<\/span> <a class="code" href="auth_8h.html#ddcddbad4007d50702fdad951f611db0bd520876d457fc4c379899363e8f9392">AUTH_ERROR<\/a>:$/;"	a
l00333	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00333"><\/a>00333                                     <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"Error communicating with auth server - leaving %s as-is for now"<\/span>, p1-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00334	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00334"><\/a>00334                                     <span class="keywordflow">break<\/span>;$/;"	a
l00335	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00335"><\/a>00335 $/;"	a
l00336	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00336"><\/a>00336                         <span class="keywordflow">default<\/span>:$/;"	a
l00337	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00337"><\/a>00337                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"I do not know about authentication code %d"<\/span>, authresponse.<a class="code" href="struct__t__authresponse.html#4d2a8485133db0ba5eb394bb45ba3e8d">authcode<\/a>);$/;"	a
l00338	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00338"><\/a>00338                             <span class="keywordflow">break<\/span>;$/;"	a
l00339	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00339"><\/a>00339                     }$/;"	a
l00340	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00340"><\/a>00340                 }$/;"	a
l00341	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00341"><\/a>00341             }$/;"	a
l00342	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00342"><\/a>00342         }$/;"	a
l00343	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00343"><\/a>00343 $/;"	a
l00344	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00344"><\/a>00344         free(token);$/;"	a
l00345	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00345"><\/a>00345         free(ip);$/;"	a
l00346	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00346"><\/a>00346         free(mac);$/;"	a
l00347	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00347"><\/a>00347     }$/;"	a
l00348	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00348"><\/a>00348     UNLOCK_CLIENT_LIST();$/;"	a
l00349	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00349"><\/a>00349 }$/;"	a
l00350	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00350"><\/a>00350 $/;"	a
l00351	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00351"><\/a>00351 <span class="keywordtype">void<\/span>$/;"	a
l00352	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00352"><\/a><a class="code" href="firewall_8h.html#de29ced5c802fe07c4228d5a0f6c9592">00352<\/a> icmp_ping(<span class="keywordtype">char<\/span> *host)$/;"	a
l00353	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00353"><\/a>00353 {$/;"	a
l00354	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00354"><\/a>00354         <span class="keyword">struct <\/span>sockaddr_in saddr;$/;"	a
l00355	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00355"><\/a>00355 <span class="preprocessor">#if defined(__linux__) || defined(__NetBSD__)<\/span>$/;"	a
l00356	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00356"><\/a>00356 <span class="preprocessor"><\/span>        <span class="keyword">struct <\/span>{$/;"	a
l00357	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00357"><\/a>00357                 <span class="keyword">struct <\/span>ip ip;$/;"	a
l00358	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00358"><\/a>00358                 <span class="keyword">struct <\/span>icmp icmp;$/;"	a
l00359	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00359"><\/a>00359         } packet;$/;"	a
l00360	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00360"><\/a>00360 <span class="preprocessor">#endif<\/span>$/;"	a
l00361	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00361"><\/a>00361 <span class="preprocessor"><\/span>        <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span> i, j;$/;"	a
l00362	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00362"><\/a>00362         <span class="keywordtype">int<\/span> opt = 2000;$/;"	a
l00363	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00363"><\/a>00363         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span> <span class="keywordtype">id<\/span> = rand16();$/;"	a
l00364	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00364"><\/a>00364 $/;"	a
l00365	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00365"><\/a>00365         memset(&amp;saddr, 0, <span class="keyword">sizeof<\/span>(saddr));$/;"	a
l00366	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00366"><\/a>00366         saddr.sin_family = AF_INET;$/;"	a
l00367	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00367"><\/a>00367         inet_aton(host, &amp;saddr.sin_addr);$/;"	a
l00368	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00368"><\/a>00368 <span class="preprocessor">#if defined(HAVE_SOCKADDR_SA_LEN) || defined(__NetBSD__)<\/span>$/;"	a
l00369	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00369"><\/a>00369 <span class="preprocessor"><\/span>        saddr.sin_len = <span class="keyword">sizeof<\/span>(<span class="keyword">struct <\/span>sockaddr_in);$/;"	a
l00370	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00370"><\/a>00370 <span class="preprocessor">#endif<\/span>$/;"	a
l00371	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00371"><\/a>00371 <span class="preprocessor"><\/span>$/;"	a
l00372	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00372"><\/a>00372 <span class="preprocessor">#if defined(__linux__) || defined(__NetBSD__)<\/span>$/;"	a
l00373	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00373"><\/a>00373 <span class="preprocessor"><\/span>        memset(&amp;packet.icmp, 0, <span class="keyword">sizeof<\/span>(packet.icmp));$/;"	a
l00374	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00374"><\/a>00374         packet.icmp.icmp_type = ICMP_ECHO;$/;"	a
l00375	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00375"><\/a>00375         packet.icmp.icmp_id = id;$/;"	a
l00376	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00376"><\/a>00376 $/;"	a
l00377	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00377"><\/a>00377         <span class="keywordflow">for<\/span> (j = 0, i = 0; i &lt; <span class="keyword">sizeof<\/span>(<span class="keyword">struct <\/span>icmp) \/ 2; i++)$/;"	a
l00378	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00378"><\/a>00378                 j += ((<span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span> *)&amp;packet.icmp)[i];$/;"	a
l00379	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00379"><\/a>00379 $/;"	a
l00380	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00380"><\/a>00380         <span class="keywordflow">while<\/span> (j &gt;&gt; 16)$/;"	a
l00381	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00381"><\/a>00381                 j = (j &amp; 0xffff) + (j &gt;&gt; 16);$/;"	a
l00382	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00382"><\/a>00382 $/;"	a
l00383	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00383"><\/a>00383         packet.icmp.icmp_cksum = (j == 0xffff) ? j : ~j;$/;"	a
l00384	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00384"><\/a>00384 $/;"	a
l00385	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00385"><\/a>00385         <span class="keywordflow">if<\/span> (setsockopt(icmp_fd, SOL_SOCKET, SO_RCVBUF, &amp;opt, <span class="keyword">sizeof<\/span>(opt)) == -1)$/;"	a
l00386	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00386"><\/a>00386                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"setsockopt(): %s"<\/span>, strerror(errno));$/;"	a
l00387	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00387"><\/a>00387 $/;"	a
l00388	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00388"><\/a>00388         <span class="keywordflow">if<\/span> (sendto(icmp_fd, (<span class="keywordtype">char<\/span> *)&amp;packet.icmp, <span class="keyword">sizeof<\/span>(<span class="keyword">struct<\/span> icmp), 0,$/;"	a
l00389	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00389"><\/a>00389                    (<span class="keyword">const<\/span> <span class="keyword">struct<\/span> sockaddr *)&amp;saddr, <span class="keyword">sizeof<\/span>(saddr)) == -1)$/;"	a
l00390	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00390"><\/a>00390                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sendto(): %s"<\/span>, strerror(errno));$/;"	a
l00391	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00391"><\/a>00391 $/;"	a
l00392	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00392"><\/a>00392         opt = 1;$/;"	a
l00393	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00393"><\/a>00393         <span class="keywordflow">if<\/span> (setsockopt(icmp_fd, SOL_SOCKET, SO_RCVBUF, &amp;opt, <span class="keyword">sizeof<\/span>(opt)) == -1)$/;"	a
l00394	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00394"><\/a>00394                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"setsockopt(): %s"<\/span>, strerror(errno));$/;"	a
l00395	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00395"><\/a>00395 <span class="preprocessor">#endif<\/span>$/;"	a
l00396	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00396"><\/a>00396 <span class="preprocessor"><\/span>$/;"	a
l00397	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00397"><\/a>00397         <span class="keywordflow">return<\/span>;$/;"	a
l00398	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00398"><\/a>00398 }$/;"	a
l00399	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00399"><\/a>00399 $/;"	a
l00400	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00400"><\/a><a class="code" href="firewall_8h.html#8dc0b2fd2982b6b043d9ba7502736e05">00400<\/a> <span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span> rand16(<span class="keywordtype">void<\/span>) {$/;"	a
l00401	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00401"><\/a>00401   <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> been_seeded = 0;$/;"	a
l00402	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00402"><\/a>00402 $/;"	a
l00403	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00403"><\/a>00403   <span class="keywordflow">if<\/span> (!been_seeded) {$/;"	a
l00404	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00404"><\/a>00404     <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span> seed = 0;$/;"	a
l00405	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00405"><\/a>00405     <span class="keyword">struct <\/span>timeval now;$/;"	a
l00406	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00406"><\/a>00406 $/;"	a
l00407	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00407"><\/a>00407     <span class="comment">\/* not a very good seed but what the heck, it needs to be quickly acquired *\/<\/span>$/;"	a
l00408	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00408"><\/a>00408     gettimeofday(&amp;now, NULL);$/;"	a
l00409	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00409"><\/a>00409     seed = now.tv_sec ^ now.tv_usec ^ (getpid() &lt;&lt; 16);$/;"	a
l00410	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00410"><\/a>00410 $/;"	a
l00411	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00411"><\/a>00411     srand(seed);$/;"	a
l00412	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00412"><\/a>00412     been_seeded = 1;$/;"	a
l00413	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00413"><\/a>00413     }$/;"	a
l00414	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00414"><\/a>00414 $/;"	a
l00415	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00415"><\/a>00415     <span class="comment">\/* Some rand() implementations have less randomness in low bits<\/span>$/;"	a
l00416	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00416"><\/a>00416 <span class="comment">     * than in high bits, so we only pay attention to the high ones.<\/span>$/;"	a
l00417	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00417"><\/a>00417 <span class="comment">     * But most implementations don't touch the high bit, so we<\/span>$/;"	a
l00418	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00418"><\/a>00418 <span class="comment">     * ignore that one.<\/span>$/;"	a
l00419	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00419"><\/a>00419 <span class="comment">     **\/<\/span>$/;"	a
l00420	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00420"><\/a>00420       <span class="keywordflow">return<\/span>( (<span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span>) (rand() &gt;&gt; 15) );$/;"	a
l00421	install/share/doc/wifidog-20090925/html/firewall_8c-source.html	/^<a name="l00421"><\/a>00421 }$/;"	a
l00001	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<h1>firewall.h<\/h1><a href="firewall_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: firewall.h 1241 2007-06-24 04:13:13Z benoitg $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _FIREWALL_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _FIREWALL_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="keywordtype">int<\/span> icmp_fd;$/;"	a
l00031	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00033	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00033"><\/a><a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a">00033<\/a> <span class="keyword">typedef<\/span> <span class="keyword">enum<\/span> <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a">_t_fw_marks<\/a> {$/;"	a
l00034	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00034"><\/a><a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b">00034<\/a>     <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a> = 1, $/;"	a
l00036	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00036"><\/a><a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75">00036<\/a>     <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a> = 2,  $/;"	a
l00037	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc">00037<\/a>     <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc" title="The client has been locked out.">FW_MARK_LOCKED<\/a> = 254 $/;"	a
l00038	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00038"><\/a>00038 } t_fw_marks;$/;"	a
l00039	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00041	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00041"><\/a>00041 <span class="keywordtype">int<\/span> fw_init(<span class="keywordtype">void<\/span>);$/;"	a
l00042	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00044	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="keywordtype">void<\/span> fw_clear_authservers(<span class="keywordtype">void<\/span>);$/;"	a
l00045	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00047	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="keywordtype">void<\/span> fw_set_authservers(<span class="keywordtype">void<\/span>);$/;"	a
l00048	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00048"><\/a>00048 $/;"	a
l00050	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00050"><\/a>00050 <span class="keywordtype">int<\/span> fw_destroy(<span class="keywordtype">void<\/span>);$/;"	a
l00051	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00051"><\/a>00051 $/;"	a
l00053	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00053"><\/a>00053 <span class="keywordtype">int<\/span> fw_allow(<span class="keywordtype">char<\/span> *ip, <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> profile);$/;"	a
l00054	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00056	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00056"><\/a>00056 <span class="keywordtype">int<\/span> fw_deny(<span class="keywordtype">char<\/span> *ip, <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> profile);$/;"	a
l00057	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00059	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00059"><\/a>00059 <span class="keywordtype">void<\/span> fw_sync_with_authserver(<span class="keywordtype">void<\/span>);$/;"	a
l00060	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00060"><\/a>00060 $/;"	a
l00062	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00062"><\/a>00062 <span class="keywordtype">char<\/span> *arp_get(<span class="keywordtype">char<\/span> *req_ip);$/;"	a
l00063	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00063"><\/a>00063 $/;"	a
l00065	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00065"><\/a>00065 <span class="keywordtype">void<\/span> icmp_ping(<span class="keywordtype">char<\/span> *host);$/;"	a
l00066	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00066"><\/a>00066 $/;"	a
l00068	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00068"><\/a>00068 <span class="keywordtype">unsigned<\/span> <span class="keywordtype">short<\/span> rand16(<span class="keywordtype">void<\/span>);$/;"	a
l00069	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00069"><\/a>00069 $/;"	a
l00070	install/share/doc/wifidog-20090925/html/firewall_8h-source.html	/^<a name="l00070"><\/a>00070 <span class="preprocessor">#endif <\/span><span class="comment">\/* _FIREWALL_H_ *\/<\/span>$/;"	a
1c9252d557956b2e501ee6e55a0cb4be	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1c9252d557956b2e501ee6e55a0cb4be"><\/a><!-- doxytag: member="firewall.h::t_fw_marks" ref="1c9252d557956b2e501ee6e55a0cb4be" args="" -->$/;"	a
642fc7cfa3f52cf80d63c704030c2119	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="642fc7cfa3f52cf80d63c704030c2119"><\/a><!-- doxytag: member="firewall.h::fw_deny" ref="642fc7cfa3f52cf80d63c704030c2119" args="(char *ip, char *mac, int profile)" -->$/;"	a
7202b7d511de9238c91d8d68ef78815f	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="7202b7d511de9238c91d8d68ef78815f"><\/a><!-- doxytag: member="firewall.h::fw_destroy" ref="7202b7d511de9238c91d8d68ef78815f" args="(void)" -->$/;"	a
8dc0b2fd2982b6b043d9ba7502736e05	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="8dc0b2fd2982b6b043d9ba7502736e05"><\/a><!-- doxytag: member="firewall.h::rand16" ref="8dc0b2fd2982b6b043d9ba7502736e05" args="(void)" -->$/;"	a
9870ce36f7e300bf9930a77a69a9bf1a	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="9870ce36f7e300bf9930a77a69a9bf1a"><\/a><!-- doxytag: member="firewall.h::arp_get" ref="9870ce36f7e300bf9930a77a69a9bf1a" args="(char *req_ip)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a8905d925b83283cdbf028243c6ed026	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="a8905d925b83283cdbf028243c6ed026"><\/a><!-- doxytag: member="firewall.h::fw_clear_authservers" ref="a8905d925b83283cdbf028243c6ed026" args="(void)" -->$/;"	a
ab3ed3199bc18936386acca307bf5d5c	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ab3ed3199bc18936386acca307bf5d5c"><\/a><!-- doxytag: member="firewall.h::icmp_fd" ref="ab3ed3199bc18936386acca307bf5d5c" args="" -->$/;"	a
b1fc844e7144f2bc3d6672db0964a31c	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="b1fc844e7144f2bc3d6672db0964a31c"><\/a><!-- doxytag: member="firewall.h::fw_set_authservers" ref="b1fc844e7144f2bc3d6672db0964a31c" args="(void)" -->$/;"	a
de29ced5c802fe07c4228d5a0f6c9592	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="de29ced5c802fe07c4228d5a0f6c9592"><\/a><!-- doxytag: member="firewall.h::icmp_ping" ref="de29ced5c802fe07c4228d5a0f6c9592" args="(char *host)" -->$/;"	a
e2749226d9b01da3a682ae1803e2530a	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="e2749226d9b01da3a682ae1803e2530a"><\/a><!-- doxytag: member="firewall.h::_t_fw_marks" ref="e2749226d9b01da3a682ae1803e2530a" args="" -->$/;"	a
e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc"><\/a><!-- doxytag: member="FW_MARK_LOCKED" ref="e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc" args="" -->FW_MARK_LOCKED<\/em>&nbsp;<\/td><td>$/;"	a
e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75"><\/a><!-- doxytag: member="FW_MARK_KNOWN" ref="e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" args="" -->FW_MARK_KNOWN<\/em>&nbsp;<\/td><td>$/;"	a
e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<tr><td valign="top"><em><a class="anchor" name="e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b"><\/a><!-- doxytag: member="FW_MARK_PROBATION" ref="e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" args="" -->FW_MARK_PROBATION<\/em>&nbsp;<\/td><td>$/;"	a
e30eaa22b5a8ae0e8915d398743db211	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="e30eaa22b5a8ae0e8915d398743db211"><\/a><!-- doxytag: member="firewall.h::fw_init" ref="e30eaa22b5a8ae0e8915d398743db211" args="(void)" -->$/;"	a
f9c7aefe796696e20e52955a80fff57f	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="f9c7aefe796696e20e52955a80fff57f"><\/a><!-- doxytag: member="firewall.h::fw_sync_with_authserver" ref="f9c7aefe796696e20e52955a80fff57f" args="(void)" -->$/;"	a
fa99884d38b776bf412e4b5f4cdce1ea	install/share/doc/wifidog-20090925/html/firewall_8h.html	/^<a class="anchor" name="fa99884d38b776bf412e4b5f4cdce1ea"><\/a><!-- doxytag: member="firewall.h::fw_allow" ref="fa99884d38b776bf412e4b5f4cdce1ea" args="(char *ip, char *mac, int profile)" -->$/;"	a
index_a	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_a">- a -<\/a><\/h3><ul>$/;"	a
index_b	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_b">- b -<\/a><\/h3><ul>$/;"	a
index_c	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_c">- c -<\/a><\/h3><ul>$/;"	a
index_d	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_d">- d -<\/a><\/h3><ul>$/;"	a
index_e	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_f	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_f">- f -<\/a><\/h3><ul>$/;"	a
index_g	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_h	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_h">- h -<\/a><\/h3><ul>$/;"	a
index_i	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_i">- i -<\/a><\/h3><ul>$/;"	a
index_l	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_l">- l -<\/a><\/h3><ul>$/;"	a
index_m	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_n	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_n">- n -<\/a><\/h3><ul>$/;"	a
index_o	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_o">- o -<\/a><\/h3><ul>$/;"	a
index_p	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_p">- p -<\/a><\/h3><ul>$/;"	a
index_r	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_s	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_s">- s -<\/a><\/h3><ul>$/;"	a
index_t	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index_w	install/share/doc/wifidog-20090925/html/functions.html	/^<h3><a class="anchor" name="index_w">- w -<\/a><\/h3><ul>$/;"	a
index_a	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_a">- a -<\/a><\/h3><ul>$/;"	a
index_b	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_b">- b -<\/a><\/h3><ul>$/;"	a
index_c	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_c">- c -<\/a><\/h3><ul>$/;"	a
index_d	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_d">- d -<\/a><\/h3><ul>$/;"	a
index_e	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_f	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_f">- f -<\/a><\/h3><ul>$/;"	a
index_g	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_h	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_h">- h -<\/a><\/h3><ul>$/;"	a
index_i	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_i">- i -<\/a><\/h3><ul>$/;"	a
index_l	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_l">- l -<\/a><\/h3><ul>$/;"	a
index_m	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_n	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_n">- n -<\/a><\/h3><ul>$/;"	a
index_o	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_o">- o -<\/a><\/h3><ul>$/;"	a
index_p	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_p">- p -<\/a><\/h3><ul>$/;"	a
index_r	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_s	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_s">- s -<\/a><\/h3><ul>$/;"	a
index_t	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index_w	install/share/doc/wifidog-20090925/html/functions_vars.html	/^<h3><a class="anchor" name="index_w">- w -<\/a><\/h3><ul>$/;"	a
l00001	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<h1>fw_iptables.c<\/h1><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: fw_iptables.c 1420 2009-09-18 23:01:57Z gbastien $ *\/<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00040"><\/a>00040 $/;"	a
l00041	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="fw__iptables_8h.html" title="Firewall iptables functions.">fw_iptables.h<\/a>"<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00050"><\/a>00050 $/;"	a
l00051	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> iptables_do_command(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *format, ...);$/;"	a
l00052	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="keyword">static<\/span> <span class="keywordtype">char<\/span> *iptables_compile(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keyword">const<\/span> <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *);$/;"	a
l00053	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> iptables_load_ruleset(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *);$/;"	a
l00054	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00055	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="keyword">extern<\/span> pthread_mutex_t  <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00056	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="keyword">extern<\/span> pthread_mutex_t  <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a>;$/;"	a
l00057	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00060	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> fw_quiet = 0;$/;"	a
l00061	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00061"><\/a>00061 $/;"	a
l00070	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00070"><\/a>00070 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00071	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00071"><\/a>00071 iptables_insert_gateway_id(<span class="keywordtype">char<\/span> **input)$/;"	a
l00072	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00072"><\/a>00072 {$/;"	a
l00073	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00073"><\/a>00073         <span class="keywordtype">char<\/span> *token;$/;"	a
l00074	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00074"><\/a>00074         <span class="keyword">const<\/span> <a class="code" href="structs__config.html">s_config<\/a> *config;$/;"	a
l00075	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00075"><\/a>00075         <span class="keywordtype">char<\/span> *buffer;$/;"	a
l00076	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00076"><\/a>00076 $/;"	a
l00077	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00077"><\/a>00077         <span class="keywordflow">if<\/span> (strstr(*input, <span class="stringliteral">"$ID$"<\/span>)==NULL)$/;"	a
l00078	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00078"><\/a>00078                 <span class="keywordflow">return<\/span>;$/;"	a
l00079	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00079"><\/a>00079 $/;"	a
l00080	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00080"><\/a>00080 $/;"	a
l00081	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00081"><\/a>00081         <span class="keywordflow">while<\/span> ((token=strstr(*input, <span class="stringliteral">"$ID$"<\/span>))!=NULL)$/;"	a
l00082	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00082"><\/a>00082                 <span class="comment">\/* This string may look odd but it's standard POSIX and ISO C *\/<\/span>$/;"	a
l00083	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00083"><\/a>00083                 memcpy(token, <span class="stringliteral">"%1$s"<\/span>, 4);$/;"	a
l00084	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00084"><\/a>00084 $/;"	a
l00085	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00085"><\/a>00085         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00086	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00086"><\/a>00086         safe_asprintf(&amp;buffer, *input, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00087	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00087"><\/a>00087 $/;"	a
l00088	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00088"><\/a>00088         free(*input);$/;"	a
l00089	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00089"><\/a>00089         *input=buffer;$/;"	a
l00090	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00090"><\/a>00090 }$/;"	a
l00091	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00091"><\/a>00091 $/;"	a
l00094	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00094"><\/a>00094 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span>$/;"	a
l00095	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00095"><\/a>00095 iptables_do_command(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *format, ...)$/;"	a
l00096	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00096"><\/a>00096 {$/;"	a
l00097	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00097"><\/a>00097         va_list vlist;$/;"	a
l00098	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00098"><\/a>00098         <span class="keywordtype">char<\/span> *fmt_cmd;$/;"	a
l00099	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00099"><\/a>00099         <span class="keywordtype">char<\/span> *cmd;$/;"	a
l00100	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="keywordtype">int<\/span> rc;$/;"	a
l00101	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00101"><\/a>00101 $/;"	a
l00102	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00102"><\/a>00102         va_start(vlist, format);$/;"	a
l00103	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00103"><\/a>00103         safe_vasprintf(&amp;fmt_cmd, format, vlist);$/;"	a
l00104	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00104"><\/a>00104         va_end(vlist);$/;"	a
l00105	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00105"><\/a>00105 $/;"	a
l00106	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00106"><\/a>00106         safe_asprintf(&amp;cmd, <span class="stringliteral">"iptables %s"<\/span>, fmt_cmd);$/;"	a
l00107	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00107"><\/a>00107         free(fmt_cmd);$/;"	a
l00108	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00108"><\/a>00108 $/;"	a
l00109	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00109"><\/a>00109         iptables_insert_gateway_id(&amp;cmd);$/;"	a
l00110	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00110"><\/a>00110 $/;"	a
l00111	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00111"><\/a>00111         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Executing command: %s"<\/span>, cmd);$/;"	a
l00112	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00112"><\/a>00112 $/;"	a
l00113	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00113"><\/a>00113         rc = <a class="code" href="util_8c.html#d3c0ab429f95535fa08bc6a4fb884bab" title="Execute a shell command.">execute<\/a>(cmd, fw_quiet);$/;"	a
l00114	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00114"><\/a>00114 $/;"	a
l00115	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00115"><\/a>00115         <span class="keywordflow">if<\/span> (rc!=0)$/;"	a
l00116	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00116"><\/a>00116                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"iptables command failed(%d): %s"<\/span>, rc, cmd);$/;"	a
l00117	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00117"><\/a>00117 $/;"	a
l00118	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00118"><\/a>00118         free(cmd);$/;"	a
l00119	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00119"><\/a>00119 $/;"	a
l00120	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00120"><\/a>00120         <span class="keywordflow">return<\/span> rc;$/;"	a
l00121	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00121"><\/a>00121 }$/;"	a
l00122	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00122"><\/a>00122 $/;"	a
l00131	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00131"><\/a>00131         <span class="keyword">static<\/span> <span class="keywordtype">char<\/span> *$/;"	a
l00132	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00132"><\/a>00132 iptables_compile(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * table, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *chain, <span class="keyword">const<\/span> <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a> *rule)$/;"	a
l00133	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00133"><\/a>00133 {$/;"	a
l00134	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00134"><\/a>00134         <span class="keywordtype">char<\/span>    command[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>],$/;"	a
l00135	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00135"><\/a>00135                 *mode;$/;"	a
l00136	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00136"><\/a>00136 $/;"	a
l00137	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00137"><\/a>00137         memset(command, 0, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>);$/;"	a
l00138	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00138"><\/a>00138 $/;"	a
l00139	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00139"><\/a>00139         <span class="keywordflow">if<\/span> (rule-&gt;<a class="code" href="struct__firewall__rule__t.html#4319185967c4252ced90b2d440034b47" title="1 = Allow rule, 0 = Block rule">block_allow<\/a> == 1) {$/;"	a
l00140	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00140"><\/a>00140                 mode = safe_strdup(<span class="stringliteral">"ACCEPT"<\/span>);$/;"	a
l00141	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00141"><\/a>00141         } <span class="keywordflow">else<\/span> {$/;"	a
l00142	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00142"><\/a>00142                 mode = safe_strdup(<span class="stringliteral">"REJECT"<\/span>);$/;"	a
l00143	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00143"><\/a>00143         }$/;"	a
l00144	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00144"><\/a>00144 $/;"	a
l00145	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00145"><\/a>00145         snprintf(command, <span class="keyword">sizeof<\/span>(command),  <span class="stringliteral">"-t %s -A %s "<\/span>,table, chain);$/;"	a
l00146	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00146"><\/a>00146         <span class="keywordflow">if<\/span> (rule-&gt;<a class="code" href="struct__firewall__rule__t.html#71fecaae85673b8c3d00a7c14f528f73" title="Mask for the rule *destination*.">mask<\/a> != NULL) {$/;"	a
l00147	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00147"><\/a>00147                 snprintf((command + strlen(command)), (<span class="keyword">sizeof<\/span>(command) - $/;"	a
l00148	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00148"><\/a>00148                                         strlen(command)), <span class="stringliteral">"-d %s "<\/span>, rule-&gt;<a class="code" href="struct__firewall__rule__t.html#71fecaae85673b8c3d00a7c14f528f73" title="Mask for the rule *destination*.">mask<\/a>);$/;"	a
l00149	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00149"><\/a>00149         }$/;"	a
l00150	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00150"><\/a>00150         <span class="keywordflow">if<\/span> (rule-&gt;<a class="code" href="struct__firewall__rule__t.html#de917f67daf277f81767a9ca7cb6ac1e" title="tcp, udp, etc ...">protocol<\/a> != NULL) {$/;"	a
l00151	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00151"><\/a>00151                 snprintf((command + strlen(command)), (<span class="keyword">sizeof<\/span>(command) -$/;"	a
l00152	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00152"><\/a>00152                                         strlen(command)), <span class="stringliteral">"-p %s "<\/span>, rule-&gt;<a class="code" href="struct__firewall__rule__t.html#de917f67daf277f81767a9ca7cb6ac1e" title="tcp, udp, etc ...">protocol<\/a>);$/;"	a
l00153	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00153"><\/a>00153         }$/;"	a
l00154	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00154"><\/a>00154         <span class="keywordflow">if<\/span> (rule-&gt;<a class="code" href="struct__firewall__rule__t.html#172be165ac52a92dfe57e0911678698d" title="Port to block\/allow.">port<\/a> != NULL) {$/;"	a
l00155	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00155"><\/a>00155                 snprintf((command + strlen(command)), (<span class="keyword">sizeof<\/span>(command) -$/;"	a
l00156	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00156"><\/a>00156                                         strlen(command)), <span class="stringliteral">"--dport %s "<\/span>, rule-&gt;<a class="code" href="struct__firewall__rule__t.html#172be165ac52a92dfe57e0911678698d" title="Port to block\/allow.">port<\/a>);$/;"	a
l00157	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00157"><\/a>00157         }$/;"	a
l00158	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00158"><\/a>00158         snprintf((command + strlen(command)), (<span class="keyword">sizeof<\/span>(command) - $/;"	a
l00159	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00159"><\/a>00159                                 strlen(command)), <span class="stringliteral">"-j %s"<\/span>, mode);$/;"	a
l00160	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00160"><\/a>00160 $/;"	a
l00161	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00161"><\/a>00161         free(mode);$/;"	a
l00162	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00162"><\/a>00162 $/;"	a
l00163	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00163"><\/a>00163         <span class="comment">\/* XXX The buffer command, an automatic variable, will get cleaned<\/span>$/;"	a
l00164	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00164"><\/a>00164 <span class="comment">         * off of the stack when we return, so we strdup() it. *\/<\/span>$/;"	a
l00165	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00165"><\/a>00165         <span class="keywordflow">return<\/span>(safe_strdup(command));$/;"	a
l00166	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00166"><\/a>00166 }$/;"	a
l00167	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00167"><\/a>00167 $/;"	a
l00175	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00175"><\/a>00175         <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00176	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00176"><\/a>00176 iptables_load_ruleset(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * table, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ruleset, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *chain)$/;"	a
l00177	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00177"><\/a>00177 {$/;"	a
l00178	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00178"><\/a>00178         <a class="code" href="struct__firewall__rule__t.html">t_firewall_rule<\/a>         *rule;$/;"	a
l00179	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00179"><\/a>00179         <span class="keywordtype">char<\/span>                    *cmd;$/;"	a
l00180	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00180"><\/a>00180 $/;"	a
l00181	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00181"><\/a>00181         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Load ruleset %s into table %s, chain %s"<\/span>, ruleset, table, chain);$/;"	a
l00182	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00182"><\/a>00182 $/;"	a
l00183	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00183"><\/a>00183         <span class="keywordflow">for<\/span> (rule = <a class="code" href="conf_8c.html#617ad9199f2b10b95498f4f15c67c66d" title="Fetch a firewall rule set.">get_ruleset<\/a>(ruleset); rule != NULL; rule = rule-&gt;<a class="code" href="struct__firewall__rule__t.html#46cf31ace7a4781cd8f67fbf3c8f75de">next<\/a>) {$/;"	a
l00184	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00184"><\/a>00184                 cmd = iptables_compile(table, chain, rule);$/;"	a
l00185	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00185"><\/a>00185                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Loading rule \\"%s\\" into table %s, chain %s"<\/span>, cmd, table, chain);$/;"	a
l00186	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00186"><\/a>00186                 iptables_do_command(cmd);$/;"	a
l00187	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00187"><\/a>00187                 free(cmd);$/;"	a
l00188	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00188"><\/a>00188         }$/;"	a
l00189	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00189"><\/a>00189 $/;"	a
l00190	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00190"><\/a>00190         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Ruleset %s loaded into table %s, chain %s"<\/span>, ruleset, table, chain);$/;"	a
l00191	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00191"><\/a>00191 }$/;"	a
l00192	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00192"><\/a>00192 $/;"	a
l00193	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00193"><\/a>00193         <span class="keywordtype">void<\/span>$/;"	a
l00194	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00194"><\/a><a class="code" href="fw__iptables_8h.html#2946cb91dee0c8a25d0489f4d49946b9">00194<\/a> iptables_fw_clear_authservers(<span class="keywordtype">void<\/span>)$/;"	a
l00195	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00195"><\/a>00195 {$/;"	a
l00196	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00196"><\/a>00196         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00197	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00197"><\/a>00197         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00198	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00198"><\/a>00198 }$/;"	a
l00199	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00199"><\/a>00199 $/;"	a
l00200	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00200"><\/a>00200         <span class="keywordtype">void<\/span>$/;"	a
l00201	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00201"><\/a><a class="code" href="fw__iptables_8h.html#cd205e30639a80845248822e2e1e7eba">00201<\/a> iptables_fw_set_authservers(<span class="keywordtype">void<\/span>)$/;"	a
l00202	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00202"><\/a>00202 {$/;"	a
l00203	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00203"><\/a>00203         <span class="keyword">const<\/span> <a class="code" href="structs__config.html">s_config<\/a> *config;$/;"	a
l00204	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00204"><\/a>00204         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_server;$/;"	a
l00205	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00205"><\/a>00205 $/;"	a
l00206	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00206"><\/a>00206         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00207	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00208"><\/a>00208         <span class="keywordflow">for<\/span> (auth_server = config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; auth_server != NULL; auth_server = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>) {$/;"	a
l00209	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00209"><\/a>00209                 <span class="keywordflow">if<\/span> (auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a> &amp;&amp; strcmp(auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>, <span class="stringliteral">"0.0.0.0"<\/span>) != 0) {$/;"	a
l00210	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00210"><\/a>00210                         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a> <span class="stringliteral">" -d %s -j ACCEPT"<\/span>, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00211	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00211"><\/a>00211                         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a> <span class="stringliteral">" -d %s -j ACCEPT"<\/span>, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00212	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00212"><\/a>00212                 }$/;"	a
l00213	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00213"><\/a>00213         }$/;"	a
l00214	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00214"><\/a>00214 $/;"	a
l00215	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00215"><\/a>00215 }$/;"	a
l00216	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00219	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00219"><\/a>00219         <span class="keywordtype">int<\/span>$/;"	a
l00220	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00220"><\/a><a class="code" href="fw__iptables_8h.html#94d41bcb1c985732a51ce171b7e858b1">00220<\/a> iptables_fw_init(<span class="keywordtype">void<\/span>)$/;"	a
l00221	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00221"><\/a>00221 {$/;"	a
l00222	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00222"><\/a>00222         <span class="keyword">const<\/span> <a class="code" href="structs__config.html">s_config<\/a> *config;$/;"	a
l00223	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00223"><\/a>00223         <span class="keywordtype">char<\/span> * ext_interface = NULL;$/;"	a
l00224	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00224"><\/a>00224         <span class="keywordtype">int<\/span> gw_port = 0;$/;"	a
l00225	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00225"><\/a>00225         <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a> *p;$/;"	a
l00226	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00226"><\/a>00226 $/;"	a
l00227	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00227"><\/a>00227         fw_quiet = 0;$/;"	a
l00228	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00228"><\/a>00228 $/;"	a
l00229	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00229"><\/a>00229         LOCK_CONFIG();$/;"	a
l00230	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00230"><\/a>00230         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00231	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00231"><\/a>00231         gw_port = config-&gt;<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>;$/;"	a
l00232	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00232"><\/a>00232         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62" title="External network interface name for firewall rules.">external_interface<\/a>) {$/;"	a
l00233	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00233"><\/a>00233                 ext_interface = safe_strdup(config-&gt;<a class="code" href="structs__config.html#ff90f0dcf55e28b34b056bb8a86f5b62" title="External network interface name for firewall rules.">external_interface<\/a>);$/;"	a
l00234	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00234"><\/a>00234         } <span class="keywordflow">else<\/span> {$/;"	a
l00235	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00235"><\/a>00235                 ext_interface = get_ext_iface();$/;"	a
l00236	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00236"><\/a>00236         }$/;"	a
l00237	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00237"><\/a>00237 $/;"	a
l00238	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00238"><\/a>00238         <span class="keywordflow">if<\/span> (ext_interface == NULL) {$/;"	a
l00239	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00239"><\/a>00239                 UNLOCK_CONFIG();$/;"	a
l00240	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00240"><\/a>00240                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: no external interface"<\/span>);$/;"	a
l00241	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00241"><\/a>00241                 <span class="keywordflow">return<\/span> 0;$/;"	a
l00242	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00242"><\/a>00242         }$/;"	a
l00243	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00243"><\/a>00243         <span class="comment">\/*<\/span>$/;"	a
l00244	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00244"><\/a>00244 <span class="comment">         *<\/span>$/;"	a
l00245	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00245"><\/a>00245 <span class="comment">         * Everything in the MANGLE table<\/span>$/;"	a
l00246	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00246"><\/a>00246 <span class="comment">         *<\/span>$/;"	a
l00247	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00247"><\/a>00247 <span class="comment">         *\/<\/span>$/;"	a
l00248	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00248"><\/a>00248 $/;"	a
l00249	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00249"><\/a>00249         <span class="comment">\/* Create new chains *\/<\/span>$/;"	a
l00250	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00250"><\/a>00250         iptables_do_command(<span class="stringliteral">"-t mangle -N "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>);$/;"	a
l00251	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00251"><\/a>00251         iptables_do_command(<span class="stringliteral">"-t mangle -N "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00252	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00252"><\/a>00252         iptables_do_command(<span class="stringliteral">"-t mangle -N "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00253	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00253"><\/a>00253 $/;"	a
l00254	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00254"><\/a>00254         <span class="comment">\/* Assign links and rules to these new chains *\/<\/span>$/;"	a
l00255	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00255"><\/a>00255         iptables_do_command(<span class="stringliteral">"-t mangle -I PREROUTING 1 -i %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00256	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00256"><\/a>00256         iptables_do_command(<span class="stringliteral">"-t mangle -I PREROUTING 1 -i %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);<span class="comment">\/\/this rule will be inserted before the prior one<\/span>$/;"	a
l00257	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00257"><\/a>00257         iptables_do_command(<span class="stringliteral">"-t mangle -I POSTROUTING 1 -o %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00258	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00258"><\/a>00258 $/;"	a
l00259	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00259"><\/a>00259         <span class="keywordflow">for<\/span> (p = config-&gt;<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>; p != NULL; p = p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a>)$/;"	a
l00260	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00260"><\/a>00260                 iptables_do_command(<span class="stringliteral">"-t mangle -A "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a> <span class="stringliteral">" -m mac --mac-source %s -j MARK --set-mark %d"<\/span>, p-&gt;<a class="code" href="struct__trusted__mac__t.html#4e4381cfff2bbfbd9455640102b21f14">mac<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>);$/;"	a
l00261	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00261"><\/a>00261 $/;"	a
l00262	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00262"><\/a>00262         <span class="comment">\/*<\/span>$/;"	a
l00263	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00263"><\/a>00263 <span class="comment">         *<\/span>$/;"	a
l00264	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00264"><\/a>00264 <span class="comment">         * Everything in the NAT table<\/span>$/;"	a
l00265	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00265"><\/a>00265 <span class="comment">         *<\/span>$/;"	a
l00266	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00266"><\/a>00266 <span class="comment">         *\/<\/span>$/;"	a
l00267	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00267"><\/a>00267 $/;"	a
l00268	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00268"><\/a>00268         <span class="comment">\/* Create new chains *\/<\/span>$/;"	a
l00269	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00269"><\/a>00269         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00270	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00270"><\/a>00270         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">TABLE_WIFIDOG_WIFI_TO_ROUTER<\/a>);$/;"	a
l00271	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00271"><\/a>00271         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00272	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00272"><\/a>00272         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00273	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00273"><\/a>00273         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00274	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00274"><\/a>00274         iptables_do_command(<span class="stringliteral">"-t nat -N "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00275	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00275"><\/a>00275 $/;"	a
l00276	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00276"><\/a>00276         <span class="comment">\/* Assign links and rules to these new chains *\/<\/span>$/;"	a
l00277	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00277"><\/a>00277         iptables_do_command(<span class="stringliteral">"-t nat -A PREROUTING -i %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00278	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00278"><\/a>00278 $/;"	a
l00279	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00279"><\/a>00279         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a> <span class="stringliteral">" -d %s -j "<\/span> <a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">TABLE_WIFIDOG_WIFI_TO_ROUTER<\/a>, config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>);$/;"	a
l00280	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00280"><\/a>00280         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_WIFI_TO_ROUTER <span class="stringliteral">" -j ACCEPT"<\/span>);$/;"	a
l00281	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00281"><\/a>00281 $/;"	a
l00282	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00282"><\/a>00282         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a> <span class="stringliteral">" -j "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00283	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00283"><\/a>00283         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j ACCEPT"<\/span>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>);$/;"	a
l00284	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00284"><\/a>00284         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j ACCEPT"<\/span>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>);$/;"	a
l00285	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00285"><\/a>00285         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -j "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00286	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00286"><\/a>00286 $/;"	a
l00287	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00287"><\/a>00287         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_UNKNOWN <span class="stringliteral">" -j "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00288	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00288"><\/a>00288         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_UNKNOWN <span class="stringliteral">" -j "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00289	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00289"><\/a>00289         iptables_do_command(<span class="stringliteral">"-t nat -A "<\/span> TABLE_WIFIDOG_UNKNOWN <span class="stringliteral">" -p tcp --dport 80 -j REDIRECT --to-ports %d"<\/span>, gw_port);$/;"	a
l00290	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00290"><\/a>00290 $/;"	a
l00291	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00291"><\/a>00291 $/;"	a
l00292	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00292"><\/a>00292         <span class="comment">\/*<\/span>$/;"	a
l00293	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00293"><\/a>00293 <span class="comment">         *<\/span>$/;"	a
l00294	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00294"><\/a>00294 <span class="comment">         * Everything in the FILTER table<\/span>$/;"	a
l00295	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00295"><\/a>00295 <span class="comment">         *<\/span>$/;"	a
l00296	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00296"><\/a>00296 <span class="comment">         *\/<\/span>$/;"	a
l00297	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00297"><\/a>00297 $/;"	a
l00298	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00298"><\/a>00298         <span class="comment">\/* Create new chains *\/<\/span>$/;"	a
l00299	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00299"><\/a>00299         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET);$/;"	a
l00300	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00300"><\/a>00300         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> TABLE_WIFIDOG_AUTHSERVERS);$/;"	a
l00301	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00301"><\/a>00301         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> <a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">TABLE_WIFIDOG_LOCKED<\/a>);$/;"	a
l00302	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00302"><\/a>00302         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> TABLE_WIFIDOG_GLOBAL);$/;"	a
l00303	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00303"><\/a>00303         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> <a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">TABLE_WIFIDOG_VALIDATE<\/a>);$/;"	a
l00304	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00304"><\/a>00304         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> <a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">TABLE_WIFIDOG_KNOWN<\/a>);$/;"	a
l00305	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00305"><\/a>00305         iptables_do_command(<span class="stringliteral">"-t filter -N "<\/span> TABLE_WIFIDOG_UNKNOWN);$/;"	a
l00306	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00306"><\/a>00306 $/;"	a
l00307	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00307"><\/a>00307         <span class="comment">\/* Assign links and rules to these new chains *\/<\/span>$/;"	a
l00308	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00308"><\/a>00308 $/;"	a
l00309	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00309"><\/a>00309         <span class="comment">\/* Insert at the beginning *\/<\/span>$/;"	a
l00310	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00310"><\/a>00310         iptables_do_command(<span class="stringliteral">"-t filter -I FORWARD -i %s -j "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00311	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00311"><\/a>00311 $/;"	a
l00312	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00312"><\/a>00312 $/;"	a
l00313	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00313"><\/a>00313         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m state --state INVALID -j DROP"<\/span>);$/;"	a
l00314	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00314"><\/a>00314 $/;"	a
l00315	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00315"><\/a>00315         <span class="comment">\/* XXX: Why this? it means that connections setup after authentication<\/span>$/;"	a
l00316	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00316"><\/a>00316 <span class="comment">           stay open even after the connection is done... <\/span>$/;"	a
l00317	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00317"><\/a>00317 <span class="comment">           iptables_do_command("-t filter -A " TABLE_WIFIDOG_WIFI_TO_INTERNET " -m state --state RELATED,ESTABLISHED -j ACCEPT");*\/<\/span>$/;"	a
l00318	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00318"><\/a>00318 $/;"	a
l00319	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00319"><\/a>00319         <span class="comment">\/\/Won't this rule NEVER match anyway?!?!? benoitg, 2007-06-23<\/span>$/;"	a
l00320	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00320"><\/a>00320         <span class="comment">\/\/iptables_do_command("-t filter -A " TABLE_WIFIDOG_WIFI_TO_INTERNET " -i %s -m state --state NEW -j DROP", ext_interface);<\/span>$/;"	a
l00321	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00321"><\/a>00321 $/;"	a
l00322	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00322"><\/a>00322         <span class="comment">\/* TCPMSS rule for PPPoE *\/<\/span>$/;"	a
l00323	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00323"><\/a>00323         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -o %s -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu"<\/span>, ext_interface);$/;"	a
l00324	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00324"><\/a>00324 $/;"	a
l00325	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00325"><\/a>00325         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -j "<\/span> TABLE_WIFIDOG_AUTHSERVERS);$/;"	a
l00326	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00326"><\/a>00326         iptables_fw_set_authservers();$/;"	a
l00327	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00327"><\/a>00327 $/;"	a
l00328	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00328"><\/a>00328         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j "<\/span> <a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">TABLE_WIFIDOG_LOCKED<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530a33cd6b4815f59b96c9c2f79c25547efc" title="The client has been locked out.">FW_MARK_LOCKED<\/a>);$/;"	a
l00329	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00329"><\/a>00329         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"locked-users"<\/span>, TABLE_WIFIDOG_LOCKED);$/;"	a
l00330	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00330"><\/a>00330 $/;"	a
l00331	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00331"><\/a>00331         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -j "<\/span> TABLE_WIFIDOG_GLOBAL);$/;"	a
l00332	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00332"><\/a>00332         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"global"<\/span>, TABLE_WIFIDOG_GLOBAL);$/;"	a
l00333	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00333"><\/a>00333         iptables_load_ruleset(<span class="stringliteral">"nat"<\/span>, <span class="stringliteral">"global"<\/span>, TABLE_WIFIDOG_GLOBAL);$/;"	a
l00334	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00334"><\/a>00334 $/;"	a
l00335	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00335"><\/a>00335         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j "<\/span> <a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">TABLE_WIFIDOG_VALIDATE<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530aec2b9c9f369d965e8fd88a870cec645b" title="The client is in probation period and must be authenticated.">FW_MARK_PROBATION<\/a>);$/;"	a
l00336	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00336"><\/a>00336         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"validating-users"<\/span>, TABLE_WIFIDOG_VALIDATE);$/;"	a
l00337	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00337"><\/a>00337 $/;"	a
l00338	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00338"><\/a>00338         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -m mark --mark 0x%u -j "<\/span> <a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">TABLE_WIFIDOG_KNOWN<\/a>, <a class="code" href="firewall_8h.html#e2749226d9b01da3a682ae1803e2530adc283e5e2b1485dc98a53c353e8d4b75" title="The client is known to the firewall.">FW_MARK_KNOWN<\/a>);$/;"	a
l00339	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00339"><\/a>00339         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"known-users"<\/span>, TABLE_WIFIDOG_KNOWN);$/;"	a
l00340	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00340"><\/a>00340 $/;"	a
l00341	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00341"><\/a>00341         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_WIFI_TO_INTERNET <span class="stringliteral">" -j "<\/span> TABLE_WIFIDOG_UNKNOWN);$/;"	a
l00342	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00342"><\/a>00342         iptables_load_ruleset(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"unknown-users"<\/span>, TABLE_WIFIDOG_UNKNOWN);$/;"	a
l00343	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00343"><\/a>00343         iptables_do_command(<span class="stringliteral">"-t filter -A "<\/span> TABLE_WIFIDOG_UNKNOWN <span class="stringliteral">" -j REJECT --reject-with icmp-port-unreachable"<\/span>);$/;"	a
l00344	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00344"><\/a>00344 $/;"	a
l00345	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00345"><\/a>00345         UNLOCK_CONFIG();$/;"	a
l00346	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00346"><\/a>00346         <span class="keywordflow">return<\/span> 1;$/;"	a
l00347	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00347"><\/a>00347 }$/;"	a
l00348	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00348"><\/a>00348 $/;"	a
l00353	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00353"><\/a>00353         <span class="keywordtype">int<\/span>$/;"	a
l00354	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00354"><\/a><a class="code" href="fw__iptables_8h.html#feabe4a819a5e16d2d2df56bdfa2ca58">00354<\/a> iptables_fw_destroy(<span class="keywordtype">void<\/span>)$/;"	a
l00355	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00355"><\/a>00355 {$/;"	a
l00356	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00356"><\/a>00356         fw_quiet = 1;$/;"	a
l00357	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00357"><\/a>00357 $/;"	a
l00358	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00358"><\/a>00358         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Destroying our iptables entries"<\/span>);$/;"	a
l00359	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00359"><\/a>00359 $/;"	a
l00360	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00360"><\/a>00360         <span class="comment">\/*<\/span>$/;"	a
l00361	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00361"><\/a>00361 <span class="comment">         *<\/span>$/;"	a
l00362	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00362"><\/a>00362 <span class="comment">         * Everything in the MANGLE table<\/span>$/;"	a
l00363	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00363"><\/a>00363 <span class="comment">         *<\/span>$/;"	a
l00364	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00364"><\/a>00364 <span class="comment">         *\/<\/span>$/;"	a
l00365	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00365"><\/a>00365         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Destroying chains in the MANGLE table"<\/span>);$/;"	a
l00366	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00366"><\/a>00366         iptables_fw_destroy_mention(<span class="stringliteral">"mangle"<\/span>, <span class="stringliteral">"PREROUTING"<\/span>, <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>);$/;"	a
l00367	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00367"><\/a>00367         iptables_fw_destroy_mention(<span class="stringliteral">"mangle"<\/span>, <span class="stringliteral">"PREROUTING"<\/span>, <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00368	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00368"><\/a>00368         iptables_fw_destroy_mention(<span class="stringliteral">"mangle"<\/span>, <span class="stringliteral">"POSTROUTING"<\/span>, <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00369	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00369"><\/a>00369         iptables_do_command(<span class="stringliteral">"-t mangle -F "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>);$/;"	a
l00370	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00370"><\/a>00370         iptables_do_command(<span class="stringliteral">"-t mangle -F "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00371	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00371"><\/a>00371         iptables_do_command(<span class="stringliteral">"-t mangle -F "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00372	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00372"><\/a>00372         iptables_do_command(<span class="stringliteral">"-t mangle -X "<\/span> <a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">TABLE_WIFIDOG_TRUSTED<\/a>);$/;"	a
l00373	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00373"><\/a>00373         iptables_do_command(<span class="stringliteral">"-t mangle -X "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00374	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00374"><\/a>00374         iptables_do_command(<span class="stringliteral">"-t mangle -X "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00375	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00375"><\/a>00375 $/;"	a
l00376	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00376"><\/a>00376         <span class="comment">\/*<\/span>$/;"	a
l00377	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00377"><\/a>00377 <span class="comment">         *<\/span>$/;"	a
l00378	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00378"><\/a>00378 <span class="comment">         * Everything in the NAT table<\/span>$/;"	a
l00379	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00379"><\/a>00379 <span class="comment">         *<\/span>$/;"	a
l00380	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00380"><\/a>00380 <span class="comment">         *\/<\/span>$/;"	a
l00381	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00381"><\/a>00381         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Destroying chains in the NAT table"<\/span>);$/;"	a
l00382	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00382"><\/a>00382         iptables_fw_destroy_mention(<span class="stringliteral">"nat"<\/span>, <span class="stringliteral">"PREROUTING"<\/span>, <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00383	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00383"><\/a>00383         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00384	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00384"><\/a>00384         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00385	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00385"><\/a>00385         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">TABLE_WIFIDOG_WIFI_TO_ROUTER<\/a>);$/;"	a
l00386	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00386"><\/a>00386         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00387	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00387"><\/a>00387         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00388	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00388"><\/a>00388         iptables_do_command(<span class="stringliteral">"-t nat -F "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00389	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00389"><\/a>00389         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00390	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00390"><\/a>00390         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00391	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00391"><\/a>00391         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">TABLE_WIFIDOG_WIFI_TO_ROUTER<\/a>);$/;"	a
l00392	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00392"><\/a>00392         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00393	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00393"><\/a>00393         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00394	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00394"><\/a>00394         iptables_do_command(<span class="stringliteral">"-t nat -X "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00395	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00395"><\/a>00395 $/;"	a
l00396	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00396"><\/a>00396         <span class="comment">\/*<\/span>$/;"	a
l00397	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00397"><\/a>00397 <span class="comment">         *<\/span>$/;"	a
l00398	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00398"><\/a>00398 <span class="comment">         * Everything in the FILTER table<\/span>$/;"	a
l00399	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00399"><\/a>00399 <span class="comment">         *<\/span>$/;"	a
l00400	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00400"><\/a>00400 <span class="comment">         *\/<\/span>$/;"	a
l00401	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00401"><\/a>00401         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Destroying chains in the FILTER table"<\/span>);$/;"	a
l00402	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00402"><\/a>00402         iptables_fw_destroy_mention(<span class="stringliteral">"filter"<\/span>, <span class="stringliteral">"FORWARD"<\/span>, <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00403	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00403"><\/a>00403         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00404	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00404"><\/a>00404         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00405	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00405"><\/a>00405         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">TABLE_WIFIDOG_LOCKED<\/a>);$/;"	a
l00406	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00406"><\/a>00406         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00407	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00407"><\/a>00407         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">TABLE_WIFIDOG_VALIDATE<\/a>);$/;"	a
l00408	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00408"><\/a>00408         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">TABLE_WIFIDOG_KNOWN<\/a>);$/;"	a
l00409	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00409"><\/a>00409         iptables_do_command(<span class="stringliteral">"-t filter -F "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00410	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00410"><\/a>00410         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">TABLE_WIFIDOG_WIFI_TO_INTERNET<\/a>);$/;"	a
l00411	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00411"><\/a>00411         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">TABLE_WIFIDOG_AUTHSERVERS<\/a>);$/;"	a
l00412	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00412"><\/a>00412         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">TABLE_WIFIDOG_LOCKED<\/a>);$/;"	a
l00413	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00413"><\/a>00413         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">TABLE_WIFIDOG_GLOBAL<\/a>);$/;"	a
l00414	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00414"><\/a>00414         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">TABLE_WIFIDOG_VALIDATE<\/a>);$/;"	a
l00415	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00415"><\/a>00415         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">TABLE_WIFIDOG_KNOWN<\/a>);$/;"	a
l00416	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00416"><\/a>00416         iptables_do_command(<span class="stringliteral">"-t filter -X "<\/span> <a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">TABLE_WIFIDOG_UNKNOWN<\/a>);$/;"	a
l00417	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00417"><\/a>00417 $/;"	a
l00418	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00418"><\/a>00418         <span class="keywordflow">return<\/span> 1;$/;"	a
l00419	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00419"><\/a>00419 }$/;"	a
l00420	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00420"><\/a>00420 $/;"	a
l00421	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00421"><\/a>00421 <span class="comment">\/*<\/span>$/;"	a
l00422	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00422"><\/a>00422 <span class="comment"> * Helper for iptables_fw_destroy<\/span>$/;"	a
l00423	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00423"><\/a>00423 <span class="comment"> * @param table The table to search<\/span>$/;"	a
l00424	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00424"><\/a>00424 <span class="comment"> * @param chain The chain in that table to search<\/span>$/;"	a
l00425	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00425"><\/a>00425 <span class="comment"> * @param mention A word to find and delete in rules in the given table+chain<\/span>$/;"	a
l00426	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00426"><\/a>00426 <span class="comment"> *\/<\/span>$/;"	a
l00427	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00427"><\/a>00427 <span class="keywordtype">int<\/span>$/;"	a
l00428	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00428"><\/a><a class="code" href="fw__iptables_8h.html#99cee9643f6caf090c134e7651289233">00428<\/a> iptables_fw_destroy_mention($/;"	a
l00429	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00429"><\/a>00429                 <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * table,$/;"	a
l00430	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00430"><\/a>00430                 <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * chain,$/;"	a
l00431	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00431"><\/a>00431                 <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * mention$/;"	a
l00432	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00432"><\/a>00432                 ) {$/;"	a
l00433	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00433"><\/a>00433         FILE *p = NULL;$/;"	a
l00434	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00434"><\/a>00434         <span class="keywordtype">char<\/span> *command = NULL;$/;"	a
l00435	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00435"><\/a>00435         <span class="keywordtype">char<\/span> *command2 = NULL;$/;"	a
l00436	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00436"><\/a>00436         <span class="keywordtype">char<\/span> line[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00437	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00437"><\/a>00437         <span class="keywordtype">char<\/span> rulenum[10];$/;"	a
l00438	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00438"><\/a>00438         <span class="keywordtype">char<\/span> *victim = safe_strdup(mention);$/;"	a
l00439	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00439"><\/a>00439         <span class="keywordtype">int<\/span> deleted = 0;$/;"	a
l00440	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00440"><\/a>00440 $/;"	a
l00441	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00441"><\/a>00441         iptables_insert_gateway_id(&amp;victim);$/;"	a
l00442	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00442"><\/a>00442 $/;"	a
l00443	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00443"><\/a>00443         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Attempting to destroy all mention of %s from %s.%s"<\/span>, victim, table, chain);$/;"	a
l00444	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00444"><\/a>00444 $/;"	a
l00445	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00445"><\/a>00445         safe_asprintf(&amp;command, <span class="stringliteral">"iptables -t %s -L %s -n --line-numbers -v"<\/span>, table, chain);$/;"	a
l00446	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00446"><\/a>00446         iptables_insert_gateway_id(&amp;command);$/;"	a
l00447	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00447"><\/a>00447 $/;"	a
l00448	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00448"><\/a>00448         <span class="keywordflow">if<\/span> ((p = popen(command, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00449	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00449"><\/a>00449                 <span class="comment">\/* Skip first 2 lines *\/<\/span>$/;"	a
l00450	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00450"><\/a>00450                 <span class="keywordflow">while<\/span> (!feof(p) &amp;&amp; fgetc(p) != <span class="charliteral">'\\n'<\/span>);$/;"	a
l00451	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00451"><\/a>00451                 <span class="keywordflow">while<\/span> (!feof(p) &amp;&amp; fgetc(p) != <span class="charliteral">'\\n'<\/span>);$/;"	a
l00452	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00452"><\/a>00452                 <span class="comment">\/* Loop over entries *\/<\/span>$/;"	a
l00453	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00453"><\/a>00453                 <span class="keywordflow">while<\/span> (fgets(line, <span class="keyword">sizeof<\/span>(line), p)) {$/;"	a
l00454	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00454"><\/a>00454                         <span class="comment">\/* Look for victim *\/<\/span>$/;"	a
l00455	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00455"><\/a>00455                         <span class="keywordflow">if<\/span> (strstr(line, victim)) {$/;"	a
l00456	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00456"><\/a>00456                                 <span class="comment">\/* Found victim - Get the rule number into rulenum*\/<\/span>$/;"	a
l00457	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00457"><\/a>00457                                 <span class="keywordflow">if<\/span> (sscanf(line, <span class="stringliteral">"%9[0-9]"<\/span>, rulenum) == 1) {$/;"	a
l00458	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00458"><\/a>00458                                         <span class="comment">\/* Delete the rule: *\/<\/span>$/;"	a
l00459	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00459"><\/a>00459                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Deleting rule %s from %s.%s because it mentions %s"<\/span>, rulenum, table, chain, victim);$/;"	a
l00460	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00460"><\/a>00460                                         safe_asprintf(&amp;command2, <span class="stringliteral">"-t %s -D %s %s"<\/span>, table, chain, rulenum);$/;"	a
l00461	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00461"><\/a>00461                                         iptables_do_command(command2);$/;"	a
l00462	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00462"><\/a>00462                                         free(command2);$/;"	a
l00463	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00463"><\/a>00463                                         deleted = 1;$/;"	a
l00464	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00464"><\/a>00464                                         <span class="comment">\/* Do not keep looping - the captured rulenums will no longer be accurate *\/<\/span>$/;"	a
l00465	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00465"><\/a>00465                                         <span class="keywordflow">break<\/span>;$/;"	a
l00466	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00466"><\/a>00466                                 }$/;"	a
l00467	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00467"><\/a>00467                         }$/;"	a
l00468	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00468"><\/a>00468                 }$/;"	a
l00469	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00469"><\/a>00469                 pclose(p);$/;"	a
l00470	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00470"><\/a>00470         }$/;"	a
l00471	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00471"><\/a>00471 $/;"	a
l00472	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00472"><\/a>00472         free(command);$/;"	a
l00473	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00473"><\/a>00473         free(victim);$/;"	a
l00474	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00474"><\/a>00474 $/;"	a
l00475	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00475"><\/a>00475         <span class="keywordflow">if<\/span> (deleted) {$/;"	a
l00476	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00476"><\/a>00476                 <span class="comment">\/* Recurse just in case there are more in the same table+chain *\/<\/span>$/;"	a
l00477	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00477"><\/a>00477                 iptables_fw_destroy_mention(table, chain, mention);$/;"	a
l00478	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00478"><\/a>00478         }$/;"	a
l00479	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00479"><\/a>00479 $/;"	a
l00480	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00480"><\/a>00480         <span class="keywordflow">return<\/span> (deleted);$/;"	a
l00481	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00481"><\/a>00481 }$/;"	a
l00482	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00482"><\/a>00482 $/;"	a
l00484	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00484"><\/a>00484         <span class="keywordtype">int<\/span>$/;"	a
l00485	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00485"><\/a><a class="code" href="fw__iptables_8h.html#215e1186b8a50b3b4c0402007872e3fc">00485<\/a> iptables_fw_access(fw_access_t type, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> tag)$/;"	a
l00486	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00486"><\/a>00486 {$/;"	a
l00487	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00487"><\/a>00487         <span class="keywordtype">int<\/span> rc;$/;"	a
l00488	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00488"><\/a>00488 $/;"	a
l00489	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00489"><\/a>00489         fw_quiet = 0;$/;"	a
l00490	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00490"><\/a>00490 $/;"	a
l00491	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00491"><\/a>00491         <span class="keywordflow">switch<\/span>(type) {$/;"	a
l00492	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00492"><\/a>00492                 <span class="keywordflow">case<\/span> FW_ACCESS_ALLOW:$/;"	a
l00493	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00493"><\/a>00493                         iptables_do_command(<span class="stringliteral">"-t mangle -A "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a> <span class="stringliteral">" -s %s -m mac --mac-source %s -j MARK --set-mark %d"<\/span>, ip, mac, tag);$/;"	a
l00494	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00494"><\/a>00494                         rc = iptables_do_command(<span class="stringliteral">"-t mangle -A "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a> <span class="stringliteral">" -d %s -j ACCEPT"<\/span>, ip);$/;"	a
l00495	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00495"><\/a>00495                         <span class="keywordflow">break<\/span>;$/;"	a
l00496	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00496"><\/a>00496                 <span class="keywordflow">case<\/span> FW_ACCESS_DENY:$/;"	a
l00497	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00497"><\/a>00497                         iptables_do_command(<span class="stringliteral">"-t mangle -D "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a> <span class="stringliteral">" -s %s -m mac --mac-source %s -j MARK --set-mark %d"<\/span>, ip, mac, tag);$/;"	a
l00498	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00498"><\/a>00498                         rc = iptables_do_command(<span class="stringliteral">"-t mangle -D "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a> <span class="stringliteral">" -d %s -j ACCEPT"<\/span>, ip);$/;"	a
l00499	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00499"><\/a>00499                         <span class="keywordflow">break<\/span>;$/;"	a
l00500	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00500"><\/a>00500                 <span class="keywordflow">default<\/span>:$/;"	a
l00501	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00501"><\/a>00501                         rc = -1;$/;"	a
l00502	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00502"><\/a>00502                         <span class="keywordflow">break<\/span>;$/;"	a
l00503	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00503"><\/a>00503         }$/;"	a
l00504	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00504"><\/a>00504 $/;"	a
l00505	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00505"><\/a>00505         <span class="keywordflow">return<\/span> rc;$/;"	a
l00506	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00506"><\/a>00506 }$/;"	a
l00507	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00507"><\/a>00507 $/;"	a
l00509	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00509"><\/a>00509         <span class="keywordtype">int<\/span>$/;"	a
l00510	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00510"><\/a><a class="code" href="fw__iptables_8h.html#bfd8ac7489174a3c172d2f12eaba704a">00510<\/a> iptables_fw_counters_update(<span class="keywordtype">void<\/span>)$/;"	a
l00511	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00511"><\/a>00511 {$/;"	a
l00512	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00512"><\/a>00512         FILE *output;$/;"	a
l00513	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00513"><\/a>00513         <span class="keywordtype">char<\/span> *script,$/;"	a
l00514	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00514"><\/a>00514              ip[16],$/;"	a
l00515	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00515"><\/a>00515              rc;$/;"	a
l00516	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00516"><\/a>00516         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> counter;$/;"	a
l00517	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00517"><\/a>00517         <a class="code" href="struct__t__client.html">t_client<\/a> *p1;$/;"	a
l00518	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00518"><\/a>00518         <span class="keyword">struct <\/span>in_addr tempaddr;$/;"	a
l00519	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00519"><\/a>00519 $/;"	a
l00520	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00520"><\/a>00520         <span class="comment">\/* Look for outgoing traffic *\/<\/span>$/;"	a
l00521	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00521"><\/a>00521         safe_asprintf(&amp;script, <span class="stringliteral">"%s %s"<\/span>, <span class="stringliteral">"iptables"<\/span>, <span class="stringliteral">"-v -n -x -t mangle -L "<\/span> <a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">TABLE_WIFIDOG_OUTGOING<\/a>);$/;"	a
l00522	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00522"><\/a>00522         iptables_insert_gateway_id(&amp;script);$/;"	a
l00523	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00523"><\/a>00523         output = popen(script, <span class="stringliteral">"r"<\/span>);$/;"	a
l00524	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00524"><\/a>00524         free(script);$/;"	a
l00525	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00525"><\/a>00525         <span class="keywordflow">if<\/span> (!output) {$/;"	a
l00526	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00526"><\/a>00526                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"popen(): %s"<\/span>, strerror(errno));$/;"	a
l00527	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00527"><\/a>00527                 <span class="keywordflow">return<\/span> -1;$/;"	a
l00528	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00528"><\/a>00528         }$/;"	a
l00529	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00529"><\/a>00529 $/;"	a
l00530	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00530"><\/a>00530         <span class="comment">\/* skip the first two lines *\/<\/span>$/;"	a
l00531	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00531"><\/a>00531         <span class="keywordflow">while<\/span> ((<span class="charliteral">'\\n'<\/span> != fgetc(output)) &amp;&amp; !feof(output))$/;"	a
l00532	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00532"><\/a>00532                 ;$/;"	a
l00533	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00533"><\/a>00533         <span class="keywordflow">while<\/span> ((<span class="charliteral">'\\n'<\/span> != fgetc(output)) &amp;&amp; !feof(output))$/;"	a
l00534	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00534"><\/a>00534                 ;$/;"	a
l00535	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00535"><\/a>00535         <span class="keywordflow">while<\/span> (output &amp;&amp; !(feof(output))) {$/;"	a
l00536	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00536"><\/a>00536                 rc = fscanf(output, <span class="stringliteral">"%*s %llu %*s %*s %*s %*s %*s %15[0-9.] %*s %*s %*s %*s %*s %*s"<\/span>, &amp;counter, ip);$/;"	a
l00537	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00537"><\/a>00537                 <span class="comment">\/\/rc = fscanf(output, "%*s %llu %*s %*s %*s %*s %*s %15[0-9.] %*s %*s %*s %*s %*s 0x%*u", &amp;counter, ip);<\/span>$/;"	a
l00538	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00538"><\/a>00538                 <span class="keywordflow">if<\/span> (2 == rc &amp;&amp; EOF != rc) {$/;"	a
l00539	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00539"><\/a>00539                         <span class="comment">\/* Sanity*\/<\/span>$/;"	a
l00540	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00540"><\/a>00540                         <span class="keywordflow">if<\/span> (!inet_aton(ip, &amp;tempaddr)) {$/;"	a
l00541	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00541"><\/a>00541                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"I was supposed to read an IP address but instead got [%s] - ignoring it"<\/span>, ip);$/;"	a
l00542	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00542"><\/a>00542                                 <span class="keywordflow">continue<\/span>;$/;"	a
l00543	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00543"><\/a>00543                         }$/;"	a
l00544	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00544"><\/a>00544                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read outgoing traffic for %s: Bytes=%llu"<\/span>, ip, counter);$/;"	a
l00545	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00545"><\/a>00545                         LOCK_CLIENT_LIST();$/;"	a
l00546	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00546"><\/a>00546                         <span class="keywordflow">if<\/span> ((p1 = <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(ip))) {$/;"	a
l00547	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00547"><\/a>00547                                 <span class="keywordflow">if<\/span> ((p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> - p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a>) &lt; counter) {$/;"	a
l00548	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00548"><\/a>00548                                         p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a> + counter;$/;"	a
l00549	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00549"><\/a>00549                                         p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a> = time(NULL);$/;"	a
l00550	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00550"><\/a>00550                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"%s - Updated counter.outgoing to %llu bytes.  Updated last_updated to %d"<\/span>, ip, counter, p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>);$/;"	a
l00551	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00551"><\/a>00551                                 }$/;"	a
l00552	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00552"><\/a>00552                         } <span class="keywordflow">else<\/span> {$/;"	a
l00553	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00553"><\/a>00553                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not find %s in client list"<\/span>, ip);$/;"	a
l00554	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00554"><\/a>00554                         }$/;"	a
l00555	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00555"><\/a>00555                         UNLOCK_CLIENT_LIST();$/;"	a
l00556	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00556"><\/a>00556                 }$/;"	a
l00557	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00557"><\/a>00557         }$/;"	a
l00558	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00558"><\/a>00558         pclose(output);$/;"	a
l00559	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00559"><\/a>00559 $/;"	a
l00560	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00560"><\/a>00560         <span class="comment">\/* Look for incoming traffic *\/<\/span>$/;"	a
l00561	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00561"><\/a>00561         safe_asprintf(&amp;script, <span class="stringliteral">"%s %s"<\/span>, <span class="stringliteral">"iptables"<\/span>, <span class="stringliteral">"-v -n -x -t mangle -L "<\/span> <a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">TABLE_WIFIDOG_INCOMING<\/a>);$/;"	a
l00562	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00562"><\/a>00562         iptables_insert_gateway_id(&amp;script);$/;"	a
l00563	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00563"><\/a>00563         output = popen(script, <span class="stringliteral">"r"<\/span>);$/;"	a
l00564	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00564"><\/a>00564         free(script);$/;"	a
l00565	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00565"><\/a>00565         <span class="keywordflow">if<\/span> (!output) {$/;"	a
l00566	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00566"><\/a>00566                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"popen(): %s"<\/span>, strerror(errno));$/;"	a
l00567	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00567"><\/a>00567                 <span class="keywordflow">return<\/span> -1;$/;"	a
l00568	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00568"><\/a>00568         }$/;"	a
l00569	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00569"><\/a>00569 $/;"	a
l00570	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00570"><\/a>00570         <span class="comment">\/* skip the first two lines *\/<\/span>$/;"	a
l00571	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00571"><\/a>00571         <span class="keywordflow">while<\/span> ((<span class="charliteral">'\\n'<\/span> != fgetc(output)) &amp;&amp; !feof(output))$/;"	a
l00572	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00572"><\/a>00572                 ;$/;"	a
l00573	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00573"><\/a>00573         <span class="keywordflow">while<\/span> ((<span class="charliteral">'\\n'<\/span> != fgetc(output)) &amp;&amp; !feof(output))$/;"	a
l00574	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00574"><\/a>00574                 ;$/;"	a
l00575	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00575"><\/a>00575         <span class="keywordflow">while<\/span> (output &amp;&amp; !(feof(output))) {$/;"	a
l00576	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00576"><\/a>00576                 rc = fscanf(output, <span class="stringliteral">"%*s %llu %*s %*s %*s %*s %*s %*s %15[0-9.]"<\/span>, &amp;counter, ip);$/;"	a
l00577	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00577"><\/a>00577                 <span class="keywordflow">if<\/span> (2 == rc &amp;&amp; EOF != rc) {$/;"	a
l00578	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00578"><\/a>00578                         <span class="comment">\/* Sanity*\/<\/span>$/;"	a
l00579	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00579"><\/a>00579                         <span class="keywordflow">if<\/span> (!inet_aton(ip, &amp;tempaddr)) {$/;"	a
l00580	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00580"><\/a>00580                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"I was supposed to read an IP address but instead got [%s] - ignoring it"<\/span>, ip);$/;"	a
l00581	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00581"><\/a>00581                                 <span class="keywordflow">continue<\/span>;$/;"	a
l00582	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00582"><\/a>00582                         }$/;"	a
l00583	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00583"><\/a>00583                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read incoming traffic for %s: Bytes=%llu"<\/span>, ip, counter);$/;"	a
l00584	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00584"><\/a>00584                         LOCK_CLIENT_LIST();$/;"	a
l00585	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00585"><\/a>00585                         <span class="keywordflow">if<\/span> ((p1 = <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(ip))) {$/;"	a
l00586	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00586"><\/a>00586                                 <span class="keywordflow">if<\/span> ((p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> - p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a>) &lt; counter) {$/;"	a
l00587	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00587"><\/a>00587                                         p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> = p1-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a> + counter;$/;"	a
l00588	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00588"><\/a>00588                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"%s - Updated counter.incoming to %llu bytes"<\/span>, ip, counter);$/;"	a
l00589	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00589"><\/a>00589                                 }$/;"	a
l00590	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00590"><\/a>00590                         } <span class="keywordflow">else<\/span> {$/;"	a
l00591	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00591"><\/a>00591                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not find %s in client list"<\/span>, ip);$/;"	a
l00592	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00592"><\/a>00592                         }$/;"	a
l00593	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00593"><\/a>00593                         UNLOCK_CLIENT_LIST();$/;"	a
l00594	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00594"><\/a>00594                 }$/;"	a
l00595	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00595"><\/a>00595         }$/;"	a
l00596	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00596"><\/a>00596         pclose(output);$/;"	a
l00597	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00597"><\/a>00597 $/;"	a
l00598	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00598"><\/a>00598         <span class="keywordflow">return<\/span> 1;$/;"	a
l00599	install/share/doc/wifidog-20090925/html/fw__iptables_8c-source.html	/^<a name="l00599"><\/a>00599 }$/;"	a
l00001	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<h1>fw_iptables.h<\/h1><a href="fw__iptables_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: fw_iptables.h 1375 2008-09-30 10:20:06Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _FW_IPTABLES_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _FW_IPTABLES_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00034	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00034"><\/a><a class="code" href="fw__iptables_8h.html#027862016be5b3115529b464530ac459">00034<\/a> <span class="preprocessor">#define TABLE_WIFIDOG_OUTGOING  "WiFiDog_$ID$_Outgoing"<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00035"><\/a><a class="code" href="fw__iptables_8h.html#446be8def54af1d1b05d7419fe750324">00035<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_WIFI_TO_INTERNET "WiFiDog_$ID$_WIFI2Internet"<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00036"><\/a><a class="code" href="fw__iptables_8h.html#b3e4ef404402dc4287b3c945eeca7232">00036<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_WIFI_TO_ROUTER "WiFiDog_$ID$_WIFI2Router"<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00037"><\/a><a class="code" href="fw__iptables_8h.html#7002adcab76a23ef8cc99b36407e251b">00037<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_INCOMING  "WiFiDog_$ID$_Incoming"<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00038"><\/a><a class="code" href="fw__iptables_8h.html#0a6d436e2e948628cf122be4deea019c">00038<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_AUTHSERVERS "WiFiDog_$ID$_AuthServers"<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00039"><\/a><a class="code" href="fw__iptables_8h.html#4b2a4d965d85a7290dfeea913a514fa0">00039<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_GLOBAL  "WiFiDog_$ID$_Global"<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00040"><\/a><a class="code" href="fw__iptables_8h.html#e07c57ef1dc33ad9a0ca99d03d7f6b66">00040<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_VALIDATE  "WiFiDog_$ID$_Validate"<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00041"><\/a><a class="code" href="fw__iptables_8h.html#5aa196e45103e9883689ac8778f16cbc">00041<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_KNOWN     "WiFiDog_$ID$_Known"<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00042"><\/a><a class="code" href="fw__iptables_8h.html#5dadbef5146e4671a507934684dffce3">00042<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_UNKNOWN   "WiFiDog_$ID$_Unknown"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00043"><\/a><a class="code" href="fw__iptables_8h.html#19e9c5d4e0fafe8f01f111887972986d">00043<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_LOCKED    "WiFiDog_$ID$_Locked"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00044"><\/a><a class="code" href="fw__iptables_8h.html#f6c0a007717822481b0d8b3a1d7ce270">00044<\/a> <span class="preprocessor"><\/span><span class="preprocessor">#define TABLE_WIFIDOG_TRUSTED    "WiFiDog_$ID$_Trusted"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor"><\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00048"><\/a><a class="code" href="fw__iptables_8h.html#77e1252d7a42ff110b4cd807cc43822e">00048<\/a> <span class="keyword">typedef<\/span> <span class="keyword">enum<\/span> <a class="code" href="fw__iptables_8h.html#77e1252d7a42ff110b4cd807cc43822e">fw_access_t_<\/a> {$/;"	a
l00049	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00049"><\/a>00049     FW_ACCESS_ALLOW,$/;"	a
l00050	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00050"><\/a>00050     FW_ACCESS_DENY$/;"	a
l00051	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00051"><\/a>00051 } fw_access_t;$/;"	a
l00052	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00054	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00054"><\/a>00054 <span class="keywordtype">int<\/span> iptables_fw_init(<span class="keywordtype">void<\/span>);$/;"	a
l00055	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00055"><\/a>00055 $/;"	a
l00057	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00057"><\/a>00057 <span class="keywordtype">void<\/span> iptables_fw_set_authservers(<span class="keywordtype">void<\/span>);$/;"	a
l00058	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00058"><\/a>00058 $/;"	a
l00060	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00060"><\/a>00060 <span class="keywordtype">void<\/span> iptables_fw_clear_authservers(<span class="keywordtype">void<\/span>);$/;"	a
l00061	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00061"><\/a>00061 $/;"	a
l00063	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00063"><\/a>00063 <span class="keywordtype">int<\/span> iptables_fw_destroy(<span class="keywordtype">void<\/span>);$/;"	a
l00064	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00064"><\/a>00064 $/;"	a
l00066	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00066"><\/a>00066 <span class="keywordtype">int<\/span> iptables_fw_destroy_mention( <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * table, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * chain, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> * mention);$/;"	a
l00067	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00067"><\/a>00067 $/;"	a
l00069	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00069"><\/a>00069 <span class="keywordtype">int<\/span> iptables_fw_access(fw_access_t type, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ip, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *mac, <span class="keywordtype">int<\/span> tag);$/;"	a
l00070	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00070"><\/a>00070 $/;"	a
l00072	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00072"><\/a>00072 <span class="keywordtype">int<\/span> iptables_fw_counters_update(<span class="keywordtype">void<\/span>);$/;"	a
l00073	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00073"><\/a>00073 $/;"	a
l00074	install/share/doc/wifidog-20090925/html/fw__iptables_8h-source.html	/^<a name="l00074"><\/a>00074 <span class="preprocessor">#endif <\/span><span class="comment">\/* _IPTABLES_H_ *\/<\/span>$/;"	a
027862016be5b3115529b464530ac459	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="027862016be5b3115529b464530ac459"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_OUTGOING" ref="027862016be5b3115529b464530ac459" args="" -->$/;"	a
03bcbe41a673ef44e0fd15ae0a33dda9	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="03bcbe41a673ef44e0fd15ae0a33dda9"><\/a><!-- doxytag: member="fw_iptables.h::fw_access_t" ref="03bcbe41a673ef44e0fd15ae0a33dda9" args="" -->$/;"	a
0a6d436e2e948628cf122be4deea019c	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="0a6d436e2e948628cf122be4deea019c"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_AUTHSERVERS" ref="0a6d436e2e948628cf122be4deea019c" args="" -->$/;"	a
19e9c5d4e0fafe8f01f111887972986d	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="19e9c5d4e0fafe8f01f111887972986d"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_LOCKED" ref="19e9c5d4e0fafe8f01f111887972986d" args="" -->$/;"	a
215e1186b8a50b3b4c0402007872e3fc	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="215e1186b8a50b3b4c0402007872e3fc"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_access" ref="215e1186b8a50b3b4c0402007872e3fc" args="(fw_access_t type, const char *ip, const char *mac, int tag)" -->$/;"	a
2946cb91dee0c8a25d0489f4d49946b9	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="2946cb91dee0c8a25d0489f4d49946b9"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_clear_authservers" ref="2946cb91dee0c8a25d0489f4d49946b9" args="(void)" -->$/;"	a
446be8def54af1d1b05d7419fe750324	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="446be8def54af1d1b05d7419fe750324"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_WIFI_TO_INTERNET" ref="446be8def54af1d1b05d7419fe750324" args="" -->$/;"	a
4b2a4d965d85a7290dfeea913a514fa0	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="4b2a4d965d85a7290dfeea913a514fa0"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_GLOBAL" ref="4b2a4d965d85a7290dfeea913a514fa0" args="" -->$/;"	a
5aa196e45103e9883689ac8778f16cbc	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="5aa196e45103e9883689ac8778f16cbc"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_KNOWN" ref="5aa196e45103e9883689ac8778f16cbc" args="" -->$/;"	a
5dadbef5146e4671a507934684dffce3	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="5dadbef5146e4671a507934684dffce3"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_UNKNOWN" ref="5dadbef5146e4671a507934684dffce3" args="" -->$/;"	a
7002adcab76a23ef8cc99b36407e251b	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="7002adcab76a23ef8cc99b36407e251b"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_INCOMING" ref="7002adcab76a23ef8cc99b36407e251b" args="" -->$/;"	a
77e1252d7a42ff110b4cd807cc43822e	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="77e1252d7a42ff110b4cd807cc43822e"><\/a><!-- doxytag: member="fw_iptables.h::fw_access_t_" ref="77e1252d7a42ff110b4cd807cc43822e" args="" -->$/;"	a
94d41bcb1c985732a51ce171b7e858b1	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="94d41bcb1c985732a51ce171b7e858b1"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_init" ref="94d41bcb1c985732a51ce171b7e858b1" args="(void)" -->$/;"	a
99cee9643f6caf090c134e7651289233	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="99cee9643f6caf090c134e7651289233"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_destroy_mention" ref="99cee9643f6caf090c134e7651289233" args="(const char *table, const char *chain, const char *mention)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b3e4ef404402dc4287b3c945eeca7232	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="b3e4ef404402dc4287b3c945eeca7232"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_WIFI_TO_ROUTER" ref="b3e4ef404402dc4287b3c945eeca7232" args="" -->$/;"	a
bfd8ac7489174a3c172d2f12eaba704a	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="bfd8ac7489174a3c172d2f12eaba704a"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_counters_update" ref="bfd8ac7489174a3c172d2f12eaba704a" args="(void)" -->$/;"	a
cd205e30639a80845248822e2e1e7eba	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="cd205e30639a80845248822e2e1e7eba"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_set_authservers" ref="cd205e30639a80845248822e2e1e7eba" args="(void)" -->$/;"	a
e07c57ef1dc33ad9a0ca99d03d7f6b66	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="e07c57ef1dc33ad9a0ca99d03d7f6b66"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_VALIDATE" ref="e07c57ef1dc33ad9a0ca99d03d7f6b66" args="" -->$/;"	a
f6c0a007717822481b0d8b3a1d7ce270	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="f6c0a007717822481b0d8b3a1d7ce270"><\/a><!-- doxytag: member="fw_iptables.h::TABLE_WIFIDOG_TRUSTED" ref="f6c0a007717822481b0d8b3a1d7ce270" args="" -->$/;"	a
feabe4a819a5e16d2d2df56bdfa2ca58	install/share/doc/wifidog-20090925/html/fw__iptables_8h.html	/^<a class="anchor" name="feabe4a819a5e16d2d2df56bdfa2ca58"><\/a><!-- doxytag: member="fw_iptables.h::iptables_fw_destroy" ref="feabe4a819a5e16d2d2df56bdfa2ca58" args="(void)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<h1>gateway.c<\/h1><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free:Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: gateway.c 1305 2007-11-01 20:04:20Z benoitg $ *\/<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;signal.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;time.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="comment">\/* for strerror() *\/<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00040	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="comment">\/* for wait() *\/<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include &lt;sys\/wait.h&gt;<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="comment">\/* for unix socket communication*\/<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include &lt;sys\/un.h&gt;<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00046"><\/a>00046 $/;"	a
l00047	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor">#include "<a class="code" href="gateway_8h.html" title="Main loop.">gateway.h<\/a>"<\/span>$/;"	a
l00053	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00054	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor">#include "<a class="code" href="commandline_8h.html" title="Command line argument handling.">commandline.h<\/a>"<\/span>$/;"	a
l00055	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00056	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="preprocessor">#include "<a class="code" href="http_8h.html" title="HTTP IO functions.">http.h<\/a>"<\/span>$/;"	a
l00057	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00058	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="preprocessor">#include "<a class="code" href="wdctl__thread_8h.html" title="WiFiDog monitoring thread.">wdctl_thread.h<\/a>"<\/span>$/;"	a
l00059	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00059"><\/a>00059 <span class="preprocessor">#include "<a class="code" href="ping__thread_8h.html" title="WiFiDog heartbeat thread.">ping_thread.h<\/a>"<\/span>$/;"	a
l00060	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="preprocessor">#include "<a class="code" href="httpd__thread_8h.html" title="WiFiDog httpd worker thread.">httpd_thread.h<\/a>"<\/span>$/;"	a
l00061	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00061"><\/a>00061 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00062	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00062"><\/a>00062 $/;"	a
l00067	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00067"><\/a>00067 <span class="keyword">static<\/span> pthread_t tid_fw_counter = 0;$/;"	a
l00068	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00068"><\/a>00068 <span class="keyword">static<\/span> pthread_t tid_ping = 0; $/;"	a
l00069	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00069"><\/a>00069 $/;"	a
l00070	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00070"><\/a>00070 <span class="comment">\/* The internal web server *\/<\/span>$/;"	a
l00071	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00071"><\/a>00071 httpd * webserver = NULL;$/;"	a
l00072	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00072"><\/a>00072 $/;"	a
l00073	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00073"><\/a>00073 <span class="comment">\/* from commandline.c *\/<\/span>$/;"	a
l00074	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00074"><\/a>00074 <span class="keyword">extern<\/span> <span class="keywordtype">char<\/span> ** restartargv;$/;"	a
l00075	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00075"><\/a>00075 <span class="keyword">extern<\/span> pid_t restart_orig_pid;$/;"	a
l00076	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00076"><\/a>00076 <a class="code" href="struct__t__client.html">t_client<\/a> *firstclient;$/;"	a
l00077	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00077"><\/a>00077 $/;"	a
l00078	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00078"><\/a>00078 <span class="comment">\/* from client_list.c *\/<\/span>$/;"	a
l00079	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00079"><\/a>00079 <span class="keyword">extern<\/span> pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00080	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00080"><\/a>00080 $/;"	a
l00081	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00081"><\/a>00081 <span class="comment">\/* Time when wifidog started  *\/<\/span>$/;"	a
l00082	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00082"><\/a>00082 time_t started_time = 0;$/;"	a
l00083	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00084"><\/a>00084 <span class="comment">\/* Appends -x, the current PID, and NULL to restartargv<\/span>$/;"	a
l00085	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00085"><\/a>00085 <span class="comment"> * see parse_commandline in commandline.c for details<\/span>$/;"	a
l00086	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00086"><\/a>00086 <span class="comment"> *<\/span>$/;"	a
l00087	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00087"><\/a>00087 <span class="comment"> * Why is restartargv global? Shouldn't it be at most static to commandline.c<\/span>$/;"	a
l00088	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00088"><\/a>00088 <span class="comment"> * and this function static there? -Alex @ 8oct2006<\/span>$/;"	a
l00089	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00089"><\/a>00089 <span class="comment"> *\/<\/span>$/;"	a
l00090	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00090"><\/a>00090 <span class="keywordtype">void<\/span> append_x_restartargv(<span class="keywordtype">void<\/span>) {$/;"	a
l00091	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00091"><\/a>00091         <span class="keywordtype">int<\/span> i;$/;"	a
l00092	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00092"><\/a>00092 $/;"	a
l00093	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00093"><\/a>00093         <span class="keywordflow">for<\/span> (i=0; restartargv[i]; i++);$/;"	a
l00094	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00094"><\/a>00094 $/;"	a
l00095	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00095"><\/a>00095         restartargv[i++] = safe_strdup(<span class="stringliteral">"-x"<\/span>);$/;"	a
l00096	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00096"><\/a>00096         safe_asprintf(&amp;(restartargv[i++]), <span class="stringliteral">"%d"<\/span>, getpid());$/;"	a
l00097	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00097"><\/a>00097 }$/;"	a
l00098	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00098"><\/a>00098 $/;"	a
l00099	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00099"><\/a>00099 <span class="comment">\/* @internal<\/span>$/;"	a
l00100	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00100"><\/a>00100 <span class="comment"> * @brief During gateway restart, connects to the parent process via the internal socket<\/span>$/;"	a
l00101	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00101"><\/a>00101 <span class="comment"> * Downloads from it the active client list<\/span>$/;"	a
l00102	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00102"><\/a>00102 <span class="comment"> *\/<\/span>$/;"	a
l00103	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00103"><\/a>00103 <span class="keywordtype">void<\/span> get_clients_from_parent(<span class="keywordtype">void<\/span>) {$/;"	a
l00104	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00104"><\/a>00104         <span class="keywordtype">int<\/span> sock;$/;"	a
l00105	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00105"><\/a>00105         <span class="keyword">struct <\/span>sockaddr_un      sa_un;$/;"	a
l00106	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00106"><\/a>00106         <a class="code" href="structs__config.html">s_config<\/a> * config = NULL;$/;"	a
l00107	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00107"><\/a>00107         <span class="keywordtype">char<\/span> linebuffer[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00108	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00108"><\/a>00108         <span class="keywordtype">int<\/span> len = 0;$/;"	a
l00109	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00109"><\/a>00109         <span class="keywordtype">char<\/span> *running1 = NULL;$/;"	a
l00110	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00110"><\/a>00110         <span class="keywordtype">char<\/span> *running2 = NULL;$/;"	a
l00111	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00111"><\/a>00111         <span class="keywordtype">char<\/span> *token1 = NULL;$/;"	a
l00112	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00112"><\/a>00112         <span class="keywordtype">char<\/span> *token2 = NULL;$/;"	a
l00113	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00113"><\/a>00113         <span class="keywordtype">char<\/span> onechar;$/;"	a
l00114	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00114"><\/a>00114         <span class="keywordtype">char<\/span> *command = NULL;$/;"	a
l00115	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00115"><\/a>00115         <span class="keywordtype">char<\/span> *key = NULL;$/;"	a
l00116	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00116"><\/a>00116         <span class="keywordtype">char<\/span> *value = NULL;$/;"	a
l00117	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00117"><\/a>00117         <a class="code" href="struct__t__client.html">t_client<\/a> * client = NULL;$/;"	a
l00118	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00118"><\/a>00118         <a class="code" href="struct__t__client.html">t_client<\/a> * lastclient = NULL;$/;"	a
l00119	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00119"><\/a>00119 $/;"	a
l00120	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00120"><\/a>00120         config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00121	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00121"><\/a>00121         $/;"	a
l00122	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00122"><\/a>00122         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Connecting to parent to download clients"<\/span>);$/;"	a
l00123	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00123"><\/a>00123 $/;"	a
l00124	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00124"><\/a>00124         <span class="comment">\/* Connect to socket *\/<\/span>$/;"	a
l00125	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00125"><\/a>00125         sock = socket(AF_UNIX, SOCK_STREAM, 0);$/;"	a
l00126	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00126"><\/a>00126         memset(&amp;sa_un, 0, <span class="keyword">sizeof<\/span>(sa_un));$/;"	a
l00127	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00127"><\/a>00127         sa_un.sun_family = AF_UNIX;$/;"	a
l00128	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00128"><\/a>00128         strncpy(sa_un.sun_path, config-&gt;internal_sock, (<span class="keyword">sizeof<\/span>(sa_un.sun_path) - 1));$/;"	a
l00129	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00129"><\/a>00129 $/;"	a
l00130	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00130"><\/a>00130         <span class="keywordflow">if<\/span> (connect(sock, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, strlen(sa_un.sun_path) + <span class="keyword">sizeof<\/span>(sa_un.sun_family))) {$/;"	a
l00131	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00131"><\/a>00131                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Failed to connect to parent (%s) - client list not downloaded"<\/span>, strerror(errno));$/;"	a
l00132	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00132"><\/a>00132                 <span class="keywordflow">return<\/span>;$/;"	a
l00133	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00133"><\/a>00133         }$/;"	a
l00134	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00134"><\/a>00134 $/;"	a
l00135	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00135"><\/a>00135         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Connected to parent.  Downloading clients"<\/span>);$/;"	a
l00136	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00136"><\/a>00136 $/;"	a
l00137	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00137"><\/a>00137         LOCK_CLIENT_LIST();$/;"	a
l00138	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00138"><\/a>00138 $/;"	a
l00139	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00139"><\/a>00139         command = NULL;$/;"	a
l00140	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00140"><\/a>00140         memset(linebuffer, 0, <span class="keyword">sizeof<\/span>(linebuffer));$/;"	a
l00141	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00141"><\/a>00141         len = 0;$/;"	a
l00142	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00142"><\/a>00142         client = NULL;$/;"	a
l00143	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00143"><\/a>00143         <span class="comment">\/* Get line by line *\/<\/span>$/;"	a
l00144	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00144"><\/a>00144         <span class="keywordflow">while<\/span> (read(sock, &amp;onechar, 1) == 1) {$/;"	a
l00145	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00145"><\/a>00145                 <span class="keywordflow">if<\/span> (onechar == <span class="charliteral">'\\n'<\/span>) {$/;"	a
l00146	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00146"><\/a>00146                         <span class="comment">\/* End of line *\/<\/span>$/;"	a
l00147	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00147"><\/a>00147                         onechar = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00148	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00148"><\/a>00148                 }$/;"	a
l00149	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00149"><\/a>00149                 linebuffer[len++] = onechar;$/;"	a
l00150	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00150"><\/a>00150 $/;"	a
l00151	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00151"><\/a>00151                 <span class="keywordflow">if<\/span> (!onechar) {$/;"	a
l00152	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00152"><\/a>00152                         <span class="comment">\/* We have a complete entry in linebuffer - parse it *\/<\/span>$/;"	a
l00153	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00153"><\/a>00153                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Received from parent: [%s]"<\/span>, linebuffer);$/;"	a
l00154	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00154"><\/a>00154                         running1 = linebuffer;$/;"	a
l00155	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00155"><\/a>00155                         <span class="keywordflow">while<\/span> ((token1 = strsep(&amp;running1, <span class="stringliteral">"|"<\/span>)) != NULL) {$/;"	a
l00156	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00156"><\/a>00156                                 <span class="keywordflow">if<\/span> (!command) {$/;"	a
l00157	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00157"><\/a>00157                                         <span class="comment">\/* The first token is the command *\/<\/span>$/;"	a
l00158	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00158"><\/a>00158                                         command = token1;$/;"	a
l00159	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00159"><\/a>00159                                 }$/;"	a
l00160	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00160"><\/a>00160                                 <span class="keywordflow">else<\/span> {$/;"	a
l00161	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00161"><\/a>00161                                 <span class="comment">\/* Token1 has something like "foo=bar" *\/<\/span>$/;"	a
l00162	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00162"><\/a>00162                                         running2 = token1;$/;"	a
l00163	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00163"><\/a>00163                                         key = value = NULL;$/;"	a
l00164	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00164"><\/a>00164                                         <span class="keywordflow">while<\/span> ((token2 = strsep(&amp;running2, <span class="stringliteral">"="<\/span>)) != NULL) {$/;"	a
l00165	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00165"><\/a>00165                                                 <span class="keywordflow">if<\/span> (!key) {$/;"	a
l00166	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00166"><\/a>00166                                                         key = token2;$/;"	a
l00167	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00167"><\/a>00167                                                 }$/;"	a
l00168	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00168"><\/a>00168                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (!value) {$/;"	a
l00169	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00169"><\/a>00169                                                         value = token2;$/;"	a
l00170	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00170"><\/a>00170                                                 }$/;"	a
l00171	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00171"><\/a>00171                                         }$/;"	a
l00172	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00172"><\/a>00172                                 }$/;"	a
l00173	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00173"><\/a>00173 $/;"	a
l00174	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00174"><\/a>00174                                 <span class="keywordflow">if<\/span> (strcmp(command, <span class="stringliteral">"CLIENT"<\/span>) == 0) {$/;"	a
l00175	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00175"><\/a>00175                                         <span class="comment">\/* This line has info about a client in the client list *\/<\/span>$/;"	a
l00176	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00176"><\/a>00176                                         <span class="keywordflow">if<\/span> (!client) {$/;"	a
l00177	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00177"><\/a>00177                                                 <span class="comment">\/* Create a new client struct *\/<\/span>$/;"	a
l00178	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00178"><\/a>00178                                                 client = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<a class="code" href="struct__t__client.html">t_client<\/a>));$/;"	a
l00179	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00179"><\/a>00179                                                 memset(client, 0, <span class="keyword">sizeof<\/span>(<a class="code" href="struct__t__client.html">t_client<\/a>));$/;"	a
l00180	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00180"><\/a>00180                                         }$/;"	a
l00181	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00181"><\/a>00181                                 }$/;"	a
l00182	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00182"><\/a>00182 $/;"	a
l00183	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00183"><\/a>00183                                 <span class="keywordflow">if<\/span> (key &amp;&amp; value) {$/;"	a
l00184	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00184"><\/a>00184                                         <span class="keywordflow">if<\/span> (strcmp(command, <span class="stringliteral">"CLIENT"<\/span>) == 0) {$/;"	a
l00185	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00185"><\/a>00185                                                 <span class="comment">\/* Assign the key into the appropriate slot in the connection structure *\/<\/span>$/;"	a
l00186	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00186"><\/a>00186                                                 <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"ip"<\/span>) == 0) {$/;"	a
l00187	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00187"><\/a>00187                                                         client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a> = safe_strdup(value);$/;"	a
l00188	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00188"><\/a>00188                                                 }$/;"	a
l00189	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00189"><\/a>00189                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"mac"<\/span>) == 0) {$/;"	a
l00190	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00190"><\/a>00190                                                         client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a> = safe_strdup(value);$/;"	a
l00191	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00191"><\/a>00191                                                 }$/;"	a
l00192	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00192"><\/a>00192                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"token"<\/span>) == 0) {$/;"	a
l00193	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00193"><\/a>00193                                                         client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a> = safe_strdup(value);$/;"	a
l00194	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00194"><\/a>00194                                                 }$/;"	a
l00195	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00195"><\/a>00195                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"fw_connection_state"<\/span>) == 0) {$/;"	a
l00196	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00196"><\/a>00196                                                         client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a> = atoi(value);$/;"	a
l00197	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00197"><\/a>00197                                                 }$/;"	a
l00198	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00198"><\/a>00198                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"fd"<\/span>) == 0) {$/;"	a
l00199	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00199"><\/a>00199                                                         client-&gt;<a class="code" href="struct__t__client.html#495baef8f1dc90c94c24561ebd61140d" title="Client HTTP socket (valid only during login before one of the _http_* function is...">fd<\/a> = atoi(value);$/;"	a
l00200	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00200"><\/a>00200                                                 }$/;"	a
l00201	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00201"><\/a>00201                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"counters_incoming"<\/span>) == 0) {$/;"	a
l00202	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00202"><\/a>00202                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a> = atoll(value);$/;"	a
l00203	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00203"><\/a>00203                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a> = client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#10913bf2ef2987382c044428fb9c39e9" title="Incoming data before wifidog restarted.">incoming_history<\/a>;$/;"	a
l00204	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00204"><\/a>00204                                                 }$/;"	a
l00205	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00205"><\/a>00205                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"counters_outgoing"<\/span>) == 0) {$/;"	a
l00206	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00206"><\/a>00206                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a> = atoll(value);$/;"	a
l00207	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00207"><\/a>00207                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a> = client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#6fbba5b171f4deb67169798cdfecb4ba" title="Outgoing data before wifidog restarted.">outgoing_history<\/a>;$/;"	a
l00208	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00208"><\/a>00208                                                 }$/;"	a
l00209	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00209"><\/a>00209                                                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(key, <span class="stringliteral">"counters_last_updated"<\/span>) == 0) {$/;"	a
l00210	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00210"><\/a>00210                                                         client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a> = atol(value);$/;"	a
l00211	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00211"><\/a>00211                                                 }$/;"	a
l00212	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00212"><\/a>00212                                                 <span class="keywordflow">else<\/span> {$/;"	a
l00213	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00213"><\/a>00213                                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"I don't know how to inherit key [%s] value [%s] from parent"<\/span>, key, value);$/;"	a
l00214	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00214"><\/a>00214                                                 }$/;"	a
l00215	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00215"><\/a>00215                                         }$/;"	a
l00216	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00216"><\/a>00216                                 }$/;"	a
l00217	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00217"><\/a>00217                         }$/;"	a
l00218	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00218"><\/a>00218 $/;"	a
l00219	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00219"><\/a>00219                         <span class="comment">\/* End of parsing this command *\/<\/span>$/;"	a
l00220	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00220"><\/a>00220                         <span class="keywordflow">if<\/span> (client) {$/;"	a
l00221	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00221"><\/a>00221                                 <span class="comment">\/* Add this client to the client list *\/<\/span>$/;"	a
l00222	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00222"><\/a>00222                                 <span class="keywordflow">if<\/span> (!firstclient) {$/;"	a
l00223	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00223"><\/a>00223                                         firstclient = client;$/;"	a
l00224	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00224"><\/a>00224                                         lastclient = firstclient;$/;"	a
l00225	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00225"><\/a>00225                                 }$/;"	a
l00226	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00226"><\/a>00226                                 <span class="keywordflow">else<\/span> {$/;"	a
l00227	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00227"><\/a>00227                                         lastclient-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> = client;$/;"	a
l00228	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00228"><\/a>00228                                         lastclient = client;$/;"	a
l00229	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00229"><\/a>00229                                 }$/;"	a
l00230	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00230"><\/a>00230                         }$/;"	a
l00231	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00231"><\/a>00231 $/;"	a
l00232	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00232"><\/a>00232                         <span class="comment">\/* Clean up *\/<\/span>$/;"	a
l00233	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00233"><\/a>00233                         command = NULL;$/;"	a
l00234	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00234"><\/a>00234                         memset(linebuffer, 0, <span class="keyword">sizeof<\/span>(linebuffer));$/;"	a
l00235	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00235"><\/a>00235                         len = 0;$/;"	a
l00236	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00236"><\/a>00236                         client = NULL;$/;"	a
l00237	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00237"><\/a>00237                 }$/;"	a
l00238	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00238"><\/a>00238         }$/;"	a
l00239	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00239"><\/a>00239 $/;"	a
l00240	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00240"><\/a>00240         UNLOCK_CLIENT_LIST();$/;"	a
l00241	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00241"><\/a>00241         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Client list downloaded successfully from parent"<\/span>);$/;"	a
l00242	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00242"><\/a>00242 $/;"	a
l00243	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00243"><\/a>00243         close(sock);$/;"	a
l00244	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00244"><\/a>00244 }$/;"	a
l00245	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00245"><\/a>00245 $/;"	a
l00253	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00253"><\/a>00253 <span class="keywordtype">void<\/span>$/;"	a
l00254	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00254"><\/a>00254 sigchld_handler(<span class="keywordtype">int<\/span> s)$/;"	a
l00255	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00255"><\/a>00255 {$/;"	a
l00256	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00256"><\/a>00256         <span class="keywordtype">int<\/span>     status;$/;"	a
l00257	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00257"><\/a>00257         pid_t rc;$/;"	a
l00258	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00258"><\/a>00258         $/;"	a
l00259	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00259"><\/a>00259         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Handler for SIGCHLD called. Trying to reap a child"<\/span>);$/;"	a
l00260	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00260"><\/a>00260 $/;"	a
l00261	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00261"><\/a>00261         rc = waitpid(-1, &amp;status, WNOHANG);$/;"	a
l00262	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00262"><\/a>00262 $/;"	a
l00263	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00263"><\/a>00263         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Handler for SIGCHLD reaped child PID %d"<\/span>, rc);$/;"	a
l00264	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00264"><\/a>00264 }$/;"	a
l00265	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00265"><\/a>00265 $/;"	a
l00268	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00268"><\/a>00268 <span class="keywordtype">void<\/span>$/;"	a
l00269	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00269"><\/a><a class="code" href="gateway_8h.html#d850f6ceb76de4be944cdedca2420db5">00269<\/a> termination_handler(<span class="keywordtype">int<\/span> s)$/;"	a
l00270	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00270"><\/a>00270 {$/;"	a
l00271	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00271"><\/a>00271         <span class="keyword">static<\/span>  pthread_mutex_t sigterm_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00272	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00272"><\/a>00272 $/;"	a
l00273	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00273"><\/a>00273         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Handler for termination caught signal %d"<\/span>, s);$/;"	a
l00274	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00274"><\/a>00274 $/;"	a
l00275	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00275"><\/a>00275         <span class="comment">\/* Makes sure we only call fw_destroy() once. *\/<\/span>$/;"	a
l00276	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00276"><\/a>00276         <span class="keywordflow">if<\/span> (pthread_mutex_trylock(&amp;sigterm_mutex)) {$/;"	a
l00277	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00277"><\/a>00277                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Another thread already began global termination handler. I'm exiting"<\/span>);$/;"	a
l00278	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00278"><\/a>00278                 pthread_exit(NULL);$/;"	a
l00279	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00279"><\/a>00279         }$/;"	a
l00280	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00280"><\/a>00280         <span class="keywordflow">else<\/span> {$/;"	a
l00281	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00281"><\/a>00281                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Cleaning up and exiting"<\/span>);$/;"	a
l00282	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00282"><\/a>00282         }$/;"	a
l00283	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00283"><\/a>00283 $/;"	a
l00284	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00284"><\/a>00284         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Flushing firewall rules..."<\/span>);$/;"	a
l00285	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00285"><\/a>00285         fw_destroy();$/;"	a
l00286	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00286"><\/a>00286 $/;"	a
l00287	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00287"><\/a>00287         <span class="comment">\/* XXX Hack<\/span>$/;"	a
l00288	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00288"><\/a>00288 <span class="comment">         * Aparently pthread_cond_timedwait under openwrt prevents signals (and therefore<\/span>$/;"	a
l00289	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00289"><\/a>00289 <span class="comment">         * termination handler) from happening so we need to explicitly kill the threads <\/span>$/;"	a
l00290	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00290"><\/a>00290 <span class="comment">         * that use that<\/span>$/;"	a
l00291	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00291"><\/a>00291 <span class="comment">         *\/<\/span>$/;"	a
l00292	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00292"><\/a>00292         <span class="keywordflow">if<\/span> (tid_fw_counter) {$/;"	a
l00293	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00293"><\/a>00293                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Explicitly killing the fw_counter thread"<\/span>);$/;"	a
l00294	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00294"><\/a>00294                 pthread_kill(tid_fw_counter, SIGKILL);$/;"	a
l00295	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00295"><\/a>00295         }$/;"	a
l00296	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00296"><\/a>00296         <span class="keywordflow">if<\/span> (tid_ping) {$/;"	a
l00297	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00297"><\/a>00297                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Explicitly killing the ping thread"<\/span>);$/;"	a
l00298	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00298"><\/a>00298                 pthread_kill(tid_ping, SIGKILL);$/;"	a
l00299	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00299"><\/a>00299         }$/;"	a
l00300	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00300"><\/a>00300 $/;"	a
l00301	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00301"><\/a>00301         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Exiting..."<\/span>);$/;"	a
l00302	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00302"><\/a>00302         exit(s == 0 ? 1 : 0);$/;"	a
l00303	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00303"><\/a>00303 }$/;"	a
l00304	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00304"><\/a>00304 $/;"	a
l00308	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00308"><\/a>00308 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00309	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00309"><\/a>00309 init_signals(<span class="keywordtype">void<\/span>)$/;"	a
l00310	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00310"><\/a>00310 {$/;"	a
l00311	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00311"><\/a>00311         <span class="keyword">struct <\/span>sigaction sa;$/;"	a
l00312	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00312"><\/a>00312 $/;"	a
l00313	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00313"><\/a>00313         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Initializing signal handlers"<\/span>);$/;"	a
l00314	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00314"><\/a>00314         $/;"	a
l00315	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00315"><\/a>00315         sa.sa_handler = sigchld_handler;$/;"	a
l00316	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00316"><\/a>00316         sigemptyset(&amp;sa.sa_mask);$/;"	a
l00317	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00317"><\/a>00317         sa.sa_flags = SA_RESTART;$/;"	a
l00318	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00318"><\/a>00318         <span class="keywordflow">if<\/span> (sigaction(SIGCHLD, &amp;sa, NULL) == -1) {$/;"	a
l00319	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00319"><\/a>00319                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00320	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00320"><\/a>00320                 exit(1);$/;"	a
l00321	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00321"><\/a>00321         }$/;"	a
l00322	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00322"><\/a>00322 $/;"	a
l00323	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00323"><\/a>00323         <span class="comment">\/* Trap SIGPIPE *\/<\/span>$/;"	a
l00324	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00324"><\/a>00324         <span class="comment">\/* This is done so that when libhttpd does a socket operation on<\/span>$/;"	a
l00325	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00325"><\/a>00325 <span class="comment">         * a disconnected socket (i.e.: Broken Pipes) we catch the signal<\/span>$/;"	a
l00326	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00326"><\/a>00326 <span class="comment">         * and do nothing. The alternative is to exit. SIGPIPE are harmless<\/span>$/;"	a
l00327	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00327"><\/a>00327 <span class="comment">         * if not desirable.<\/span>$/;"	a
l00328	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00328"><\/a>00328 <span class="comment">         *\/<\/span>$/;"	a
l00329	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00329"><\/a>00329         sa.sa_handler = SIG_IGN;$/;"	a
l00330	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00330"><\/a>00330         <span class="keywordflow">if<\/span> (sigaction(SIGPIPE, &amp;sa, NULL) == -1) {$/;"	a
l00331	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00331"><\/a>00331                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00332	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00332"><\/a>00332                 exit(1);$/;"	a
l00333	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00333"><\/a>00333         }$/;"	a
l00334	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00334"><\/a>00334 $/;"	a
l00335	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00335"><\/a>00335         sa.sa_handler = termination_handler;$/;"	a
l00336	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00336"><\/a>00336         sigemptyset(&amp;sa.sa_mask);$/;"	a
l00337	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00337"><\/a>00337         sa.sa_flags = SA_RESTART;$/;"	a
l00338	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00338"><\/a>00338 $/;"	a
l00339	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00339"><\/a>00339         <span class="comment">\/* Trap SIGTERM *\/<\/span>$/;"	a
l00340	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00340"><\/a>00340         <span class="keywordflow">if<\/span> (sigaction(SIGTERM, &amp;sa, NULL) == -1) {$/;"	a
l00341	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00341"><\/a>00341                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00342	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00342"><\/a>00342                 exit(1);$/;"	a
l00343	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00343"><\/a>00343         }$/;"	a
l00344	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00344"><\/a>00344 $/;"	a
l00345	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00345"><\/a>00345         <span class="comment">\/* Trap SIGQUIT *\/<\/span>$/;"	a
l00346	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00346"><\/a>00346         <span class="keywordflow">if<\/span> (sigaction(SIGQUIT, &amp;sa, NULL) == -1) {$/;"	a
l00347	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00347"><\/a>00347                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00348	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00348"><\/a>00348                 exit(1);$/;"	a
l00349	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00349"><\/a>00349         }$/;"	a
l00350	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00350"><\/a>00350 $/;"	a
l00351	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00351"><\/a>00351         <span class="comment">\/* Trap SIGINT *\/<\/span>$/;"	a
l00352	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00352"><\/a>00352         <span class="keywordflow">if<\/span> (sigaction(SIGINT, &amp;sa, NULL) == -1) {$/;"	a
l00353	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00353"><\/a>00353                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"sigaction(): %s"<\/span>, strerror(errno));$/;"	a
l00354	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00354"><\/a>00354                 exit(1);$/;"	a
l00355	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00355"><\/a>00355         }$/;"	a
l00356	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00356"><\/a>00356 }$/;"	a
l00357	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00357"><\/a>00357 $/;"	a
l00361	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00361"><\/a>00361 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00362	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00362"><\/a>00362 main_loop(<span class="keywordtype">void<\/span>)$/;"	a
l00363	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00363"><\/a>00363 {$/;"	a
l00364	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00364"><\/a>00364         <span class="keywordtype">int<\/span> result;$/;"	a
l00365	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00365"><\/a>00365         pthread_t       tid;$/;"	a
l00366	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00366"><\/a>00366         <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00367	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00367"><\/a>00367         request *r;$/;"	a
l00368	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00368"><\/a>00368         <span class="keywordtype">void<\/span> **params;$/;"	a
l00369	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00369"><\/a>00369 $/;"	a
l00370	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00370"><\/a>00370     <span class="comment">\/* Set the time when wifidog started *\/<\/span>$/;"	a
l00371	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00371"><\/a>00371         <span class="keywordflow">if<\/span> (!started_time) {$/;"	a
l00372	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00372"><\/a>00372                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Setting started_time"<\/span>);$/;"	a
l00373	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00373"><\/a>00373                 started_time = time(NULL);$/;"	a
l00374	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00374"><\/a>00374         }$/;"	a
l00375	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00375"><\/a>00375         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (started_time &lt; MINIMUM_STARTED_TIME) {$/;"	a
l00376	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00376"><\/a>00376                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"Detected possible clock skew - re-setting started_time"<\/span>);$/;"	a
l00377	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00377"><\/a>00377                 started_time = time(NULL);$/;"	a
l00378	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00378"><\/a>00378         }$/;"	a
l00379	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00379"><\/a>00379 $/;"	a
l00380	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00380"><\/a>00380         <span class="comment">\/* If we don't have the Gateway IP address, get it. Can't fail. *\/<\/span>$/;"	a
l00381	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00381"><\/a>00381         <span class="keywordflow">if<\/span> (!config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>) {$/;"	a
l00382	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00382"><\/a>00382                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Finding IP address of %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00383	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00383"><\/a>00383                 <span class="keywordflow">if<\/span> ((config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a> = get_iface_ip(config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>)) == NULL) {$/;"	a
l00384	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00384"><\/a>00384                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not get IP address information of %s, exiting..."<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00385	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00385"><\/a>00385                         exit(1);$/;"	a
l00386	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00386"><\/a>00386                 }$/;"	a
l00387	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00387"><\/a>00387                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"%s = %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>, config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>);$/;"	a
l00388	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00388"><\/a>00388         }$/;"	a
l00389	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00389"><\/a>00389 $/;"	a
l00390	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00390"><\/a>00390         <span class="comment">\/* If we don't have the Gateway ID, construct it from the internal MAC address.<\/span>$/;"	a
l00391	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00391"><\/a>00391 <span class="comment">         * "Can't fail" so exit() if the impossible happens. *\/<\/span>$/;"	a
l00392	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00392"><\/a>00392         <span class="keywordflow">if<\/span> (!config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>) {$/;"	a
l00393	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00393"><\/a>00393         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Finding MAC address of %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00394	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00394"><\/a>00394         <span class="keywordflow">if<\/span> ((config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a> = get_iface_mac(config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>)) == NULL) {$/;"	a
l00395	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00395"><\/a>00395                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not get MAC address information of %s, exiting..."<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>);$/;"	a
l00396	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00396"><\/a>00396                         exit(1);$/;"	a
l00397	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00397"><\/a>00397                 }$/;"	a
l00398	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00398"><\/a>00398                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"%s = %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#d618811ef3a6a0e3b373d972c6cf2e8c" title="Interface we will accept connections on.">gw_interface<\/a>, config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>);$/;"	a
l00399	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00399"><\/a>00399         }$/;"	a
l00400	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00400"><\/a>00400 $/;"	a
l00401	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00401"><\/a>00401         <span class="comment">\/* Initializes the web server *\/<\/span>$/;"	a
l00402	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00402"><\/a>00402         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Creating web server on %s:%d"<\/span>, config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>, config-&gt;<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>);$/;"	a
l00403	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00403"><\/a>00403         <span class="keywordflow">if<\/span> ((webserver = httpdCreate(config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>, config-&gt;<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>)) == NULL) {$/;"	a
l00404	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00404"><\/a>00404                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not create web server: %s"<\/span>, strerror(errno));$/;"	a
l00405	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00405"><\/a>00405                 exit(1);$/;"	a
l00406	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00406"><\/a>00406         }$/;"	a
l00407	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00407"><\/a>00407 $/;"	a
l00408	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00408"><\/a>00408         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Assigning callbacks to web server"<\/span>);$/;"	a
l00409	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00409"><\/a>00409         httpdAddCContent(webserver, <span class="stringliteral">"\/"<\/span>, <span class="stringliteral">"wifidog"<\/span>, 0, NULL, <a class="code" href="http_8c.html#a61e9e265a1529e600dd83ef91cd0d14" title="Callback for libhttpd.">http_callback_wifidog<\/a>);$/;"	a
l00410	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00410"><\/a>00410         httpdAddCContent(webserver, <span class="stringliteral">"\/wifidog"<\/span>, <span class="stringliteral">""<\/span>, 0, NULL, <a class="code" href="http_8c.html#a61e9e265a1529e600dd83ef91cd0d14" title="Callback for libhttpd.">http_callback_wifidog<\/a>);$/;"	a
l00411	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00411"><\/a>00411         httpdAddCContent(webserver, <span class="stringliteral">"\/wifidog"<\/span>, <span class="stringliteral">"about"<\/span>, 0, NULL, <a class="code" href="http_8c.html#f306222145f5e2699ed19e716df0fb35" title="Callback for libhttpd.">http_callback_about<\/a>);$/;"	a
l00412	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00412"><\/a>00412         httpdAddCContent(webserver, <span class="stringliteral">"\/wifidog"<\/span>, <span class="stringliteral">"status"<\/span>, 0, NULL, <a class="code" href="http_8c.html#676d4eaab18f4187387db5c1236b55b8" title="Callback for libhttpd.">http_callback_status<\/a>);$/;"	a
l00413	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00413"><\/a>00413         httpdAddCContent(webserver, <span class="stringliteral">"\/wifidog"<\/span>, <span class="stringliteral">"auth"<\/span>, 0, NULL, <a class="code" href="http_8c.html#f5d4744903ff7f32bd96a8cb85af299e" title="Callback for libhttpd, main entry point post login for auth confirmation.">http_callback_auth<\/a>);$/;"	a
l00414	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00414"><\/a>00414 $/;"	a
l00415	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00415"><\/a>00415         httpdAddC404Content(webserver, <a class="code" href="http_8c.html#7164c2c972bb0668cf8a7ac5c5f2a0a6" title="Callback for libhttpd, main entry point for captive portal.">http_callback_404<\/a>);$/;"	a
l00416	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00416"><\/a>00416 $/;"	a
l00417	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00417"><\/a>00417         <span class="comment">\/* Reset the firewall (if WiFiDog crashed) *\/<\/span>$/;"	a
l00418	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00418"><\/a>00418         fw_destroy();$/;"	a
l00419	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00419"><\/a>00419         <span class="comment">\/* Then initialize it *\/<\/span>$/;"	a
l00420	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00420"><\/a>00420         <span class="keywordflow">if<\/span> (!fw_init()) {$/;"	a
l00421	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00421"><\/a>00421                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to initialize firewall"<\/span>);$/;"	a
l00422	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00422"><\/a>00422                 exit(1);$/;"	a
l00423	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00423"><\/a>00423         }$/;"	a
l00424	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00424"><\/a>00424 $/;"	a
l00425	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00425"><\/a>00425         <span class="comment">\/* Start clean up thread *\/<\/span>$/;"	a
l00426	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00426"><\/a>00426         result = pthread_create(&amp;tid_fw_counter, NULL, (<span class="keywordtype">void<\/span> *)<a class="code" href="auth_8c.html#0d343be361ec134828fe457a4d4b94e7" title="Periodically check if connections expired.">thread_client_timeout_check<\/a>, NULL);$/;"	a
l00427	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00427"><\/a>00427         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00428	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00428"><\/a>00428             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (fw_counter) - exiting"<\/span>);$/;"	a
l00429	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00429"><\/a>00429             termination_handler(0);$/;"	a
l00430	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00430"><\/a>00430         }$/;"	a
l00431	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00431"><\/a>00431         pthread_detach(tid_fw_counter);$/;"	a
l00432	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00432"><\/a>00432 $/;"	a
l00433	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00433"><\/a>00433         <span class="comment">\/* Start control thread *\/<\/span>$/;"	a
l00434	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00434"><\/a>00434         result = pthread_create(&amp;tid, NULL, (<span class="keywordtype">void<\/span> *)<a class="code" href="wdctl__thread_8c.html#620bac3ec925a104631e817432f8a04e" title="Listen for WiFiDog control messages on a unix domain socket.">thread_wdctl<\/a>, (<span class="keywordtype">void<\/span> *)safe_strdup(config-&gt;<a class="code" href="structs__config.html#2d5969c6676bbefa37c435bfe018a15d" title="wdctl path to socket">wdctl_sock<\/a>));$/;"	a
l00435	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00435"><\/a>00435         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00436	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00436"><\/a>00436                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (wdctl) - exiting"<\/span>);$/;"	a
l00437	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00437"><\/a>00437                 termination_handler(0);$/;"	a
l00438	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00438"><\/a>00438         }$/;"	a
l00439	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00439"><\/a>00439         pthread_detach(tid);$/;"	a
l00440	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00440"><\/a>00440         $/;"	a
l00441	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00441"><\/a>00441         <span class="comment">\/* Start heartbeat thread *\/<\/span>$/;"	a
l00442	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00442"><\/a>00442         result = pthread_create(&amp;tid_ping, NULL, (<span class="keywordtype">void<\/span> *)<a class="code" href="ping__thread_8c.html#3b019c5b71e02b8f475285a22222b296" title="Periodically checks on the auth server to see if it&amp;#39;s alive.">thread_ping<\/a>, NULL);$/;"	a
l00443	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00443"><\/a>00443         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00444	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00444"><\/a>00444             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (ping) - exiting"<\/span>);$/;"	a
l00445	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00445"><\/a>00445                 termination_handler(0);$/;"	a
l00446	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00446"><\/a>00446         }$/;"	a
l00447	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00447"><\/a>00447         pthread_detach(tid_ping);$/;"	a
l00448	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00448"><\/a>00448         $/;"	a
l00449	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00449"><\/a>00449         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Waiting for connections"<\/span>);$/;"	a
l00450	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00450"><\/a>00450         <span class="keywordflow">while<\/span>(1) {$/;"	a
l00451	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00451"><\/a>00451                 r = httpdGetConnection(webserver, NULL);$/;"	a
l00452	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00452"><\/a>00452 $/;"	a
l00453	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00453"><\/a>00453                 <span class="comment">\/* We can't convert this to a switch because there might be<\/span>$/;"	a
l00454	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00454"><\/a>00454 <span class="comment">                 * values that are not -1, 0 or 1. *\/<\/span>$/;"	a
l00455	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00455"><\/a>00455                 <span class="keywordflow">if<\/span> (webserver-&gt;lastError == -1) {$/;"	a
l00456	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00456"><\/a>00456                         <span class="comment">\/* Interrupted system call *\/<\/span>$/;"	a
l00457	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00457"><\/a>00457                         <span class="keywordflow">continue<\/span>; <span class="comment">\/* restart loop *\/<\/span>$/;"	a
l00458	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00458"><\/a>00458                 }$/;"	a
l00459	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00459"><\/a>00459                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (webserver-&gt;lastError &lt; -1) {$/;"	a
l00460	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00460"><\/a>00460                         <span class="comment">\/*<\/span>$/;"	a
l00461	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00461"><\/a>00461 <span class="comment">                         * FIXME<\/span>$/;"	a
l00462	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00462"><\/a>00462 <span class="comment">                         * An error occurred - should we abort?<\/span>$/;"	a
l00463	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00463"><\/a>00463 <span class="comment">                         * reboot the device ?<\/span>$/;"	a
l00464	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00464"><\/a>00464 <span class="comment">                         *\/<\/span>$/;"	a
l00465	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00465"><\/a>00465                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: httpdGetConnection returned unexpected value %d, exiting."<\/span>, webserver-&gt;lastError);$/;"	a
l00466	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00466"><\/a>00466                         termination_handler(0);$/;"	a
l00467	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00467"><\/a>00467                 }$/;"	a
l00468	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00468"><\/a>00468                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (r != NULL) {$/;"	a
l00469	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00469"><\/a>00469                         <span class="comment">\/*<\/span>$/;"	a
l00470	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00470"><\/a>00470 <span class="comment">                         * We got a connection<\/span>$/;"	a
l00471	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00471"><\/a>00471 <span class="comment">                         *<\/span>$/;"	a
l00472	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00472"><\/a>00472 <span class="comment">                         * We should create another thread<\/span>$/;"	a
l00473	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00473"><\/a>00473 <span class="comment">                         *\/<\/span>$/;"	a
l00474	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00474"><\/a>00474                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Received connection from %s, spawning worker thread"<\/span>, r-&gt;clientAddr);$/;"	a
l00475	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00475"><\/a>00475                         <span class="comment">\/* The void**'s are a simulation of the normal C<\/span>$/;"	a
l00476	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00476"><\/a>00476 <span class="comment">                         * function calling sequence. *\/<\/span>$/;"	a
l00477	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00477"><\/a>00477                         params = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(2 * <span class="keyword">sizeof<\/span>(<span class="keywordtype">void<\/span> *));$/;"	a
l00478	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00478"><\/a>00478                         *params = webserver;$/;"	a
l00479	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00479"><\/a>00479                         *(params + 1) = r;$/;"	a
l00480	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00480"><\/a>00480 $/;"	a
l00481	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00481"><\/a>00481                         result = pthread_create(&amp;tid, NULL, (<span class="keywordtype">void<\/span> *)<a class="code" href="httpd__thread_8c.html#2925feb4c55460a80bd30f6ef363779d" title="Handle a web request.">thread_httpd<\/a>, (<span class="keywordtype">void<\/span> *)params);$/;"	a
l00482	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00482"><\/a>00482                         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00483	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00483"><\/a>00483                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (httpd) - exiting"<\/span>);$/;"	a
l00484	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00484"><\/a>00484                                 termination_handler(0);$/;"	a
l00485	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00485"><\/a>00485                         }$/;"	a
l00486	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00486"><\/a>00486                         pthread_detach(tid);$/;"	a
l00487	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00487"><\/a>00487                 }$/;"	a
l00488	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00488"><\/a>00488                 <span class="keywordflow">else<\/span> {$/;"	a
l00489	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00489"><\/a>00489                         <span class="comment">\/* webserver-&gt;lastError should be 2 *\/<\/span>$/;"	a
l00490	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00490"><\/a>00490                         <span class="comment">\/* XXX We failed an ACL.... No handling because<\/span>$/;"	a
l00491	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00491"><\/a>00491 <span class="comment">                         * we don't set any... *\/<\/span>$/;"	a
l00492	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00492"><\/a>00492                 }$/;"	a
l00493	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00493"><\/a>00493         }$/;"	a
l00494	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00494"><\/a>00494 $/;"	a
l00495	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00495"><\/a>00495         <span class="comment">\/* never reached *\/<\/span>$/;"	a
l00496	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00496"><\/a>00496 }$/;"	a
l00497	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00497"><\/a>00497 $/;"	a
l00499	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00499"><\/a>00499 <span class="keywordtype">int<\/span> main(<span class="keywordtype">int<\/span> argc, <span class="keywordtype">char<\/span> **argv) {$/;"	a
l00500	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00500"><\/a>00500 $/;"	a
l00501	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00501"><\/a>00501         <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00502	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00502"><\/a>00502         <a class="code" href="conf_8c.html#068a358868c409bbd99d7eef3c988866" title="Initialise the conf system.">config_init<\/a>();$/;"	a
l00503	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00503"><\/a>00503 $/;"	a
l00504	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00504"><\/a>00504         <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(argc, argv);$/;"	a
l00505	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00505"><\/a>00505 $/;"	a
l00506	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00506"><\/a>00506         <span class="comment">\/* Initialize the config *\/<\/span>$/;"	a
l00507	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00507"><\/a>00507         <a class="code" href="conf_8c.html#d3faac0efa0ac4c1032c0c54f7e93711" title="Reads the configuration file.">config_read<\/a>(config-&gt;<a class="code" href="structs__config.html#10bef4a1d29228311acf38c9692a5a81" title="name of the config file">configfile<\/a>);$/;"	a
l00508	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00508"><\/a>00508         <a class="code" href="conf_8c.html#0f9540b3f729ba3b3d31b613d3eca364" title="Check that the configuration is valid.">config_validate<\/a>();$/;"	a
l00509	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00509"><\/a>00509 $/;"	a
l00510	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00510"><\/a>00510         <span class="comment">\/* Initializes the linked list of connected clients *\/<\/span>$/;"	a
l00511	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00511"><\/a>00511         <a class="code" href="client__list_8c.html#d624b5c33e086131f3af7b52589f5fd1" title="Initializes the client list.">client_list_init<\/a>();$/;"	a
l00512	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00512"><\/a>00512 $/;"	a
l00513	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00513"><\/a>00513         <span class="comment">\/* Init the signals to catch chld\/quit\/etc *\/<\/span>$/;"	a
l00514	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00514"><\/a>00514         init_signals();$/;"	a
l00515	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00515"><\/a>00515 $/;"	a
l00516	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00516"><\/a>00516         <span class="keywordflow">if<\/span> (restart_orig_pid) {$/;"	a
l00517	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00517"><\/a>00517                 <span class="comment">\/*<\/span>$/;"	a
l00518	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00518"><\/a>00518 <span class="comment">                 * We were restarted and our parent is waiting for us to talk to it over the socket<\/span>$/;"	a
l00519	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00519"><\/a>00519 <span class="comment">                 *\/<\/span>$/;"	a
l00520	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00520"><\/a>00520                 get_clients_from_parent();$/;"	a
l00521	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00521"><\/a>00521 $/;"	a
l00522	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00522"><\/a>00522                 <span class="comment">\/*<\/span>$/;"	a
l00523	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00523"><\/a>00523 <span class="comment">                 * At this point the parent will start destroying itself and the firewall. Let it finish it's job before we continue<\/span>$/;"	a
l00524	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00524"><\/a>00524 <span class="comment">                 *\/<\/span>$/;"	a
l00525	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00525"><\/a>00525                 <span class="keywordflow">while<\/span> (kill(restart_orig_pid, 0) != -1) {$/;"	a
l00526	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00526"><\/a>00526                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Waiting for parent PID %d to die before continuing loading"<\/span>, restart_orig_pid);$/;"	a
l00527	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00527"><\/a>00527                         sleep(1);$/;"	a
l00528	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00528"><\/a>00528                 }$/;"	a
l00529	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00529"><\/a>00529 $/;"	a
l00530	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00530"><\/a>00530                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Parent PID %d seems to be dead. Continuing loading."<\/span>);$/;"	a
l00531	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00531"><\/a>00531         }$/;"	a
l00532	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00532"><\/a>00532 $/;"	a
l00533	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00533"><\/a>00533         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#e53582fbd0f3930cb34130a0f6d98389" title="if daemon &amp;gt; 0, use daemon mode">daemon<\/a>) {$/;"	a
l00534	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00534"><\/a>00534 $/;"	a
l00535	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00535"><\/a>00535                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Forking into background"<\/span>);$/;"	a
l00536	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00536"><\/a>00536 $/;"	a
l00537	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00537"><\/a>00537                 <span class="keywordflow">switch<\/span>(safe_fork()) {$/;"	a
l00538	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00538"><\/a>00538                         <span class="keywordflow">case<\/span> 0: <span class="comment">\/* child *\/<\/span>$/;"	a
l00539	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00539"><\/a>00539                                 setsid();$/;"	a
l00540	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00540"><\/a>00540                                 append_x_restartargv();$/;"	a
l00541	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00541"><\/a>00541                                 main_loop();$/;"	a
l00542	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00542"><\/a>00542                                 <span class="keywordflow">break<\/span>;$/;"	a
l00543	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00543"><\/a>00543 $/;"	a
l00544	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00544"><\/a>00544                         <span class="keywordflow">default<\/span>: <span class="comment">\/* parent *\/<\/span>$/;"	a
l00545	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00545"><\/a>00545                                 exit(0);$/;"	a
l00546	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00546"><\/a>00546                                 <span class="keywordflow">break<\/span>;$/;"	a
l00547	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00547"><\/a>00547                 }$/;"	a
l00548	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00548"><\/a>00548         }$/;"	a
l00549	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00549"><\/a>00549         <span class="keywordflow">else<\/span> {$/;"	a
l00550	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00550"><\/a>00550                 append_x_restartargv();$/;"	a
l00551	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00551"><\/a>00551                 main_loop();$/;"	a
l00552	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00552"><\/a>00552         }$/;"	a
l00553	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00553"><\/a>00553 $/;"	a
l00554	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00554"><\/a>00554         <span class="keywordflow">return<\/span>(0); <span class="comment">\/* never reached *\/<\/span>$/;"	a
l00555	install/share/doc/wifidog-20090925/html/gateway_8c-source.html	/^<a name="l00555"><\/a>00555 }$/;"	a
l00001	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<h1>gateway.h<\/h1><a href="gateway_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: gateway.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _GATEWAY_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _GATEWAY_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span> $/;"	a
l00031	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="keywordtype">void<\/span> termination_handler(<span class="keywordtype">int<\/span> s);$/;"	a
l00032	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00032"><\/a>00032 $/;"	a
l00033	install/share/doc/wifidog-20090925/html/gateway_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#endif <\/span><span class="comment">\/* _GATEWAY_H_ *\/<\/span>$/;"	a
_details	install/share/doc/wifidog-20090925/html/gateway_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
d850f6ceb76de4be944cdedca2420db5	install/share/doc/wifidog-20090925/html/gateway_8h.html	/^<a class="anchor" name="d850f6ceb76de4be944cdedca2420db5"><\/a><!-- doxytag: member="gateway.h::termination_handler" ref="d850f6ceb76de4be944cdedca2420db5" args="(int s)" -->$/;"	a
index__	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index__">- _ -<\/a><\/h3><ul>$/;"	a
index_a	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_a">- a -<\/a><\/h3><ul>$/;"	a
index_c	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_c">- c -<\/a><\/h3><ul>$/;"	a
index_d	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_d">- d -<\/a><\/h3><ul>$/;"	a
index_e	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_f	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_f">- f -<\/a><\/h3><ul>$/;"	a
index_g	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_h	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_h">- h -<\/a><\/h3><ul>$/;"	a
index_i	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_i">- i -<\/a><\/h3><ul>$/;"	a
index_m	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_n	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_n">- n -<\/a><\/h3><ul>$/;"	a
index_p	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_p">- p -<\/a><\/h3><ul>$/;"	a
index_r	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_s	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_s">- s -<\/a><\/h3><ul>$/;"	a
index_t	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index_w	install/share/doc/wifidog-20090925/html/globals.html	/^<h3><a class="anchor" name="index_w">- w -<\/a><\/h3><ul>$/;"	a
index_d	install/share/doc/wifidog-20090925/html/globals_defs.html	/^<h3><a class="anchor" name="index_d">- d -<\/a><\/h3><ul>$/;"	a
index_e	install/share/doc/wifidog-20090925/html/globals_defs.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_g	install/share/doc/wifidog-20090925/html/globals_defs.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_m	install/share/doc/wifidog-20090925/html/globals_defs.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_n	install/share/doc/wifidog-20090925/html/globals_defs.html	/^<h3><a class="anchor" name="index_n">- n -<\/a><\/h3><ul>$/;"	a
index_r	install/share/doc/wifidog-20090925/html/globals_defs.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_t	install/share/doc/wifidog-20090925/html/globals_defs.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index__	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index__">- _ -<\/a><\/h3><ul>$/;"	a
index_a	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_a">- a -<\/a><\/h3><ul>$/;"	a
index_c	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_c">- c -<\/a><\/h3><ul>$/;"	a
index_e	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_e">- e -<\/a><\/h3><ul>$/;"	a
index_f	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_f">- f -<\/a><\/h3><ul>$/;"	a
index_g	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_g">- g -<\/a><\/h3><ul>$/;"	a
index_h	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_h">- h -<\/a><\/h3><ul>$/;"	a
index_i	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_i">- i -<\/a><\/h3><ul>$/;"	a
index_m	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_m">- m -<\/a><\/h3><ul>$/;"	a
index_p	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_p">- p -<\/a><\/h3><ul>$/;"	a
index_r	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_r">- r -<\/a><\/h3><ul>$/;"	a
index_s	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_s">- s -<\/a><\/h3><ul>$/;"	a
index_t	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_t">- t -<\/a><\/h3><ul>$/;"	a
index_w	install/share/doc/wifidog-20090925/html/globals_func.html	/^<h3><a class="anchor" name="index_w">- w -<\/a><\/h3><ul>$/;"	a
l00001	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<h1>http.c<\/h1><a href="http_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: http.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor"><\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;sys\/stat.h&gt;<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;fcntl.h&gt;<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00044"><\/a>00044 $/;"	a
l00045	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "<a class="code" href="http_8h.html" title="HTTP IO functions.">http.h<\/a>"<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00053	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00054	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00055	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00055"><\/a>00055 $/;"	a
l00056	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00057	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00057"><\/a>00057 $/;"	a
l00058	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00059	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00060	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="keyword">extern<\/span> pthread_mutex_t  <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00061	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00061"><\/a>00061 $/;"	a
l00063	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="keywordtype">void<\/span>$/;"	a
l00064	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00064"><\/a><a class="code" href="http_8h.html#7164c2c972bb0668cf8a7ac5c5f2a0a6">00064<\/a> <a class="code" href="http_8c.html#7164c2c972bb0668cf8a7ac5c5f2a0a6" title="Callback for libhttpd, main entry point for captive portal.">http_callback_404<\/a>(httpd *webserver, request *r)$/;"	a
l00065	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00065"><\/a>00065 {$/;"	a
l00066	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00066"><\/a>00066         <span class="keywordtype">char<\/span>            tmp_url[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>],$/;"	a
l00067	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00067"><\/a>00067                         *url;$/;"	a
l00068	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00068"><\/a>00068         <a class="code" href="structs__config.html">s_config<\/a>        *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00069	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00069"><\/a>00069         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00070	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00070"><\/a>00070 $/;"	a
l00071	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00071"><\/a>00071         memset(tmp_url, 0, <span class="keyword">sizeof<\/span>(tmp_url));$/;"	a
l00072	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00072"><\/a>00072         <span class="comment">\/* <\/span>$/;"	a
l00073	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00073"><\/a>00073 <span class="comment">         * XXX Note the code below assumes that the client's request is a plain<\/span>$/;"	a
l00074	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00074"><\/a>00074 <span class="comment">         * http request to a standard port. At any rate, this handler is called only<\/span>$/;"	a
l00075	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00075"><\/a>00075 <span class="comment">         * if the internet\/auth server is down so it's not a huge loss, but still.<\/span>$/;"	a
l00076	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00076"><\/a>00076 <span class="comment">         *\/<\/span>$/;"	a
l00077	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00077"><\/a>00077         snprintf(tmp_url, (<span class="keyword">sizeof<\/span>(tmp_url) - 1), <span class="stringliteral">"http:\/\/%s%s%s%s"<\/span>,$/;"	a
l00078	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00078"><\/a>00078                         r-&gt;request.host,$/;"	a
l00079	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00079"><\/a>00079                         r-&gt;request.path,$/;"	a
l00080	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00080"><\/a>00080                         r-&gt;request.query[0] ? <span class="stringliteral">"?"<\/span> : <span class="stringliteral">""<\/span>,$/;"	a
l00081	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00081"><\/a>00081                         r-&gt;request.query);$/;"	a
l00082	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00082"><\/a>00082         url = httpdUrlEncode(tmp_url);$/;"	a
l00083	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00084"><\/a>00084         <span class="keywordflow">if<\/span> (!is_online()) {$/;"	a
l00085	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00085"><\/a>00085                 <span class="comment">\/* The internet connection is down at the moment  - apologize and do not redirect anywhere *\/<\/span>$/;"	a
l00086	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00086"><\/a>00086                 <span class="keywordtype">char<\/span> * buf;$/;"	a
l00087	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00087"><\/a>00087                 safe_asprintf(&amp;buf, $/;"	a
l00088	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00088"><\/a>00088                         <span class="stringliteral">"&lt;p&gt;We apologize, but it seems that the internet connection that powers this hotspot is temporarily unavailable.&lt;\/p&gt;"<\/span>$/;"	a
l00089	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00089"><\/a>00089                         <span class="stringliteral">"&lt;p&gt;If at all possible, please notify the owners of this hotspot that the internet connection is out of service.&lt;\/p&gt;"<\/span>$/;"	a
l00090	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00090"><\/a>00090                         <span class="stringliteral">"&lt;p&gt;The maintainers of this network are aware of this disruption.  We hope that this situation will be resolved soon.&lt;\/p&gt;"<\/span>$/;"	a
l00091	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00091"><\/a>00091                         <span class="stringliteral">"&lt;p&gt;In a while please &lt;a href='%s'&gt;click here&lt;\/a&gt; to try your request again.&lt;\/p&gt;"<\/span>, tmp_url);$/;"	a
l00092	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00092"><\/a>00092 $/;"	a
l00093	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00093"><\/a>00093                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"Uh oh! Internet access unavailable!"<\/span>, buf);$/;"	a
l00094	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00094"><\/a>00094                 free(buf);$/;"	a
l00095	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00095"><\/a>00095                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Sent %s an apology since I am not online - no point sending them to auth server"<\/span>, r-&gt;clientAddr);$/;"	a
l00096	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00096"><\/a>00096         }$/;"	a
l00097	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00097"><\/a>00097         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (!is_auth_online()) {$/;"	a
l00098	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00098"><\/a>00098                 <span class="comment">\/* The auth server is down at the moment - apologize and do not redirect anywhere *\/<\/span>$/;"	a
l00099	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00099"><\/a>00099                 <span class="keywordtype">char<\/span> * buf;$/;"	a
l00100	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00100"><\/a>00100                 safe_asprintf(&amp;buf, $/;"	a
l00101	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00101"><\/a>00101                         <span class="stringliteral">"&lt;p&gt;We apologize, but it seems that we are currently unable to re-direct you to the login screen.&lt;\/p&gt;"<\/span>$/;"	a
l00102	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00102"><\/a>00102                         <span class="stringliteral">"&lt;p&gt;The maintainers of this network are aware of this disruption.  We hope that this situation will be resolved soon.&lt;\/p&gt;"<\/span>$/;"	a
l00103	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00103"><\/a>00103                         <span class="stringliteral">"&lt;p&gt;In a couple of minutes please &lt;a href='%s'&gt;click here&lt;\/a&gt; to try your request again.&lt;\/p&gt;"<\/span>, tmp_url);$/;"	a
l00104	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00104"><\/a>00104 $/;"	a
l00105	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00105"><\/a>00105                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"Uh oh! Login screen unavailable!"<\/span>, buf);$/;"	a
l00106	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00106"><\/a>00106                 free(buf);$/;"	a
l00107	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00107"><\/a>00107                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Sent %s an apology since auth server not online - no point sending them to auth server"<\/span>, r-&gt;clientAddr);$/;"	a
l00108	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00108"><\/a>00108         }$/;"	a
l00109	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00109"><\/a>00109         <span class="keywordflow">else<\/span> {$/;"	a
l00110	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00110"><\/a>00110                 <span class="comment">\/* Re-direct them to auth server *\/<\/span>$/;"	a
l00111	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00111"><\/a>00111                 <span class="keywordtype">char<\/span> *urlFragment;$/;"	a
l00112	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00112"><\/a>00112                 safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%sgw_address=%s&amp;gw_port=%d&amp;gw_id=%s&amp;url=%s"<\/span>,$/;"	a
l00113	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00113"><\/a>00113                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#0752c3da9e2be08ca6d19449fa4cf425" title="This is the script the user will be sent to for login.">authserv_login_script_path_fragment<\/a>,$/;"	a
l00114	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00114"><\/a>00114                         config-&gt;<a class="code" href="structs__config.html#a9067918ad171a070ccd631887fe2da0" title="Internal IP address for our web server.">gw_address<\/a>,$/;"	a
l00115	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00115"><\/a>00115                         config-&gt;<a class="code" href="structs__config.html#16d75212a8b3ca23cadd6c5e5aa61189" title="Port the webserver will run on.">gw_port<\/a>, $/;"	a
l00116	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00116"><\/a>00116                         config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>,$/;"	a
l00117	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00117"><\/a>00117                         url);$/;"	a
l00118	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00118"><\/a>00118                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Captured %s requesting [%s] and re-directing them to login page"<\/span>, r-&gt;clientAddr, url);$/;"	a
l00119	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00119"><\/a>00119                 <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to login page"<\/span>);$/;"	a
l00120	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00120"><\/a>00120                 free(urlFragment);$/;"	a
l00121	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00121"><\/a>00121         }$/;"	a
l00122	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00122"><\/a>00122         free(url);$/;"	a
l00123	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00123"><\/a>00123 }$/;"	a
l00124	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00124"><\/a>00124 $/;"	a
l00125	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00125"><\/a>00125 <span class="keywordtype">void<\/span> $/;"	a
l00126	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00126"><\/a><a class="code" href="http_8h.html#a61e9e265a1529e600dd83ef91cd0d14">00126<\/a> <a class="code" href="http_8c.html#a61e9e265a1529e600dd83ef91cd0d14" title="Callback for libhttpd.">http_callback_wifidog<\/a>(httpd *webserver, request *r)$/;"	a
l00127	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00127"><\/a>00127 {$/;"	a
l00128	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00128"><\/a>00128         <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"WiFiDog"<\/span>, <span class="stringliteral">"Please use the menu to navigate the features of this WiFiDog installation."<\/span>);$/;"	a
l00129	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00129"><\/a>00129 }$/;"	a
l00130	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00130"><\/a>00130 $/;"	a
l00131	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00131"><\/a>00131 <span class="keywordtype">void<\/span> $/;"	a
l00132	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00132"><\/a><a class="code" href="http_8h.html#f306222145f5e2699ed19e716df0fb35">00132<\/a> <a class="code" href="http_8c.html#f306222145f5e2699ed19e716df0fb35" title="Callback for libhttpd.">http_callback_about<\/a>(httpd *webserver, request *r)$/;"	a
l00133	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00133"><\/a>00133 {$/;"	a
l00134	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00134"><\/a>00134         <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"About WiFiDog"<\/span>, <span class="stringliteral">"This is WiFiDog version &lt;strong&gt;"<\/span> VERSION <span class="stringliteral">"&lt;\/strong&gt;"<\/span>);$/;"	a
l00135	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00135"><\/a>00135 }$/;"	a
l00136	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00136"><\/a>00136 $/;"	a
l00137	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00137"><\/a>00137 <span class="keywordtype">void<\/span> $/;"	a
l00138	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00138"><\/a><a class="code" href="http_8h.html#676d4eaab18f4187387db5c1236b55b8">00138<\/a> <a class="code" href="http_8c.html#676d4eaab18f4187387db5c1236b55b8" title="Callback for libhttpd.">http_callback_status<\/a>(httpd *webserver, request *r)$/;"	a
l00139	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00139"><\/a>00139 {$/;"	a
l00140	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00140"><\/a>00140         <span class="keyword">const<\/span> <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00141	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00141"><\/a>00141         <span class="keywordtype">char<\/span> * status = NULL;$/;"	a
l00142	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00142"><\/a>00142         <span class="keywordtype">char<\/span> *buf;$/;"	a
l00143	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00143"><\/a>00143 $/;"	a
l00144	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00144"><\/a>00144         <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a> &amp;&amp; $/;"	a
l00145	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00145"><\/a>00145                         (strcmp(config-&gt;<a class="code" href="structs__config.html#116c013bc650d44eb25f9e3521b0f88d" title="Username for HTTP authentication.">httpdusername<\/a>, r-&gt;request.authUser) ||$/;"	a
l00146	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00146"><\/a>00146                          strcmp(config-&gt;<a class="code" href="structs__config.html#e78aa9497032c5a27194633fcad862a5" title="Password for HTTP authentication.">httpdpassword<\/a>, r-&gt;request.authPassword))) {$/;"	a
l00147	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00147"><\/a>00147                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Status page requested, forcing authentication"<\/span>);$/;"	a
l00148	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00148"><\/a>00148                 httpdForceAuthenticate(r, config-&gt;<a class="code" href="structs__config.html#283515007953f307a7b599ee480b743d" title="HTTP Authentication realm.">httpdrealm<\/a>);$/;"	a
l00149	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00149"><\/a>00149                 <span class="keywordflow">return<\/span>;$/;"	a
l00150	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00150"><\/a>00150         }$/;"	a
l00151	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00151"><\/a>00151 $/;"	a
l00152	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00152"><\/a>00152         status = get_status_text();$/;"	a
l00153	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00153"><\/a>00153         safe_asprintf(&amp;buf, <span class="stringliteral">"&lt;pre&gt;%s&lt;\/pre&gt;"<\/span>, status);$/;"	a
l00154	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00154"><\/a>00154         <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"WiFiDog Status"<\/span>, buf);$/;"	a
l00155	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00155"><\/a>00155         free(buf);$/;"	a
l00156	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00156"><\/a>00156         free(status);$/;"	a
l00157	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00157"><\/a>00157 }$/;"	a
l00162	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00162"><\/a><a class="code" href="http_8h.html#e31633b9629ec33c9006d0d29ad9ba83">00162<\/a> <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(request *r, <span class="keywordtype">char<\/span> *urlFragment, <span class="keywordtype">char<\/span> *text)$/;"	a
l00163	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00163"><\/a>00163 {$/;"	a
l00164	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00164"><\/a>00164         <span class="keywordtype">char<\/span> *protocol = NULL;$/;"	a
l00165	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00165"><\/a>00165         <span class="keywordtype">int<\/span> port = 80;$/;"	a
l00166	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00166"><\/a>00166         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00167	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00167"><\/a>00167 $/;"	a
l00168	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00168"><\/a>00168         <span class="keywordflow">if<\/span> (auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#87bde1ef8a18890d18858a360d276098" title="Use SSL or not.">authserv_use_ssl<\/a>) {$/;"	a
l00169	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00169"><\/a>00169                 protocol = <span class="stringliteral">"https"<\/span>;$/;"	a
l00170	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00170"><\/a>00170                 port = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#f4d82be7a680c24437a91ed1467f8921" title="Https port the central server listens on.">authserv_ssl_port<\/a>;$/;"	a
l00171	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00171"><\/a>00171         } <span class="keywordflow">else<\/span> {$/;"	a
l00172	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00172"><\/a>00172                 protocol = <span class="stringliteral">"http"<\/span>;$/;"	a
l00173	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00173"><\/a>00173                 port = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7f1ad17f9e62f68144ff1981def918fb" title="Http port the central server listens on.">authserv_http_port<\/a>;$/;"	a
l00174	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00174"><\/a>00174         }$/;"	a
l00175	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00175"><\/a>00175                                         $/;"	a
l00176	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00176"><\/a>00176         <span class="keywordtype">char<\/span> *url = NULL;$/;"	a
l00177	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00177"><\/a>00177         safe_asprintf(&amp;url, <span class="stringliteral">"%s:\/\/%s:%d%s%s"<\/span>,$/;"	a
l00178	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00178"><\/a>00178                 protocol,$/;"	a
l00179	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00179"><\/a>00179                 auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>,$/;"	a
l00180	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00180"><\/a>00180                 port,$/;"	a
l00181	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00181"><\/a>00181                 auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#ff64f568944bbf0b01bb379b17ae2161" title="Path where wifidog resides.">authserv_path<\/a>,$/;"	a
l00182	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00182"><\/a>00182                 urlFragment$/;"	a
l00183	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00183"><\/a>00183         );$/;"	a
l00184	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00184"><\/a>00184         <a class="code" href="http_8c.html#bbf6eaf48119c43e4d37a8d7b3f16f11" title="Sends a redirect to the web browser.">http_send_redirect<\/a>(r, url, text);$/;"	a
l00185	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00185"><\/a>00185         free(url);      $/;"	a
l00186	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00186"><\/a>00186 }$/;"	a
l00187	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00187"><\/a>00187 $/;"	a
l00192	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00192"><\/a><a class="code" href="http_8h.html#bbf6eaf48119c43e4d37a8d7b3f16f11">00192<\/a> <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#bbf6eaf48119c43e4d37a8d7b3f16f11" title="Sends a redirect to the web browser.">http_send_redirect<\/a>(request *r, <span class="keywordtype">char<\/span> *url, <span class="keywordtype">char<\/span> *text)$/;"	a
l00193	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00193"><\/a>00193 {$/;"	a
l00194	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00194"><\/a>00194                 <span class="keywordtype">char<\/span> *message = NULL;$/;"	a
l00195	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00195"><\/a>00195                 <span class="keywordtype">char<\/span> *header = NULL;$/;"	a
l00196	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00196"><\/a>00196                 <span class="keywordtype">char<\/span> *response = NULL;$/;"	a
l00197	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00197"><\/a>00197                                                         <span class="comment">\/* Re-direct them to auth server *\/<\/span>$/;"	a
l00198	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00198"><\/a>00198                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Redirecting client browser to %s"<\/span>, url);$/;"	a
l00199	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00199"><\/a>00199                 safe_asprintf(&amp;header, <span class="stringliteral">"Location: %s"<\/span>,$/;"	a
l00200	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00200"><\/a>00200                         url$/;"	a
l00201	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00201"><\/a>00201                 );$/;"	a
l00202	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00202"><\/a>00202                 <span class="keywordflow">if<\/span>(text) {$/;"	a
l00203	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00203"><\/a>00203                         safe_asprintf(&amp;response, <span class="stringliteral">"307 %s\\n"<\/span>,$/;"	a
l00204	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00204"><\/a>00204                                 text$/;"	a
l00205	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00205"><\/a>00205                         );      $/;"	a
l00206	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00206"><\/a>00206                 }$/;"	a
l00207	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00207"><\/a>00207                 <span class="keywordflow">else<\/span> {$/;"	a
l00208	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00208"><\/a>00208                         safe_asprintf(&amp;response, <span class="stringliteral">"307 %s\\n"<\/span>,$/;"	a
l00209	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00209"><\/a>00209                                 <span class="stringliteral">"Redirecting"<\/span>$/;"	a
l00210	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00210"><\/a>00210                         );              $/;"	a
l00211	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00211"><\/a>00211                 }       $/;"	a
l00212	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00212"><\/a>00212                 httpdSetResponse(r, response);$/;"	a
l00213	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00213"><\/a>00213                 httpdAddHeader(r, header);$/;"	a
l00214	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00214"><\/a>00214                 free(response);$/;"	a
l00215	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00215"><\/a>00215                 free(header);   $/;"	a
l00216	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00216"><\/a>00216                 safe_asprintf(&amp;message, <span class="stringliteral">"Please &lt;a href='%s'&gt;click here&lt;\/a&gt;."<\/span>, url);$/;"	a
l00217	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00217"><\/a>00217                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, text ? text : <span class="stringliteral">"Redirection to message"<\/span>, message);$/;"	a
l00218	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00218"><\/a>00218                 free(message);$/;"	a
l00219	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00219"><\/a>00219 }$/;"	a
l00220	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00220"><\/a>00220 $/;"	a
l00221	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00221"><\/a>00221 <span class="keywordtype">void<\/span> $/;"	a
l00222	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00222"><\/a><a class="code" href="http_8h.html#f5d4744903ff7f32bd96a8cb85af299e">00222<\/a> <a class="code" href="http_8c.html#f5d4744903ff7f32bd96a8cb85af299e" title="Callback for libhttpd, main entry point post login for auth confirmation.">http_callback_auth<\/a>(httpd *webserver, request *r)$/;"	a
l00223	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00223"><\/a>00223 {$/;"	a
l00224	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00224"><\/a>00224         <a class="code" href="struct__t__client.html">t_client<\/a>        *client;$/;"	a
l00225	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00225"><\/a>00225         httpVar * token;$/;"	a
l00226	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00226"><\/a>00226         <span class="keywordtype">char<\/span>    *mac;$/;"	a
l00227	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00227"><\/a>00227         httpVar *logout = httpdGetVariableByName(r, <span class="stringliteral">"logout"<\/span>);$/;"	a
l00228	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00228"><\/a>00228         <span class="keywordflow">if<\/span> ((token = httpdGetVariableByName(r, <span class="stringliteral">"token"<\/span>))) {$/;"	a
l00229	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00229"><\/a>00229                 <span class="comment">\/* They supplied variable "token" *\/<\/span>$/;"	a
l00230	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00230"><\/a>00230                 <span class="keywordflow">if<\/span> (!(mac = arp_get(r-&gt;clientAddr))) {$/;"	a
l00231	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00231"><\/a>00231                         <span class="comment">\/* We could not get their MAC address *\/<\/span>$/;"	a
l00232	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00232"><\/a>00232                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Failed to retrieve MAC address for ip %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00233	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00233"><\/a>00233                         <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"WiFiDog Error"<\/span>, <span class="stringliteral">"Failed to retrieve your MAC address"<\/span>);$/;"	a
l00234	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00234"><\/a>00234                 } <span class="keywordflow">else<\/span> {$/;"	a
l00235	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00235"><\/a>00235                         <span class="comment">\/* We have their MAC address *\/<\/span>$/;"	a
l00236	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00236"><\/a>00236 $/;"	a
l00237	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00237"><\/a>00237                         LOCK_CLIENT_LIST();$/;"	a
l00238	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00238"><\/a>00238                         $/;"	a
l00239	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00239"><\/a>00239                         <span class="keywordflow">if<\/span> ((client = <a class="code" href="client__list_8c.html#6ef7c0e44163b7ad9ed0353b095c1bbb" title="Finds a client by its IP and MAC.">client_list_find<\/a>(r-&gt;clientAddr, mac)) == NULL) {$/;"	a
l00240	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00240"><\/a>00240                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"New client for %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00241	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00241"><\/a>00241                                 <a class="code" href="client__list_8c.html#65ad84da2af952d86d9ea8c326951911" title="Adds a new client to the connections list.">client_list_append<\/a>(r-&gt;clientAddr, mac, token-&gt;value);$/;"	a
l00242	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00242"><\/a>00242                         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (logout) {$/;"	a
l00243	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00243"><\/a>00243                             <a class="code" href="struct__t__authresponse.html" title="This structure contains all the information returned by the authentication server...">t_authresponse<\/a>  authresponse;$/;"	a
l00244	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00244"><\/a>00244                             <a class="code" href="structs__config.html">s_config<\/a> *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00245	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00245"><\/a>00245                             <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> incoming = client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>;$/;"	a
l00246	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00246"><\/a>00246                             <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">long<\/span> outgoing = client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>;$/;"	a
l00247	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00247"><\/a>00247                             <span class="keywordtype">char<\/span> *ip = safe_strdup(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00248	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00248"><\/a>00248                             <span class="keywordtype">char<\/span> *urlFragment = NULL;$/;"	a
l00249	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00249"><\/a>00249                             <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00250	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00250"><\/a>00250                                                                 $/;"	a
l00251	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00251"><\/a>00251                             fw_deny(client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00252	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00252"><\/a>00252                             <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(client);$/;"	a
l00253	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00253"><\/a>00253                             <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Got logout from %s"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00254	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00254"><\/a>00254                             $/;"	a
l00255	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00255"><\/a>00255                             <span class="comment">\/* Advertise the logout if we have an auth server *\/<\/span>$/;"	a
l00256	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00256"><\/a>00256                             <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a> != NULL) {$/;"	a
l00257	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00257"><\/a>00257                                         UNLOCK_CLIENT_LIST();$/;"	a
l00258	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00258"><\/a>00258                                         <a class="code" href="centralserver_8c.html#5c562f637bd218d2f397e8b1d9eae656" title="Initiates a transaction with the auth server.">auth_server_request<\/a>(&amp;authresponse, <a class="code" href="centralserver_8h.html#b262747ac931a0a8c357448e7a2cf301" title="Notify the the central server of a client logout.">REQUEST_TYPE_LOGOUT<\/a>, ip, mac, token-&gt;value, $/;"	a
l00259	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00259"><\/a>00259                                                                             incoming, outgoing);$/;"	a
l00260	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00260"><\/a>00260                                         LOCK_CLIENT_LIST();$/;"	a
l00261	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00261"><\/a>00261                                         $/;"	a
l00262	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00262"><\/a>00262                                         <span class="comment">\/* Re-direct them to auth server *\/<\/span>$/;"	a
l00263	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00263"><\/a>00263                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Got manual logout from client ip %s, mac %s, token %s"<\/span>$/;"	a
l00264	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00264"><\/a>00264                                         <span class="stringliteral">"- redirecting them to logout message"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00265	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00265"><\/a>00265                                         safe_asprintf(&amp;urlFragment, <span class="stringliteral">"%smessage=%s"<\/span>,$/;"	a
l00266	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00266"><\/a>00266                                                 auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#88f07a2b3771a88671ca3c4a77790f10" title="This is the script the user will be sent to upon error to read a readable message...">authserv_msg_script_path_fragment<\/a>,$/;"	a
l00267	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00267"><\/a>00267                                                 <a class="code" href="centralserver_8h.html#9aa808dd68665d6af8a050e22bb9e1c4" title="Sent after the user performed a manual log-out on the gateway.">GATEWAY_MESSAGE_ACCOUNT_LOGGED_OUT<\/a>$/;"	a
l00268	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00268"><\/a>00268                                         );$/;"	a
l00269	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00269"><\/a>00269                                         <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(r, urlFragment, <span class="stringliteral">"Redirect to logout message"<\/span>);$/;"	a
l00270	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00270"><\/a>00270                                         free(urlFragment);$/;"	a
l00271	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00271"><\/a>00271                             }$/;"	a
l00272	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00272"><\/a>00272                             free(ip);$/;"	a
l00273	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00273"><\/a>00273                         } $/;"	a
l00274	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00274"><\/a>00274                         <span class="keywordflow">else<\/span> {$/;"	a
l00275	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00275"><\/a>00275                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Client for %s is already in the client list"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>);$/;"	a
l00276	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00276"><\/a>00276                         }$/;"	a
l00277	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00277"><\/a>00277                         UNLOCK_CLIENT_LIST();$/;"	a
l00278	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00278"><\/a>00278                         <span class="keywordflow">if<\/span> (!logout) {$/;"	a
l00279	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00279"><\/a>00279                                 <a class="code" href="auth_8c.html#88932f2cd4b44875ef888e2fc0817da5" title="Authenticate a single client against the central server.">authenticate_client<\/a>(r);$/;"	a
l00280	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00280"><\/a>00280                         }$/;"	a
l00281	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00281"><\/a>00281                         free(mac);$/;"	a
l00282	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00282"><\/a>00282                 }$/;"	a
l00283	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00283"><\/a>00283         } <span class="keywordflow">else<\/span> {$/;"	a
l00284	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00284"><\/a>00284                 <span class="comment">\/* They did not supply variable "token" *\/<\/span>$/;"	a
l00285	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00285"><\/a>00285                 <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(r, <span class="stringliteral">"WiFiDog error"<\/span>, <span class="stringliteral">"Invalid token"<\/span>);$/;"	a
l00286	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00286"><\/a>00286         }$/;"	a
l00287	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00287"><\/a>00287 }$/;"	a
l00288	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00288"><\/a>00288 $/;"	a
l00289	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00289"><\/a><a class="code" href="http_8h.html#fdcb681ef78f59098d6bc931333640ae">00289<\/a> <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(request *r, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *title, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span>* message)$/;"	a
l00290	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00290"><\/a>00290 {$/;"	a
l00291	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00291"><\/a>00291     <a class="code" href="structs__config.html">s_config<\/a>    *config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00292	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00292"><\/a>00292     <span class="keywordtype">char<\/span> *buffer;$/;"	a
l00293	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00293"><\/a>00293     <span class="keyword">struct <\/span>stat stat_info;$/;"	a
l00294	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00294"><\/a>00294     <span class="keywordtype">int<\/span> fd;$/;"	a
l00295	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00295"><\/a>00295     ssize_t written;$/;"	a
l00296	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00296"><\/a>00296 $/;"	a
l00297	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00297"><\/a>00297     fd=open(config-&gt;<a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6" title="name of the HTML file used for messages">htmlmsgfile<\/a>, O_RDONLY);$/;"	a
l00298	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00298"><\/a>00298     <span class="keywordflow">if<\/span> (fd==-1) {$/;"	a
l00299	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00299"><\/a>00299         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to open HTML message file %s: %s"<\/span>, config-&gt;<a class="code" href="structs__config.html#18aae60cdf3f7cf683a8344da8f039a6" title="name of the HTML file used for messages">htmlmsgfile<\/a>, strerror(errno));$/;"	a
l00300	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00300"><\/a>00300         <span class="keywordflow">return<\/span>;$/;"	a
l00301	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00301"><\/a>00301     }$/;"	a
l00302	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00302"><\/a>00302 $/;"	a
l00303	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00303"><\/a>00303     <span class="keywordflow">if<\/span> (fstat(fd, &amp;stat_info)==-1) {$/;"	a
l00304	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00304"><\/a>00304         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to stat HTML message file: %s"<\/span>, strerror(errno));$/;"	a
l00305	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00305"><\/a>00305         close(fd);$/;"	a
l00306	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00306"><\/a>00306         <span class="keywordflow">return<\/span>;$/;"	a
l00307	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00307"><\/a>00307     }$/;"	a
l00308	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00308"><\/a>00308 $/;"	a
l00309	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00309"><\/a>00309     buffer=(<span class="keywordtype">char<\/span>*)<a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(stat_info.st_size+1);$/;"	a
l00310	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00310"><\/a>00310     written=read(fd, buffer, stat_info.st_size);$/;"	a
l00311	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00311"><\/a>00311     <span class="keywordflow">if<\/span> (written==-1) {$/;"	a
l00312	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00312"><\/a>00312         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to read HTML message file: %s"<\/span>, strerror(errno));$/;"	a
l00313	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00313"><\/a>00313         free(buffer);$/;"	a
l00314	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00314"><\/a>00314         close(fd);$/;"	a
l00315	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00315"><\/a>00315         <span class="keywordflow">return<\/span>;$/;"	a
l00316	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00316"><\/a>00316     }$/;"	a
l00317	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00317"><\/a>00317     close(fd);$/;"	a
l00318	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00318"><\/a>00318 $/;"	a
l00319	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00319"><\/a>00319     buffer[written]=0;$/;"	a
l00320	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00320"><\/a>00320     httpdAddVariable(r, <span class="stringliteral">"title"<\/span>, title);$/;"	a
l00321	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00321"><\/a>00321     httpdAddVariable(r, <span class="stringliteral">"message"<\/span>, message);$/;"	a
l00322	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00322"><\/a>00322     httpdAddVariable(r, <span class="stringliteral">"nodeID"<\/span>, config-&gt;<a class="code" href="structs__config.html#69743b1cf3e7e8d6ed2069e67f76a9a8" title="ID of the Gateway, sent to central server.">gw_id<\/a>);$/;"	a
l00323	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00323"><\/a>00323     httpdOutput(r, buffer);$/;"	a
l00324	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00324"><\/a>00324     free(buffer);$/;"	a
l00325	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00325"><\/a>00325 }$/;"	a
l00326	install/share/doc/wifidog-20090925/html/http_8c-source.html	/^<a name="l00326"><\/a>00326 $/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="http.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
676d4eaab18f4187387db5c1236b55b8	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="676d4eaab18f4187387db5c1236b55b8"><\/a><!-- doxytag: member="http.c::http_callback_status" ref="676d4eaab18f4187387db5c1236b55b8" args="(httpd *webserver, request *r)" -->$/;"	a
7164c2c972bb0668cf8a7ac5c5f2a0a6	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="7164c2c972bb0668cf8a7ac5c5f2a0a6"><\/a><!-- doxytag: member="http.c::http_callback_404" ref="7164c2c972bb0668cf8a7ac5c5f2a0a6" args="(httpd *webserver, request *r)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/http_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a61e9e265a1529e600dd83ef91cd0d14	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="a61e9e265a1529e600dd83ef91cd0d14"><\/a><!-- doxytag: member="http.c::http_callback_wifidog" ref="a61e9e265a1529e600dd83ef91cd0d14" args="(httpd *webserver, request *r)" -->$/;"	a
bbf6eaf48119c43e4d37a8d7b3f16f11	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="bbf6eaf48119c43e4d37a8d7b3f16f11"><\/a><!-- doxytag: member="http.c::http_send_redirect" ref="bbf6eaf48119c43e4d37a8d7b3f16f11" args="(request *r, char *url, char *text)" -->$/;"	a
e31633b9629ec33c9006d0d29ad9ba83	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="e31633b9629ec33c9006d0d29ad9ba83"><\/a><!-- doxytag: member="http.c::http_send_redirect_to_auth" ref="e31633b9629ec33c9006d0d29ad9ba83" args="(request *r, char *urlFragment, char *text)" -->$/;"	a
f306222145f5e2699ed19e716df0fb35	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="f306222145f5e2699ed19e716df0fb35"><\/a><!-- doxytag: member="http.c::http_callback_about" ref="f306222145f5e2699ed19e716df0fb35" args="(httpd *webserver, request *r)" -->$/;"	a
f5d4744903ff7f32bd96a8cb85af299e	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="f5d4744903ff7f32bd96a8cb85af299e"><\/a><!-- doxytag: member="http.c::http_callback_auth" ref="f5d4744903ff7f32bd96a8cb85af299e" args="(httpd *webserver, request *r)" -->$/;"	a
fdcb681ef78f59098d6bc931333640ae	install/share/doc/wifidog-20090925/html/http_8c.html	/^<a class="anchor" name="fdcb681ef78f59098d6bc931333640ae"><\/a><!-- doxytag: member="http.c::send_http_page" ref="fdcb681ef78f59098d6bc931333640ae" args="(request *r, const char *title, const char *message)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<h1>http.h<\/h1><a href="http_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: http.h 1346 2008-04-21 23:04:40Z acv $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _HTTP_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _HTTP_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00033	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#7164c2c972bb0668cf8a7ac5c5f2a0a6" title="Callback for libhttpd, main entry point for captive portal.">http_callback_404<\/a>(httpd *webserver, request *r);$/;"	a
l00035	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#a61e9e265a1529e600dd83ef91cd0d14" title="Callback for libhttpd.">http_callback_wifidog<\/a>(httpd *webserver, request *r);$/;"	a
l00037	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00037"><\/a>00037 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#f306222145f5e2699ed19e716df0fb35" title="Callback for libhttpd.">http_callback_about<\/a>(httpd *webserver, request *r);$/;"	a
l00039	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00039"><\/a>00039 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#676d4eaab18f4187387db5c1236b55b8" title="Callback for libhttpd.">http_callback_status<\/a>(httpd *webserver, request *r);$/;"	a
l00041	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00041"><\/a>00041 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#f5d4744903ff7f32bd96a8cb85af299e" title="Callback for libhttpd, main entry point post login for auth confirmation.">http_callback_auth<\/a>(httpd *webserver, request *r);$/;"	a
l00042	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00044	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#fdcb681ef78f59098d6bc931333640ae" title="Sends a HTML page to web browser.">send_http_page<\/a>(request *r, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *title, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span>* message);$/;"	a
l00045	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00047	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#bbf6eaf48119c43e4d37a8d7b3f16f11" title="Sends a redirect to the web browser.">http_send_redirect<\/a>(request *r, <span class="keywordtype">char<\/span> *url, <span class="keywordtype">char<\/span> *text);$/;"	a
l00049	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00049"><\/a>00049 <span class="keywordtype">void<\/span> <a class="code" href="http_8c.html#e31633b9629ec33c9006d0d29ad9ba83" title="Convenience function to redirect the web browser to the auth server.">http_send_redirect_to_auth<\/a>(request *r, <span class="keywordtype">char<\/span> *urlFragment, <span class="keywordtype">char<\/span> *text);$/;"	a
l00050	install/share/doc/wifidog-20090925/html/http_8h-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#endif <\/span><span class="comment">\/* _HTTP_H_ *\/<\/span>$/;"	a
676d4eaab18f4187387db5c1236b55b8	install/share/doc/wifidog-20090925/html/http_8h.html	/^<a class="anchor" name="676d4eaab18f4187387db5c1236b55b8"><\/a><!-- doxytag: member="http.h::http_callback_status" ref="676d4eaab18f4187387db5c1236b55b8" args="(httpd *webserver, request *r)" -->$/;"	a
7164c2c972bb0668cf8a7ac5c5f2a0a6	install/share/doc/wifidog-20090925/html/http_8h.html	/^<a class="anchor" name="7164c2c972bb0668cf8a7ac5c5f2a0a6"><\/a><!-- doxytag: member="http.h::http_callback_404" ref="7164c2c972bb0668cf8a7ac5c5f2a0a6" args="(httpd *webserver, request *r)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/http_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a61e9e265a1529e600dd83ef91cd0d14	install/share/doc/wifidog-20090925/html/http_8h.html	/^<a class="anchor" name="a61e9e265a1529e600dd83ef91cd0d14"><\/a><!-- doxytag: member="http.h::http_callback_wifidog" ref="a61e9e265a1529e600dd83ef91cd0d14" args="(httpd *webserver, request *r)" -->$/;"	a
bbf6eaf48119c43e4d37a8d7b3f16f11	install/share/doc/wifidog-20090925/html/http_8h.html	/^<a class="anchor" name="bbf6eaf48119c43e4d37a8d7b3f16f11"><\/a><!-- doxytag: member="http.h::http_send_redirect" ref="bbf6eaf48119c43e4d37a8d7b3f16f11" args="(request *r, char *url, char *text)" -->$/;"	a
e31633b9629ec33c9006d0d29ad9ba83	install/share/doc/wifidog-20090925/html/http_8h.html	/^<a class="anchor" name="e31633b9629ec33c9006d0d29ad9ba83"><\/a><!-- doxytag: member="http.h::http_send_redirect_to_auth" ref="e31633b9629ec33c9006d0d29ad9ba83" args="(request *r, char *urlFragment, char *text)" -->$/;"	a
f306222145f5e2699ed19e716df0fb35	install/share/doc/wifidog-20090925/html/http_8h.html	/^<a class="anchor" name="f306222145f5e2699ed19e716df0fb35"><\/a><!-- doxytag: member="http.h::http_callback_about" ref="f306222145f5e2699ed19e716df0fb35" args="(httpd *webserver, request *r)" -->$/;"	a
f5d4744903ff7f32bd96a8cb85af299e	install/share/doc/wifidog-20090925/html/http_8h.html	/^<a class="anchor" name="f5d4744903ff7f32bd96a8cb85af299e"><\/a><!-- doxytag: member="http.h::http_callback_auth" ref="f5d4744903ff7f32bd96a8cb85af299e" args="(httpd *webserver, request *r)" -->$/;"	a
fdcb681ef78f59098d6bc931333640ae	install/share/doc/wifidog-20090925/html/http_8h.html	/^<a class="anchor" name="fdcb681ef78f59098d6bc931333640ae"><\/a><!-- doxytag: member="http.h::send_http_page" ref="fdcb681ef78f59098d6bc931333640ae" args="(request *r, const char *title, const char *message)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<h1>httpd_thread.c<\/h1><a href="httpd__thread_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: httpd_thread.c 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00022	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00022"><\/a>00022 $/;"	a
l00028	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;signal.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00038"><\/a>00038 $/;"	a
l00039	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00040"><\/a>00040 $/;"	a
l00041	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="httpd__thread_8h.html" title="WiFiDog httpd worker thread.">httpd_thread.h<\/a>"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00049	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="keywordtype">void<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00050"><\/a><a class="code" href="httpd__thread_8h.html#2925feb4c55460a80bd30f6ef363779d">00050<\/a> <a class="code" href="httpd__thread_8c.html#2925feb4c55460a80bd30f6ef363779d" title="Handle a web request.">thread_httpd<\/a>(<span class="keywordtype">void<\/span> *args)$/;"	a
l00051	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00051"><\/a>00051 {$/;"	a
l00052	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00052"><\/a>00052         <span class="keywordtype">void<\/span>    **params;$/;"	a
l00053	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00053"><\/a>00053         httpd   *webserver;$/;"	a
l00054	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00054"><\/a>00054         request *r;$/;"	a
l00055	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00055"><\/a>00055         $/;"	a
l00056	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00056"><\/a>00056         params = (<span class="keywordtype">void<\/span> **)args;$/;"	a
l00057	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00057"><\/a>00057         webserver = *params;$/;"	a
l00058	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00058"><\/a>00058         r = *(params + 1);$/;"	a
l00059	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00059"><\/a>00059         free(params); <span class="comment">\/* XXX We must release this ourselves. *\/<\/span>$/;"	a
l00060	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00060"><\/a>00060         $/;"	a
l00061	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00061"><\/a>00061         <span class="keywordflow">if<\/span> (httpdReadRequest(webserver, r) == 0) {$/;"	a
l00062	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00062"><\/a>00062                 <span class="comment">\/*<\/span>$/;"	a
l00063	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="comment">                 * We read the request fine<\/span>$/;"	a
l00064	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00064"><\/a>00064 <span class="comment">                 *\/<\/span>$/;"	a
l00065	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00065"><\/a>00065                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Processing request from %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00066	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00066"><\/a>00066                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Calling httpdProcessRequest() for %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00067	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00067"><\/a>00067                 httpdProcessRequest(webserver, r);$/;"	a
l00068	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00068"><\/a>00068                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Returned from httpdProcessRequest() for %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00069	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00069"><\/a>00069         }$/;"	a
l00070	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00070"><\/a>00070         <span class="keywordflow">else<\/span> {$/;"	a
l00071	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00071"><\/a>00071                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"No valid request received from %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00072	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00072"><\/a>00072         }$/;"	a
l00073	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00073"><\/a>00073         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Closing connection with %s"<\/span>, r-&gt;clientAddr);$/;"	a
l00074	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00074"><\/a>00074         httpdEndRequest(r);$/;"	a
l00075	install/share/doc/wifidog-20090925/html/httpd__thread_8c-source.html	/^<a name="l00075"><\/a>00075 }$/;"	a
2925feb4c55460a80bd30f6ef363779d	install/share/doc/wifidog-20090925/html/httpd__thread_8c.html	/^<a class="anchor" name="2925feb4c55460a80bd30f6ef363779d"><\/a><!-- doxytag: member="httpd_thread.c::thread_httpd" ref="2925feb4c55460a80bd30f6ef363779d" args="(void *args)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/httpd__thread_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<h1>httpd_thread.h<\/h1><a href="httpd__thread_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: httpd_thread.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _HTTPD_THREAD_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _HTTPD_THREAD_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="keywordtype">void<\/span> <a class="code" href="httpd__thread_8c.html#2925feb4c55460a80bd30f6ef363779d" title="Handle a web request.">thread_httpd<\/a>(<span class="keywordtype">void<\/span> *args);$/;"	a
l00032	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00032"><\/a>00032 $/;"	a
l00033	install/share/doc/wifidog-20090925/html/httpd__thread_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#endif<\/span>$/;"	a
2925feb4c55460a80bd30f6ef363779d	install/share/doc/wifidog-20090925/html/httpd__thread_8h.html	/^<a class="anchor" name="2925feb4c55460a80bd30f6ef363779d"><\/a><!-- doxytag: member="httpd_thread.h::thread_httpd" ref="2925feb4c55460a80bd30f6ef363779d" args="(void *args)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/httpd__thread_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<h1>ping_thread.c<\/h1><a href="ping__thread_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: ping_thread.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor"><\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;netdb.h&gt;<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include &lt;signal.h&gt;<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include "<a class="code" href="ping__thread_8h.html" title="WiFiDog heartbeat thread.">ping_thread.h<\/a>"<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00053	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00054	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00055	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> <a class="code" href="ping__thread_8c.html#2d355ce676ac949c810c9379cbba5ba9">ping<\/a>(<span class="keywordtype">void<\/span>);$/;"	a
l00056	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00056"><\/a>00056 $/;"	a
l00057	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="keyword">extern<\/span> time_t started_time;$/;"	a
l00058	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00058"><\/a>00058 $/;"	a
l00063	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="keywordtype">void<\/span>$/;"	a
l00064	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00064"><\/a><a class="code" href="ping__thread_8h.html#3b019c5b71e02b8f475285a22222b296">00064<\/a> <a class="code" href="ping__thread_8c.html#3b019c5b71e02b8f475285a22222b296" title="Periodically checks on the auth server to see if it&amp;#39;s alive.">thread_ping<\/a>(<span class="keywordtype">void<\/span> *arg)$/;"	a
l00065	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00065"><\/a>00065 {$/;"	a
l00066	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00066"><\/a>00066         pthread_cond_t          cond = PTHREAD_COND_INITIALIZER;$/;"	a
l00067	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00067"><\/a>00067         pthread_mutex_t         cond_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00068	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00068"><\/a>00068         <span class="keyword">struct  <\/span>timespec        timeout;$/;"	a
l00069	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00069"><\/a>00069         $/;"	a
l00070	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00070"><\/a>00070         <span class="keywordflow">while<\/span> (1) {$/;"	a
l00071	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00071"><\/a>00071                 <span class="comment">\/* Make sure we check the servers at the very begining *\/<\/span>$/;"	a
l00072	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00072"><\/a>00072                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Running ping()"<\/span>);$/;"	a
l00073	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00073"><\/a>00073                 <a class="code" href="ping__thread_8c.html#2d355ce676ac949c810c9379cbba5ba9">ping<\/a>();$/;"	a
l00074	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00074"><\/a>00074                 $/;"	a
l00075	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00075"><\/a>00075                 <span class="comment">\/* Sleep for config.checkinterval seconds... *\/<\/span>$/;"	a
l00076	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00076"><\/a>00076                 timeout.tv_sec = time(NULL) + <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;<a class="code" href="structs__config.html#9ef8928b35edeee0b3b4da39489c1ff7" title="Frequency the the client timeout check thread will run.">checkinterval<\/a>;$/;"	a
l00077	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00077"><\/a>00077                 timeout.tv_nsec = 0;$/;"	a
l00078	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00078"><\/a>00078 $/;"	a
l00079	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00079"><\/a>00079                 <span class="comment">\/* Mutex must be locked for pthread_cond_timedwait... *\/<\/span>$/;"	a
l00080	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00080"><\/a>00080                 pthread_mutex_lock(&amp;cond_mutex);$/;"	a
l00081	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00081"><\/a>00081                 $/;"	a
l00082	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00082"><\/a>00082                 <span class="comment">\/* Thread safe "sleep" *\/<\/span>$/;"	a
l00083	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00083"><\/a>00083                 pthread_cond_timedwait(&amp;cond, &amp;cond_mutex, &amp;timeout);$/;"	a
l00084	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00084"><\/a>00084 $/;"	a
l00085	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00085"><\/a>00085                 <span class="comment">\/* No longer needs to be locked *\/<\/span>$/;"	a
l00086	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00086"><\/a>00086                 pthread_mutex_unlock(&amp;cond_mutex);$/;"	a
l00087	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00087"><\/a>00087         }$/;"	a
l00088	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00088"><\/a>00088 }$/;"	a
l00089	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00089"><\/a>00089 $/;"	a
l00093	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00093"><\/a>00093 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00094	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00094"><\/a><a class="code" href="ping__thread_8c.html#2d355ce676ac949c810c9379cbba5ba9">00094<\/a> <a class="code" href="ping__thread_8c.html#2d355ce676ac949c810c9379cbba5ba9">ping<\/a>(<span class="keywordtype">void<\/span>)$/;"	a
l00095	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00095"><\/a>00095 {$/;"	a
l00096	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00096"><\/a>00096         ssize_t                 numbytes;$/;"	a
l00097	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00097"><\/a>00097         <span class="keywordtype">size_t<\/span>                  totalbytes;$/;"	a
l00098	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00098"><\/a>00098         <span class="keywordtype">int<\/span>                     sockfd, nfds, done;$/;"	a
l00099	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00099"><\/a>00099         <span class="keywordtype">char<\/span>                    request[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00100	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00100"><\/a>00100         fd_set                  readfds;$/;"	a
l00101	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00101"><\/a>00101         <span class="keyword">struct <\/span>timeval          timeout;$/;"	a
l00102	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00102"><\/a>00102         FILE * fh;$/;"	a
l00103	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00103"><\/a>00103         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> sys_uptime  = 0;$/;"	a
l00104	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00104"><\/a>00104         <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span>      sys_memfree = 0;$/;"	a
l00105	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00105"><\/a>00105         <span class="keywordtype">float<\/span>             sys_load    = 0;$/;"	a
l00106	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00106"><\/a>00106         <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a>     *auth_server = NULL;$/;"	a
l00107	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00107"><\/a>00107         auth_server = <a class="code" href="conf_8c.html#82ffcd3c683aadc31aca9c53a2d2739a" title="Get the active auth server.">get_auth_server<\/a>();$/;"	a
l00108	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00108"><\/a>00108         $/;"	a
l00109	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00109"><\/a>00109         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Entering ping()"<\/span>);$/;"	a
l00110	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00110"><\/a>00110         $/;"	a
l00111	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00111"><\/a>00111         <span class="comment">\/*<\/span>$/;"	a
l00112	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00112"><\/a>00112 <span class="comment">         * The ping thread does not really try to see if the auth server is actually<\/span>$/;"	a
l00113	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00113"><\/a>00113 <span class="comment">         * working. Merely that there is a web server listening at the port. And that<\/span>$/;"	a
l00114	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00114"><\/a>00114 <span class="comment">         * is done by connect_auth_server() internally.<\/span>$/;"	a
l00115	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00115"><\/a>00115 <span class="comment">         *\/<\/span>$/;"	a
l00116	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00116"><\/a>00116         sockfd = <a class="code" href="centralserver_8c.html#168b78813319c6f409394019fcf45f62" title="Tries really hard to connect to an auth server. Returns a connected file descriptor...">connect_auth_server<\/a>();$/;"	a
l00117	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00117"><\/a>00117         <span class="keywordflow">if<\/span> (sockfd == -1) {$/;"	a
l00118	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00118"><\/a>00118                 <span class="comment">\/*<\/span>$/;"	a
l00119	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00119"><\/a>00119 <span class="comment">                 * No auth servers for me to talk to<\/span>$/;"	a
l00120	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00120"><\/a>00120 <span class="comment">                 *\/<\/span>$/;"	a
l00121	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00121"><\/a>00121                 <span class="keywordflow">return<\/span>;$/;"	a
l00122	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00122"><\/a>00122         }$/;"	a
l00123	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00123"><\/a>00123 $/;"	a
l00124	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00124"><\/a>00124         <span class="comment">\/*<\/span>$/;"	a
l00125	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00125"><\/a>00125 <span class="comment">         * Populate uptime, memfree and load<\/span>$/;"	a
l00126	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00126"><\/a>00126 <span class="comment">         *\/<\/span>$/;"	a
l00127	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00127"><\/a>00127         <span class="keywordflow">if<\/span> ((fh = fopen(<span class="stringliteral">"\/proc\/uptime"<\/span>, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00128	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00128"><\/a>00128                 fscanf(fh, <span class="stringliteral">"%lu"<\/span>, &amp;sys_uptime);$/;"	a
l00129	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00129"><\/a>00129                 fclose(fh);$/;"	a
l00130	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00130"><\/a>00130         }$/;"	a
l00131	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00131"><\/a>00131         <span class="keywordflow">if<\/span> ((fh = fopen(<span class="stringliteral">"\/proc\/meminfo"<\/span>, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00132	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00132"><\/a>00132                 <span class="keywordflow">while<\/span> (!feof(fh)) {$/;"	a
l00133	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00133"><\/a>00133                         <span class="keywordflow">if<\/span> (fscanf(fh, <span class="stringliteral">"MemFree: %u"<\/span>, &amp;sys_memfree) == 0) {$/;"	a
l00134	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00134"><\/a>00134                                 <span class="comment">\/* Not on this line *\/<\/span>$/;"	a
l00135	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00135"><\/a>00135                                 <span class="keywordflow">while<\/span> (!feof(fh) &amp;&amp; fgetc(fh) != <span class="charliteral">'\\n'<\/span>);$/;"	a
l00136	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00136"><\/a>00136                         }$/;"	a
l00137	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00137"><\/a>00137                         <span class="keywordflow">else<\/span> {$/;"	a
l00138	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00138"><\/a>00138                                 <span class="comment">\/* Found it *\/<\/span>$/;"	a
l00139	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00139"><\/a>00139                                 <span class="keywordflow">break<\/span>;$/;"	a
l00140	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00140"><\/a>00140                         }$/;"	a
l00141	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00141"><\/a>00141                 }$/;"	a
l00142	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00142"><\/a>00142                 fclose(fh);$/;"	a
l00143	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00143"><\/a>00143         }$/;"	a
l00144	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00144"><\/a>00144         <span class="keywordflow">if<\/span> ((fh = fopen(<span class="stringliteral">"\/proc\/loadavg"<\/span>, <span class="stringliteral">"r"<\/span>))) {$/;"	a
l00145	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00145"><\/a>00145                 fscanf(fh, <span class="stringliteral">"%f"<\/span>, &amp;sys_load);$/;"	a
l00146	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00146"><\/a>00146                 fclose(fh);$/;"	a
l00147	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00147"><\/a>00147         }$/;"	a
l00148	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00148"><\/a>00148 $/;"	a
l00149	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00149"><\/a>00149         <span class="comment">\/*<\/span>$/;"	a
l00150	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00150"><\/a>00150 <span class="comment">         * Prep &amp; send request<\/span>$/;"	a
l00151	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00151"><\/a>00151 <span class="comment">         *\/<\/span>$/;"	a
l00152	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00152"><\/a>00152         snprintf(request, <span class="keyword">sizeof<\/span>(request) - 1,$/;"	a
l00153	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00153"><\/a>00153                         <span class="stringliteral">"GET %s%sgw_id=%s&amp;sys_uptime=%lu&amp;sys_memfree=%u&amp;sys_load=%.2f&amp;wifidog_uptime=%lu HTTP\/1.0\\r\\n"<\/span>$/;"	a
l00154	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00154"><\/a>00154                         <span class="stringliteral">"User-Agent: WiFiDog %s\\r\\n"<\/span>$/;"	a
l00155	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00155"><\/a>00155                         <span class="stringliteral">"Host: %s\\r\\n"<\/span>$/;"	a
l00156	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00156"><\/a>00156                         <span class="stringliteral">"\\r\\n"<\/span>,$/;"	a
l00157	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00157"><\/a>00157                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#ff64f568944bbf0b01bb379b17ae2161" title="Path where wifidog resides.">authserv_path<\/a>,$/;"	a
l00158	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00158"><\/a>00158                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#b33784964244174aef057fa405f76756" title="This is the ping heartbeating script.">authserv_ping_script_path_fragment<\/a>,$/;"	a
l00159	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00159"><\/a>00159                         <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;gw_id,$/;"	a
l00160	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00160"><\/a>00160                         sys_uptime,$/;"	a
l00161	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00161"><\/a>00161                         sys_memfree,$/;"	a
l00162	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00162"><\/a>00162                         sys_load,$/;"	a
l00163	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00163"><\/a>00163                         (<span class="keywordtype">long<\/span> <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span>)((<span class="keywordtype">long<\/span> <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span>)time(NULL) - (<span class="keywordtype">long<\/span> <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span>)started_time),$/;"	a
l00164	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00164"><\/a>00164                         VERSION,$/;"	a
l00165	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00165"><\/a>00165                         auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>);$/;"	a
l00166	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00166"><\/a>00166 $/;"	a
l00167	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00167"><\/a>00167         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"HTTP Request to Server: [%s]"<\/span>, request);$/;"	a
l00168	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00168"><\/a>00168         $/;"	a
l00169	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00169"><\/a>00169         send(sockfd, request, strlen(request), 0);$/;"	a
l00170	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00170"><\/a>00170 $/;"	a
l00171	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00171"><\/a>00171         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Reading response"<\/span>);$/;"	a
l00172	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00172"><\/a>00172         $/;"	a
l00173	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00173"><\/a>00173         numbytes = totalbytes = 0;$/;"	a
l00174	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00174"><\/a>00174         done = 0;$/;"	a
l00175	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00175"><\/a>00175         <span class="keywordflow">do<\/span> {$/;"	a
l00176	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00176"><\/a>00176                 FD_ZERO(&amp;readfds);$/;"	a
l00177	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00177"><\/a>00177                 FD_SET(sockfd, &amp;readfds);$/;"	a
l00178	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00178"><\/a>00178                 timeout.tv_sec = 30; <span class="comment">\/* XXX magic... 30 second *\/<\/span>$/;"	a
l00179	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00179"><\/a>00179                 timeout.tv_usec = 0;$/;"	a
l00180	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00180"><\/a>00180                 nfds = sockfd + 1;$/;"	a
l00181	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00181"><\/a>00181 $/;"	a
l00182	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00182"><\/a>00182                 nfds = select(nfds, &amp;readfds, NULL, NULL, &amp;timeout);$/;"	a
l00183	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00183"><\/a>00183 $/;"	a
l00184	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00184"><\/a>00184                 <span class="keywordflow">if<\/span> (nfds &gt; 0) {$/;"	a
l00187	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00187"><\/a>00187                         numbytes = read(sockfd, request + totalbytes, <a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a> - (totalbytes + 1));$/;"	a
l00188	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00188"><\/a>00188                         <span class="keywordflow">if<\/span> (numbytes &lt; 0) {$/;"	a
l00189	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00189"><\/a>00189                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"An error occurred while reading from auth server: %s"<\/span>, strerror(errno));$/;"	a
l00190	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00190"><\/a>00190                                 <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00191	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00191"><\/a>00191                                 close(sockfd);$/;"	a
l00192	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00192"><\/a>00192                                 <span class="keywordflow">return<\/span>;$/;"	a
l00193	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00193"><\/a>00193                         }$/;"	a
l00194	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00194"><\/a>00194                         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (numbytes == 0) {$/;"	a
l00195	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00195"><\/a>00195                                 done = 1;$/;"	a
l00196	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00196"><\/a>00196                         }$/;"	a
l00197	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00197"><\/a>00197                         <span class="keywordflow">else<\/span> {$/;"	a
l00198	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00198"><\/a>00198                                 totalbytes += numbytes;$/;"	a
l00199	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00199"><\/a>00199                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read %d bytes, total now %d"<\/span>, numbytes, totalbytes);$/;"	a
l00200	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00200"><\/a>00200                         }$/;"	a
l00201	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00201"><\/a>00201                 }$/;"	a
l00202	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00202"><\/a>00202                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (nfds == 0) {$/;"	a
l00203	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00203"><\/a>00203                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Timed out reading data via select() from auth server"<\/span>);$/;"	a
l00204	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00204"><\/a>00204                         <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00205	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00205"><\/a>00205                         close(sockfd);$/;"	a
l00206	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00206"><\/a>00206                         <span class="keywordflow">return<\/span>;$/;"	a
l00207	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00207"><\/a>00207                 }$/;"	a
l00208	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00208"><\/a>00208                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (nfds &lt; 0) {$/;"	a
l00209	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00209"><\/a>00209                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Error reading data via select() from auth server: %s"<\/span>, strerror(errno));$/;"	a
l00210	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00210"><\/a>00210                         <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00211	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00211"><\/a>00211                         close(sockfd);$/;"	a
l00212	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00212"><\/a>00212                         <span class="keywordflow">return<\/span>;$/;"	a
l00213	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00213"><\/a>00213                 }$/;"	a
l00214	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00214"><\/a>00214         } <span class="keywordflow">while<\/span> (!done);$/;"	a
l00215	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00215"><\/a>00215         close(sockfd);$/;"	a
l00216	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00217	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00217"><\/a>00217         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Done reading reply, total %d bytes"<\/span>, totalbytes);$/;"	a
l00218	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00218"><\/a>00218 $/;"	a
l00219	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00219"><\/a>00219         request[totalbytes] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00220	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00220"><\/a>00220 $/;"	a
l00221	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00221"><\/a>00221         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"HTTP Response from Server: [%s]"<\/span>, request);$/;"	a
l00222	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00222"><\/a>00222         $/;"	a
l00223	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00223"><\/a>00223         <span class="keywordflow">if<\/span> (strstr(request, <span class="stringliteral">"Pong"<\/span>) == 0) {$/;"	a
l00224	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00224"><\/a>00224                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_WARNING, <span class="stringliteral">"Auth server did NOT say pong!"<\/span>);$/;"	a
l00225	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00225"><\/a>00225                 <span class="comment">\/* FIXME *\/<\/span>$/;"	a
l00226	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00226"><\/a>00226         }$/;"	a
l00227	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00227"><\/a>00227         <span class="keywordflow">else<\/span> {$/;"	a
l00228	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00228"><\/a>00228                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Auth Server Says: Pong"<\/span>);$/;"	a
l00229	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00229"><\/a>00229         }$/;"	a
l00230	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00230"><\/a>00230 $/;"	a
l00231	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00231"><\/a>00231         <span class="keywordflow">return<\/span>; $/;"	a
l00232	install/share/doc/wifidog-20090925/html/ping__thread_8c-source.html	/^<a name="l00232"><\/a>00232 }$/;"	a
2d355ce676ac949c810c9379cbba5ba9	install/share/doc/wifidog-20090925/html/ping__thread_8c.html	/^<a class="anchor" name="2d355ce676ac949c810c9379cbba5ba9"><\/a><!-- doxytag: member="ping_thread.c::ping" ref="2d355ce676ac949c810c9379cbba5ba9" args="(void)" -->$/;"	a
3b019c5b71e02b8f475285a22222b296	install/share/doc/wifidog-20090925/html/ping__thread_8c.html	/^<a class="anchor" name="3b019c5b71e02b8f475285a22222b296"><\/a><!-- doxytag: member="ping_thread.c::thread_ping" ref="3b019c5b71e02b8f475285a22222b296" args="(void *arg)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/ping__thread_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
f0eea6ebdbba8400df1fe94af7991211	install/share/doc/wifidog-20090925/html/ping__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f0eea6ebdbba8400df1fe94af7991211"><\/a><!-- doxytag: member="ping_thread.c::started_time" ref="f0eea6ebdbba8400df1fe94af7991211" args="" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<h1>ping_thread.h<\/h1><a href="ping__thread_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: ping_thread.h 1104 2006-10-09 00:58:46Z acv $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _PING_THREAD_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _PING_THREAD_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define MINIMUM_STARTED_TIME 1041379200 <\/span><span class="comment">\/* 2003-01-01 *\/<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00031"><\/a>00031 $/;"	a
l00033	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="keywordtype">void<\/span> <a class="code" href="ping__thread_8c.html#3b019c5b71e02b8f475285a22222b296" title="Periodically checks on the auth server to see if it&amp;#39;s alive.">thread_ping<\/a>(<span class="keywordtype">void<\/span> *arg);$/;"	a
l00034	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00034"><\/a>00034 $/;"	a
l00035	install/share/doc/wifidog-20090925/html/ping__thread_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#endif<\/span>$/;"	a
1e3706b097a2ecc4d3390dedca7d5438	install/share/doc/wifidog-20090925/html/ping__thread_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1e3706b097a2ecc4d3390dedca7d5438"><\/a><!-- doxytag: member="ping_thread.h::MINIMUM_STARTED_TIME" ref="1e3706b097a2ecc4d3390dedca7d5438" args="" -->$/;"	a
3b019c5b71e02b8f475285a22222b296	install/share/doc/wifidog-20090925/html/ping__thread_8h.html	/^<a class="anchor" name="3b019c5b71e02b8f475285a22222b296"><\/a><!-- doxytag: member="ping_thread.h::thread_ping" ref="3b019c5b71e02b8f475285a22222b296" args="(void *arg)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/ping__thread_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
l00001	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<h1>safe.c<\/h1><a href="safe_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/*<\/span>$/;"	a
l00022	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00022"><\/a>00022 <span class="comment"> * $Id: safe.c 901 2006-01-17 18:58:13Z mina $<\/span>$/;"	a
l00023	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00023"><\/a>00023 <span class="comment"> *\/<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="comment">\/* From gateway.c *\/<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="keyword">extern<\/span> httpd * webserver;$/;"	a
l00044	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00044"><\/a>00044 $/;"	a
l00045	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00045"><\/a><a class="code" href="safe_8h.html#c26280b92f7122e6f76a0407d26ae8e7">00045<\/a> <span class="keywordtype">void<\/span> * <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a> (<span class="keywordtype">size_t<\/span> size) {$/;"	a
l00046	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00046"><\/a>00046         <span class="keywordtype">void<\/span> * retval = NULL;$/;"	a
l00047	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00047"><\/a>00047         retval = malloc(size);$/;"	a
l00048	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00048"><\/a>00048         <span class="keywordflow">if<\/span> (!retval) {$/;"	a
l00049	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00049"><\/a>00049                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to malloc %d bytes of memory: %s.  Bailing out"<\/span>, size, strerror(errno));$/;"	a
l00050	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00050"><\/a>00050                 exit(1);$/;"	a
l00051	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00051"><\/a>00051         }$/;"	a
l00052	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00052"><\/a>00052         <span class="keywordflow">return<\/span> (retval);$/;"	a
l00053	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00053"><\/a>00053 }$/;"	a
l00054	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00055	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="keywordtype">char<\/span> * safe_strdup(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *s) {$/;"	a
l00056	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00056"><\/a>00056         <span class="keywordtype">char<\/span> * retval = NULL;$/;"	a
l00057	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00057"><\/a>00057         <span class="keywordflow">if<\/span> (!s) {$/;"	a
l00058	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00058"><\/a>00058                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"safe_strdup called with NULL which would have crashed strdup. Bailing out"<\/span>);$/;"	a
l00059	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00059"><\/a>00059                 exit(1);$/;"	a
l00060	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00060"><\/a>00060         }$/;"	a
l00061	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00061"><\/a>00061         retval = strdup(s);$/;"	a
l00062	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00062"><\/a>00062         <span class="keywordflow">if<\/span> (!retval) {$/;"	a
l00063	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00063"><\/a>00063                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to duplicate a string: %s.  Bailing out"<\/span>, strerror(errno));$/;"	a
l00064	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00064"><\/a>00064                 exit(1);$/;"	a
l00065	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00065"><\/a>00065         }$/;"	a
l00066	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00066"><\/a>00066         <span class="keywordflow">return<\/span> (retval);$/;"	a
l00067	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00067"><\/a>00067 }$/;"	a
l00068	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00068"><\/a>00068 $/;"	a
l00069	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00069"><\/a>00069 <span class="keywordtype">int<\/span> safe_asprintf(<span class="keywordtype">char<\/span> **strp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *fmt, ...) {$/;"	a
l00070	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00070"><\/a>00070         va_list ap;$/;"	a
l00071	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00071"><\/a>00071         <span class="keywordtype">int<\/span> retval;$/;"	a
l00072	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00072"><\/a>00072 $/;"	a
l00073	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00073"><\/a>00073         va_start(ap, fmt);$/;"	a
l00074	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00074"><\/a>00074         retval = safe_vasprintf(strp, fmt, ap);$/;"	a
l00075	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00075"><\/a>00075         va_end(ap);$/;"	a
l00076	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00076"><\/a>00076 $/;"	a
l00077	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00077"><\/a>00077         <span class="keywordflow">return<\/span> (retval);$/;"	a
l00078	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00078"><\/a>00078 }$/;"	a
l00079	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00079"><\/a>00079 $/;"	a
l00080	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00080"><\/a>00080 <span class="keywordtype">int<\/span> safe_vasprintf(<span class="keywordtype">char<\/span> **strp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *fmt, va_list ap) {$/;"	a
l00081	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00081"><\/a>00081         <span class="keywordtype">int<\/span> retval;$/;"	a
l00082	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00082"><\/a>00082 $/;"	a
l00083	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00083"><\/a>00083         retval = vasprintf(strp, fmt, ap);$/;"	a
l00084	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00084"><\/a>00084 $/;"	a
l00085	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00085"><\/a>00085         <span class="keywordflow">if<\/span> (retval == -1) {$/;"	a
l00086	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00086"><\/a>00086                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to vasprintf: %s.  Bailing out"<\/span>, strerror(errno));$/;"	a
l00087	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00087"><\/a>00087                 exit (1);$/;"	a
l00088	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00088"><\/a>00088         }$/;"	a
l00089	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00089"><\/a>00089         <span class="keywordflow">return<\/span> (retval);$/;"	a
l00090	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00090"><\/a>00090 }$/;"	a
l00091	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00091"><\/a>00091 $/;"	a
l00092	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00092"><\/a>00092 pid_t safe_fork(<span class="keywordtype">void<\/span>) {$/;"	a
l00093	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00093"><\/a>00093         pid_t result;$/;"	a
l00094	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00094"><\/a>00094         result = fork();$/;"	a
l00095	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00095"><\/a>00095 $/;"	a
l00096	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00096"><\/a>00096         <span class="keywordflow">if<\/span> (result == -1) {$/;"	a
l00097	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00097"><\/a>00097                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_CRIT, <span class="stringliteral">"Failed to fork: %s.  Bailing out"<\/span>, strerror(errno));$/;"	a
l00098	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00098"><\/a>00098                 exit (1);$/;"	a
l00099	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00099"><\/a>00099         }$/;"	a
l00100	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (result == 0) {$/;"	a
l00101	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00101"><\/a>00101                 <span class="comment">\/* I'm the child - do some cleanup *\/<\/span>$/;"	a
l00102	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00102"><\/a>00102                 <span class="keywordflow">if<\/span> (webserver) {$/;"	a
l00103	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00103"><\/a>00103                         close(webserver-&gt;serverSock);$/;"	a
l00104	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00104"><\/a>00104                         webserver = NULL;$/;"	a
l00105	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00105"><\/a>00105                 }$/;"	a
l00106	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00106"><\/a>00106         }$/;"	a
l00107	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00107"><\/a>00107 $/;"	a
l00108	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00108"><\/a>00108         <span class="keywordflow">return<\/span> result;$/;"	a
l00109	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00109"><\/a>00109 }$/;"	a
l00110	install/share/doc/wifidog-20090925/html/safe_8c-source.html	/^<a name="l00110"><\/a>00110 $/;"	a
26d804f329dea2733da34a4953a22a9d	install/share/doc/wifidog-20090925/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="26d804f329dea2733da34a4953a22a9d"><\/a><!-- doxytag: member="safe.c::safe_strdup" ref="26d804f329dea2733da34a4953a22a9d" args="(const char *s)" -->$/;"	a
449f05a9c30dc0c5368ecbb5c3c9db9e	install/share/doc/wifidog-20090925/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="449f05a9c30dc0c5368ecbb5c3c9db9e"><\/a><!-- doxytag: member="safe.c::safe_fork" ref="449f05a9c30dc0c5368ecbb5c3c9db9e" args="(void)" -->$/;"	a
4b7c5789d13951000a0b5faa1afeaa23	install/share/doc/wifidog-20090925/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4b7c5789d13951000a0b5faa1afeaa23"><\/a><!-- doxytag: member="safe.c::safe_asprintf" ref="4b7c5789d13951000a0b5faa1afeaa23" args="(char **strp, const char *fmt,...)" -->$/;"	a
89cbee244ffadc05f3e2629ef0e9c3c2	install/share/doc/wifidog-20090925/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="89cbee244ffadc05f3e2629ef0e9c3c2"><\/a><!-- doxytag: member="safe.c::safe_vasprintf" ref="89cbee244ffadc05f3e2629ef0e9c3c2" args="(char **strp, const char *fmt, va_list ap)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/safe_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a220f44b717da5c2f1b65fe1e068477a	install/share/doc/wifidog-20090925/html/safe_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a220f44b717da5c2f1b65fe1e068477a"><\/a><!-- doxytag: member="safe.c::webserver" ref="a220f44b717da5c2f1b65fe1e068477a" args="" -->$/;"	a
c26280b92f7122e6f76a0407d26ae8e7	install/share/doc/wifidog-20090925/html/safe_8c.html	/^<a class="anchor" name="c26280b92f7122e6f76a0407d26ae8e7"><\/a><!-- doxytag: member="safe.c::safe_malloc" ref="c26280b92f7122e6f76a0407d26ae8e7" args="(size_t size)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<h1>safe.h<\/h1><a href="safe_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: safe.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _SAFE_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _SAFE_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span> <span class="comment">\/* For va_list *\/<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span> <span class="comment">\/* For fork *\/<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span> <span class="comment">\/* For fork *\/<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00033"><\/a>00033 $/;"	a
l00036	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00036"><\/a>00036 <span class="keywordtype">void<\/span> * <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a> (<span class="keywordtype">size_t<\/span> size);$/;"	a
l00037	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00037"><\/a>00037 $/;"	a
l00038	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="comment">\/* @brief Safe version of strdup<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00039"><\/a>00039 <span class="comment"> *\/<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00040"><\/a>00040 <span class="keywordtype">char<\/span> * safe_strdup(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *s);$/;"	a
l00041	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00042"><\/a>00042 <span class="comment">\/* @brief Safe version of asprintf<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="comment"> *\/<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="keywordtype">int<\/span> safe_asprintf(<span class="keywordtype">char<\/span> **strp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *fmt, ...);$/;"	a
l00045	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00046"><\/a>00046 <span class="comment">\/* @brief Safe version of vasprintf<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="comment"> *\/<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00048"><\/a>00048 <span class="keywordtype">int<\/span> safe_vasprintf(<span class="keywordtype">char<\/span> **strp, <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *fmt, va_list ap);$/;"	a
l00049	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00049"><\/a>00049 $/;"	a
l00050	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00050"><\/a>00050 <span class="comment">\/* @brief Safe version of fork<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00051"><\/a>00051 <span class="comment"> *\/<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00053	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00053"><\/a>00053 pid_t safe_fork(<span class="keywordtype">void<\/span>);$/;"	a
l00054	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00055	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00055"><\/a>00055 <span class="preprocessor">#endif <\/span><span class="comment">\/* _SAFE_H_ *\/<\/span>$/;"	a
l00056	install/share/doc/wifidog-20090925/html/safe_8h-source.html	/^<a name="l00056"><\/a>00056 $/;"	a
26d804f329dea2733da34a4953a22a9d	install/share/doc/wifidog-20090925/html/safe_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="26d804f329dea2733da34a4953a22a9d"><\/a><!-- doxytag: member="safe.h::safe_strdup" ref="26d804f329dea2733da34a4953a22a9d" args="(const char *s)" -->$/;"	a
449f05a9c30dc0c5368ecbb5c3c9db9e	install/share/doc/wifidog-20090925/html/safe_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="449f05a9c30dc0c5368ecbb5c3c9db9e"><\/a><!-- doxytag: member="safe.h::safe_fork" ref="449f05a9c30dc0c5368ecbb5c3c9db9e" args="(void)" -->$/;"	a
4b7c5789d13951000a0b5faa1afeaa23	install/share/doc/wifidog-20090925/html/safe_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4b7c5789d13951000a0b5faa1afeaa23"><\/a><!-- doxytag: member="safe.h::safe_asprintf" ref="4b7c5789d13951000a0b5faa1afeaa23" args="(char **strp, const char *fmt,...)" -->$/;"	a
89cbee244ffadc05f3e2629ef0e9c3c2	install/share/doc/wifidog-20090925/html/safe_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="89cbee244ffadc05f3e2629ef0e9c3c2"><\/a><!-- doxytag: member="safe.h::safe_vasprintf" ref="89cbee244ffadc05f3e2629ef0e9c3c2" args="(char **strp, const char *fmt, va_list ap)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/safe_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
c26280b92f7122e6f76a0407d26ae8e7	install/share/doc/wifidog-20090925/html/safe_8h.html	/^<a class="anchor" name="c26280b92f7122e6f76a0407d26ae8e7"><\/a><!-- doxytag: member="safe.h::safe_malloc" ref="c26280b92f7122e6f76a0407d26ae8e7" args="(size_t size)" -->$/;"	a
0752c3da9e2be08ca6d19449fa4cf425	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="0752c3da9e2be08ca6d19449fa4cf425"><\/a><!-- doxytag: member="_auth_serv_t::authserv_login_script_path_fragment" ref="0752c3da9e2be08ca6d19449fa4cf425" args="" -->$/;"	a
175f8cddd51f79e81679c70e2ce172f3	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="175f8cddd51f79e81679c70e2ce172f3"><\/a><!-- doxytag: member="_auth_serv_t::authserv_hostname" ref="175f8cddd51f79e81679c70e2ce172f3" args="" -->$/;"	a
7e294f129187f1449244d266028c68e5	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7e294f129187f1449244d266028c68e5"><\/a><!-- doxytag: member="_auth_serv_t::next" ref="7e294f129187f1449244d266028c68e5" args="" -->$/;"	a
7f1ad17f9e62f68144ff1981def918fb	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="7f1ad17f9e62f68144ff1981def918fb"><\/a><!-- doxytag: member="_auth_serv_t::authserv_http_port" ref="7f1ad17f9e62f68144ff1981def918fb" args="" -->$/;"	a
87bde1ef8a18890d18858a360d276098	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="87bde1ef8a18890d18858a360d276098"><\/a><!-- doxytag: member="_auth_serv_t::authserv_use_ssl" ref="87bde1ef8a18890d18858a360d276098" args="" -->$/;"	a
88f07a2b3771a88671ca3c4a77790f10	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="88f07a2b3771a88671ca3c4a77790f10"><\/a><!-- doxytag: member="_auth_serv_t::authserv_msg_script_path_fragment" ref="88f07a2b3771a88671ca3c4a77790f10" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b33784964244174aef057fa405f76756	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="b33784964244174aef057fa405f76756"><\/a><!-- doxytag: member="_auth_serv_t::authserv_ping_script_path_fragment" ref="b33784964244174aef057fa405f76756" args="" -->$/;"	a
bb67841d88cfe9fd79f9b965dd72b28e	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="bb67841d88cfe9fd79f9b965dd72b28e"><\/a><!-- doxytag: member="_auth_serv_t::last_ip" ref="bb67841d88cfe9fd79f9b965dd72b28e" args="" -->$/;"	a
bcf430ab833dd65830904abf5793e1c6	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="bcf430ab833dd65830904abf5793e1c6"><\/a><!-- doxytag: member="_auth_serv_t::authserv_portal_script_path_fragment" ref="bcf430ab833dd65830904abf5793e1c6" args="" -->$/;"	a
c1144ccb4a8c9418fe1b92a13aa701e8	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="c1144ccb4a8c9418fe1b92a13aa701e8"><\/a><!-- doxytag: member="_auth_serv_t::authserv_auth_script_path_fragment" ref="c1144ccb4a8c9418fe1b92a13aa701e8" args="" -->$/;"	a
f4d82be7a680c24437a91ed1467f8921	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="f4d82be7a680c24437a91ed1467f8921"><\/a><!-- doxytag: member="_auth_serv_t::authserv_ssl_port" ref="f4d82be7a680c24437a91ed1467f8921" args="" -->$/;"	a
ff64f568944bbf0b01bb379b17ae2161	install/share/doc/wifidog-20090925/html/struct__auth__serv__t.html	/^<a class="anchor" name="ff64f568944bbf0b01bb379b17ae2161"><\/a><!-- doxytag: member="_auth_serv_t::authserv_path" ref="ff64f568944bbf0b01bb379b17ae2161" args="" -->$/;"	a
172be165ac52a92dfe57e0911678698d	install/share/doc/wifidog-20090925/html/struct__firewall__rule__t.html	/^<a class="anchor" name="172be165ac52a92dfe57e0911678698d"><\/a><!-- doxytag: member="_firewall_rule_t::port" ref="172be165ac52a92dfe57e0911678698d" args="" -->$/;"	a
4319185967c4252ced90b2d440034b47	install/share/doc/wifidog-20090925/html/struct__firewall__rule__t.html	/^<a class="anchor" name="4319185967c4252ced90b2d440034b47"><\/a><!-- doxytag: member="_firewall_rule_t::block_allow" ref="4319185967c4252ced90b2d440034b47" args="" -->$/;"	a
46cf31ace7a4781cd8f67fbf3c8f75de	install/share/doc/wifidog-20090925/html/struct__firewall__rule__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="46cf31ace7a4781cd8f67fbf3c8f75de"><\/a><!-- doxytag: member="_firewall_rule_t::next" ref="46cf31ace7a4781cd8f67fbf3c8f75de" args="" -->$/;"	a
71fecaae85673b8c3d00a7c14f528f73	install/share/doc/wifidog-20090925/html/struct__firewall__rule__t.html	/^<a class="anchor" name="71fecaae85673b8c3d00a7c14f528f73"><\/a><!-- doxytag: member="_firewall_rule_t::mask" ref="71fecaae85673b8c3d00a7c14f528f73" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/struct__firewall__rule__t.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
de917f67daf277f81767a9ca7cb6ac1e	install/share/doc/wifidog-20090925/html/struct__firewall__rule__t.html	/^<a class="anchor" name="de917f67daf277f81767a9ca7cb6ac1e"><\/a><!-- doxytag: member="_firewall_rule_t::protocol" ref="de917f67daf277f81767a9ca7cb6ac1e" args="" -->$/;"	a
01cf836d509e646ac7fee6d5ac791ead	install/share/doc/wifidog-20090925/html/struct__firewall__ruleset__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="01cf836d509e646ac7fee6d5ac791ead"><\/a><!-- doxytag: member="_firewall_ruleset_t::name" ref="01cf836d509e646ac7fee6d5ac791ead" args="" -->$/;"	a
51556fca7d717b95a9b53695bfd0c07a	install/share/doc/wifidog-20090925/html/struct__firewall__ruleset__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="51556fca7d717b95a9b53695bfd0c07a"><\/a><!-- doxytag: member="_firewall_ruleset_t::next" ref="51556fca7d717b95a9b53695bfd0c07a" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/struct__firewall__ruleset__t.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
ee34ad9758267b6ae770681d6017a4a7	install/share/doc/wifidog-20090925/html/struct__firewall__ruleset__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ee34ad9758267b6ae770681d6017a4a7"><\/a><!-- doxytag: member="_firewall_ruleset_t::rules" ref="ee34ad9758267b6ae770681d6017a4a7" args="" -->$/;"	a
4d2a8485133db0ba5eb394bb45ba3e8d	install/share/doc/wifidog-20090925/html/struct__t__authresponse.html	/^<a class="anchor" name="4d2a8485133db0ba5eb394bb45ba3e8d"><\/a><!-- doxytag: member="_t_authresponse::authcode" ref="4d2a8485133db0ba5eb394bb45ba3e8d" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/struct__t__authresponse.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
211c67d5a5f5eea8ea443947dccacf82	install/share/doc/wifidog-20090925/html/struct__t__client.html	/^<a class="anchor" name="211c67d5a5f5eea8ea443947dccacf82"><\/a><!-- doxytag: member="_t_client::ip" ref="211c67d5a5f5eea8ea443947dccacf82" args="" -->$/;"	a
495baef8f1dc90c94c24561ebd61140d	install/share/doc/wifidog-20090925/html/struct__t__client.html	/^<a class="anchor" name="495baef8f1dc90c94c24561ebd61140d"><\/a><!-- doxytag: member="_t_client::fd" ref="495baef8f1dc90c94c24561ebd61140d" args="" -->$/;"	a
530b82c768532f3467c80abd51c06d1b	install/share/doc/wifidog-20090925/html/struct__t__client.html	/^<a class="anchor" name="530b82c768532f3467c80abd51c06d1b"><\/a><!-- doxytag: member="_t_client::mac" ref="530b82c768532f3467c80abd51c06d1b" args="" -->$/;"	a
5daa51a49977df48e0664b89f029f082	install/share/doc/wifidog-20090925/html/struct__t__client.html	/^<a class="anchor" name="5daa51a49977df48e0664b89f029f082"><\/a><!-- doxytag: member="_t_client::next" ref="5daa51a49977df48e0664b89f029f082" args="" -->$/;"	a
6aa8adb62a098684aa47c3105a7090d1	install/share/doc/wifidog-20090925/html/struct__t__client.html	/^<a class="anchor" name="6aa8adb62a098684aa47c3105a7090d1"><\/a><!-- doxytag: member="_t_client::counters" ref="6aa8adb62a098684aa47c3105a7090d1" args="" -->$/;"	a
80d3364a1172ca74e1fb475609a54a15	install/share/doc/wifidog-20090925/html/struct__t__client.html	/^<a class="anchor" name="80d3364a1172ca74e1fb475609a54a15"><\/a><!-- doxytag: member="_t_client::fw_connection_state" ref="80d3364a1172ca74e1fb475609a54a15" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/struct__t__client.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
f75604bedd92e1054f3fca789a5a41ad	install/share/doc/wifidog-20090925/html/struct__t__client.html	/^<a class="anchor" name="f75604bedd92e1054f3fca789a5a41ad"><\/a><!-- doxytag: member="_t_client::token" ref="f75604bedd92e1054f3fca789a5a41ad" args="" -->$/;"	a
10913bf2ef2987382c044428fb9c39e9	install/share/doc/wifidog-20090925/html/struct__t__counters.html	/^<a class="anchor" name="10913bf2ef2987382c044428fb9c39e9"><\/a><!-- doxytag: member="_t_counters::incoming_history" ref="10913bf2ef2987382c044428fb9c39e9" args="" -->$/;"	a
6fbba5b171f4deb67169798cdfecb4ba	install/share/doc/wifidog-20090925/html/struct__t__counters.html	/^<a class="anchor" name="6fbba5b171f4deb67169798cdfecb4ba"><\/a><!-- doxytag: member="_t_counters::outgoing_history" ref="6fbba5b171f4deb67169798cdfecb4ba" args="" -->$/;"	a
8953c7b1e636c79dad0359282c28b5d1	install/share/doc/wifidog-20090925/html/struct__t__counters.html	/^<a class="anchor" name="8953c7b1e636c79dad0359282c28b5d1"><\/a><!-- doxytag: member="_t_counters::last_updated" ref="8953c7b1e636c79dad0359282c28b5d1" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/struct__t__counters.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
ad35b1bd0b0de20a4fbcacc133898063	install/share/doc/wifidog-20090925/html/struct__t__counters.html	/^<a class="anchor" name="ad35b1bd0b0de20a4fbcacc133898063"><\/a><!-- doxytag: member="_t_counters::incoming" ref="ad35b1bd0b0de20a4fbcacc133898063" args="" -->$/;"	a
e8c2b343f2e37219011e5c53fd39390d	install/share/doc/wifidog-20090925/html/struct__t__counters.html	/^<a class="anchor" name="e8c2b343f2e37219011e5c53fd39390d"><\/a><!-- doxytag: member="_t_counters::outgoing" ref="e8c2b343f2e37219011e5c53fd39390d" args="" -->$/;"	a
4e4381cfff2bbfbd9455640102b21f14	install/share/doc/wifidog-20090925/html/struct__trusted__mac__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4e4381cfff2bbfbd9455640102b21f14"><\/a><!-- doxytag: member="_trusted_mac_t::mac" ref="4e4381cfff2bbfbd9455640102b21f14" args="" -->$/;"	a
949f4da24c7f33f4a8463dac5d9d565c	install/share/doc/wifidog-20090925/html/struct__trusted__mac__t.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="949f4da24c7f33f4a8463dac5d9d565c"><\/a><!-- doxytag: member="_trusted_mac_t::next" ref="949f4da24c7f33f4a8463dac5d9d565c" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/struct__trusted__mac__t.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
0d3b219bafe97bb489549dcdd334b074	install/share/doc/wifidog-20090925/html/structs__config.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0d3b219bafe97bb489549dcdd334b074"><\/a><!-- doxytag: member="s_config::param" ref="0d3b219bafe97bb489549dcdd334b074" args="" -->$/;"	a
10bef4a1d29228311acf38c9692a5a81	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="10bef4a1d29228311acf38c9692a5a81"><\/a><!-- doxytag: member="s_config::configfile" ref="10bef4a1d29228311acf38c9692a5a81" args="[255]" -->$/;"	a
116c013bc650d44eb25f9e3521b0f88d	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="116c013bc650d44eb25f9e3521b0f88d"><\/a><!-- doxytag: member="s_config::httpdusername" ref="116c013bc650d44eb25f9e3521b0f88d" args="" -->$/;"	a
132360d3c982b91fe0cdff6622eee1f1	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="132360d3c982b91fe0cdff6622eee1f1"><\/a><!-- doxytag: member="s_config::internal_sock" ref="132360d3c982b91fe0cdff6622eee1f1" args="" -->$/;"	a
16d75212a8b3ca23cadd6c5e5aa61189	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="16d75212a8b3ca23cadd6c5e5aa61189"><\/a><!-- doxytag: member="s_config::gw_port" ref="16d75212a8b3ca23cadd6c5e5aa61189" args="" -->$/;"	a
18aae60cdf3f7cf683a8344da8f039a6	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="18aae60cdf3f7cf683a8344da8f039a6"><\/a><!-- doxytag: member="s_config::htmlmsgfile" ref="18aae60cdf3f7cf683a8344da8f039a6" args="" -->$/;"	a
205a18044b75a27d255ca3fdf30c0d64	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="205a18044b75a27d255ca3fdf30c0d64"><\/a><!-- doxytag: member="s_config::trustedmaclist" ref="205a18044b75a27d255ca3fdf30c0d64" args="" -->$/;"	a
283515007953f307a7b599ee480b743d	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="283515007953f307a7b599ee480b743d"><\/a><!-- doxytag: member="s_config::httpdrealm" ref="283515007953f307a7b599ee480b743d" args="" -->$/;"	a
2d5969c6676bbefa37c435bfe018a15d	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="2d5969c6676bbefa37c435bfe018a15d"><\/a><!-- doxytag: member="s_config::wdctl_sock" ref="2d5969c6676bbefa37c435bfe018a15d" args="" -->$/;"	a
2ed9a59507be060fe0e1deae7fcc077b	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="2ed9a59507be060fe0e1deae7fcc077b"><\/a><!-- doxytag: member="s_config::httpdname" ref="2ed9a59507be060fe0e1deae7fcc077b" args="" -->$/;"	a
69743b1cf3e7e8d6ed2069e67f76a9a8	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="69743b1cf3e7e8d6ed2069e67f76a9a8"><\/a><!-- doxytag: member="s_config::gw_id" ref="69743b1cf3e7e8d6ed2069e67f76a9a8" args="" -->$/;"	a
72a375118114359c8fcf890bba1e77fb	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="72a375118114359c8fcf890bba1e77fb"><\/a><!-- doxytag: member="s_config::debuglevel" ref="72a375118114359c8fcf890bba1e77fb" args="" -->$/;"	a
784dd5fa3d27b3d1311b18f23e919362	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="784dd5fa3d27b3d1311b18f23e919362"><\/a><!-- doxytag: member="s_config::log_syslog" ref="784dd5fa3d27b3d1311b18f23e919362" args="" -->$/;"	a
7a24ca5b2cc1ff099bda0af17e654a95	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="7a24ca5b2cc1ff099bda0af17e654a95"><\/a><!-- doxytag: member="s_config::httpdmaxconn" ref="7a24ca5b2cc1ff099bda0af17e654a95" args="" -->$/;"	a
860efab2a31502f548fc188ba2243f4e	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="860efab2a31502f548fc188ba2243f4e"><\/a><!-- doxytag: member="s_config::auth_servers" ref="860efab2a31502f548fc188ba2243f4e" args="" -->$/;"	a
9284ae2f338cce20da86aa74916df38c	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="9284ae2f338cce20da86aa74916df38c"><\/a><!-- doxytag: member="s_config::clienttimeout" ref="9284ae2f338cce20da86aa74916df38c" args="" -->$/;"	a
93ffa58b6d61d2a8eb6dd31dc4346fd4	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="93ffa58b6d61d2a8eb6dd31dc4346fd4"><\/a><!-- doxytag: member="s_config::rulesets" ref="93ffa58b6d61d2a8eb6dd31dc4346fd4" args="" -->$/;"	a
9ef8928b35edeee0b3b4da39489c1ff7	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="9ef8928b35edeee0b3b4da39489c1ff7"><\/a><!-- doxytag: member="s_config::checkinterval" ref="9ef8928b35edeee0b3b4da39489c1ff7" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/structs__config.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a9067918ad171a070ccd631887fe2da0	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="a9067918ad171a070ccd631887fe2da0"><\/a><!-- doxytag: member="s_config::gw_address" ref="a9067918ad171a070ccd631887fe2da0" args="" -->$/;"	a
cf2da8057a1661fb677d6a4c805843a5	install/share/doc/wifidog-20090925/html/structs__config.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cf2da8057a1661fb677d6a4c805843a5"><\/a><!-- doxytag: member="s_config::command" ref="cf2da8057a1661fb677d6a4c805843a5" args="" -->$/;"	a
d331abd0de5c051099d862891f454e7a	install/share/doc/wifidog-20090925/html/structs__config.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d331abd0de5c051099d862891f454e7a"><\/a><!-- doxytag: member="s_config::socket" ref="d331abd0de5c051099d862891f454e7a" args="" -->$/;"	a
d618811ef3a6a0e3b373d972c6cf2e8c	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="d618811ef3a6a0e3b373d972c6cf2e8c"><\/a><!-- doxytag: member="s_config::gw_interface" ref="d618811ef3a6a0e3b373d972c6cf2e8c" args="" -->$/;"	a
e53582fbd0f3930cb34130a0f6d98389	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="e53582fbd0f3930cb34130a0f6d98389"><\/a><!-- doxytag: member="s_config::daemon" ref="e53582fbd0f3930cb34130a0f6d98389" args="" -->$/;"	a
e78aa9497032c5a27194633fcad862a5	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="e78aa9497032c5a27194633fcad862a5"><\/a><!-- doxytag: member="s_config::httpdpassword" ref="e78aa9497032c5a27194633fcad862a5" args="" -->$/;"	a
eaad87f73a87a2f752b111dad813902d	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="eaad87f73a87a2f752b111dad813902d"><\/a><!-- doxytag: member="s_config::syslog_facility" ref="eaad87f73a87a2f752b111dad813902d" args="" -->$/;"	a
ff90f0dcf55e28b34b056bb8a86f5b62	install/share/doc/wifidog-20090925/html/structs__config.html	/^<a class="anchor" name="ff90f0dcf55e28b34b056bb8a86f5b62"><\/a><!-- doxytag: member="s_config::external_interface" ref="ff90f0dcf55e28b34b056bb8a86f5b62" args="" -->$/;"	a
_todo000001	install/share/doc/wifidog-20090925/html/todo.html	/^<a class="anchor" name="_todo000001"><\/a> <dl>$/;"	a
_todo000003	install/share/doc/wifidog-20090925/html/todo.html	/^<a class="anchor" name="_todo000003"><\/a> <dl>$/;"	a
_todo000004	install/share/doc/wifidog-20090925/html/todo.html	/^<a class="anchor" name="_todo000004"><\/a> <dl>$/;"	a
_todo000005	install/share/doc/wifidog-20090925/html/todo.html	/^<a class="anchor" name="_todo000005"><\/a> <dl>$/;"	a
_todo000006	install/share/doc/wifidog-20090925/html/todo.html	/^<a class="anchor" name="_todo000006"><\/a> <dl>$/;"	a
_todo000007	install/share/doc/wifidog-20090925/html/todo.html	/^<a class="anchor" name="_todo000007"><\/a> <dl>$/;"	a
todo	install/share/doc/wifidog-20090925/html/todo.html	/^<h1><a class="anchor" name="todo">Todo List <\/a><\/h1><a class="anchor" name="_todo000001"><\/a> <dl>$/;"	a
toggleFolder	install/share/doc/wifidog-20090925/html/tree.html	/^    function toggleFolder(id, imageNode) $/;"	f
l00001	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<h1>util.c<\/h1><a href="util_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment"> \\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/*<\/span>$/;"	a
l00022	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00022"><\/a>00022 <span class="comment"> * $Id: util.c 1381 2008-09-30 12:16:08Z wichert $<\/span>$/;"	a
l00023	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00023"><\/a>00023 <span class="comment"> *\/<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor"><\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;sys\/wait.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;sys\/unistd.h&gt;<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include &lt;sys\/ioctl.h&gt;<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include &lt;arpa\/inet.h&gt;<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00044"><\/a>00044 $/;"	a
l00045	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#if defined(__NetBSD__)<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor"><\/span><span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include &lt;ifaddrs.h&gt;<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include &lt;net\/if.h&gt;<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include &lt;net\/if_dl.h&gt;<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include &lt;<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>&gt;<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#endif<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor"><\/span>$/;"	a
l00053	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#ifdef __linux__<\/span>$/;"	a
l00054	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor"><\/span><span class="preprocessor">#include &lt;netinet\/in.h&gt;<\/span>$/;"	a
l00055	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00055"><\/a>00055 <span class="preprocessor">#include &lt;net\/if.h&gt;<\/span>$/;"	a
l00056	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="preprocessor">#endif<\/span>$/;"	a
l00057	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="preprocessor"><\/span>$/;"	a
l00058	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00059	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00059"><\/a>00059 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00060	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="preprocessor">#include &lt;netdb.h&gt;<\/span>$/;"	a
l00061	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00061"><\/a>00061 $/;"	a
l00062	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00062"><\/a>00062 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00063	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00064	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00064"><\/a>00064 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00065	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00065"><\/a>00065 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00066	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00066"><\/a>00066 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00067	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00067"><\/a>00067 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00068	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00068"><\/a>00068 $/;"	a
l00069	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00069"><\/a>00069 <span class="preprocessor">#include "..\/config.h"<\/span>$/;"	a
l00070	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00070"><\/a>00070 $/;"	a
l00071	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00071"><\/a>00071 <span class="keyword">static<\/span> pthread_mutex_t ghbn_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00072	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00072"><\/a>00072 $/;"	a
l00073	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00073"><\/a>00073 <span class="comment">\/* Defined in ping_thread.c *\/<\/span>$/;"	a
l00074	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00074"><\/a>00074 <span class="keyword">extern<\/span> time_t started_time;$/;"	a
l00075	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00075"><\/a>00075 $/;"	a
l00076	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00076"><\/a>00076 <span class="comment">\/* Defined in clientlist.c *\/<\/span>$/;"	a
l00077	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00077"><\/a>00077 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00078	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00078"><\/a>00078 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a>;$/;"	a
l00079	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00079"><\/a>00079 $/;"	a
l00080	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00080"><\/a>00080 <span class="comment">\/* Defined in commandline.c *\/<\/span>$/;"	a
l00081	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00081"><\/a>00081 <span class="keyword">extern<\/span> pid_t restart_orig_pid;$/;"	a
l00082	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00082"><\/a>00082 $/;"	a
l00083	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00083"><\/a>00083 <span class="comment">\/* XXX Do these need to be locked ? *\/<\/span>$/;"	a
l00084	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00084"><\/a>00084 <span class="keyword">static<\/span> time_t last_online_time = 0;$/;"	a
l00085	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00085"><\/a>00085 <span class="keyword">static<\/span> time_t last_offline_time = 0;$/;"	a
l00086	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00086"><\/a>00086 <span class="keyword">static<\/span> time_t last_auth_online_time = 0;$/;"	a
l00087	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00087"><\/a>00087 <span class="keyword">static<\/span> time_t last_auth_offline_time = 0;$/;"	a
l00088	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00088"><\/a>00088 $/;"	a
l00089	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00089"><\/a>00089 <span class="keywordtype">long<\/span> served_this_session = 0;$/;"	a
l00090	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00090"><\/a>00090 $/;"	a
l00096	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00096"><\/a>00096 <span class="keywordtype">int<\/span>$/;"	a
l00097	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00097"><\/a><a class="code" href="util_8h.html#d3c0ab429f95535fa08bc6a4fb884bab">00097<\/a> <a class="code" href="util_8c.html#d3c0ab429f95535fa08bc6a4fb884bab" title="Execute a shell command.">execute<\/a>(<span class="keywordtype">char<\/span> *cmd_line, <span class="keywordtype">int<\/span> quiet)$/;"	a
l00098	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00098"><\/a>00098 {$/;"	a
l00099	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00099"><\/a>00099         <span class="keywordtype">int<\/span> pid,$/;"	a
l00100	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00100"><\/a>00100             status,$/;"	a
l00101	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00101"><\/a>00101             rc;$/;"	a
l00102	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00102"><\/a>00102 $/;"	a
l00103	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00103"><\/a>00103         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *new_argv[4];$/;"	a
l00104	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00104"><\/a>00104         new_argv[0] = <span class="stringliteral">"\/bin\/sh"<\/span>;$/;"	a
l00105	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00105"><\/a>00105         new_argv[1] = <span class="stringliteral">"-c"<\/span>;$/;"	a
l00106	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00106"><\/a>00106         new_argv[2] = cmd_line;$/;"	a
l00107	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00107"><\/a>00107         new_argv[3] = NULL;$/;"	a
l00108	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00108"><\/a>00108 $/;"	a
l00109	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00109"><\/a>00109         pid = safe_fork();$/;"	a
l00110	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00110"><\/a>00110         <span class="keywordflow">if<\/span> (pid == 0) {    <span class="comment">\/* for the child process:         *\/<\/span>$/;"	a
l00111	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00111"><\/a>00111                 <span class="comment">\/* We don't want to see any errors if quiet flag is on *\/<\/span>$/;"	a
l00112	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00112"><\/a>00112                 <span class="keywordflow">if<\/span> (quiet) close(2);$/;"	a
l00113	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00113"><\/a>00113                 <span class="keywordflow">if<\/span> (execvp(<span class="stringliteral">"\/bin\/sh"<\/span>, (<span class="keywordtype">char<\/span> *<span class="keyword">const<\/span> *)new_argv) == -1) {    <span class="comment">\/* execute the command  *\/<\/span>$/;"	a
l00114	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00114"><\/a>00114                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"execvp(): %s"<\/span>, strerror(errno));$/;"	a
l00115	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00115"><\/a>00115                 } <span class="keywordflow">else<\/span> {$/;"	a
l00116	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00116"><\/a>00116                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"execvp() failed"<\/span>);$/;"	a
l00117	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00117"><\/a>00117                 }$/;"	a
l00118	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00118"><\/a>00118                 exit(1);$/;"	a
l00119	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00119"><\/a>00119         }$/;"	a
l00120	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00120"><\/a>00120 $/;"	a
l00121	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00121"><\/a>00121         <span class="comment">\/* for the parent:      *\/<\/span>$/;"	a
l00122	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00122"><\/a>00122         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Waiting for PID %d to exit"<\/span>, pid);$/;"	a
l00123	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00123"><\/a>00123         rc = waitpid(pid, &amp;status, 0);$/;"	a
l00124	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00124"><\/a>00124         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Process PID %d exited"<\/span>, rc);$/;"	a
l00125	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00125"><\/a>00125 $/;"	a
l00126	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00126"><\/a>00126         <span class="keywordflow">return<\/span> (WEXITSTATUS(status));$/;"	a
l00127	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00127"><\/a>00127 }$/;"	a
l00128	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00128"><\/a>00128 $/;"	a
l00129	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00129"><\/a>00129         <span class="keyword">struct <\/span>in_addr *$/;"	a
l00130	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00130"><\/a>00130 wd_gethostbyname(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *name)$/;"	a
l00131	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00131"><\/a>00131 {$/;"	a
l00132	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00132"><\/a>00132         <span class="keyword">struct <\/span>hostent *he;$/;"	a
l00133	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00133"><\/a>00133         <span class="keyword">struct <\/span>in_addr *h_addr, *in_addr_temp;$/;"	a
l00134	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00134"><\/a>00134 $/;"	a
l00135	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00135"><\/a>00135         <span class="comment">\/* XXX Calling function is reponsible for free() *\/<\/span>$/;"	a
l00136	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00136"><\/a>00136 $/;"	a
l00137	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00137"><\/a>00137         h_addr = <a class="code" href="safe_8c.html#c26280b92f7122e6f76a0407d26ae8e7" title="Safe version of malloc.">safe_malloc<\/a>(<span class="keyword">sizeof<\/span>(<span class="keyword">struct<\/span> in_addr));$/;"	a
l00138	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00138"><\/a>00138 $/;"	a
l00139	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00139"><\/a>00139         LOCK_GHBN();$/;"	a
l00140	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00140"><\/a>00140 $/;"	a
l00141	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00141"><\/a>00141         he = gethostbyname(name);$/;"	a
l00142	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00142"><\/a>00142 $/;"	a
l00143	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00143"><\/a>00143         <span class="keywordflow">if<\/span> (he == NULL) {$/;"	a
l00144	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00144"><\/a>00144                 free(h_addr);$/;"	a
l00145	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00145"><\/a>00145                 UNLOCK_GHBN();$/;"	a
l00146	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00146"><\/a>00146                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00147	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00147"><\/a>00147         }$/;"	a
l00148	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00148"><\/a>00148 $/;"	a
l00149	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00149"><\/a>00149         mark_online();$/;"	a
l00150	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00150"><\/a>00150 $/;"	a
l00151	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00151"><\/a>00151         in_addr_temp = (<span class="keyword">struct <\/span>in_addr *)he-&gt;h_addr_list[0];$/;"	a
l00152	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00152"><\/a>00152         h_addr-&gt;s_addr = in_addr_temp-&gt;s_addr;$/;"	a
l00153	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00153"><\/a>00153 $/;"	a
l00154	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00154"><\/a>00154         UNLOCK_GHBN();$/;"	a
l00155	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00155"><\/a>00155 $/;"	a
l00156	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00156"><\/a>00156         <span class="keywordflow">return<\/span> h_addr;$/;"	a
l00157	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00157"><\/a>00157 }$/;"	a
l00158	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00158"><\/a>00158 $/;"	a
l00159	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00159"><\/a>00159         <span class="keywordtype">char<\/span> *$/;"	a
l00160	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00160"><\/a>00160 get_iface_ip(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ifname)$/;"	a
l00161	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00161"><\/a>00161 {$/;"	a
l00162	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00162"><\/a>00162 <span class="preprocessor">#if defined(__linux__)<\/span>$/;"	a
l00163	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00163"><\/a>00163 <span class="preprocessor"><\/span>        <span class="keyword">struct <\/span>ifreq if_data;$/;"	a
l00164	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00164"><\/a>00164         <span class="keyword">struct <\/span>in_addr in;$/;"	a
l00165	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00165"><\/a>00165         <span class="keywordtype">char<\/span> *ip_str;$/;"	a
l00166	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordtype">int<\/span> sockd;$/;"	a
l00167	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00167"><\/a>00167         u_int32_t ip;$/;"	a
l00168	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00168"><\/a>00168 $/;"	a
l00169	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00169"><\/a>00169         <span class="comment">\/* Create a socket *\/<\/span>$/;"	a
l00170	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00170"><\/a>00170         <span class="keywordflow">if<\/span> ((sockd = socket (AF_INET, SOCK_PACKET, htons(0x8086))) &lt; 0) {$/;"	a
l00171	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00171"><\/a>00171                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"socket(): %s"<\/span>, strerror(errno));$/;"	a
l00172	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00172"><\/a>00172                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00173	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00173"><\/a>00173         }$/;"	a
l00174	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00174"><\/a>00174 $/;"	a
l00175	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00175"><\/a>00175         <span class="comment">\/* Get IP of internal interface *\/<\/span>$/;"	a
l00176	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00176"><\/a>00176         strcpy (if_data.ifr_name, ifname);$/;"	a
l00177	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00177"><\/a>00177 $/;"	a
l00178	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00178"><\/a>00178         <span class="comment">\/* Get the IP address *\/<\/span>$/;"	a
l00179	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00179"><\/a>00179         <span class="keywordflow">if<\/span> (ioctl (sockd, SIOCGIFADDR, &amp;if_data) &lt; 0) {$/;"	a
l00180	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00180"><\/a>00180                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"ioctl(): SIOCGIFADDR %s"<\/span>, strerror(errno));$/;"	a
l00181	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00181"><\/a>00181                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00182	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00182"><\/a>00182         }$/;"	a
l00183	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00183"><\/a>00183         memcpy ((<span class="keywordtype">void<\/span> *) &amp;ip, (<span class="keywordtype">void<\/span> *) &amp;if_data.ifr_addr.sa_data + 2, 4);$/;"	a
l00184	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00184"><\/a>00184         in.s_addr = ip;$/;"	a
l00185	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00185"><\/a>00185 $/;"	a
l00186	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00186"><\/a>00186         ip_str = inet_ntoa(in);$/;"	a
l00187	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00187"><\/a>00187         close(sockd);$/;"	a
l00188	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00188"><\/a>00188         <span class="keywordflow">return<\/span> safe_strdup(ip_str);$/;"	a
l00189	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00189"><\/a>00189 <span class="preprocessor">#elif defined(__NetBSD__)<\/span>$/;"	a
l00190	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00190"><\/a>00190 <span class="preprocessor"><\/span>        <span class="keyword">struct <\/span>ifaddrs *ifa, *ifap;$/;"	a
l00191	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00191"><\/a>00191         <span class="keywordtype">char<\/span> *str = NULL;$/;"	a
l00192	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00192"><\/a>00192 $/;"	a
l00193	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00193"><\/a>00193         <span class="keywordflow">if<\/span> (getifaddrs(&amp;ifap) == -1) {$/;"	a
l00194	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00194"><\/a>00194                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"getifaddrs(): %s"<\/span>, strerror(errno));$/;"	a
l00195	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00195"><\/a>00195                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00196	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00196"><\/a>00196         }$/;"	a
l00197	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00197"><\/a>00197         <span class="comment">\/* XXX arbitrarily pick the first IPv4 address *\/<\/span>$/;"	a
l00198	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00198"><\/a>00198         <span class="keywordflow">for<\/span> (ifa = ifap; ifa != NULL; ifa = ifa-&gt;ifa_next) {$/;"	a
l00199	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00199"><\/a>00199                 <span class="keywordflow">if<\/span> (strcmp(ifa-&gt;ifa_name, ifname) == 0 &amp;&amp;$/;"	a
l00200	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00200"><\/a>00200                                 ifa-&gt;ifa_addr-&gt;sa_family == AF_INET)$/;"	a
l00201	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00201"><\/a>00201                         <span class="keywordflow">break<\/span>;$/;"	a
l00202	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00202"><\/a>00202         }$/;"	a
l00203	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00203"><\/a>00203         <span class="keywordflow">if<\/span> (ifa == NULL) {$/;"	a
l00204	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00204"><\/a>00204                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"%s: no IPv4 address assigned"<\/span>);$/;"	a
l00205	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00205"><\/a>00205                 <span class="keywordflow">goto<\/span> out;$/;"	a
l00206	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00206"><\/a>00206         }$/;"	a
l00207	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00207"><\/a>00207         str = safe_strdup(inet_ntoa($/;"	a
l00208	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00208"><\/a>00208                                 ((<span class="keyword">struct<\/span> sockaddr_in *)ifa-&gt;ifa_addr)-&gt;sin_addr));$/;"	a
l00209	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00209"><\/a>00209 out:$/;"	a
l00210	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00210"><\/a>00210         freeifaddrs(ifap);$/;"	a
l00211	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00211"><\/a>00211         <span class="keywordflow">return<\/span> str;$/;"	a
l00212	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00212"><\/a>00212 <span class="preprocessor">#else<\/span>$/;"	a
l00213	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00213"><\/a>00213 <span class="preprocessor"><\/span>        <span class="keywordflow">return<\/span> safe_strdup(<span class="stringliteral">"0.0.0.0"<\/span>);$/;"	a
l00214	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00214"><\/a>00214 <span class="preprocessor">#endif<\/span>$/;"	a
l00215	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00215"><\/a>00215 <span class="preprocessor"><\/span>}$/;"	a
l00216	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00217	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00217"><\/a>00217         <span class="keywordtype">char<\/span> *$/;"	a
l00218	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00218"><\/a>00218 get_iface_mac(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ifname)$/;"	a
l00219	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00219"><\/a>00219 {$/;"	a
l00220	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00220"><\/a>00220 <span class="preprocessor">#if defined(__linux__)<\/span>$/;"	a
l00221	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00221"><\/a>00221 <span class="preprocessor"><\/span>        <span class="keywordtype">int<\/span> r, s;$/;"	a
l00222	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00222"><\/a>00222         <span class="keyword">struct <\/span>ifreq ifr;$/;"	a
l00223	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00223"><\/a>00223         <span class="keywordtype">char<\/span> *hwaddr, mac[13];$/;"	a
l00224	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00224"><\/a>00224 $/;"	a
l00225	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00225"><\/a>00225         strcpy(ifr.ifr_name, ifname);$/;"	a
l00226	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00226"><\/a>00226 $/;"	a
l00227	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00227"><\/a>00227         s = socket(PF_INET, SOCK_DGRAM, 0);$/;"	a
l00228	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00228"><\/a>00228         <span class="keywordflow">if<\/span> (-1 == s) {$/;"	a
l00229	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00229"><\/a>00229                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"get_iface_mac socket: %s"<\/span>, strerror(errno));$/;"	a
l00230	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00230"><\/a>00230                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00231	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00231"><\/a>00231         }$/;"	a
l00232	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00232"><\/a>00232 $/;"	a
l00233	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00233"><\/a>00233         r = ioctl(s, SIOCGIFHWADDR, &amp;ifr);$/;"	a
l00234	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00234"><\/a>00234         <span class="keywordflow">if<\/span> (r == -1) {$/;"	a
l00235	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00235"><\/a>00235                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"get_iface_mac ioctl(SIOCGIFHWADDR): %s"<\/span>, strerror(errno));$/;"	a
l00236	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00236"><\/a>00236                 close(s);$/;"	a
l00237	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00237"><\/a>00237                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00238	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00238"><\/a>00238         }$/;"	a
l00239	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00239"><\/a>00239 $/;"	a
l00240	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00240"><\/a>00240         hwaddr = ifr.ifr_hwaddr.sa_data;$/;"	a
l00241	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00241"><\/a>00241         close(s);$/;"	a
l00242	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00242"><\/a>00242         snprintf(mac, <span class="keyword">sizeof<\/span>(mac), <span class="stringliteral">"%02X%02X%02X%02X%02X%02X"<\/span>, $/;"	a
l00243	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00243"><\/a>00243                         hwaddr[0] &amp; 0xFF,$/;"	a
l00244	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00244"><\/a>00244                         hwaddr[1] &amp; 0xFF,$/;"	a
l00245	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00245"><\/a>00245                         hwaddr[2] &amp; 0xFF,$/;"	a
l00246	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00246"><\/a>00246                         hwaddr[3] &amp; 0xFF,$/;"	a
l00247	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00247"><\/a>00247                         hwaddr[4] &amp; 0xFF,$/;"	a
l00248	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00248"><\/a>00248                         hwaddr[5] &amp; 0xFF$/;"	a
l00249	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00249"><\/a>00249                 );$/;"	a
l00250	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00250"><\/a>00250 $/;"	a
l00251	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00251"><\/a>00251         <span class="keywordflow">return<\/span> safe_strdup(mac);$/;"	a
l00252	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00252"><\/a>00252 <span class="preprocessor">#elif defined(__NetBSD__)<\/span>$/;"	a
l00253	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00253"><\/a>00253 <span class="preprocessor"><\/span>        <span class="keyword">struct <\/span>ifaddrs *ifa, *ifap;$/;"	a
l00254	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00254"><\/a>00254         <span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *hwaddr;$/;"	a
l00255	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00255"><\/a>00255         <span class="keywordtype">char<\/span> mac[13], *str = NULL;$/;"	a
l00256	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00256"><\/a>00256         <span class="keyword">struct <\/span>sockaddr_dl *sdl;$/;"	a
l00257	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00257"><\/a>00257 $/;"	a
l00258	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00258"><\/a>00258         <span class="keywordflow">if<\/span> (getifaddrs(&amp;ifap) == -1) {$/;"	a
l00259	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00259"><\/a>00259                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"getifaddrs(): %s"<\/span>, strerror(errno));$/;"	a
l00260	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00260"><\/a>00260                 <span class="keywordflow">return<\/span> NULL;$/;"	a
l00261	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00261"><\/a>00261         }$/;"	a
l00262	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00262"><\/a>00262         <span class="keywordflow">for<\/span> (ifa = ifap; ifa != NULL; ifa = ifa-&gt;ifa_next) {$/;"	a
l00263	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00263"><\/a>00263                 <span class="keywordflow">if<\/span> (strcmp(ifa-&gt;ifa_name, ifname) == 0 &amp;&amp;$/;"	a
l00264	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00264"><\/a>00264                                 ifa-&gt;ifa_addr-&gt;sa_family == AF_LINK)$/;"	a
l00265	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00265"><\/a>00265                         <span class="keywordflow">break<\/span>;$/;"	a
l00266	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00266"><\/a>00266         }$/;"	a
l00267	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00267"><\/a>00267         <span class="keywordflow">if<\/span> (ifa == NULL) {$/;"	a
l00268	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00268"><\/a>00268                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"%s: no link-layer address assigned"<\/span>);$/;"	a
l00269	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00269"><\/a>00269                 <span class="keywordflow">goto<\/span> out;$/;"	a
l00270	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00270"><\/a>00270         }$/;"	a
l00271	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00271"><\/a>00271         sdl = (<span class="keyword">struct <\/span>sockaddr_dl *)ifa-&gt;ifa_addr;$/;"	a
l00272	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00272"><\/a>00272         hwaddr = LLADDR(sdl);$/;"	a
l00273	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00273"><\/a>00273         snprintf(mac, <span class="keyword">sizeof<\/span>(mac), <span class="stringliteral">"%02X%02X%02X%02X%02X%02X"<\/span>,$/;"	a
l00274	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00274"><\/a>00274                         hwaddr[0] &amp; 0xFF, hwaddr[1] &amp; 0xFF,$/;"	a
l00275	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00275"><\/a>00275                         hwaddr[2] &amp; 0xFF, hwaddr[3] &amp; 0xFF,$/;"	a
l00276	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00276"><\/a>00276                         hwaddr[4] &amp; 0xFF, hwaddr[5] &amp; 0xFF);$/;"	a
l00277	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00277"><\/a>00277 $/;"	a
l00278	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00278"><\/a>00278         str = safe_strdup(mac);$/;"	a
l00279	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00279"><\/a>00279 out:$/;"	a
l00280	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00280"><\/a>00280         freeifaddrs(ifap);$/;"	a
l00281	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00281"><\/a>00281         <span class="keywordflow">return<\/span> str;$/;"	a
l00282	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00282"><\/a>00282 <span class="preprocessor">#else<\/span>$/;"	a
l00283	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00283"><\/a>00283 <span class="preprocessor"><\/span>        <span class="keywordflow">return<\/span> NULL;$/;"	a
l00284	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00284"><\/a>00284 <span class="preprocessor">#endif<\/span>$/;"	a
l00285	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00285"><\/a>00285 <span class="preprocessor"><\/span>}$/;"	a
l00286	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00286"><\/a>00286 $/;"	a
l00287	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00287"><\/a>00287         <span class="keywordtype">char<\/span> *$/;"	a
l00288	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00288"><\/a>00288 get_ext_iface(<span class="keywordtype">void<\/span>)$/;"	a
l00289	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00289"><\/a>00289 {$/;"	a
l00290	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00290"><\/a>00290 <span class="preprocessor">#ifdef __linux__<\/span>$/;"	a
l00291	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00291"><\/a>00291 <span class="preprocessor"><\/span>        FILE *input;$/;"	a
l00292	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00292"><\/a>00292         <span class="keywordtype">char<\/span> *device, *gw;$/;"	a
l00293	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00293"><\/a>00293         <span class="keywordtype">int<\/span> i = 1;$/;"	a
l00294	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00294"><\/a>00294         <span class="keywordtype">int<\/span> keep_detecting = 1;$/;"	a
l00295	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00295"><\/a>00295         pthread_cond_t          cond = PTHREAD_COND_INITIALIZER;$/;"	a
l00296	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00296"><\/a>00296         pthread_mutex_t         cond_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	a
l00297	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00297"><\/a>00297         <span class="keyword">struct  <\/span>timespec        timeout;$/;"	a
l00298	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00298"><\/a>00298         device = (<span class="keywordtype">char<\/span> *)malloc(16);$/;"	a
l00299	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00299"><\/a>00299         gw = (<span class="keywordtype">char<\/span> *)malloc(16);$/;"	a
l00300	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00300"><\/a>00300         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"get_ext_iface(): Autodectecting the external interface from routing table"<\/span>);$/;"	a
l00301	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00301"><\/a>00301         <span class="keywordflow">while<\/span>(keep_detecting) {$/;"	a
l00302	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00302"><\/a>00302                 input = fopen(<span class="stringliteral">"\/proc\/net\/route"<\/span>, <span class="stringliteral">"r"<\/span>);$/;"	a
l00303	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00303"><\/a>00303                 <span class="keywordflow">while<\/span> (!feof(input)) {$/;"	a
l00304	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00304"><\/a>00304                         <span class="comment">\/* XXX scanf(3) is unsafe, risks overrun *\/<\/span> $/;"	a
l00305	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00305"><\/a>00305                         fscanf(input, <span class="stringliteral">"%s %s %*s %*s %*s %*s %*s %*s %*s %*s %*s\\n"<\/span>, device, gw);$/;"	a
l00306	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00306"><\/a>00306                         <span class="keywordflow">if<\/span> (strcmp(gw, <span class="stringliteral">"00000000"<\/span>) == 0) {$/;"	a
l00307	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00307"><\/a>00307                                 free(gw);$/;"	a
l00308	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00308"><\/a>00308                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"get_ext_iface(): Detected %s as the default interface after try %d"<\/span>, device, i);$/;"	a
l00309	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00309"><\/a>00309                                 <span class="keywordflow">return<\/span> device;$/;"	a
l00310	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00310"><\/a>00310                         }$/;"	a
l00311	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00311"><\/a>00311                 }$/;"	a
l00312	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00312"><\/a>00312                 fclose(input);$/;"	a
l00313	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00313"><\/a>00313                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"get_ext_iface(): Failed to detect the external interface after try %d (maybe the interface is not up yet?).  Retry limit: %d"<\/span>, i, <a class="code" href="conf_8h.html#771a6a60dbaa6c7532ab6cd31b397f7d">NUM_EXT_INTERFACE_DETECT_RETRY<\/a>);$/;"	a
l00314	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00314"><\/a>00314                 <span class="comment">\/* Sleep for EXT_INTERFACE_DETECT_RETRY_INTERVAL seconds *\/<\/span>$/;"	a
l00315	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00315"><\/a>00315                 timeout.tv_sec = time(NULL) + <a class="code" href="conf_8h.html#b67c119b3d066438d4c3405b518bb289">EXT_INTERFACE_DETECT_RETRY_INTERVAL<\/a>;$/;"	a
l00316	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00316"><\/a>00316                 timeout.tv_nsec = 0;$/;"	a
l00317	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00317"><\/a>00317                 <span class="comment">\/* Mutex must be locked for pthread_cond_timedwait... *\/<\/span>$/;"	a
l00318	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00318"><\/a>00318                 pthread_mutex_lock(&amp;cond_mutex);        $/;"	a
l00319	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00319"><\/a>00319                 <span class="comment">\/* Thread safe "sleep" *\/<\/span>$/;"	a
l00320	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00320"><\/a>00320                 pthread_cond_timedwait(&amp;cond, &amp;cond_mutex, &amp;timeout);$/;"	a
l00321	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00321"><\/a>00321                 <span class="comment">\/* No longer needs to be locked *\/<\/span>$/;"	a
l00322	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00322"><\/a>00322                 pthread_mutex_unlock(&amp;cond_mutex);$/;"	a
l00323	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00323"><\/a>00323                 <span class="comment">\/\/for (i=1; i&lt;=NUM_EXT_INTERFACE_DETECT_RETRY; i++) {<\/span>$/;"	a
l00324	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00324"><\/a>00324                 <span class="keywordflow">if<\/span> (<a class="code" href="conf_8h.html#771a6a60dbaa6c7532ab6cd31b397f7d">NUM_EXT_INTERFACE_DETECT_RETRY<\/a> != 0 &amp;&amp; i&gt;<a class="code" href="conf_8h.html#771a6a60dbaa6c7532ab6cd31b397f7d">NUM_EXT_INTERFACE_DETECT_RETRY<\/a>) {$/;"	a
l00325	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00325"><\/a>00325                         keep_detecting = 0;$/;"	a
l00326	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00326"><\/a>00326                 }$/;"	a
l00327	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00327"><\/a>00327                 i++;$/;"	a
l00328	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00328"><\/a>00328         }$/;"	a
l00329	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00329"><\/a>00329         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"get_ext_iface(): Failed to detect the external interface after %d tries, aborting"<\/span>, i);$/;"	a
l00330	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00330"><\/a>00330         exit(1);$/;"	a
l00331	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00331"><\/a>00331         free(device);$/;"	a
l00332	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00332"><\/a>00332         free(gw);$/;"	a
l00333	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00333"><\/a>00333 <span class="preprocessor">#endif<\/span>$/;"	a
l00334	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00334"><\/a>00334 <span class="preprocessor"><\/span>        <span class="keywordflow">return<\/span> NULL;$/;"	a
l00335	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00335"><\/a>00335         }$/;"	a
l00336	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00336"><\/a>00336 $/;"	a
l00337	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00337"><\/a>00337         <span class="keywordtype">void<\/span> mark_online() {$/;"	a
l00338	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00338"><\/a>00338                 <span class="keywordtype">int<\/span> before;$/;"	a
l00339	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00339"><\/a>00339                 <span class="keywordtype">int<\/span> after;$/;"	a
l00340	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00340"><\/a>00340 $/;"	a
l00341	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00341"><\/a>00341                 before = is_online();$/;"	a
l00342	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00342"><\/a>00342                 time(&amp;last_online_time);$/;"	a
l00343	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00343"><\/a>00343                 after = is_online();$/;"	a
l00344	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00344"><\/a>00344 $/;"	a
l00345	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00345"><\/a>00345                 <span class="keywordflow">if<\/span> (before != after) {$/;"	a
l00346	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00346"><\/a>00346                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"ONLINE status became %s"<\/span>, (after ? <span class="stringliteral">"ON"<\/span> : <span class="stringliteral">"OFF"<\/span>));$/;"	a
l00347	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00347"><\/a>00347                 }$/;"	a
l00348	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00348"><\/a>00348 $/;"	a
l00349	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00349"><\/a>00349         }$/;"	a
l00350	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00350"><\/a>00350 $/;"	a
l00351	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00351"><\/a>00351         <span class="keywordtype">void<\/span> mark_offline() {$/;"	a
l00352	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00352"><\/a>00352                 <span class="keywordtype">int<\/span> before;$/;"	a
l00353	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00353"><\/a>00353                 <span class="keywordtype">int<\/span> after;$/;"	a
l00354	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00354"><\/a>00354 $/;"	a
l00355	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00355"><\/a>00355                 before = is_online();$/;"	a
l00356	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00356"><\/a>00356                 time(&amp;last_offline_time);$/;"	a
l00357	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00357"><\/a>00357                 after = is_online();$/;"	a
l00358	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00358"><\/a>00358 $/;"	a
l00359	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00359"><\/a>00359                 <span class="keywordflow">if<\/span> (before != after) {$/;"	a
l00360	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00360"><\/a>00360                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"ONLINE status became %s"<\/span>, (after ? <span class="stringliteral">"ON"<\/span> : <span class="stringliteral">"OFF"<\/span>));$/;"	a
l00361	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00361"><\/a>00361                 }$/;"	a
l00362	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00362"><\/a>00362 $/;"	a
l00363	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00363"><\/a>00363                 <span class="comment">\/* If we're offline it definately means the auth server is offline *\/<\/span>$/;"	a
l00364	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00364"><\/a>00364                 mark_auth_offline();$/;"	a
l00365	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00365"><\/a>00365 $/;"	a
l00366	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00366"><\/a>00366         }$/;"	a
l00367	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00367"><\/a>00367 $/;"	a
l00368	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00368"><\/a>00368         <span class="keywordtype">int<\/span> is_online() {$/;"	a
l00369	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00369"><\/a>00369                 <span class="keywordflow">if<\/span> (last_online_time == 0 || (last_offline_time - last_online_time) &gt;= (<a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;checkinterval * 2) ) {$/;"	a
l00370	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00370"><\/a>00370                         <span class="comment">\/* We're probably offline *\/<\/span>$/;"	a
l00371	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00371"><\/a>00371                         <span class="keywordflow">return<\/span> (0);$/;"	a
l00372	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00372"><\/a>00372                 }$/;"	a
l00373	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00373"><\/a>00373                 <span class="keywordflow">else<\/span> {$/;"	a
l00374	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00374"><\/a>00374                         <span class="comment">\/* We're probably online *\/<\/span>$/;"	a
l00375	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00375"><\/a>00375                         <span class="keywordflow">return<\/span> (1);$/;"	a
l00376	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00376"><\/a>00376                 }$/;"	a
l00377	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00377"><\/a>00377         }$/;"	a
l00378	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00378"><\/a>00378 $/;"	a
l00379	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00379"><\/a>00379         <span class="keywordtype">void<\/span> mark_auth_online() {$/;"	a
l00380	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00380"><\/a>00380                 <span class="keywordtype">int<\/span> before;$/;"	a
l00381	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00381"><\/a>00381                 <span class="keywordtype">int<\/span> after;$/;"	a
l00382	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00382"><\/a>00382 $/;"	a
l00383	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00383"><\/a>00383                 before = is_auth_online();$/;"	a
l00384	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00384"><\/a>00384                 time(&amp;last_auth_online_time);$/;"	a
l00385	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00385"><\/a>00385                 after = is_auth_online();$/;"	a
l00386	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00386"><\/a>00386 $/;"	a
l00387	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00387"><\/a>00387                 <span class="keywordflow">if<\/span> (before != after) {$/;"	a
l00388	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00388"><\/a>00388                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"AUTH_ONLINE status became %s"<\/span>, (after ? <span class="stringliteral">"ON"<\/span> : <span class="stringliteral">"OFF"<\/span>));$/;"	a
l00389	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00389"><\/a>00389                 }$/;"	a
l00390	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00390"><\/a>00390 $/;"	a
l00391	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00391"><\/a>00391                 <span class="comment">\/* If auth server is online it means we're definately online *\/<\/span>$/;"	a
l00392	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00392"><\/a>00392                 mark_online();$/;"	a
l00393	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00393"><\/a>00393 $/;"	a
l00394	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00394"><\/a>00394         }$/;"	a
l00395	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00395"><\/a>00395 $/;"	a
l00396	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00396"><\/a>00396         <span class="keywordtype">void<\/span> mark_auth_offline() {$/;"	a
l00397	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00397"><\/a>00397                 <span class="keywordtype">int<\/span> before;$/;"	a
l00398	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00398"><\/a>00398                 <span class="keywordtype">int<\/span> after;$/;"	a
l00399	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00399"><\/a>00399 $/;"	a
l00400	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00400"><\/a>00400                 before = is_auth_online();$/;"	a
l00401	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00401"><\/a>00401                 time(&amp;last_auth_offline_time);$/;"	a
l00402	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00402"><\/a>00402                 after = is_auth_online();$/;"	a
l00403	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00403"><\/a>00403 $/;"	a
l00404	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00404"><\/a>00404                 <span class="keywordflow">if<\/span> (before != after) {$/;"	a
l00405	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00405"><\/a>00405                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"AUTH_ONLINE status became %s"<\/span>, (after ? <span class="stringliteral">"ON"<\/span> : <span class="stringliteral">"OFF"<\/span>));$/;"	a
l00406	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00406"><\/a>00406                 }$/;"	a
l00407	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00407"><\/a>00407 $/;"	a
l00408	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00408"><\/a>00408         }$/;"	a
l00409	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00409"><\/a>00409 $/;"	a
l00410	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00410"><\/a>00410         <span class="keywordtype">int<\/span> is_auth_online() {$/;"	a
l00411	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00411"><\/a>00411                 <span class="keywordflow">if<\/span> (!is_online()) {$/;"	a
l00412	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00412"><\/a>00412                         <span class="comment">\/* If we're not online auth is definately not online :) *\/<\/span>$/;"	a
l00413	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00413"><\/a>00413                         <span class="keywordflow">return<\/span> (0);$/;"	a
l00414	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00414"><\/a>00414                 }$/;"	a
l00415	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00415"><\/a>00415                 <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (last_auth_online_time == 0 || (last_auth_offline_time - last_auth_online_time) &gt;= (<a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>()-&gt;checkinterval * 2) ) {$/;"	a
l00416	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00416"><\/a>00416                         <span class="comment">\/* Auth is  probably offline *\/<\/span>$/;"	a
l00417	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00417"><\/a>00417                         <span class="keywordflow">return<\/span> (0);$/;"	a
l00418	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00418"><\/a>00418                 }$/;"	a
l00419	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00419"><\/a>00419                 <span class="keywordflow">else<\/span> {$/;"	a
l00420	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00420"><\/a>00420                         <span class="comment">\/* Auth is probably online *\/<\/span>$/;"	a
l00421	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00421"><\/a>00421                         <span class="keywordflow">return<\/span> (1);$/;"	a
l00422	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00422"><\/a>00422                 }$/;"	a
l00423	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00423"><\/a>00423         }$/;"	a
l00424	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00424"><\/a>00424 $/;"	a
l00425	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00425"><\/a>00425         <span class="comment">\/*<\/span>$/;"	a
l00426	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00426"><\/a>00426 <span class="comment">         * @return A string containing human-readable status text. MUST BE free()d by caller<\/span>$/;"	a
l00427	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00427"><\/a>00427 <span class="comment">         *\/<\/span>$/;"	a
l00428	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00428"><\/a>00428         <span class="keywordtype">char<\/span> * get_status_text() {$/;"	a
l00429	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00429"><\/a>00429                 <span class="keywordtype">char<\/span> buffer[STATUS_BUF_SIZ];$/;"	a
l00430	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00430"><\/a>00430                 ssize_t len;$/;"	a
l00431	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00431"><\/a>00431                 <a class="code" href="structs__config.html">s_config<\/a> *config;$/;"	a
l00432	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00432"><\/a>00432                 <a class="code" href="struct__auth__serv__t.html">t_auth_serv<\/a> *auth_server;$/;"	a
l00433	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00433"><\/a>00433                 <a class="code" href="struct__t__client.html">t_client<\/a>        *first;$/;"	a
l00434	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00434"><\/a>00434                 <span class="keywordtype">int<\/span>             count;$/;"	a
l00435	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00435"><\/a>00435                 <span class="keywordtype">unsigned<\/span> <span class="keywordtype">long<\/span> <span class="keywordtype">int<\/span> uptime = 0;$/;"	a
l00436	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00436"><\/a>00436                 <span class="keywordtype">unsigned<\/span> <span class="keywordtype">int<\/span> days = 0, hours = 0, minutes = 0, seconds = 0;$/;"	a
l00437	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00437"><\/a>00437                 <a class="code" href="struct__trusted__mac__t.html">t_trusted_mac<\/a> *p;$/;"	a
l00438	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00438"><\/a>00438 $/;"	a
l00439	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00439"><\/a>00439                 len = 0;$/;"	a
l00440	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00440"><\/a>00440                 snprintf(buffer, (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"WiFiDog status\\n\\n"<\/span>);$/;"	a
l00441	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00441"><\/a>00441                 len = strlen(buffer);$/;"	a
l00442	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00442"><\/a>00442 $/;"	a
l00443	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00443"><\/a>00443                 uptime = time(NULL) - started_time;$/;"	a
l00444	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00444"><\/a>00444                 days    = uptime \/ (24 * 60 * 60);$/;"	a
l00445	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00445"><\/a>00445                 uptime -= days * (24 * 60 * 60);$/;"	a
l00446	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00446"><\/a>00446                 hours   = uptime \/ (60 * 60);$/;"	a
l00447	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00447"><\/a>00447                 uptime -= hours * (60 * 60);$/;"	a
l00448	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00448"><\/a>00448                 minutes = uptime \/ 60;$/;"	a
l00449	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00449"><\/a>00449                 uptime -= minutes * 60;$/;"	a
l00450	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00450"><\/a>00450                 seconds = uptime;$/;"	a
l00451	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00451"><\/a>00451 $/;"	a
l00452	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00452"><\/a>00452                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Version: "<\/span> VERSION <span class="stringliteral">"\\n"<\/span>);$/;"	a
l00453	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00453"><\/a>00453                 len = strlen(buffer);$/;"	a
l00454	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00454"><\/a>00454 $/;"	a
l00455	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00455"><\/a>00455                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Uptime: %ud %uh %um %us\\n"<\/span>, days, hours, minutes, seconds);$/;"	a
l00456	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00456"><\/a>00456                 len = strlen(buffer);$/;"	a
l00457	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00457"><\/a>00457 $/;"	a
l00458	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00458"><\/a>00458                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Has been restarted: "<\/span>);$/;"	a
l00459	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00459"><\/a>00459                 len = strlen(buffer);$/;"	a
l00460	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00460"><\/a>00460                 <span class="keywordflow">if<\/span> (restart_orig_pid) {$/;"	a
l00461	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00461"><\/a>00461                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"yes (from PID %d)\\n"<\/span>, restart_orig_pid);$/;"	a
l00462	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00462"><\/a>00462                         len = strlen(buffer);$/;"	a
l00463	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00463"><\/a>00463                 }$/;"	a
l00464	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00464"><\/a>00464                 <span class="keywordflow">else<\/span> {$/;"	a
l00465	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00465"><\/a>00465                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"no\\n"<\/span>);$/;"	a
l00466	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00466"><\/a>00466                         len = strlen(buffer);$/;"	a
l00467	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00467"><\/a>00467                 }$/;"	a
l00468	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00468"><\/a>00468 $/;"	a
l00469	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00469"><\/a>00469                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Internet Connectivity: %s\\n"<\/span>, (is_online() ? <span class="stringliteral">"yes"<\/span> : <span class="stringliteral">"no"<\/span>));$/;"	a
l00470	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00470"><\/a>00470                 len = strlen(buffer);$/;"	a
l00471	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00471"><\/a>00471 $/;"	a
l00472	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00472"><\/a>00472                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Auth server reachable: %s\\n"<\/span>, (is_auth_online() ? <span class="stringliteral">"yes"<\/span> : <span class="stringliteral">"no"<\/span>));$/;"	a
l00473	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00473"><\/a>00473                 len = strlen(buffer);$/;"	a
l00474	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00474"><\/a>00474 $/;"	a
l00475	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00475"><\/a>00475                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"Clients served this session: %lu\\n\\n"<\/span>, served_this_session);$/;"	a
l00476	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00476"><\/a>00476                 len = strlen(buffer);$/;"	a
l00477	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00477"><\/a>00477 $/;"	a
l00478	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00478"><\/a>00478                 LOCK_CLIENT_LIST();$/;"	a
l00479	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00479"><\/a>00479 $/;"	a
l00480	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00480"><\/a>00480                 first = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>();$/;"	a
l00481	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00481"><\/a>00481 $/;"	a
l00482	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00482"><\/a>00482                 <span class="keywordflow">if<\/span> (first == NULL) {$/;"	a
l00483	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00483"><\/a>00483                         count = 0;$/;"	a
l00484	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00484"><\/a>00484                 } <span class="keywordflow">else<\/span> {$/;"	a
l00485	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00485"><\/a>00485                         count = 1;$/;"	a
l00486	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00486"><\/a>00486                         <span class="keywordflow">while<\/span> (first-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a> != NULL) {$/;"	a
l00487	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00487"><\/a>00487                                 first = first-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00488	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00488"><\/a>00488                                 count++;$/;"	a
l00489	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00489"><\/a>00489                         }$/;"	a
l00490	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00490"><\/a>00490                 }$/;"	a
l00491	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00491"><\/a>00491 $/;"	a
l00492	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00492"><\/a>00492                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"%d clients "<\/span>$/;"	a
l00493	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00493"><\/a>00493                                 <span class="stringliteral">"connected.\\n"<\/span>, count);$/;"	a
l00494	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00494"><\/a>00494                 len = strlen(buffer);$/;"	a
l00495	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00495"><\/a>00495 $/;"	a
l00496	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00496"><\/a>00496                 first = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>();$/;"	a
l00497	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00497"><\/a>00497 $/;"	a
l00498	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00498"><\/a>00498                 count = 0;$/;"	a
l00499	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00499"><\/a>00499                 <span class="keywordflow">while<\/span> (first != NULL) {$/;"	a
l00500	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00500"><\/a>00500                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"\\nClient %d\\n"<\/span>, count);$/;"	a
l00501	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00501"><\/a>00501                         len = strlen(buffer);$/;"	a
l00502	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00502"><\/a>00502 $/;"	a
l00503	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00503"><\/a>00503                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  IP: %s MAC: %s\\n"<\/span>, first-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, first-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>);$/;"	a
l00504	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00504"><\/a>00504                         len = strlen(buffer);$/;"	a
l00505	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00505"><\/a>00505 $/;"	a
l00506	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00506"><\/a>00506                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  Token: %s\\n"<\/span>, first-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>);$/;"	a
l00507	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00507"><\/a>00507                         len = strlen(buffer);$/;"	a
l00508	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00508"><\/a>00508 $/;"	a
l00509	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00509"><\/a>00509                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  Downloaded: %llu\\n  Uploaded: %llu\\n"<\/span> , first-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>, first-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>);$/;"	a
l00510	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00510"><\/a>00510                         len = strlen(buffer);$/;"	a
l00511	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00511"><\/a>00511 $/;"	a
l00512	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00512"><\/a>00512                         count++;$/;"	a
l00513	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00513"><\/a>00513                         first = first-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00514	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00514"><\/a>00514                 }$/;"	a
l00515	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00515"><\/a>00515 $/;"	a
l00516	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00516"><\/a>00516                 UNLOCK_CLIENT_LIST();$/;"	a
l00517	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00517"><\/a>00517 $/;"	a
l00518	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00518"><\/a>00518                 config = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00519	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00519"><\/a>00519 $/;"	a
l00520	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00520"><\/a>00520                 <span class="keywordflow">if<\/span> (config-&gt;<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a> != NULL) {$/;"	a
l00521	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00521"><\/a>00521                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"\\nTrusted MAC addresses:\\n"<\/span>);$/;"	a
l00522	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00522"><\/a>00522                         len = strlen(buffer);$/;"	a
l00523	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00523"><\/a>00523 $/;"	a
l00524	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00524"><\/a>00524                         <span class="keywordflow">for<\/span> (p = config-&gt;<a class="code" href="structs__config.html#205a18044b75a27d255ca3fdf30c0d64" title="list of trusted macs">trustedmaclist<\/a>; p != NULL; p = p-&gt;<a class="code" href="struct__trusted__mac__t.html#949f4da24c7f33f4a8463dac5d9d565c">next<\/a>) {$/;"	a
l00525	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00525"><\/a>00525                                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  %s\\n"<\/span>, p-&gt;<a class="code" href="struct__trusted__mac__t.html#4e4381cfff2bbfbd9455640102b21f14">mac<\/a>);$/;"	a
l00526	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00526"><\/a>00526                                 len = strlen(buffer);$/;"	a
l00527	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00527"><\/a>00527                         }$/;"	a
l00528	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00528"><\/a>00528                 }$/;"	a
l00529	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00529"><\/a>00529 $/;"	a
l00530	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00530"><\/a>00530                 snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"\\nAuthentication servers:\\n"<\/span>);$/;"	a
l00531	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00531"><\/a>00531                 len = strlen(buffer);$/;"	a
l00532	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00532"><\/a>00532 $/;"	a
l00533	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00533"><\/a>00533                 LOCK_CONFIG();$/;"	a
l00534	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00534"><\/a>00534 $/;"	a
l00535	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00535"><\/a>00535                 <span class="keywordflow">for<\/span> (auth_server = config-&gt;<a class="code" href="structs__config.html#860efab2a31502f548fc188ba2243f4e" title="Auth servers list.">auth_servers<\/a>; auth_server != NULL; auth_server = auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#7e294f129187f1449244d266028c68e5">next<\/a>) {$/;"	a
l00536	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00536"><\/a>00536                         snprintf((buffer + len), (<span class="keyword">sizeof<\/span>(buffer) - len), <span class="stringliteral">"  Host: %s (%s)\\n"<\/span>, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#175f8cddd51f79e81679c70e2ce172f3" title="Hostname of the central server.">authserv_hostname<\/a>, auth_server-&gt;<a class="code" href="struct__auth__serv__t.html#bb67841d88cfe9fd79f9b965dd72b28e" title="Last ip used by authserver.">last_ip<\/a>);$/;"	a
l00537	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00537"><\/a>00537                         len = strlen(buffer);$/;"	a
l00538	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00538"><\/a>00538                 }$/;"	a
l00539	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00539"><\/a>00539 $/;"	a
l00540	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00540"><\/a>00540                 UNLOCK_CONFIG();$/;"	a
l00541	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00541"><\/a>00541 $/;"	a
l00542	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00542"><\/a>00542                 <span class="keywordflow">return<\/span> safe_strdup(buffer);$/;"	a
l00543	install/share/doc/wifidog-20090925/html/util_8c-source.html	/^<a name="l00543"><\/a>00543         }$/;"	a
0cf123f608ee86a2bc577164c4e58bfc	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0cf123f608ee86a2bc577164c4e58bfc"><\/a><!-- doxytag: member="util.c::mark_auth_offline" ref="0cf123f608ee86a2bc577164c4e58bfc" args="()" -->$/;"	a
0fbc87940c4a8d7907d13b711a19a68f	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0fbc87940c4a8d7907d13b711a19a68f"><\/a><!-- doxytag: member="util.c::ghbn_mutex" ref="0fbc87940c4a8d7907d13b711a19a68f" args="" -->$/;"	a
1292062c6863401b0c8b6743bb746df7	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1292062c6863401b0c8b6743bb746df7"><\/a><!-- doxytag: member="util.c::get_ext_iface" ref="1292062c6863401b0c8b6743bb746df7" args="(void)" -->$/;"	a
3236543c5f99e9273a665f875e0d3061	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3236543c5f99e9273a665f875e0d3061"><\/a><!-- doxytag: member="util.c::wd_gethostbyname" ref="3236543c5f99e9273a665f875e0d3061" args="(const char *name)" -->$/;"	a
3d50bd009ad5dbff8e63077b05925011	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3d50bd009ad5dbff8e63077b05925011"><\/a><!-- doxytag: member="util.c::last_auth_offline_time" ref="3d50bd009ad5dbff8e63077b05925011" args="" -->$/;"	a
41bb1ae6f994fced016bcd412e99f410	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="41bb1ae6f994fced016bcd412e99f410"><\/a><!-- doxytag: member="util.c::is_online" ref="41bb1ae6f994fced016bcd412e99f410" args="()" -->$/;"	a
4e7610fe011a6fcc90cfd7cc57f90c96	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4e7610fe011a6fcc90cfd7cc57f90c96"><\/a><!-- doxytag: member="util.c::is_auth_online" ref="4e7610fe011a6fcc90cfd7cc57f90c96" args="()" -->$/;"	a
566a5213a52fcf010039d572da5c7490	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="566a5213a52fcf010039d572da5c7490"><\/a><!-- doxytag: member="util.c::mark_online" ref="566a5213a52fcf010039d572da5c7490" args="()" -->$/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	install/share/doc/wifidog-20090925/html/util_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="util.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
710a60241e13983640602a02301fe8cc	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="710a60241e13983640602a02301fe8cc"><\/a><!-- doxytag: member="util.c::last_offline_time" ref="710a60241e13983640602a02301fe8cc" args="" -->$/;"	a
71d23e774a069ca0b4617c40fc262f4e	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="71d23e774a069ca0b4617c40fc262f4e"><\/a><!-- doxytag: member="util.c::mark_offline" ref="71d23e774a069ca0b4617c40fc262f4e" args="()" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/util_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b374ff230d9977e6b952612d61689f39	install/share/doc/wifidog-20090925/html/util_8c.html	/^<a class="anchor" name="b374ff230d9977e6b952612d61689f39"><\/a><!-- doxytag: member="util.c::config_mutex" ref="b374ff230d9977e6b952612d61689f39" args="" -->$/;"	a
b55a47ffb38b07a1c8d865c4821d52cc	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b55a47ffb38b07a1c8d865c4821d52cc"><\/a><!-- doxytag: member="util.c::restart_orig_pid" ref="b55a47ffb38b07a1c8d865c4821d52cc" args="" -->$/;"	a
c4c06e11b18189acbe7ca7c1bb1d1fb8	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c4c06e11b18189acbe7ca7c1bb1d1fb8"><\/a><!-- doxytag: member="util.c::get_status_text" ref="c4c06e11b18189acbe7ca7c1bb1d1fb8" args="()" -->$/;"	a
d309c457ebb918832a3f7910ba2c7b3a	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d309c457ebb918832a3f7910ba2c7b3a"><\/a><!-- doxytag: member="util.c::served_this_session" ref="d309c457ebb918832a3f7910ba2c7b3a" args="" -->$/;"	a
d3c0ab429f95535fa08bc6a4fb884bab	install/share/doc/wifidog-20090925/html/util_8c.html	/^<a class="anchor" name="d3c0ab429f95535fa08bc6a4fb884bab"><\/a><!-- doxytag: member="util.c::execute" ref="d3c0ab429f95535fa08bc6a4fb884bab" args="(char *cmd_line, int quiet)" -->$/;"	a
d90431781df5a681e0930efb6e88400b	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d90431781df5a681e0930efb6e88400b"><\/a><!-- doxytag: member="util.c::get_iface_ip" ref="d90431781df5a681e0930efb6e88400b" args="(const char *ifname)" -->$/;"	a
e7518947376bdd01423c520485ebaf14	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e7518947376bdd01423c520485ebaf14"><\/a><!-- doxytag: member="util.c::last_auth_online_time" ref="e7518947376bdd01423c520485ebaf14" args="" -->$/;"	a
eeca5446f2051d6e199c2cf68362fd75	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eeca5446f2051d6e199c2cf68362fd75"><\/a><!-- doxytag: member="util.c::mark_auth_online" ref="eeca5446f2051d6e199c2cf68362fd75" args="()" -->$/;"	a
f0eea6ebdbba8400df1fe94af7991211	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f0eea6ebdbba8400df1fe94af7991211"><\/a><!-- doxytag: member="util.c::started_time" ref="f0eea6ebdbba8400df1fe94af7991211" args="" -->$/;"	a
f62d0c4e60d6cc70ac8e6e44231935e8	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f62d0c4e60d6cc70ac8e6e44231935e8"><\/a><!-- doxytag: member="util.c::get_iface_mac" ref="f62d0c4e60d6cc70ac8e6e44231935e8" args="(const char *ifname)" -->$/;"	a
f8eac168be39d5b2ebce70dfff1034ad	install/share/doc/wifidog-20090925/html/util_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f8eac168be39d5b2ebce70dfff1034ad"><\/a><!-- doxytag: member="util.c::last_online_time" ref="f8eac168be39d5b2ebce70dfff1034ad" args="" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<h1>util.h<\/h1><a href="util_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: util.h 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _UTIL_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _UTIL_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define STATUS_BUF_SIZ  16384<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor"><\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00034"><\/a>00034 <span class="keywordtype">int<\/span> <a class="code" href="util_8c.html#d3c0ab429f95535fa08bc6a4fb884bab" title="Execute a shell command.">execute<\/a>(<span class="keywordtype">char<\/span> *cmd_line, <span class="keywordtype">int<\/span> quiet);$/;"	a
l00035	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="keyword">struct <\/span>in_addr *wd_gethostbyname(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *name);$/;"	a
l00036	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00037"><\/a>00037 <span class="comment">\/* @brief Get IP address of an interface *\/<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="keywordtype">char<\/span> *get_iface_ip(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ifname);$/;"	a
l00039	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00039"><\/a>00039 $/;"	a
l00040	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00040"><\/a>00040 <span class="comment">\/* @brief Get MAC address of an interface *\/<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00041"><\/a>00041 <span class="keywordtype">char<\/span> *get_iface_mac(<span class="keyword">const<\/span> <span class="keywordtype">char<\/span> *ifname);$/;"	a
l00042	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="comment">\/* @brief Get interface name of default gateway *\/<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00044"><\/a>00044 <span class="keywordtype">char<\/span> *get_ext_iface (<span class="keywordtype">void<\/span>);$/;"	a
l00045	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00045"><\/a>00045 $/;"	a
l00046	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00046"><\/a>00046 <span class="comment">\/* @brief Sets hint that an online action (dns\/connect\/etc using WAN) succeeded *\/<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00047"><\/a>00047 <span class="keywordtype">void<\/span> mark_online();$/;"	a
l00048	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00048"><\/a>00048 <span class="comment">\/* @brief Sets hint that an online action (dns\/connect\/etc using WAN) failed *\/<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00049"><\/a>00049 <span class="keywordtype">void<\/span> mark_offline();$/;"	a
l00050	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00050"><\/a>00050 <span class="comment">\/* @brief Returns a guess (true or false) on whether we're online or not based on previous calls to mark_online and mark_offline *\/<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00051"><\/a>00051 <span class="keywordtype">int<\/span> is_online();$/;"	a
l00052	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00052"><\/a>00052 $/;"	a
l00053	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00053"><\/a>00053 <span class="comment">\/* @brief Sets hint that an auth server online action succeeded *\/<\/span>$/;"	a
l00054	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00054"><\/a>00054 <span class="keywordtype">void<\/span> mark_auth_online();$/;"	a
l00055	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00055"><\/a>00055 <span class="comment">\/* @brief Sets hint that an auth server online action failed *\/<\/span>$/;"	a
l00056	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00056"><\/a>00056 <span class="keywordtype">void<\/span> mark_auth_offline();$/;"	a
l00057	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00057"><\/a>00057 <span class="comment">\/* @brief Returns a guess (true or false) on whether we're an auth server is online or not based on previous calls to mark_auth_online and mark_auth_offline *\/<\/span>$/;"	a
l00058	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00058"><\/a>00058 <span class="keywordtype">int<\/span> is_auth_online();$/;"	a
l00059	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00060	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00060"><\/a>00060 <span class="comment">\/*<\/span>$/;"	a
l00061	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00061"><\/a>00061 <span class="comment"> * @brief Creates a human-readable paragraph of the status of wifidog<\/span>$/;"	a
l00062	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00062"><\/a>00062 <span class="comment"> *\/<\/span>$/;"	a
l00063	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00063"><\/a>00063 <span class="keywordtype">char<\/span> * get_status_text();$/;"	a
l00064	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00064"><\/a>00064 $/;"	a
l00065	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00065"><\/a>00065 <span class="preprocessor">#define LOCK_GHBN() do { \\<\/span>$/;"	a
l00066	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00066"><\/a>00066 <span class="preprocessor">        debug(LOG_DEBUG, "Locking wd_gethostbyname()"); \\<\/span>$/;"	a
l00067	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00067"><\/a>00067 <span class="preprocessor">        pthread_mutex_lock(&amp;ghbn_mutex); \\<\/span>$/;"	a
l00068	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00068"><\/a>00068 <span class="preprocessor">        debug(LOG_DEBUG, "wd_gethostbyname() locked"); \\<\/span>$/;"	a
l00069	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00069"><\/a>00069 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00070	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00070"><\/a>00070 <span class="preprocessor"><\/span>$/;"	a
l00071	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00071"><\/a>00071 <span class="preprocessor">#define UNLOCK_GHBN() do { \\<\/span>$/;"	a
l00072	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00072"><\/a>00072 <span class="preprocessor">        debug(LOG_DEBUG, "Unlocking wd_gethostbyname()"); \\<\/span>$/;"	a
l00073	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00073"><\/a>00073 <span class="preprocessor">        pthread_mutex_unlock(&amp;ghbn_mutex); \\<\/span>$/;"	a
l00074	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00074"><\/a>00074 <span class="preprocessor">        debug(LOG_DEBUG, "wd_gethostbyname() unlocked"); \\<\/span>$/;"	a
l00075	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00075"><\/a>00075 <span class="preprocessor">} while (0)<\/span>$/;"	a
l00076	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00076"><\/a>00076 <span class="preprocessor"><\/span>$/;"	a
l00077	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00077"><\/a>00077 <span class="preprocessor">#endif <\/span><span class="comment">\/* _UTIL_H_ *\/<\/span>$/;"	a
l00078	install/share/doc/wifidog-20090925/html/util_8h-source.html	/^<a name="l00078"><\/a>00078 $/;"	a
0cf123f608ee86a2bc577164c4e58bfc	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0cf123f608ee86a2bc577164c4e58bfc"><\/a><!-- doxytag: member="util.h::mark_auth_offline" ref="0cf123f608ee86a2bc577164c4e58bfc" args="()" -->$/;"	a
1292062c6863401b0c8b6743bb746df7	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1292062c6863401b0c8b6743bb746df7"><\/a><!-- doxytag: member="util.h::get_ext_iface" ref="1292062c6863401b0c8b6743bb746df7" args="(void)" -->$/;"	a
3236543c5f99e9273a665f875e0d3061	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3236543c5f99e9273a665f875e0d3061"><\/a><!-- doxytag: member="util.h::wd_gethostbyname" ref="3236543c5f99e9273a665f875e0d3061" args="(const char *name)" -->$/;"	a
41bb1ae6f994fced016bcd412e99f410	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="41bb1ae6f994fced016bcd412e99f410"><\/a><!-- doxytag: member="util.h::is_online" ref="41bb1ae6f994fced016bcd412e99f410" args="()" -->$/;"	a
4e7610fe011a6fcc90cfd7cc57f90c96	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4e7610fe011a6fcc90cfd7cc57f90c96"><\/a><!-- doxytag: member="util.h::is_auth_online" ref="4e7610fe011a6fcc90cfd7cc57f90c96" args="()" -->$/;"	a
514397517babe0a7f56651c98674ea84	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="514397517babe0a7f56651c98674ea84"><\/a><!-- doxytag: member="util.h::STATUS_BUF_SIZ" ref="514397517babe0a7f56651c98674ea84" args="" -->$/;"	a
566a5213a52fcf010039d572da5c7490	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="566a5213a52fcf010039d572da5c7490"><\/a><!-- doxytag: member="util.h::mark_online" ref="566a5213a52fcf010039d572da5c7490" args="()" -->$/;"	a
71d23e774a069ca0b4617c40fc262f4e	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="71d23e774a069ca0b4617c40fc262f4e"><\/a><!-- doxytag: member="util.h::mark_offline" ref="71d23e774a069ca0b4617c40fc262f4e" args="()" -->$/;"	a
9fe47cb092157d21079b5f1acd9ffc35	install/share/doc/wifidog-20090925/html/util_8h.html	/^<a class="anchor" name="9fe47cb092157d21079b5f1acd9ffc35"><\/a><!-- doxytag: member="util.h::LOCK_GHBN" ref="9fe47cb092157d21079b5f1acd9ffc35" args="()" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/util_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
c4c06e11b18189acbe7ca7c1bb1d1fb8	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c4c06e11b18189acbe7ca7c1bb1d1fb8"><\/a><!-- doxytag: member="util.h::get_status_text" ref="c4c06e11b18189acbe7ca7c1bb1d1fb8" args="()" -->$/;"	a
c81f7a57da68af360e22ee74f9c64e85	install/share/doc/wifidog-20090925/html/util_8h.html	/^<a class="anchor" name="c81f7a57da68af360e22ee74f9c64e85"><\/a><!-- doxytag: member="util.h::UNLOCK_GHBN" ref="c81f7a57da68af360e22ee74f9c64e85" args="()" -->$/;"	a
d3c0ab429f95535fa08bc6a4fb884bab	install/share/doc/wifidog-20090925/html/util_8h.html	/^<a class="anchor" name="d3c0ab429f95535fa08bc6a4fb884bab"><\/a><!-- doxytag: member="util.h::execute" ref="d3c0ab429f95535fa08bc6a4fb884bab" args="(char *cmd_line, int quiet)" -->$/;"	a
d90431781df5a681e0930efb6e88400b	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d90431781df5a681e0930efb6e88400b"><\/a><!-- doxytag: member="util.h::get_iface_ip" ref="d90431781df5a681e0930efb6e88400b" args="(const char *ifname)" -->$/;"	a
eeca5446f2051d6e199c2cf68362fd75	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eeca5446f2051d6e199c2cf68362fd75"><\/a><!-- doxytag: member="util.h::mark_auth_online" ref="eeca5446f2051d6e199c2cf68362fd75" args="()" -->$/;"	a
f62d0c4e60d6cc70ac8e6e44231935e8	install/share/doc/wifidog-20090925/html/util_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f62d0c4e60d6cc70ac8e6e44231935e8"><\/a><!-- doxytag: member="util.h::get_iface_mac" ref="f62d0c4e60d6cc70ac8e6e44231935e8" args="(const char *ifname)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<h1>wdctl.c<\/h1><a href="wdctl_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: wdctl.c 1373 2008-09-30 09:27:40Z wichert $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;sys\/un.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00040"><\/a>00040 $/;"	a
l00041	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00041"><\/a>00041 <span class="preprocessor">#include "<a class="code" href="wdctl_8h.html" title="WiFiDog monitoring client.">wdctl.h<\/a>"<\/span>$/;"	a
l00042	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00042"><\/a>00042 $/;"	a
l00043	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00043"><\/a>00043 <a class="code" href="structs__config.html">s_config<\/a> config;$/;"	a
l00044	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00044"><\/a>00044 $/;"	a
l00045	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> usage(<span class="keywordtype">void<\/span>);$/;"	a
l00046	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> init_config(<span class="keywordtype">void<\/span>);$/;"	a
l00047	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(<span class="keywordtype">int<\/span>, <span class="keywordtype">char<\/span> **);$/;"	a
l00048	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span> connect_to_server(<span class="keywordtype">char<\/span> *);$/;"	a
l00049	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="keyword">static<\/span> <span class="keywordtype">size_t<\/span> send_request(<span class="keywordtype">int<\/span>, <span class="keywordtype">char<\/span> *);$/;"	a
l00050	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_status(<span class="keywordtype">void<\/span>);$/;"	a
l00051	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_stop(<span class="keywordtype">void<\/span>);$/;"	a
l00052	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_reset(<span class="keywordtype">void<\/span>);$/;"	a
l00053	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_restart(<span class="keywordtype">void<\/span>);$/;"	a
l00054	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00054"><\/a>00054 $/;"	a
l00060	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00061	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00061"><\/a>00061 usage(<span class="keywordtype">void<\/span>)$/;"	a
l00062	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00062"><\/a>00062 {$/;"	a
l00063	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00063"><\/a>00063     printf(<span class="stringliteral">"Usage: wdctl [options] command [arguments]\\n"<\/span>);$/;"	a
l00064	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00064"><\/a>00064     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00065	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00065"><\/a>00065     printf(<span class="stringliteral">"options:\\n"<\/span>);$/;"	a
l00066	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00066"><\/a>00066     printf(<span class="stringliteral">"  -s &lt;path&gt;         Path to the socket\\n"<\/span>);$/;"	a
l00067	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00067"><\/a>00067     printf(<span class="stringliteral">"  -h                Print usage\\n"<\/span>);$/;"	a
l00068	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00068"><\/a>00068     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00069	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00069"><\/a>00069     printf(<span class="stringliteral">"commands:\\n"<\/span>);$/;"	a
l00070	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00070"><\/a>00070     printf(<span class="stringliteral">"  reset [mac|ip]    Reset the specified mac or ip connection\\n"<\/span>);$/;"	a
l00071	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00071"><\/a>00071     printf(<span class="stringliteral">"  status            Obtain the status of wifidog\\n"<\/span>);$/;"	a
l00072	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00072"><\/a>00072     printf(<span class="stringliteral">"  stop              Stop the running wifidog\\n"<\/span>);$/;"	a
l00073	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00073"><\/a>00073     printf(<span class="stringliteral">"  restart           Re-start the running wifidog (without disconnecting active users!)\\n"<\/span>);$/;"	a
l00074	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00074"><\/a>00074     printf(<span class="stringliteral">"\\n"<\/span>);$/;"	a
l00075	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00075"><\/a>00075 }$/;"	a
l00076	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00076"><\/a>00076 $/;"	a
l00081	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00081"><\/a>00081 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00082	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00082"><\/a>00082 init_config(<span class="keywordtype">void<\/span>)$/;"	a
l00083	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00083"><\/a>00083 {$/;"	a
l00084	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00084"><\/a>00084 $/;"	a
l00085	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00085"><\/a>00085         config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a> = strdup(DEFAULT_SOCK);$/;"	a
l00086	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00086"><\/a>00086         config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_UNDEF;$/;"	a
l00087	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00087"><\/a>00087 }$/;"	a
l00088	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00088"><\/a>00088 $/;"	a
l00093	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00093"><\/a>00093 <span class="keywordtype">void<\/span>$/;"	a
l00094	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00094"><\/a>00094 <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(<span class="keywordtype">int<\/span> argc, <span class="keywordtype">char<\/span> **argv)$/;"	a
l00095	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00095"><\/a>00095 {$/;"	a
l00096	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00096"><\/a>00096     <span class="keyword">extern<\/span> <span class="keywordtype">int<\/span> optind;$/;"	a
l00097	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00097"><\/a>00097     <span class="keywordtype">int<\/span> c;$/;"	a
l00098	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00098"><\/a>00098 $/;"	a
l00099	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00099"><\/a>00099     <span class="keywordflow">while<\/span> (-1 != (c = getopt(argc, argv, <span class="stringliteral">"s:h"<\/span>))) {$/;"	a
l00100	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="keywordflow">switch<\/span>(c) {$/;"	a
l00101	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00101"><\/a>00101             <span class="keywordflow">case<\/span> <span class="charliteral">'h'<\/span>:$/;"	a
l00102	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00102"><\/a>00102                 usage();$/;"	a
l00103	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00103"><\/a>00103                 exit(1);$/;"	a
l00104	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00104"><\/a>00104                 <span class="keywordflow">break<\/span>;$/;"	a
l00105	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00105"><\/a>00105 $/;"	a
l00106	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00106"><\/a>00106             <span class="keywordflow">case<\/span> <span class="charliteral">'s'<\/span>:$/;"	a
l00107	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00107"><\/a>00107                 <span class="keywordflow">if<\/span> (optarg) {$/;"	a
l00108	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00108"><\/a>00108                     free(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00109	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00109"><\/a>00109                     config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a> = strdup(optarg);$/;"	a
l00110	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00110"><\/a>00110                 }$/;"	a
l00111	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00111"><\/a>00111                 <span class="keywordflow">break<\/span>;$/;"	a
l00112	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00112"><\/a>00112 $/;"	a
l00113	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00113"><\/a>00113             <span class="keywordflow">default<\/span>:$/;"	a
l00114	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00114"><\/a>00114                 usage();$/;"	a
l00115	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00115"><\/a>00115                 exit(1);$/;"	a
l00116	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00116"><\/a>00116                 <span class="keywordflow">break<\/span>;$/;"	a
l00117	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00117"><\/a>00117         }$/;"	a
l00118	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00118"><\/a>00118     }$/;"	a
l00119	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00119"><\/a>00119 $/;"	a
l00120	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00120"><\/a>00120     <span class="keywordflow">if<\/span> ((argc - optind) &lt;= 0) {$/;"	a
l00121	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00121"><\/a>00121             usage();$/;"	a
l00122	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00122"><\/a>00122             exit(1);$/;"	a
l00123	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00123"><\/a>00123     }$/;"	a
l00124	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00124"><\/a>00124 $/;"	a
l00125	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00125"><\/a>00125     <span class="keywordflow">if<\/span> (strcmp(*(argv + optind), <span class="stringliteral">"status"<\/span>) == 0) {$/;"	a
l00126	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00126"><\/a>00126             config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_STATUS;$/;"	a
l00127	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00127"><\/a>00127     } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(*(argv + optind), <span class="stringliteral">"stop"<\/span>) == 0) {$/;"	a
l00128	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00128"><\/a>00128             config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_STOP;$/;"	a
l00129	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00129"><\/a>00129     } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(*(argv + optind), <span class="stringliteral">"reset"<\/span>) == 0) {$/;"	a
l00130	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00130"><\/a>00130             config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_KILL;$/;"	a
l00131	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00131"><\/a>00131             <span class="keywordflow">if<\/span> ((argc - (optind + 1)) &lt;= 0) {$/;"	a
l00132	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00132"><\/a>00132                     fprintf(stderr, <span class="stringliteral">"wdctl: Error: You must specify an IP "<\/span>$/;"	a
l00133	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00133"><\/a>00133                                     <span class="stringliteral">"or a Mac address to reset\\n"<\/span>);$/;"	a
l00134	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00134"><\/a>00134                     usage();$/;"	a
l00135	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00135"><\/a>00135                     exit(1);$/;"	a
l00136	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00136"><\/a>00136             }$/;"	a
l00137	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00137"><\/a>00137             config.<a class="code" href="structs__config.html#0d3b219bafe97bb489549dcdd334b074">param<\/a> = strdup(*(argv + optind + 1));$/;"	a
l00138	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00138"><\/a>00138     } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(*(argv + optind), <span class="stringliteral">"restart"<\/span>) == 0) {$/;"	a
l00139	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00139"><\/a>00139             config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a> = WDCTL_RESTART;$/;"	a
l00140	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00140"><\/a>00140     }$/;"	a
l00141	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00141"><\/a>00141          <span class="keywordflow">else<\/span> {$/;"	a
l00142	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00142"><\/a>00142             fprintf(stderr, <span class="stringliteral">"wdctl: Error: Invalid command \\"%s\\"\\n"<\/span>, *(argv + optind));$/;"	a
l00143	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00143"><\/a>00143             usage();$/;"	a
l00144	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00144"><\/a>00144             exit(1);$/;"	a
l00145	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00145"><\/a>00145     }$/;"	a
l00146	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00146"><\/a>00146 }$/;"	a
l00147	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00147"><\/a>00147 $/;"	a
l00148	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00148"><\/a>00148 <span class="keyword">static<\/span> <span class="keywordtype">int<\/span>$/;"	a
l00149	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00149"><\/a>00149 connect_to_server(<span class="keywordtype">char<\/span> *sock_name)$/;"	a
l00150	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00150"><\/a>00150 {$/;"	a
l00151	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00151"><\/a>00151         <span class="keywordtype">int<\/span> sock;$/;"	a
l00152	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00152"><\/a>00152         <span class="keyword">struct <\/span>sockaddr_un      sa_un;$/;"	a
l00153	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00153"><\/a>00153         $/;"	a
l00154	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00154"><\/a>00154         <span class="comment">\/* Connect to socket *\/<\/span>$/;"	a
l00155	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00155"><\/a>00155         sock = socket(AF_UNIX, SOCK_STREAM, 0);$/;"	a
l00156	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00156"><\/a>00156         memset(&amp;sa_un, 0, <span class="keyword">sizeof<\/span>(sa_un));$/;"	a
l00157	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00157"><\/a>00157         sa_un.sun_family = AF_UNIX;$/;"	a
l00158	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00158"><\/a>00158         strncpy(sa_un.sun_path, sock_name, (<span class="keyword">sizeof<\/span>(sa_un.sun_path) - 1));$/;"	a
l00159	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00159"><\/a>00159 $/;"	a
l00160	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00160"><\/a>00160         <span class="keywordflow">if<\/span> (connect(sock, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, $/;"	a
l00161	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00161"><\/a>00161                         strlen(sa_un.sun_path) + <span class="keyword">sizeof<\/span>(sa_un.sun_family))) {$/;"	a
l00162	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00162"><\/a>00162                 fprintf(stderr, <span class="stringliteral">"wdctl: wifidog probably not started (Error: %s)\\n"<\/span>, strerror(errno));$/;"	a
l00163	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00163"><\/a>00163                 exit(1);$/;"	a
l00164	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00164"><\/a>00164         }$/;"	a
l00165	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00165"><\/a>00165 $/;"	a
l00166	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordflow">return<\/span> sock;$/;"	a
l00167	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00167"><\/a>00167 }$/;"	a
l00168	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00168"><\/a>00168 $/;"	a
l00169	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00169"><\/a>00169 <span class="keyword">static<\/span> <span class="keywordtype">size_t<\/span>$/;"	a
l00170	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00170"><\/a>00170 send_request(<span class="keywordtype">int<\/span> sock, <span class="keywordtype">char<\/span> *request)$/;"	a
l00171	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00171"><\/a>00171 {$/;"	a
l00172	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00172"><\/a>00172         <span class="keywordtype">size_t<\/span>  len;$/;"	a
l00173	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00173"><\/a>00173         ssize_t written;$/;"	a
l00174	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00174"><\/a>00174                 $/;"	a
l00175	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00175"><\/a>00175         len = 0;$/;"	a
l00176	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00176"><\/a>00176         <span class="keywordflow">while<\/span> (len != strlen(request)) {$/;"	a
l00177	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00177"><\/a>00177                 written = write(sock, (request + len), strlen(request) - len);$/;"	a
l00178	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00178"><\/a>00178                 <span class="keywordflow">if<\/span> (written == -1) {$/;"	a
l00179	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00179"><\/a>00179                         fprintf(stderr, <span class="stringliteral">"Write to wifidog failed: %s\\n"<\/span>,$/;"	a
l00180	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00180"><\/a>00180                                         strerror(errno));$/;"	a
l00181	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00181"><\/a>00181                         exit(1);$/;"	a
l00182	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00182"><\/a>00182                 }$/;"	a
l00183	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00183"><\/a>00183                 len += written;$/;"	a
l00184	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00184"><\/a>00184         }$/;"	a
l00185	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00185"><\/a>00185 $/;"	a
l00186	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00186"><\/a>00186         <span class="keywordflow">return<\/span> len;$/;"	a
l00187	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00187"><\/a>00187 }$/;"	a
l00188	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00188"><\/a>00188 $/;"	a
l00189	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00189"><\/a>00189 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00190	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00190"><\/a>00190 wdctl_status(<span class="keywordtype">void<\/span>)$/;"	a
l00191	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00191"><\/a>00191 {$/;"	a
l00192	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00192"><\/a>00192         <span class="keywordtype">int<\/span>     sock;$/;"	a
l00193	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00193"><\/a>00193         <span class="keywordtype">char<\/span>    buffer[4096];$/;"	a
l00194	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00194"><\/a>00194         <span class="keywordtype">char<\/span>    request[16];$/;"	a
l00195	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00195"><\/a>00195         <span class="keywordtype">int<\/span>     len;$/;"	a
l00196	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00196"><\/a>00196 $/;"	a
l00197	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00197"><\/a>00197         sock = connect_to_server(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00198	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00198"><\/a>00198                 $/;"	a
l00199	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00199"><\/a>00199         strncpy(request, <span class="stringliteral">"status\\r\\n\\r\\n"<\/span>, 15);$/;"	a
l00200	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00200"><\/a>00200 $/;"	a
l00201	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00201"><\/a>00201         len = send_request(sock, request);$/;"	a
l00202	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00202"><\/a>00202         $/;"	a
l00203	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00203"><\/a>00203         <span class="keywordflow">while<\/span> ((len = read(sock, buffer, <span class="keyword">sizeof<\/span>(buffer))) &gt; 0) {$/;"	a
l00204	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00204"><\/a>00204                 buffer[len] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00205	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00205"><\/a>00205                 printf(<span class="stringliteral">"%s"<\/span>, buffer);$/;"	a
l00206	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00206"><\/a>00206         }$/;"	a
l00207	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00208"><\/a>00208         shutdown(sock, 2);$/;"	a
l00209	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00209"><\/a>00209         close(sock);$/;"	a
l00210	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00210"><\/a>00210 }$/;"	a
l00211	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00211"><\/a>00211 $/;"	a
l00212	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00212"><\/a>00212 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00213	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00213"><\/a>00213 wdctl_stop(<span class="keywordtype">void<\/span>)$/;"	a
l00214	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00214"><\/a>00214 {$/;"	a
l00215	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00215"><\/a>00215         <span class="keywordtype">int<\/span>     sock;$/;"	a
l00216	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00216"><\/a>00216         <span class="keywordtype">char<\/span>    buffer[4096];$/;"	a
l00217	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00217"><\/a>00217         <span class="keywordtype">char<\/span>    request[16];$/;"	a
l00218	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00218"><\/a>00218         <span class="keywordtype">int<\/span>     len;$/;"	a
l00219	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00219"><\/a>00219 $/;"	a
l00220	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00220"><\/a>00220         sock = connect_to_server(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00221	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00221"><\/a>00221                 $/;"	a
l00222	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00222"><\/a>00222         strncpy(request, <span class="stringliteral">"stop\\r\\n\\r\\n"<\/span>, 15);$/;"	a
l00223	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00223"><\/a>00223 $/;"	a
l00224	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00224"><\/a>00224         len = send_request(sock, request);$/;"	a
l00225	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00225"><\/a>00225         $/;"	a
l00226	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00226"><\/a>00226         <span class="keywordflow">while<\/span> ((len = read(sock, buffer, <span class="keyword">sizeof<\/span>(buffer))) &gt; 0) {$/;"	a
l00227	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00227"><\/a>00227                 buffer[len] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00228	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00228"><\/a>00228                 printf(<span class="stringliteral">"%s"<\/span>, buffer);$/;"	a
l00229	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00229"><\/a>00229         }$/;"	a
l00230	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00230"><\/a>00230 $/;"	a
l00231	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00231"><\/a>00231         shutdown(sock, 2);$/;"	a
l00232	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00232"><\/a>00232         close(sock);$/;"	a
l00233	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00233"><\/a>00233 }$/;"	a
l00234	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00234"><\/a>00234 $/;"	a
l00235	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00235"><\/a>00235 <span class="keywordtype">void<\/span>$/;"	a
l00236	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00236"><\/a>00236 wdctl_reset(<span class="keywordtype">void<\/span>)$/;"	a
l00237	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00237"><\/a>00237 {$/;"	a
l00238	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00238"><\/a>00238         <span class="keywordtype">int<\/span>     sock;$/;"	a
l00239	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00239"><\/a>00239         <span class="keywordtype">char<\/span>    buffer[4096];$/;"	a
l00240	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00240"><\/a>00240         <span class="keywordtype">char<\/span>    request[64];$/;"	a
l00241	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00241"><\/a>00241         <span class="keywordtype">size_t<\/span>  len;$/;"	a
l00242	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00242"><\/a>00242         <span class="keywordtype">int<\/span>     rlen;$/;"	a
l00243	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00243"><\/a>00243 $/;"	a
l00244	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00244"><\/a>00244         sock = connect_to_server(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00245	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00245"><\/a>00245                 $/;"	a
l00246	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00246"><\/a>00246         strncpy(request, <span class="stringliteral">"reset "<\/span>, 64);$/;"	a
l00247	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00247"><\/a>00247         strncat(request, config.<a class="code" href="structs__config.html#0d3b219bafe97bb489549dcdd334b074">param<\/a>, (64 - strlen(request)));$/;"	a
l00248	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00248"><\/a>00248         strncat(request, <span class="stringliteral">"\\r\\n\\r\\n"<\/span>, (64 - strlen(request)));$/;"	a
l00249	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00249"><\/a>00249 $/;"	a
l00250	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00250"><\/a>00250         len = send_request(sock, request);$/;"	a
l00251	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00251"><\/a>00251         $/;"	a
l00252	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00252"><\/a>00252         len = 0;$/;"	a
l00253	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00253"><\/a>00253         memset(buffer, 0, <span class="keyword">sizeof<\/span>(buffer));$/;"	a
l00254	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00254"><\/a>00254         <span class="keywordflow">while<\/span> ((len &lt; <span class="keyword">sizeof<\/span>(buffer)) &amp;&amp; ((rlen = read(sock, (buffer + len),$/;"	a
l00255	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00255"><\/a>00255                                 (<span class="keyword">sizeof<\/span>(buffer) - len))) &gt; 0)){$/;"	a
l00256	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00256"><\/a>00256                 len += rlen;$/;"	a
l00257	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00257"><\/a>00257         }$/;"	a
l00258	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00258"><\/a>00258 $/;"	a
l00259	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00259"><\/a>00259         <span class="keywordflow">if<\/span> (strcmp(buffer, <span class="stringliteral">"Yes"<\/span>) == 0) {$/;"	a
l00260	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00260"><\/a>00260                 printf(<span class="stringliteral">"Connection %s successfully reset.\\n"<\/span>, config.<a class="code" href="structs__config.html#0d3b219bafe97bb489549dcdd334b074">param<\/a>);$/;"	a
l00261	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00261"><\/a>00261         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strcmp(buffer, <span class="stringliteral">"No"<\/span>) == 0) {$/;"	a
l00262	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00262"><\/a>00262                 printf(<span class="stringliteral">"Connection %s was not active.\\n"<\/span>, config.<a class="code" href="structs__config.html#0d3b219bafe97bb489549dcdd334b074">param<\/a>);$/;"	a
l00263	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00263"><\/a>00263         } <span class="keywordflow">else<\/span> {$/;"	a
l00264	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00264"><\/a>00264                 fprintf(stderr, <span class="stringliteral">"wdctl: Error: WiFiDog sent an abnormal "<\/span>$/;"	a
l00265	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00265"><\/a>00265                                 <span class="stringliteral">"reply.\\n"<\/span>);$/;"	a
l00266	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00266"><\/a>00266         }$/;"	a
l00267	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00267"><\/a>00267 $/;"	a
l00268	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00268"><\/a>00268         shutdown(sock, 2);$/;"	a
l00269	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00269"><\/a>00269         close(sock);$/;"	a
l00270	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00270"><\/a>00270 }$/;"	a
l00271	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00271"><\/a>00271 $/;"	a
l00272	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00272"><\/a>00272 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00273	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00273"><\/a>00273 wdctl_restart(<span class="keywordtype">void<\/span>)$/;"	a
l00274	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00274"><\/a>00274 {$/;"	a
l00275	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00275"><\/a>00275         <span class="keywordtype">int<\/span>     sock;$/;"	a
l00276	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00276"><\/a>00276         <span class="keywordtype">char<\/span>    buffer[4096];$/;"	a
l00277	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00277"><\/a>00277         <span class="keywordtype">char<\/span>    request[16];$/;"	a
l00278	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00278"><\/a>00278         <span class="keywordtype">int<\/span>     len;$/;"	a
l00279	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00279"><\/a>00279 $/;"	a
l00280	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00280"><\/a>00280         sock = connect_to_server(config.<a class="code" href="structs__config.html#d331abd0de5c051099d862891f454e7a">socket<\/a>);$/;"	a
l00281	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00281"><\/a>00281                 $/;"	a
l00282	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00282"><\/a>00282         strncpy(request, <span class="stringliteral">"restart\\r\\n\\r\\n"<\/span>, 15);$/;"	a
l00283	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00283"><\/a>00283 $/;"	a
l00284	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00284"><\/a>00284         len = send_request(sock, request);$/;"	a
l00285	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00285"><\/a>00285         $/;"	a
l00286	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00286"><\/a>00286         <span class="keywordflow">while<\/span> ((len = read(sock, buffer, <span class="keyword">sizeof<\/span>(buffer))) &gt; 0) {$/;"	a
l00287	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00287"><\/a>00287                 buffer[len] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00288	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00288"><\/a>00288                 printf(<span class="stringliteral">"%s"<\/span>, buffer);$/;"	a
l00289	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00289"><\/a>00289         }$/;"	a
l00290	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00290"><\/a>00290 $/;"	a
l00291	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00291"><\/a>00291         shutdown(sock, 2);$/;"	a
l00292	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00292"><\/a>00292         close(sock);$/;"	a
l00293	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00293"><\/a>00293 }$/;"	a
l00294	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00294"><\/a>00294 $/;"	a
l00295	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00295"><\/a>00295 <span class="keywordtype">int<\/span>$/;"	a
l00296	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00296"><\/a>00296 main(<span class="keywordtype">int<\/span> argc, <span class="keywordtype">char<\/span> **argv)$/;"	a
l00297	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00297"><\/a>00297 {$/;"	a
l00298	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00298"><\/a>00298 $/;"	a
l00299	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00299"><\/a>00299         <span class="comment">\/* Init configuration *\/<\/span>$/;"	a
l00300	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00300"><\/a>00300         init_config();$/;"	a
l00301	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00301"><\/a>00301         <a class="code" href="commandline_8c.html#e24d4b7fe84e05687b4c390ed8096b8a" title="Parses the command line and set the config accordingly.">parse_commandline<\/a>(argc, argv);$/;"	a
l00302	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00302"><\/a>00302 $/;"	a
l00303	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00303"><\/a>00303         <span class="keywordflow">switch<\/span>(config.<a class="code" href="structs__config.html#cf2da8057a1661fb677d6a4c805843a5">command<\/a>) {$/;"	a
l00304	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00304"><\/a>00304         <span class="keywordflow">case<\/span> WDCTL_STATUS:$/;"	a
l00305	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00305"><\/a>00305                 wdctl_status();$/;"	a
l00306	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00306"><\/a>00306                 <span class="keywordflow">break<\/span>;$/;"	a
l00307	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00307"><\/a>00307         $/;"	a
l00308	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00308"><\/a>00308         <span class="keywordflow">case<\/span> WDCTL_STOP:$/;"	a
l00309	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00309"><\/a>00309                 wdctl_stop();$/;"	a
l00310	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00310"><\/a>00310                 <span class="keywordflow">break<\/span>;$/;"	a
l00311	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00311"><\/a>00311 $/;"	a
l00312	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00312"><\/a>00312         <span class="keywordflow">case<\/span> WDCTL_KILL:$/;"	a
l00313	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00313"><\/a>00313                 wdctl_reset();$/;"	a
l00314	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00314"><\/a>00314                 <span class="keywordflow">break<\/span>;$/;"	a
l00315	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00315"><\/a>00315                 $/;"	a
l00316	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00316"><\/a>00316         <span class="keywordflow">case<\/span> WDCTL_RESTART:$/;"	a
l00317	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00317"><\/a>00317                 wdctl_restart();$/;"	a
l00318	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00318"><\/a>00318                 <span class="keywordflow">break<\/span>;$/;"	a
l00319	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00319"><\/a>00319 $/;"	a
l00320	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00320"><\/a>00320         <span class="keywordflow">default<\/span>:$/;"	a
l00321	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00321"><\/a>00321                 <span class="comment">\/* XXX NEVER REACHED *\/<\/span>$/;"	a
l00322	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00322"><\/a>00322                 fprintf(stderr, <span class="stringliteral">"Oops\\n"<\/span>);$/;"	a
l00323	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00323"><\/a>00323                 exit(1);$/;"	a
l00324	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00324"><\/a>00324                 <span class="keywordflow">break<\/span>;$/;"	a
l00325	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00325"><\/a>00325         }$/;"	a
l00326	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00326"><\/a>00326         exit(0);$/;"	a
l00327	install/share/doc/wifidog-20090925/html/wdctl_8c-source.html	/^<a name="l00327"><\/a>00327 }$/;"	a
0cebabb746a51732ec95bf81af215b63	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<a class="anchor" name="0cebabb746a51732ec95bf81af215b63"><\/a><!-- doxytag: member="wdctl.c::parse_commandline" ref="0cebabb746a51732ec95bf81af215b63" args="(int, char **)" -->$/;"	a
375ac45ca0dffcf271a45768e5352906	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="375ac45ca0dffcf271a45768e5352906"><\/a><!-- doxytag: member="wdctl.c::wdctl_restart" ref="375ac45ca0dffcf271a45768e5352906" args="(void)" -->$/;"	a
3c04138a5bfe5d72780bb7e82a18e627	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3c04138a5bfe5d72780bb7e82a18e627"><\/a><!-- doxytag: member="wdctl.c::main" ref="3c04138a5bfe5d72780bb7e82a18e627" args="(int argc, char **argv)" -->$/;"	a
43aef46781062865294dac3956f2cca8	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="43aef46781062865294dac3956f2cca8"><\/a><!-- doxytag: member="wdctl.c::wdctl_reset" ref="43aef46781062865294dac3956f2cca8" args="(void)" -->$/;"	a
5f7940ad2fedc85b0266e6cd36780676	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5f7940ad2fedc85b0266e6cd36780676"><\/a><!-- doxytag: member="wdctl.c::init_config" ref="5f7940ad2fedc85b0266e6cd36780676" args="(void)" -->$/;"	a
69f0abb3febeb6a1440a1c43c4299423	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="69f0abb3febeb6a1440a1c43c4299423"><\/a><!-- doxytag: member="wdctl.c::wdctl_stop" ref="69f0abb3febeb6a1440a1c43c4299423" args="(void)" -->$/;"	a
6afe179b832c95341f5426667994900d	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6afe179b832c95341f5426667994900d"><\/a><!-- doxytag: member="wdctl.c::connect_to_server" ref="6afe179b832c95341f5426667994900d" args="(char *)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
ade5b00daf915be32d7f6cbf116cd9e6	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ade5b00daf915be32d7f6cbf116cd9e6"><\/a><!-- doxytag: member="wdctl.c::config" ref="ade5b00daf915be32d7f6cbf116cd9e6" args="" -->$/;"	a
d0dad603aebcd095087935bcb0c7c5d5	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d0dad603aebcd095087935bcb0c7c5d5"><\/a><!-- doxytag: member="wdctl.c::send_request" ref="d0dad603aebcd095087935bcb0c7c5d5" args="(int, char *)" -->$/;"	a
d92fb21abdced30198124c59c11024c3	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d92fb21abdced30198124c59c11024c3"><\/a><!-- doxytag: member="wdctl.c::wdctl_status" ref="d92fb21abdced30198124c59c11024c3" args="(void)" -->$/;"	a
d96d407a911fbb914fa8e4cfbf2faf0f	install/share/doc/wifidog-20090925/html/wdctl_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d96d407a911fbb914fa8e4cfbf2faf0f"><\/a><!-- doxytag: member="wdctl.c::usage" ref="d96d407a911fbb914fa8e4cfbf2faf0f" args="(void)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<h1>wdctl.h<\/h1><a href="wdctl_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: wdctl.h 901 2006-01-17 18:58:13Z mina $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _WDCTL_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _WDCTL_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define DEFAULT_SOCK    "\/tmp\/wdctl.sock"<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor"><\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#define WDCTL_UNDEF             0<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor"><\/span><span class="preprocessor">#define WDCTL_STATUS            1<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor"><\/span><span class="preprocessor">#define WDCTL_STOP              2<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor"><\/span><span class="preprocessor">#define WDCTL_KILL              3<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor"><\/span><span class="preprocessor">#define WDCTL_RESTART   4<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor"><\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00038"><\/a>00038 <span class="keyword">typedef<\/span> <span class="keyword">struct <\/span>{$/;"	a
l00039	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00039"><\/a>00039         <span class="keywordtype">char<\/span>    *socket;$/;"	a
l00040	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00040"><\/a>00040         <span class="keywordtype">int<\/span>     command;$/;"	a
l00041	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00041"><\/a>00041         <span class="keywordtype">char<\/span>    *param;$/;"	a
l00042	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00042"><\/a>00042 } <a class="code" href="structs__config.html">s_config<\/a>;$/;"	a
l00043	install/share/doc/wifidog-20090925/html/wdctl_8h-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#endif<\/span>$/;"	a
00739f1966cd0ef4de4a13c57694abca	install/share/doc/wifidog-20090925/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="00739f1966cd0ef4de4a13c57694abca"><\/a><!-- doxytag: member="wdctl.h::WDCTL_RESTART" ref="00739f1966cd0ef4de4a13c57694abca" args="" -->$/;"	a
0901580654d5c856161afeb7a7a9eef1	install/share/doc/wifidog-20090925/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0901580654d5c856161afeb7a7a9eef1"><\/a><!-- doxytag: member="wdctl.h::WDCTL_STATUS" ref="0901580654d5c856161afeb7a7a9eef1" args="" -->$/;"	a
4475d561ed3f25da45e2e709ab645d64	install/share/doc/wifidog-20090925/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4475d561ed3f25da45e2e709ab645d64"><\/a><!-- doxytag: member="wdctl.h::WDCTL_UNDEF" ref="4475d561ed3f25da45e2e709ab645d64" args="" -->$/;"	a
8f370096143d35d05b7ad2e6d0a9e1a3	install/share/doc/wifidog-20090925/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8f370096143d35d05b7ad2e6d0a9e1a3"><\/a><!-- doxytag: member="wdctl.h::WDCTL_KILL" ref="8f370096143d35d05b7ad2e6d0a9e1a3" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/wdctl_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
a4d4cc98e8dc9966956db1ea4e726d6c	install/share/doc/wifidog-20090925/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a4d4cc98e8dc9966956db1ea4e726d6c"><\/a><!-- doxytag: member="wdctl.h::DEFAULT_SOCK" ref="a4d4cc98e8dc9966956db1ea4e726d6c" args="" -->$/;"	a
ed6d0b6c2903117f0c0cf8be6d448b72	install/share/doc/wifidog-20090925/html/wdctl_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ed6d0b6c2903117f0c0cf8be6d448b72"><\/a><!-- doxytag: member="wdctl.h::WDCTL_STOP" ref="ed6d0b6c2903117f0c0cf8be6d448b72" args="" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<h1>wdctl_thread.c<\/h1><a href="wdctl__thread_8c.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: wdctl_thread.c 1305 2007-11-01 20:04:20Z benoitg $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#define _GNU_SOURCE<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;<\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#include &lt;stdlib.h&gt;<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor">#include &lt;pthread.h&gt;<\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00032"><\/a>00032 <span class="preprocessor">#include &lt;string.h&gt;<\/span>$/;"	a
l00033	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00033"><\/a>00033 <span class="preprocessor">#include &lt;stdarg.h&gt;<\/span>$/;"	a
l00034	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00034"><\/a>00034 <span class="preprocessor">#include &lt;sys\/types.h&gt;<\/span>$/;"	a
l00035	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00035"><\/a>00035 <span class="preprocessor">#include &lt;sys\/socket.h&gt;<\/span>$/;"	a
l00036	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00036"><\/a>00036 <span class="preprocessor">#include &lt;sys\/un.h&gt;<\/span>$/;"	a
l00037	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#include &lt;unistd.h&gt;<\/span>$/;"	a
l00038	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00038"><\/a>00038 <span class="preprocessor">#include &lt;syslog.h&gt;<\/span>$/;"	a
l00039	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00039"><\/a>00039 <span class="preprocessor">#include &lt;signal.h&gt;<\/span>$/;"	a
l00040	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00040"><\/a>00040 <span class="preprocessor">#include &lt;errno.h&gt;<\/span>$/;"	a
l00041	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00041"><\/a>00041 $/;"	a
l00042	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00042"><\/a>00042 <span class="preprocessor">#include "<a class="code" href="common_8h.html" title="Common constants and other bits.">common.h<\/a>"<\/span>$/;"	a
l00043	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00043"><\/a>00043 <span class="preprocessor">#include "httpd.h"<\/span>$/;"	a
l00044	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00044"><\/a>00044 <span class="preprocessor">#include "<a class="code" href="util_8h.html" title="Misc utility functions.">util.h<\/a>"<\/span>$/;"	a
l00045	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00045"><\/a>00045 <span class="preprocessor">#include "<a class="code" href="conf_8h.html" title="Config file parsing.">conf.h<\/a>"<\/span>$/;"	a
l00046	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00046"><\/a>00046 <span class="preprocessor">#include "<a class="code" href="debug_8h.html" title="Debug output routines.">debug.h<\/a>"<\/span>$/;"	a
l00047	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00047"><\/a>00047 <span class="preprocessor">#include "<a class="code" href="auth_8h.html" title="Authentication handling thread.">auth.h<\/a>"<\/span>$/;"	a
l00048	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00048"><\/a>00048 <span class="preprocessor">#include "<a class="code" href="centralserver_8h.html" title="Functions to talk to the central server (auth\/send stats\/get rules\/etc...).">centralserver.h<\/a>"<\/span>$/;"	a
l00049	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00049"><\/a>00049 <span class="preprocessor">#include "<a class="code" href="fw__iptables_8h.html" title="Firewall iptables functions.">fw_iptables.h<\/a>"<\/span>$/;"	a
l00050	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00050"><\/a>00050 <span class="preprocessor">#include "<a class="code" href="firewall_8h.html" title="Firewall update functions.">firewall.h<\/a>"<\/span>$/;"	a
l00051	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00051"><\/a>00051 <span class="preprocessor">#include "<a class="code" href="client__list_8h.html" title="Client List functions.">client_list.h<\/a>"<\/span>$/;"	a
l00052	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00052"><\/a>00052 <span class="preprocessor">#include "<a class="code" href="wdctl__thread_8h.html" title="WiFiDog monitoring thread.">wdctl_thread.h<\/a>"<\/span>$/;"	a
l00053	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00053"><\/a>00053 <span class="preprocessor">#include "<a class="code" href="gateway_8h.html" title="Main loop.">gateway.h<\/a>"<\/span>$/;"	a
l00054	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00054"><\/a>00054 <span class="preprocessor">#include "<a class="code" href="safe_8h.html" title="Safe versions of stdlib\/string functions that error out and exit if memory allocation...">safe.h<\/a>"<\/span>$/;"	a
l00055	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00055"><\/a>00055 $/;"	a
l00056	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00056"><\/a>00056 <span class="comment">\/* Defined in clientlist.c *\/<\/span>$/;"	a
l00057	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00057"><\/a>00057 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="auth_8c.html#5e2d2ea51ec761e9b26ac7f2d3b75264">client_list_mutex<\/a>;$/;"	a
l00058	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00058"><\/a>00058 <span class="keyword">extern<\/span>  pthread_mutex_t <a class="code" href="centralserver_8c.html#b374ff230d9977e6b952612d61689f39">config_mutex<\/a>;$/;"	a
l00059	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00059"><\/a>00059 $/;"	a
l00060	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00060"><\/a>00060 <span class="comment">\/* From commandline.c: *\/<\/span>$/;"	a
l00061	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00061"><\/a>00061 <span class="keyword">extern<\/span> <span class="keywordtype">char<\/span> ** restartargv;$/;"	a
l00062	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00062"><\/a>00062 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> *thread_wdctl_handler(<span class="keywordtype">void<\/span> *);$/;"	a
l00063	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00063"><\/a>00063 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_status(<span class="keywordtype">int<\/span>);$/;"	a
l00064	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00064"><\/a>00064 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> <a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">wdctl_stop<\/a>(<span class="keywordtype">int<\/span>);$/;"	a
l00065	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00065"><\/a>00065 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_reset(<span class="keywordtype">int<\/span>, <span class="keywordtype">char<\/span> *);$/;"	a
l00066	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00066"><\/a>00066 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> wdctl_restart(<span class="keywordtype">int<\/span>);$/;"	a
l00067	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00067"><\/a>00067 $/;"	a
l00072	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00072"><\/a>00072 <span class="keywordtype">void<\/span>$/;"	a
l00073	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00073"><\/a><a class="code" href="wdctl__thread_8h.html#620bac3ec925a104631e817432f8a04e">00073<\/a> <a class="code" href="wdctl__thread_8c.html#620bac3ec925a104631e817432f8a04e" title="Listen for WiFiDog control messages on a unix domain socket.">thread_wdctl<\/a>(<span class="keywordtype">void<\/span> *arg)$/;"	a
l00074	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00074"><\/a>00074 {$/;"	a
l00075	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00075"><\/a>00075         <span class="keywordtype">int<\/span>     fd;$/;"	a
l00076	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00076"><\/a>00076         <span class="keywordtype">char<\/span>    *sock_name;$/;"	a
l00077	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00077"><\/a>00077         <span class="keyword">struct  <\/span>sockaddr_un     sa_un;$/;"	a
l00078	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00078"><\/a>00078         <span class="keywordtype">int<\/span> result;$/;"	a
l00079	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00079"><\/a>00079         pthread_t       tid;$/;"	a
l00080	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00080"><\/a>00080         socklen_t len;$/;"	a
l00081	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00081"><\/a>00081 $/;"	a
l00082	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00082"><\/a>00082         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Starting wdctl."<\/span>);$/;"	a
l00083	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00083"><\/a>00083 $/;"	a
l00084	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00084"><\/a>00084         memset(&amp;sa_un, 0, <span class="keyword">sizeof<\/span>(sa_un));$/;"	a
l00085	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00085"><\/a>00085         sock_name = (<span class="keywordtype">char<\/span> *)arg;$/;"	a
l00086	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00086"><\/a>00086         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Socket name: %s"<\/span>, sock_name);$/;"	a
l00087	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00087"><\/a>00087 $/;"	a
l00088	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00088"><\/a>00088         <span class="keywordflow">if<\/span> (strlen(sock_name) &gt; (<span class="keyword">sizeof<\/span>(sa_un.sun_path) - 1)) {$/;"	a
l00089	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00089"><\/a>00089                 <span class="comment">\/* TODO: Die handler with logging.... *\/<\/span>$/;"	a
l00090	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00090"><\/a>00090                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"WDCTL socket name too long"<\/span>);$/;"	a
l00091	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00091"><\/a>00091                 exit(1);$/;"	a
l00092	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00092"><\/a>00092         }$/;"	a
l00093	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00093"><\/a>00093         $/;"	a
l00094	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00094"><\/a>00094 $/;"	a
l00095	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00095"><\/a>00095         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Creating socket"<\/span>);$/;"	a
l00096	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00096"><\/a>00096         wdctl_socket_server = socket(PF_UNIX, SOCK_STREAM, 0);$/;"	a
l00097	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00097"><\/a>00097 $/;"	a
l00098	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00098"><\/a>00098         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Got server socket %d"<\/span>, wdctl_socket_server);$/;"	a
l00099	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00099"><\/a>00099 $/;"	a
l00100	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00100"><\/a>00100         <span class="comment">\/* If it exists, delete... Not the cleanest way to deal. *\/<\/span>$/;"	a
l00101	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00101"><\/a>00101         unlink(sock_name);$/;"	a
l00102	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00102"><\/a>00102 $/;"	a
l00103	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00103"><\/a>00103         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Filling sockaddr_un"<\/span>);$/;"	a
l00104	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00104"><\/a>00104         strcpy(sa_un.sun_path, sock_name); <span class="comment">\/* XXX No size check because we<\/span>$/;"	a
l00105	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00105"><\/a>00105 <span class="comment">                                            * check a few lines before. *\/<\/span>$/;"	a
l00106	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00106"><\/a>00106         sa_un.sun_family = AF_UNIX;$/;"	a
l00107	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00107"><\/a>00107         $/;"	a
l00108	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00108"><\/a>00108         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Binding socket (%s) (%d)"<\/span>, sa_un.sun_path,$/;"	a
l00109	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00109"><\/a>00109                         strlen(sock_name));$/;"	a
l00110	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00110"><\/a>00110         $/;"	a
l00111	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00111"><\/a>00111         <span class="comment">\/* Which to use, AF_UNIX, PF_UNIX, AF_LOCAL, PF_LOCAL? *\/<\/span>$/;"	a
l00112	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00112"><\/a>00112         <span class="keywordflow">if<\/span> (bind(wdctl_socket_server, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, strlen(sock_name) $/;"	a
l00113	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00113"><\/a>00113                                 + <span class="keyword">sizeof<\/span>(sa_un.sun_family))) {$/;"	a
l00114	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00114"><\/a>00114                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not bind control socket: %s"<\/span>,$/;"	a
l00115	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00115"><\/a>00115                                 strerror(errno));$/;"	a
l00116	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00116"><\/a>00116                 pthread_exit(NULL);$/;"	a
l00117	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00117"><\/a>00117         }$/;"	a
l00118	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00118"><\/a>00118 $/;"	a
l00119	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00119"><\/a>00119         <span class="keywordflow">if<\/span> (listen(wdctl_socket_server, 5)) {$/;"	a
l00120	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00120"><\/a>00120                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not listen on control socket: %s"<\/span>,$/;"	a
l00121	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00121"><\/a>00121                                 strerror(errno));$/;"	a
l00122	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00122"><\/a>00122                 pthread_exit(NULL);$/;"	a
l00123	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00123"><\/a>00123         }$/;"	a
l00124	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00124"><\/a>00124 $/;"	a
l00125	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00125"><\/a>00125         <span class="keywordflow">while<\/span> (1) {$/;"	a
l00126	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00126"><\/a>00126                 len = <span class="keyword">sizeof<\/span>(sa_un); $/;"	a
l00127	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00127"><\/a>00127                 memset(&amp;sa_un, 0, len);$/;"	a
l00128	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00128"><\/a>00128                 <span class="keywordflow">if<\/span> ((fd = accept(wdctl_socket_server, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, &amp;len)) == -1){$/;"	a
l00129	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00129"><\/a>00129                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Accept failed on control socket: %s"<\/span>,$/;"	a
l00130	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00130"><\/a>00130                                         strerror(errno));$/;"	a
l00131	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00131"><\/a>00131                 } <span class="keywordflow">else<\/span> {$/;"	a
l00132	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00132"><\/a>00132                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Accepted connection on wdctl socket %d (%s)"<\/span>, fd, sa_un.sun_path);$/;"	a
l00133	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00133"><\/a>00133                         result = pthread_create(&amp;tid, NULL, &amp;thread_wdctl_handler, (<span class="keywordtype">void<\/span> *)fd);$/;"	a
l00134	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00134"><\/a>00134                         <span class="keywordflow">if<\/span> (result != 0) {$/;"	a
l00135	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00135"><\/a>00135                                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"FATAL: Failed to create a new thread (wdctl handler) - exiting"<\/span>);$/;"	a
l00136	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00136"><\/a>00136                                 termination_handler(0);$/;"	a
l00137	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00137"><\/a>00137                         }$/;"	a
l00138	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00138"><\/a>00138                         pthread_detach(tid);$/;"	a
l00139	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00139"><\/a>00139                 }$/;"	a
l00140	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00140"><\/a>00140         }$/;"	a
l00141	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00141"><\/a>00141 }$/;"	a
l00142	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00142"><\/a>00142 $/;"	a
l00143	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00143"><\/a>00143 $/;"	a
l00144	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00144"><\/a>00144 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span> *$/;"	a
l00145	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00145"><\/a>00145 thread_wdctl_handler(<span class="keywordtype">void<\/span> *arg)$/;"	a
l00146	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00146"><\/a>00146 {$/;"	a
l00147	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00147"><\/a>00147         <span class="keywordtype">int<\/span>     fd,$/;"	a
l00148	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00148"><\/a>00148                 done,$/;"	a
l00149	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00149"><\/a>00149                 i;$/;"	a
l00150	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00150"><\/a>00150         <span class="keywordtype">char<\/span>    request[<a class="code" href="common_8h.html#2491303d0fe260aaba8f46717cda66cc" title="Read buffer for socket read?">MAX_BUF<\/a>];$/;"	a
l00151	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00151"><\/a>00151         ssize_t read_bytes,$/;"	a
l00152	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00152"><\/a>00152                 len;$/;"	a
l00153	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00153"><\/a>00153 $/;"	a
l00154	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00154"><\/a>00154         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Entering thread_wdctl_handler...."<\/span>);$/;"	a
l00155	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00155"><\/a>00155 $/;"	a
l00156	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00156"><\/a>00156         fd = (int)arg;$/;"	a
l00157	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00157"><\/a>00157         $/;"	a
l00158	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00158"><\/a>00158         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Read bytes and stuff from %d"<\/span>, fd);$/;"	a
l00159	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00159"><\/a>00159 $/;"	a
l00160	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00160"><\/a>00160         <span class="comment">\/* Init variables *\/<\/span>$/;"	a
l00161	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00161"><\/a>00161         read_bytes = 0;$/;"	a
l00162	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00162"><\/a>00162         done = 0;$/;"	a
l00163	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00163"><\/a>00163         memset(request, 0, <span class="keyword">sizeof<\/span>(request));$/;"	a
l00164	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00164"><\/a>00164         $/;"	a
l00165	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00165"><\/a>00165         <span class="comment">\/* Read.... *\/<\/span>$/;"	a
l00166	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00166"><\/a>00166         <span class="keywordflow">while<\/span> (!done &amp;&amp; read_bytes &lt; (<span class="keyword">sizeof<\/span>(request) - 1)) {$/;"	a
l00167	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00167"><\/a>00167                 len = read(fd, request + read_bytes,$/;"	a
l00168	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00168"><\/a>00168                                 <span class="keyword">sizeof<\/span>(request) - read_bytes);$/;"	a
l00169	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00169"><\/a>00169 $/;"	a
l00170	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00170"><\/a>00170                 <span class="comment">\/* Have we gotten a command yet? *\/<\/span>$/;"	a
l00171	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00171"><\/a>00171                 <span class="keywordflow">for<\/span> (i = read_bytes; i &lt; (read_bytes + len); i++) {$/;"	a
l00172	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00172"><\/a>00172                         <span class="keywordflow">if<\/span> (request[i] == <span class="charliteral">'\\r'<\/span> || request[i] == <span class="charliteral">'\\n'<\/span>) {$/;"	a
l00173	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00173"><\/a>00173                                 request[i] = <span class="charliteral">'\\0'<\/span>;$/;"	a
l00174	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00174"><\/a>00174                                 done = 1;$/;"	a
l00175	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00175"><\/a>00175                         }$/;"	a
l00176	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00176"><\/a>00176                 }$/;"	a
l00177	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00177"><\/a>00177                 $/;"	a
l00178	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00178"><\/a>00178                 <span class="comment">\/* Increment position *\/<\/span>$/;"	a
l00179	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00179"><\/a>00179                 read_bytes += len;$/;"	a
l00180	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00180"><\/a>00180         }$/;"	a
l00181	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00181"><\/a>00181 $/;"	a
l00182	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00182"><\/a>00182         <span class="keywordflow">if<\/span> (strncmp(request, <span class="stringliteral">"status"<\/span>, 6) == 0) {$/;"	a
l00183	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00183"><\/a>00183                 wdctl_status(fd);$/;"	a
l00184	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00184"><\/a>00184         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strncmp(request, <span class="stringliteral">"stop"<\/span>, 4) == 0) {$/;"	a
l00185	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00185"><\/a>00185                 <a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">wdctl_stop<\/a>(fd);$/;"	a
l00186	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00186"><\/a>00186         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strncmp(request, <span class="stringliteral">"reset"<\/span>, 5) == 0) {$/;"	a
l00187	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00187"><\/a>00187                 wdctl_reset(fd, (request + 6));$/;"	a
l00188	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00188"><\/a>00188         } <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> (strncmp(request, <span class="stringliteral">"restart"<\/span>, 7) == 0) {$/;"	a
l00189	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00189"><\/a>00189                 wdctl_restart(fd);$/;"	a
l00190	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00190"><\/a>00190         }$/;"	a
l00191	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00191"><\/a>00191 $/;"	a
l00192	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00192"><\/a>00192         <span class="keywordflow">if<\/span> (!done) {$/;"	a
l00193	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00193"><\/a>00193                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Invalid wdctl request."<\/span>);$/;"	a
l00194	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00194"><\/a>00194                 shutdown(fd, 2);$/;"	a
l00195	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00195"><\/a>00195                 close(fd);$/;"	a
l00196	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00196"><\/a>00196                 pthread_exit(NULL);$/;"	a
l00197	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00197"><\/a>00197         }$/;"	a
l00198	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00198"><\/a>00198 $/;"	a
l00199	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00199"><\/a>00199         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Request received: [%s]"<\/span>, request);$/;"	a
l00200	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00200"><\/a>00200         $/;"	a
l00201	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00201"><\/a>00201         shutdown(fd, 2);$/;"	a
l00202	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00202"><\/a>00202         close(fd);$/;"	a
l00203	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00203"><\/a>00203         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Exiting thread_wdctl_handler...."<\/span>);$/;"	a
l00204	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00204"><\/a>00204 $/;"	a
l00205	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00205"><\/a>00205         <span class="keywordflow">return<\/span> NULL;$/;"	a
l00206	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00206"><\/a>00206 }$/;"	a
l00207	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00207"><\/a>00207 $/;"	a
l00208	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00208"><\/a>00208 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00209	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00209"><\/a>00209 wdctl_status(<span class="keywordtype">int<\/span> fd)$/;"	a
l00210	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00210"><\/a>00210 {$/;"	a
l00211	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00211"><\/a>00211         <span class="keywordtype">char<\/span> * status = NULL;$/;"	a
l00212	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00212"><\/a>00212         <span class="keywordtype">int<\/span> len = 0;$/;"	a
l00213	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00213"><\/a>00213 $/;"	a
l00214	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00214"><\/a>00214         status = get_status_text();$/;"	a
l00215	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00215"><\/a>00215         len = strlen(status);$/;"	a
l00216	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00216"><\/a>00216 $/;"	a
l00217	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00217"><\/a>00217         write(fd, status, len);$/;"	a
l00218	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00218"><\/a>00218 $/;"	a
l00219	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00219"><\/a>00219         free(status);$/;"	a
l00220	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00220"><\/a>00220 }$/;"	a
l00221	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00221"><\/a>00221 $/;"	a
l00223	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00223"><\/a>00223 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00224	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00224"><\/a><a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">00224<\/a> <a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">wdctl_stop<\/a>(<span class="keywordtype">int<\/span> fd)$/;"	a
l00225	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00225"><\/a>00225 {$/;"	a
l00226	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00226"><\/a>00226         pid_t   pid;$/;"	a
l00227	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00227"><\/a>00227 $/;"	a
l00228	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00228"><\/a>00228         pid = getpid();$/;"	a
l00229	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00229"><\/a>00229         kill(pid, SIGINT);$/;"	a
l00230	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00230"><\/a>00230 }$/;"	a
l00231	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00231"><\/a>00231 $/;"	a
l00232	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00232"><\/a>00232 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00233	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00233"><\/a>00233 wdctl_restart(<span class="keywordtype">int<\/span> afd)$/;"	a
l00234	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00234"><\/a>00234 {$/;"	a
l00235	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00235"><\/a>00235         <span class="keywordtype">int<\/span>     sock,$/;"	a
l00236	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00236"><\/a>00236                 fd;$/;"	a
l00237	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00237"><\/a>00237         <span class="keywordtype">char<\/span>    *sock_name;$/;"	a
l00238	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00238"><\/a>00238         <span class="keyword">struct  <\/span>sockaddr_un     sa_un;$/;"	a
l00239	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00239"><\/a>00239         <a class="code" href="structs__config.html">s_config<\/a> * conf = NULL;$/;"	a
l00240	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00240"><\/a>00240         <a class="code" href="struct__t__client.html">t_client<\/a> * client = NULL;$/;"	a
l00241	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00241"><\/a>00241         <span class="keywordtype">char<\/span> * tempstring = NULL;$/;"	a
l00242	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00242"><\/a>00242         pid_t pid;$/;"	a
l00243	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00243"><\/a>00243         ssize_t written;$/;"	a
l00244	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00244"><\/a>00244         socklen_t len;$/;"	a
l00245	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00245"><\/a>00245 $/;"	a
l00246	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00246"><\/a>00246         conf = <a class="code" href="conf_8c.html#64e73012596dd6628c18742c8046069f" title="Get the current gateway configuration.">config_get_config<\/a>();$/;"	a
l00247	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00247"><\/a>00247 $/;"	a
l00248	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00248"><\/a>00248         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Will restart myself"<\/span>);$/;"	a
l00249	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00249"><\/a>00249 $/;"	a
l00250	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00250"><\/a>00250         <span class="comment">\/*<\/span>$/;"	a
l00251	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00251"><\/a>00251 <span class="comment">         * First, prepare the internal socket<\/span>$/;"	a
l00252	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00252"><\/a>00252 <span class="comment">         *\/<\/span>$/;"	a
l00253	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00253"><\/a>00253         memset(&amp;sa_un, 0, <span class="keyword">sizeof<\/span>(sa_un));$/;"	a
l00254	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00254"><\/a>00254         sock_name = conf-&gt;internal_sock;$/;"	a
l00255	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00255"><\/a>00255         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Socket name: %s"<\/span>, sock_name);$/;"	a
l00256	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00256"><\/a>00256 $/;"	a
l00257	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00257"><\/a>00257         <span class="keywordflow">if<\/span> (strlen(sock_name) &gt; (<span class="keyword">sizeof<\/span>(sa_un.sun_path) - 1)) {$/;"	a
l00258	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00258"><\/a>00258                 <span class="comment">\/* TODO: Die handler with logging.... *\/<\/span>$/;"	a
l00259	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00259"><\/a>00259                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"INTERNAL socket name too long"<\/span>);$/;"	a
l00260	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00260"><\/a>00260                 <span class="keywordflow">return<\/span>;$/;"	a
l00261	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00261"><\/a>00261         }$/;"	a
l00262	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00262"><\/a>00262 $/;"	a
l00263	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00263"><\/a>00263         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Creating socket"<\/span>);$/;"	a
l00264	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00264"><\/a>00264         sock = socket(PF_UNIX, SOCK_STREAM, 0);$/;"	a
l00265	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00265"><\/a>00265 $/;"	a
l00266	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00266"><\/a>00266         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Got internal socket %d"<\/span>, sock);$/;"	a
l00267	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00267"><\/a>00267 $/;"	a
l00268	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00268"><\/a>00268         <span class="comment">\/* If it exists, delete... Not the cleanest way to deal. *\/<\/span>$/;"	a
l00269	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00269"><\/a>00269         unlink(sock_name);$/;"	a
l00270	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00270"><\/a>00270 $/;"	a
l00271	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00271"><\/a>00271         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Filling sockaddr_un"<\/span>);$/;"	a
l00272	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00272"><\/a>00272         strcpy(sa_un.sun_path, sock_name); <span class="comment">\/* XXX No size check because we check a few lines before. *\/<\/span>$/;"	a
l00273	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00273"><\/a>00273         sa_un.sun_family = AF_UNIX;$/;"	a
l00274	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00274"><\/a>00274         $/;"	a
l00275	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00275"><\/a>00275         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Binding socket (%s) (%d)"<\/span>, sa_un.sun_path, strlen(sock_name));$/;"	a
l00276	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00276"><\/a>00276         $/;"	a
l00277	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00277"><\/a>00277         <span class="comment">\/* Which to use, AF_UNIX, PF_UNIX, AF_LOCAL, PF_LOCAL? *\/<\/span>$/;"	a
l00278	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00278"><\/a>00278         <span class="keywordflow">if<\/span> (bind(sock, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, strlen(sock_name) + <span class="keyword">sizeof<\/span>(sa_un.sun_family))) {$/;"	a
l00279	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00279"><\/a>00279                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not bind internal socket: %s"<\/span>, strerror(errno));$/;"	a
l00280	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00280"><\/a>00280                 <span class="keywordflow">return<\/span>;$/;"	a
l00281	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00281"><\/a>00281         }$/;"	a
l00282	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00282"><\/a>00282 $/;"	a
l00283	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00283"><\/a>00283         <span class="keywordflow">if<\/span> (listen(sock, 5)) {$/;"	a
l00284	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00284"><\/a>00284                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Could not listen on internal socket: %s"<\/span>, strerror(errno));$/;"	a
l00285	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00285"><\/a>00285                 <span class="keywordflow">return<\/span>;$/;"	a
l00286	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00286"><\/a>00286         }$/;"	a
l00287	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00287"><\/a>00287         $/;"	a
l00288	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00288"><\/a>00288         <span class="comment">\/*<\/span>$/;"	a
l00289	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00289"><\/a>00289 <span class="comment">         * The internal socket is ready, fork and exec ourselves<\/span>$/;"	a
l00290	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00290"><\/a>00290 <span class="comment">         *\/<\/span>$/;"	a
l00291	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00291"><\/a>00291         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Forking in preparation for exec()..."<\/span>);$/;"	a
l00292	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00292"><\/a>00292         pid = safe_fork();$/;"	a
l00293	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00293"><\/a>00293         <span class="keywordflow">if<\/span> (pid &gt; 0) {$/;"	a
l00294	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00294"><\/a>00294                 <span class="comment">\/* Parent *\/<\/span>$/;"	a
l00295	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00295"><\/a>00295 $/;"	a
l00296	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00296"><\/a>00296                 <span class="comment">\/* Wait for the child to connect to our socket :*\/<\/span>$/;"	a
l00297	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00297"><\/a>00297                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Waiting for child to connect on internal socket"<\/span>);$/;"	a
l00298	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00298"><\/a>00298                 len = <span class="keyword">sizeof<\/span>(sa_un);$/;"	a
l00299	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00299"><\/a>00299                 <span class="keywordflow">if<\/span> ((fd = accept(sock, (<span class="keyword">struct<\/span> sockaddr *)&amp;sa_un, &amp;len)) == -1){$/;"	a
l00300	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00300"><\/a>00300                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Accept failed on internal socket: %s"<\/span>, strerror(errno));$/;"	a
l00301	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00301"><\/a>00301                         close(sock);$/;"	a
l00302	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00302"><\/a>00302                         <span class="keywordflow">return<\/span>;$/;"	a
l00303	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00303"><\/a>00303                 }$/;"	a
l00304	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00304"><\/a>00304 $/;"	a
l00305	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00305"><\/a>00305                 close(sock);$/;"	a
l00306	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00306"><\/a>00306 $/;"	a
l00307	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00307"><\/a>00307                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Received connection from child.  Sending them all existing clients"<\/span>);$/;"	a
l00308	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00308"><\/a>00308 $/;"	a
l00309	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00309"><\/a>00309                 <span class="comment">\/* The child is connected. Send them over the socket the existing clients *\/<\/span>$/;"	a
l00310	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00310"><\/a>00310                 LOCK_CLIENT_LIST();$/;"	a
l00311	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00311"><\/a>00311                 client = <a class="code" href="client__list_8c.html#4d619ca71763380120ec60d4f9c7d084" title="Get the first element of the list of connected clients.">client_get_first_client<\/a>();$/;"	a
l00312	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00312"><\/a>00312                 <span class="keywordflow">while<\/span> (client) {$/;"	a
l00313	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00313"><\/a>00313                         <span class="comment">\/* Send this client *\/<\/span>$/;"	a
l00314	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00314"><\/a>00314                         safe_asprintf(&amp;tempstring, <span class="stringliteral">"CLIENT|ip=%s|mac=%s|token=%s|fw_connection_state=%u|fd=%d|counters_incoming=%llu|counters_outgoing=%llu|counters_last_updated=%lu\\n"<\/span>, client-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, client-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, client-&gt;<a class="code" href="struct__t__client.html#f75604bedd92e1054f3fca789a5a41ad" title="Client token.">token<\/a>, client-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>, client-&gt;<a class="code" href="struct__t__client.html#495baef8f1dc90c94c24561ebd61140d" title="Client HTTP socket (valid only during login before one of the _http_* function is...">fd<\/a>, client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#ad35b1bd0b0de20a4fbcacc133898063" title="Incoming data total.">incoming<\/a>, client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#e8c2b343f2e37219011e5c53fd39390d" title="Outgoing data total.">outgoing<\/a>, client-&gt;<a class="code" href="struct__t__client.html#6aa8adb62a098684aa47c3105a7090d1" title="Counters for input\/output of the client.">counters<\/a>.<a class="code" href="struct__t__counters.html#8953c7b1e636c79dad0359282c28b5d1" title="Last update of the counters.">last_updated<\/a>);$/;"	a
l00315	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00315"><\/a>00315                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Sending to child client data: %s"<\/span>, tempstring);$/;"	a
l00316	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00316"><\/a>00316                         len = 0;$/;"	a
l00317	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00317"><\/a>00317                         <span class="keywordflow">while<\/span> (len != strlen(tempstring)) {$/;"	a
l00318	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00318"><\/a>00318                                 written = write(fd, (tempstring + len), strlen(tempstring) - len);$/;"	a
l00319	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00319"><\/a>00319                                 <span class="keywordflow">if<\/span> (written == -1) {$/;"	a
l00320	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00320"><\/a>00320                                         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Failed to write client data to child: %s"<\/span>, strerror(errno));$/;"	a
l00321	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00321"><\/a>00321                                         free(tempstring);$/;"	a
l00322	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00322"><\/a>00322                                         <span class="keywordflow">break<\/span>;$/;"	a
l00323	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00323"><\/a>00323                                 }$/;"	a
l00324	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00324"><\/a>00324                                 <span class="keywordflow">else<\/span> {$/;"	a
l00325	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00325"><\/a>00325                                         len += written;$/;"	a
l00326	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00326"><\/a>00326                                 }$/;"	a
l00327	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00327"><\/a>00327                         }$/;"	a
l00328	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00328"><\/a>00328                         free(tempstring);$/;"	a
l00329	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00329"><\/a>00329                         client = client-&gt;<a class="code" href="struct__t__client.html#5daa51a49977df48e0664b89f029f082" title="Pointer to the next client.">next<\/a>;$/;"	a
l00330	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00330"><\/a>00330                 }$/;"	a
l00331	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00331"><\/a>00331                 UNLOCK_CLIENT_LIST();$/;"	a
l00332	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00332"><\/a>00332 $/;"	a
l00333	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00333"><\/a>00333                 close(fd);$/;"	a
l00334	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00334"><\/a>00334 $/;"	a
l00335	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00335"><\/a>00335                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_INFO, <span class="stringliteral">"Sent all existing clients to child.  Committing suicide!"<\/span>);$/;"	a
l00336	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00336"><\/a>00336 $/;"	a
l00337	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00337"><\/a>00337                 shutdown(afd, 2);$/;"	a
l00338	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00338"><\/a>00338                 close(afd);$/;"	a
l00339	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00339"><\/a>00339 $/;"	a
l00340	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00340"><\/a>00340                 <span class="comment">\/* Our job in life is done. Commit suicide! *\/<\/span>$/;"	a
l00341	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00341"><\/a>00341                 <a class="code" href="wdctl__thread_8c.html#e95b8ccbd6c9d361d465a1619ab16733">wdctl_stop<\/a>(afd);$/;"	a
l00342	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00342"><\/a>00342         }$/;"	a
l00343	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00343"><\/a>00343         <span class="keywordflow">else<\/span> {$/;"	a
l00344	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00344"><\/a>00344                 <span class="comment">\/* Child *\/<\/span>$/;"	a
l00345	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00345"><\/a>00345                 close(wdctl_socket_server);$/;"	a
l00346	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00346"><\/a>00346                 close(icmp_fd);$/;"	a
l00347	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00347"><\/a>00347                 close(sock);$/;"	a
l00348	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00348"><\/a>00348                 shutdown(afd, 2);$/;"	a
l00349	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00349"><\/a>00349                 close(afd);$/;"	a
l00350	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00350"><\/a>00350                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_NOTICE, <span class="stringliteral">"Re-executing myself (%s)"<\/span>, restartargv[0]);$/;"	a
l00351	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00351"><\/a>00351                 setsid();$/;"	a
l00352	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00352"><\/a>00352                 execvp(restartargv[0], restartargv);$/;"	a
l00353	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00353"><\/a>00353                 <span class="comment">\/* If we've reached here the exec() failed - die quickly and silently *\/<\/span>$/;"	a
l00354	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00354"><\/a>00354                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"I failed to re-execute myself: %s"<\/span>, strerror(errno));$/;"	a
l00355	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00355"><\/a>00355                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_ERR, <span class="stringliteral">"Exiting without cleanup"<\/span>);$/;"	a
l00356	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00356"><\/a>00356                 exit(1);$/;"	a
l00357	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00357"><\/a>00357         }$/;"	a
l00358	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00358"><\/a>00358 $/;"	a
l00359	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00359"><\/a>00359 }$/;"	a
l00360	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00360"><\/a>00360 $/;"	a
l00361	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00361"><\/a>00361 <span class="keyword">static<\/span> <span class="keywordtype">void<\/span>$/;"	a
l00362	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00362"><\/a>00362 wdctl_reset(<span class="keywordtype">int<\/span> fd, <span class="keywordtype">char<\/span> *arg)$/;"	a
l00363	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00363"><\/a>00363 {$/;"	a
l00364	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00364"><\/a>00364         <a class="code" href="struct__t__client.html">t_client<\/a>        *node;$/;"	a
l00365	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00365"><\/a>00365 $/;"	a
l00366	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00366"><\/a>00366         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Entering wdctl_reset..."<\/span>);$/;"	a
l00367	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00367"><\/a>00367         $/;"	a
l00368	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00368"><\/a>00368         LOCK_CLIENT_LIST();$/;"	a
l00369	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00369"><\/a>00369         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Argument: %s (@%x)"<\/span>, arg, arg);$/;"	a
l00370	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00370"><\/a>00370         $/;"	a
l00371	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00371"><\/a>00371         <span class="comment">\/* We get the node or return... *\/<\/span>$/;"	a
l00372	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00372"><\/a>00372         <span class="keywordflow">if<\/span> ((node = <a class="code" href="client__list_8c.html#8d47e246eaa43b7e6216b0d698143dd3" title="Finds a client only by its IP.">client_list_find_by_ip<\/a>(arg)) != NULL);$/;"	a
l00373	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00373"><\/a>00373         <span class="keywordflow">else<\/span> <span class="keywordflow">if<\/span> ((node = <a class="code" href="client__list_8c.html#5d741b8940ddeaa92f3b17c7fd1dab7b" title="Finds a client only by its Mac.">client_list_find_by_mac<\/a>(arg)) != NULL);$/;"	a
l00374	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00374"><\/a>00374         <span class="keywordflow">else<\/span> {$/;"	a
l00375	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00375"><\/a>00375                 <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Client not found."<\/span>);$/;"	a
l00376	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00376"><\/a>00376                 UNLOCK_CLIENT_LIST();$/;"	a
l00377	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00377"><\/a>00377                 write(fd, <span class="stringliteral">"No"<\/span>, 2);$/;"	a
l00378	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00378"><\/a>00378                 <span class="keywordflow">return<\/span>;$/;"	a
l00379	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00379"><\/a>00379         }$/;"	a
l00380	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00380"><\/a>00380 $/;"	a
l00381	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00381"><\/a>00381         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Got node %x."<\/span>, node);$/;"	a
l00382	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00382"><\/a>00382         $/;"	a
l00383	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00383"><\/a>00383         <span class="comment">\/* deny.... *\/<\/span>$/;"	a
l00384	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00384"><\/a>00384         <span class="comment">\/* TODO: maybe just deleting the connection is not best... But this<\/span>$/;"	a
l00385	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00385"><\/a>00385 <span class="comment">         * is a manual command, I don't anticipate it'll be that useful. *\/<\/span>$/;"	a
l00386	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00386"><\/a>00386         fw_deny(node-&gt;<a class="code" href="struct__t__client.html#211c67d5a5f5eea8ea443947dccacf82" title="Client Ip address.">ip<\/a>, node-&gt;<a class="code" href="struct__t__client.html#530b82c768532f3467c80abd51c06d1b" title="Client Mac address.">mac<\/a>, node-&gt;<a class="code" href="struct__t__client.html#80d3364a1172ca74e1fb475609a54a15" title="Connection state in the firewall.">fw_connection_state<\/a>);$/;"	a
l00387	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00387"><\/a>00387         <a class="code" href="client__list_8c.html#6cb127e61a08a2910438c8d91272616a" title="Deletes a client from the connections list.">client_list_delete<\/a>(node);$/;"	a
l00388	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00388"><\/a>00388         $/;"	a
l00389	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00389"><\/a>00389         UNLOCK_CLIENT_LIST();$/;"	a
l00390	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00390"><\/a>00390         $/;"	a
l00391	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00391"><\/a>00391         write(fd, <span class="stringliteral">"Yes"<\/span>, 3);$/;"	a
l00392	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00392"><\/a>00392         $/;"	a
l00393	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00393"><\/a>00393         <a class="code" href="debug_8h.html#522ebc0c3c064e7ddf37eda0ee8c3f8a" title="Used to output messages. The messages will include the finlname and line number,...">debug<\/a>(LOG_DEBUG, <span class="stringliteral">"Exiting wdctl_reset..."<\/span>);$/;"	a
l00394	install/share/doc/wifidog-20090925/html/wdctl__thread_8c-source.html	/^<a name="l00394"><\/a>00394 }$/;"	a
30059693a490a3b23934af7540fd73b2	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="30059693a490a3b23934af7540fd73b2"><\/a><!-- doxytag: member="wdctl_thread.c::wdctl_status" ref="30059693a490a3b23934af7540fd73b2" args="(int)" -->$/;"	a
3c52dcc44643589b9f1039b576518dea	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3c52dcc44643589b9f1039b576518dea"><\/a><!-- doxytag: member="wdctl_thread.c::restartargv" ref="3c52dcc44643589b9f1039b576518dea" args="" -->$/;"	a
5e2d2ea51ec761e9b26ac7f2d3b75264	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<a class="anchor" name="5e2d2ea51ec761e9b26ac7f2d3b75264"><\/a><!-- doxytag: member="wdctl_thread.c::client_list_mutex" ref="5e2d2ea51ec761e9b26ac7f2d3b75264" args="" -->$/;"	a
620bac3ec925a104631e817432f8a04e	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<a class="anchor" name="620bac3ec925a104631e817432f8a04e"><\/a><!-- doxytag: member="wdctl_thread.c::thread_wdctl" ref="620bac3ec925a104631e817432f8a04e" args="(void *arg)" -->$/;"	a
70c21ac1616554eacec70c64265dee7a	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="70c21ac1616554eacec70c64265dee7a"><\/a><!-- doxytag: member="wdctl_thread.c::thread_wdctl_handler" ref="70c21ac1616554eacec70c64265dee7a" args="(void *)" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
b374ff230d9977e6b952612d61689f39	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<a class="anchor" name="b374ff230d9977e6b952612d61689f39"><\/a><!-- doxytag: member="wdctl_thread.c::config_mutex" ref="b374ff230d9977e6b952612d61689f39" args="" -->$/;"	a
d9c67702f9c5c9eb3777aa371b6c6843	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d9c67702f9c5c9eb3777aa371b6c6843"><\/a><!-- doxytag: member="wdctl_thread.c::wdctl_reset" ref="d9c67702f9c5c9eb3777aa371b6c6843" args="(int, char *)" -->$/;"	a
e95b8ccbd6c9d361d465a1619ab16733	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<a class="anchor" name="e95b8ccbd6c9d361d465a1619ab16733"><\/a><!-- doxytag: member="wdctl_thread.c::wdctl_stop" ref="e95b8ccbd6c9d361d465a1619ab16733" args="(int)" -->$/;"	a
ebc06723bffbc74d76c0444d51405fad	install/share/doc/wifidog-20090925/html/wdctl__thread_8c.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ebc06723bffbc74d76c0444d51405fad"><\/a><!-- doxytag: member="wdctl_thread.c::wdctl_restart" ref="ebc06723bffbc74d76c0444d51405fad" args="(int)" -->$/;"	a
l00001	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<h1>wdctl_thread.h<\/h1><a href="wdctl__thread_8h.html">Go to the documentation of this file.<\/a><div class="fragment"><pre class="fragment"><a name="l00001"><\/a>00001 <span class="comment">\/********************************************************************\\<\/span>$/;"	a
l00002	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00002"><\/a>00002 <span class="comment"> * This program is free software; you can redistribute it and\/or    *<\/span>$/;"	a
l00003	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00003"><\/a>00003 <span class="comment"> * modify it under the terms of the GNU General Public License as   *<\/span>$/;"	a
l00004	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00004"><\/a>00004 <span class="comment"> * published by the Free Software Foundation; either version 2 of   *<\/span>$/;"	a
l00005	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00005"><\/a>00005 <span class="comment"> * the License, or (at your option) any later version.              *<\/span>$/;"	a
l00006	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00006"><\/a>00006 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00007	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00007"><\/a>00007 <span class="comment"> * This program is distributed in the hope that it will be useful,  *<\/span>$/;"	a
l00008	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00008"><\/a>00008 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of   *<\/span>$/;"	a
l00009	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00009"><\/a>00009 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    *<\/span>$/;"	a
l00010	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00010"><\/a>00010 <span class="comment"> * GNU General Public License for more details.                     *<\/span>$/;"	a
l00011	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00011"><\/a>00011 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00012	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00012"><\/a>00012 <span class="comment"> * You should have received a copy of the GNU General Public License*<\/span>$/;"	a
l00013	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00013"><\/a>00013 <span class="comment"> * along with this program; if not, contact:                        *<\/span>$/;"	a
l00014	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00014"><\/a>00014 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00015	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00015"><\/a>00015 <span class="comment"> * Free Software Foundation           Voice:  +1-617-542-5942       *<\/span>$/;"	a
l00016	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00016"><\/a>00016 <span class="comment"> * 59 Temple Place - Suite 330        Fax:    +1-617-542-2652       *<\/span>$/;"	a
l00017	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00017"><\/a>00017 <span class="comment"> * Boston, MA  02111-1307,  USA       gnu@gnu.org                   *<\/span>$/;"	a
l00018	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00018"><\/a>00018 <span class="comment"> *                                                                  *<\/span>$/;"	a
l00019	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00019"><\/a>00019 <span class="comment">\\********************************************************************\/<\/span>$/;"	a
l00020	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00020"><\/a>00020 $/;"	a
l00021	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00021"><\/a>00021 <span class="comment">\/* $Id: wdctl_thread.h 1241 2007-06-24 04:13:13Z benoitg $ *\/<\/span>$/;"	a
l00027	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00027"><\/a>00027 <span class="preprocessor">#ifndef _WDCTL_THREAD_H_<\/span>$/;"	a
l00028	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00028"><\/a>00028 <span class="preprocessor"><\/span><span class="preprocessor">#define _WDCTL_THREAD_H_<\/span>$/;"	a
l00029	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00029"><\/a>00029 <span class="preprocessor"><\/span>$/;"	a
l00030	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00030"><\/a>00030 <span class="preprocessor">#define DEFAULT_WDCTL_SOCK      "\/tmp\/wdctl.sock"<\/span>$/;"	a
l00031	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00031"><\/a>00031 <span class="preprocessor"><\/span>$/;"	a
l00032	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00032"><\/a>00032 <span class="keywordtype">int<\/span> wdctl_socket_server;$/;"	a
l00033	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00033"><\/a>00033 $/;"	a
l00035	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00035"><\/a>00035 <span class="keywordtype">void<\/span> <a class="code" href="wdctl__thread_8c.html#620bac3ec925a104631e817432f8a04e" title="Listen for WiFiDog control messages on a unix domain socket.">thread_wdctl<\/a>(<span class="keywordtype">void<\/span> *arg);$/;"	a
l00036	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00036"><\/a>00036 $/;"	a
l00037	install/share/doc/wifidog-20090925/html/wdctl__thread_8h-source.html	/^<a name="l00037"><\/a>00037 <span class="preprocessor">#endif<\/span>$/;"	a
620bac3ec925a104631e817432f8a04e	install/share/doc/wifidog-20090925/html/wdctl__thread_8h.html	/^<a class="anchor" name="620bac3ec925a104631e817432f8a04e"><\/a><!-- doxytag: member="wdctl_thread.h::thread_wdctl" ref="620bac3ec925a104631e817432f8a04e" args="(void *arg)" -->$/;"	a
857429d3a578c49322a70e6dfd833bf2	install/share/doc/wifidog-20090925/html/wdctl__thread_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="857429d3a578c49322a70e6dfd833bf2"><\/a><!-- doxytag: member="wdctl_thread.h::wdctl_socket_server" ref="857429d3a578c49322a70e6dfd833bf2" args="" -->$/;"	a
_details	install/share/doc/wifidog-20090925/html/wdctl__thread_8h.html	/^<hr><a name="_details"><\/a><h2>Detailed Description<\/h2>$/;"	a
cee7c0173f525e29800b87222b407386	install/share/doc/wifidog-20090925/html/wdctl__thread_8h.html	/^<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cee7c0173f525e29800b87222b407386"><\/a><!-- doxytag: member="wdctl_thread.h::DEFAULT_WDCTL_SOCK" ref="cee7c0173f525e29800b87222b407386" args="" -->$/;"	a
ACLOCAL	libhttpd/Makefile	/^ACLOCAL = \/home\/liping\/wifidog-master\/config\/missing aclocal-1.4$/;"	m
AR	libhttpd/Makefile	/^AR = ar$/;"	m
AS	libhttpd/Makefile	/^AS = @AS@$/;"	m
AUTOCONF	libhttpd/Makefile	/^AUTOCONF = autoconf$/;"	m
AUTOHEADER	libhttpd/Makefile	/^AUTOHEADER = autoheader$/;"	m
AUTOMAKE	libhttpd/Makefile	/^AUTOMAKE = \/home\/liping\/wifidog-master\/config\/missing automake-1.4$/;"	m
BUILDROOT	libhttpd/Makefile	/^BUILDROOT = $/;"	m
CC	libhttpd/Makefile	/^CC = gcc$/;"	m
CCLD	libhttpd/Makefile	/^CCLD = $(CC)$/;"	m
CFLAGS	libhttpd/Makefile	/^CFLAGS = -g -O2$/;"	m
COMPILE	libhttpd/Makefile	/^COMPILE = $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)$/;"	m
CONFIG_CLEAN_FILES	libhttpd/Makefile	/^CONFIG_CLEAN_FILES = $/;"	m
CONFIG_HEADER	libhttpd/Makefile	/^CONFIG_HEADER = ..\/config.h$/;"	m
CPPFLAGS	libhttpd/Makefile	/^CPPFLAGS = $/;"	m
CXX	libhttpd/Makefile	/^CXX = g++$/;"	m
CXXCPP	libhttpd/Makefile	/^CXXCPP = g++ -E$/;"	m
DEFS	libhttpd/Makefile	/^DEFS = -DHAVE_CONFIG_H -I. -I$(srcdir) -I..$/;"	m
DESTDIR	libhttpd/Makefile	/^DESTDIR =$/;"	m
DISTFILES	libhttpd/Makefile	/^DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)$/;"	m
DIST_COMMON	libhttpd/Makefile	/^DIST_COMMON =  README Makefile.am Makefile.in$/;"	m
DLLTOOL	libhttpd/Makefile	/^DLLTOOL = @DLLTOOL@$/;"	m
DOT	libhttpd/Makefile	/^DOT = $/;"	m
DOXYGEN	libhttpd/Makefile	/^DOXYGEN = $/;"	m
DSYMUTIL	libhttpd/Makefile	/^DSYMUTIL = $/;"	m
ECHO	libhttpd/Makefile	/^ECHO = echo$/;"	m
EGREP	libhttpd/Makefile	/^EGREP = \/bin\/grep -E$/;"	m
EXEEXT	libhttpd/Makefile	/^EXEEXT = $/;"	m
EXTRA_DIST	libhttpd/Makefile	/^EXTRA_DIST = README$/;"	m
F77	libhttpd/Makefile	/^F77 = $/;"	m
GCJ	libhttpd/Makefile	/^GCJ = @GCJ@$/;"	m
GCJFLAGS	libhttpd/Makefile	/^GCJFLAGS = @GCJFLAGS@$/;"	m
GZIP_ENV	libhttpd/Makefile	/^GZIP_ENV = --best$/;"	m
HAVE_LIB	libhttpd/Makefile	/^HAVE_LIB = @HAVE_LIB@$/;"	m
HEADERS	libhttpd/Makefile	/^HEADERS =  $(noinst_HEADERS) $(pkginclude_HEADERS)$/;"	m
INSTALL	libhttpd/Makefile	/^INSTALL = \/usr\/bin\/install -c$/;"	m
INSTALL_DATA	libhttpd/Makefile	/^INSTALL_DATA = ${INSTALL} -m 644$/;"	m
INSTALL_PROGRAM	libhttpd/Makefile	/^INSTALL_PROGRAM = ${INSTALL} $(AM_INSTALL_PROGRAM_FLAGS)$/;"	m
INSTALL_SCRIPT	libhttpd/Makefile	/^INSTALL_SCRIPT = ${INSTALL}$/;"	m
LDFLAGS	libhttpd/Makefile	/^LDFLAGS = $/;"	m
LIB	libhttpd/Makefile	/^LIB = @LIB@$/;"	m
LIBS	libhttpd/Makefile	/^LIBS = -lnsl -lpthread $/;"	m
LIBTOOL	libhttpd/Makefile	/^LIBTOOL = $(SHELL) $(top_builddir)\/libtool$/;"	m
LINK	libhttpd/Makefile	/^LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(LDFLAGS) -o $@$/;"	m
LN_S	libhttpd/Makefile	/^LN_S = ln -s$/;"	m
LTCOMPILE	libhttpd/Makefile	/^LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)$/;"	m
LTLIB	libhttpd/Makefile	/^LTLIB = @LTLIB@$/;"	m
LTLIBRARIES	libhttpd/Makefile	/^LTLIBRARIES =  $(lib_LTLIBRARIES)$/;"	m
MAINT	libhttpd/Makefile	/^MAINT = #$/;"	m
MAKEINFO	libhttpd/Makefile	/^MAKEINFO = \/home\/liping\/wifidog-master\/config\/missing makeinfo$/;"	m
NMEDIT	libhttpd/Makefile	/^NMEDIT = $/;"	m
NORMAL_INSTALL	libhttpd/Makefile	/^NORMAL_INSTALL = :$/;"	m
NORMAL_UNINSTALL	libhttpd/Makefile	/^NORMAL_UNINSTALL = :$/;"	m
OBJDUMP	libhttpd/Makefile	/^OBJDUMP = @OBJDUMP@$/;"	m
OBJECTS	libhttpd/Makefile	/^OBJECTS = $(libhttpd_la_OBJECTS)$/;"	m
OBJEXT	libhttpd/Makefile	/^OBJEXT = o$/;"	m
PACKAGE	libhttpd/Makefile	/^PACKAGE = wifidog$/;"	m
POST_INSTALL	libhttpd/Makefile	/^POST_INSTALL = :$/;"	m
POST_UNINSTALL	libhttpd/Makefile	/^POST_UNINSTALL = :$/;"	m
PRE_INSTALL	libhttpd/Makefile	/^PRE_INSTALL = :$/;"	m
PRE_UNINSTALL	libhttpd/Makefile	/^PRE_UNINSTALL = :$/;"	m
RANLIB	libhttpd/Makefile	/^RANLIB = ranlib$/;"	m
RC	libhttpd/Makefile	/^RC = @RC@$/;"	m
SED	libhttpd/Makefile	/^SED = \/bin\/sed$/;"	m
SHELL	libhttpd/Makefile	/^SHELL = \/bin\/bash$/;"	m
SOURCES	libhttpd/Makefile	/^SOURCES = $(libhttpd_la_SOURCES)$/;"	m
STRIP	libhttpd/Makefile	/^STRIP = strip$/;"	m
TAR	libhttpd/Makefile	/^TAR = tar$/;"	m
VERSION	libhttpd/Makefile	/^VERSION = 20090925$/;"	m
WIFIDOG_MAJOR_VERSION	libhttpd/Makefile	/^WIFIDOG_MAJOR_VERSION = 1$/;"	m
WIFIDOG_MICRO_VERSION	libhttpd/Makefile	/^WIFIDOG_MICRO_VERSION = 5$/;"	m
WIFIDOG_MINOR_VERSION	libhttpd/Makefile	/^WIFIDOG_MINOR_VERSION = 1$/;"	m
WIFIDOG_VERSION	libhttpd/Makefile	/^WIFIDOG_VERSION = 20090925$/;"	m
bindir	libhttpd/Makefile	/^bindir = ${exec_prefix}\/bin$/;"	m
datadir	libhttpd/Makefile	/^datadir = ${prefix}\/share$/;"	m
distdir	libhttpd/Makefile	/^distdir = $(top_builddir)\/$(PACKAGE)-$(VERSION)\/$(subdir)$/;"	m
enable_dot	libhttpd/Makefile	/^enable_dot = no$/;"	m
enable_html_docs	libhttpd/Makefile	/^enable_html_docs = yes$/;"	m
enable_latex_docs	libhttpd/Makefile	/^enable_latex_docs = no$/;"	m
exec_prefix	libhttpd/Makefile	/^exec_prefix = ${prefix}$/;"	m
host_alias	libhttpd/Makefile	/^host_alias = $/;"	m
host_triplet	libhttpd/Makefile	/^host_triplet = i686-pc-linux-gnu$/;"	m
includedir	libhttpd/Makefile	/^includedir = ${prefix}\/include$/;"	m
infodir	libhttpd/Makefile	/^infodir = ${prefix}\/share\/info$/;"	m
lib_LTLIBRARIES	libhttpd/Makefile	/^lib_LTLIBRARIES = libhttpd.la$/;"	m
libdir	libhttpd/Makefile	/^libdir = ${exec_prefix}\/lib$/;"	m
libexecdir	libhttpd/Makefile	/^libexecdir = ${exec_prefix}\/libexec$/;"	m
libhttpd_la_LDFLAGS	libhttpd/Makefile	/^libhttpd_la_LDFLAGS = $/;"	m
libhttpd_la_LIBADD	libhttpd/Makefile	/^libhttpd_la_LIBADD = $/;"	m
libhttpd_la_OBJECTS	libhttpd/Makefile	/^libhttpd_la_OBJECTS =  protocol.lo api.lo version.lo ip_acl.lo$/;"	m
libhttpd_la_SOURCES	libhttpd/Makefile	/^libhttpd_la_SOURCES = protocol.c 	api.c 	version.c 	ip_acl.c$/;"	m
list	libhttpd/Makefile	/^	list='$(lib_LTLIBRARIES)'; for p in $$list; do \\$/;"	m
list	libhttpd/Makefile	/^	list='$(pkginclude_HEADERS)'; for p in $$list; do \\$/;"	m
localstatedir	libhttpd/Makefile	/^localstatedir = ${prefix}\/var$/;"	m
mandir	libhttpd/Makefile	/^mandir = ${prefix}\/share\/man$/;"	m
mkinstalldirs	libhttpd/Makefile	/^mkinstalldirs = $(SHELL) $(top_srcdir)\/config\/mkinstalldirs$/;"	m
noinst_HEADERS	libhttpd/Makefile	/^noinst_HEADERS = httpd_priv.h$/;"	m
oldincludedir	libhttpd/Makefile	/^oldincludedir = \/usr\/include$/;"	m
pkgdatadir	libhttpd/Makefile	/^pkgdatadir = $(datadir)\/wifidog$/;"	m
pkginclude_HEADERS	libhttpd/Makefile	/^pkginclude_HEADERS = httpd.h$/;"	m
pkgincludedir	libhttpd/Makefile	/^pkgincludedir = $(includedir)\/wifidog$/;"	m
pkglibdir	libhttpd/Makefile	/^pkglibdir = $(libdir)\/wifidog$/;"	m
prefix	libhttpd/Makefile	/^prefix = \/home\/liping\/wifidog-master\/install$/;"	m
sbindir	libhttpd/Makefile	/^sbindir = ${exec_prefix}\/sbin$/;"	m
sharedstatedir	libhttpd/Makefile	/^sharedstatedir = ${prefix}\/com$/;"	m
srcdir	libhttpd/Makefile	/^srcdir = .$/;"	m
subdir	libhttpd/Makefile	/^subdir = libhttpd$/;"	m
sysconfdir	libhttpd/Makefile	/^sysconfdir = ${prefix}\/etc$/;"	m
top_builddir	libhttpd/Makefile	/^top_builddir = ..$/;"	m
top_srcdir	libhttpd/Makefile	/^top_srcdir = ..$/;"	m
transform	libhttpd/Makefile	/^transform = s,x,x,$/;"	m
httpdAddC404Content	libhttpd/api.c	/^int httpdAddC404Content(server, function)$/;"	f
httpdAddCContent	libhttpd/api.c	/^int httpdAddCContent(server, dir, name, indexFlag, preload, function)$/;"	f
httpdAddCWildcardContent	libhttpd/api.c	/^int httpdAddCWildcardContent(server, dir, preload, function)$/;"	f
httpdAddFileContent	libhttpd/api.c	/^int httpdAddFileContent(server, dir, name, indexFlag, preload, path)$/;"	f
httpdAddHeader	libhttpd/api.c	/^void httpdAddHeader(request *r, const char *msg)$/;"	f
httpdAddStaticContent	libhttpd/api.c	/^int httpdAddStaticContent(server, dir, name, indexFlag, preload, data)$/;"	f
httpdAddVariable	libhttpd/api.c	/^int httpdAddVariable(request *r, const char *name, const char *value)$/;"	f
httpdAddWildcardContent	libhttpd/api.c	/^int httpdAddWildcardContent(server, dir, preload, path)$/;"	f
httpdAuthenticate	libhttpd/api.c	/^void httpdAuthenticate(request *r, const char *realm)$/;"	f
httpdCreate	libhttpd/api.c	/^httpd *httpdCreate(host, port)$/;"	f
httpdDestroy	libhttpd/api.c	/^void httpdDestroy(server)$/;"	f
httpdDumpVariables	libhttpd/api.c	/^void httpdDumpVariables(request *r)$/;"	f
httpdEndRequest	libhttpd/api.c	/^void httpdEndRequest(request *r)$/;"	f
httpdForceAuthenticate	libhttpd/api.c	/^void httpdForceAuthenticate(request *r, const char *realm)$/;"	f
httpdFreeVariables	libhttpd/api.c	/^void httpdFreeVariables(request *r)$/;"	f
httpdGetConnection	libhttpd/api.c	/^request *httpdGetConnection(server, timeout)$/;"	f
httpdGetNextVariableByPrefix	libhttpd/api.c	/^httpVar *httpdGetNextVariableByPrefix(curVar, prefix)$/;"	f
httpdGetVariableByName	libhttpd/api.c	/^httpVar *httpdGetVariableByName(request *r, const char *name)$/;"	f
httpdGetVariableByPrefix	libhttpd/api.c	/^httpVar *httpdGetVariableByPrefix(request *r, const char *prefix)$/;"	f
httpdGetVariableByPrefixedName	libhttpd/api.c	/^httpVar *httpdGetVariableByPrefixedName(request *r, const char *prefix, const char *name)$/;"	f
httpdOutput	libhttpd/api.c	/^void httpdOutput(request *r, const char *msg)$/;"	f
httpdPrintf	libhttpd/api.c	/^void httpdPrintf(request *r, const char *fmt, ...)$/;"	f
httpdProcessRequest	libhttpd/api.c	/^void httpdProcessRequest(httpd *server, request *r)$/;"	f
httpdReadRequest	libhttpd/api.c	/^int httpdReadRequest(httpd *server, request *r)$/;"	f
httpdRequestMethodName	libhttpd/api.c	/^char *httpdRequestMethodName(request *r)$/;"	f
httpdSendHeaders	libhttpd/api.c	/^void httpdSendHeaders(request *r)$/;"	f
httpdSetAccessLog	libhttpd/api.c	/^void httpdSetAccessLog(server, fp)$/;"	f
httpdSetContentType	libhttpd/api.c	/^void httpdSetContentType(request *r, const char *type)$/;"	f
httpdSetCookie	libhttpd/api.c	/^void httpdSetCookie(request *r, const char *name, const char *value)$/;"	f
httpdSetErrorLog	libhttpd/api.c	/^void httpdSetErrorLog(server, fp)$/;"	f
httpdSetFileBase	libhttpd/api.c	/^void httpdSetFileBase(server, path)$/;"	f
httpdSetResponse	libhttpd/api.c	/^void httpdSetResponse(request *r, const char *msg)$/;"	f
httpdUrlEncode	libhttpd/api.c	/^char *httpdUrlEncode(str)$/;"	f
HTTP_ACL_DENY	libhttpd/httpd.h	91;"	d
HTTP_ACL_PERMIT	libhttpd/httpd.h	90;"	d
HTTP_ANY_ADDR	libhttpd/httpd.h	68;"	d
HTTP_C_FUNCT	libhttpd/httpd.h	77;"	d
HTTP_C_WILDCARD	libhttpd/httpd.h	81;"	d
HTTP_EMBER_FUNCT	libhttpd/httpd.h	78;"	d
HTTP_FALSE	libhttpd/httpd.h	74;"	d
HTTP_FILE	libhttpd/httpd.h	76;"	d
HTTP_GET	libhttpd/httpd.h	70;"	d
HTTP_IP_ADDR_LEN	libhttpd/httpd.h	65;"	d
HTTP_MAX_AUTH	libhttpd/httpd.h	64;"	d
HTTP_MAX_HEADERS	libhttpd/httpd.h	63;"	d
HTTP_MAX_LEN	libhttpd/httpd.h	61;"	d
HTTP_MAX_URL	libhttpd/httpd.h	62;"	d
HTTP_METHOD_ERROR	libhttpd/httpd.h	83;"	d
HTTP_PORT	libhttpd/httpd.h	60;"	d
HTTP_POST	libhttpd/httpd.h	71;"	d
HTTP_READ_BUF_LEN	libhttpd/httpd.h	67;"	d
HTTP_STATIC	libhttpd/httpd.h	79;"	d
HTTP_TIME_STRING_LEN	libhttpd/httpd.h	66;"	d
HTTP_TRUE	libhttpd/httpd.h	73;"	d
HTTP_WILDCARD	libhttpd/httpd.h	80;"	d
LIB_HTTPD_H	libhttpd/httpd.h	33;"	d
__ANSI_PROTO	libhttpd/httpd.h	39;"	d
__ANSI_PROTO	libhttpd/httpd.h	41;"	d
_httpd_404	libhttpd/httpd.h	/^typedef struct _httpd_404 {$/;"	s
_httpd_content	libhttpd/httpd.h	/^typedef struct _httpd_content{$/;"	s
_httpd_dir	libhttpd/httpd.h	/^typedef struct _httpd_dir{$/;"	s
_httpd_var	libhttpd/httpd.h	/^typedef struct _httpd_var{$/;"	s
accessLog	libhttpd/httpd.h	/^	FILE	*accessLog,$/;"	m	struct:__anon3
action	libhttpd/httpd.h	/^                action;$/;"	m	struct:ip_acl_s
addr	libhttpd/httpd.h	/^        int     addr;$/;"	m	struct:ip_acl_s
authLength	libhttpd/httpd.h	/^		authLength;$/;"	m	struct:__anon1
authPassword	libhttpd/httpd.h	/^	char	authPassword[HTTP_MAX_AUTH];$/;"	m	struct:__anon1
authUser	libhttpd/httpd.h	/^	char	authUser[HTTP_MAX_AUTH];$/;"	m	struct:__anon1
children	libhttpd/httpd.h	/^	struct	_httpd_dir *children,$/;"	m	struct:_httpd_dir	typeref:struct:_httpd_dir::_httpd_dir
clientAddr	libhttpd/httpd.h	/^		clientAddr[HTTP_IP_ADDR_LEN];$/;"	m	struct:__anon4
clientSock	libhttpd/httpd.h	/^	int	clientSock,$/;"	m	struct:__anon4
content	libhttpd/httpd.h	/^	httpContent	*content;$/;"	m	struct:__anon2
content	libhttpd/httpd.h	/^	httpDir	*content;$/;"	m	struct:__anon3
contentLength	libhttpd/httpd.h	/^		contentLength,$/;"	m	struct:__anon1
contentType	libhttpd/httpd.h	/^			contentType[HTTP_MAX_URL];$/;"	m	struct:__anon2
contentType	libhttpd/httpd.h	/^		contentType[HTTP_MAX_URL],$/;"	m	struct:__anon1
data	libhttpd/httpd.h	/^	char	*data,$/;"	m	struct:_httpd_content
defaultAcl	libhttpd/httpd.h	/^	httpAcl	*defaultAcl;$/;"	m	struct:__anon3
entries	libhttpd/httpd.h	/^	struct	_httpd_content *entries;$/;"	m	struct:_httpd_dir	typeref:struct:_httpd_dir::_httpd_content
errorLog	libhttpd/httpd.h	/^		*errorLog;$/;"	m	struct:__anon3
fileBasePath	libhttpd/httpd.h	/^	char	fileBasePath[HTTP_MAX_URL],$/;"	m	struct:__anon3
function	libhttpd/httpd.h	/^	void	(*function)();$/;"	m	struct:_httpd_404
function	libhttpd/httpd.h	/^	void	(*function)();$/;"	m	struct:_httpd_content
handle404	libhttpd/httpd.h	/^	http404  *handle404;$/;"	m	struct:__anon3
headers	libhttpd/httpd.h	/^			headers[HTTP_MAX_HEADERS],$/;"	m	struct:__anon2
headersSent	libhttpd/httpd.h	/^	char		headersSent,$/;"	m	struct:__anon2
host	libhttpd/httpd.h	/^		*host;$/;"	m	struct:__anon3
host	libhttpd/httpd.h	/^	        host[HTTP_MAX_URL], \/* acv@acv.ca\/wifidog: Added decoding$/;"	m	struct:__anon1
http404	libhttpd/httpd.h	/^} http404;$/;"	t	typeref:struct:_httpd_404
httpAcl	libhttpd/httpd.h	/^} httpAcl;$/;"	t	typeref:struct:ip_acl_s
httpContent	libhttpd/httpd.h	/^} httpContent;$/;"	t	typeref:struct:_httpd_content
httpDir	libhttpd/httpd.h	/^} httpDir;$/;"	t	typeref:struct:_httpd_dir
httpReq	libhttpd/httpd.h	/^} httpReq;$/;"	t	typeref:struct:__anon1
httpRes	libhttpd/httpd.h	/^} httpRes;$/;"	t	typeref:struct:__anon2
httpVar	libhttpd/httpd.h	/^} httpVar;$/;"	t	typeref:struct:_httpd_var
httpd	libhttpd/httpd.h	/^} httpd;$/;"	t	typeref:struct:__anon3
httpdRequestContentLength	libhttpd/httpd.h	88;"	d
httpdRequestContentType	libhttpd/httpd.h	87;"	d
httpdRequestMethod	libhttpd/httpd.h	85;"	d
httpdRequestPath	libhttpd/httpd.h	86;"	d
ifModified	libhttpd/httpd.h	/^	        ifModified[HTTP_MAX_URL];$/;"	m	struct:__anon1
indexFlag	libhttpd/httpd.h	/^		indexFlag;$/;"	m	struct:_httpd_content
ip_acl_s	libhttpd/httpd.h	/^typedef struct ip_acl_s{$/;"	s
lastError	libhttpd/httpd.h	/^		lastError;$/;"	m	struct:__anon3
len	libhttpd/httpd.h	/^        char    len,$/;"	m	struct:ip_acl_s
method	libhttpd/httpd.h	/^	int	method,$/;"	m	struct:__anon1
name	libhttpd/httpd.h	/^	char	*name,$/;"	m	struct:_httpd_var
name	libhttpd/httpd.h	/^	char	*name;$/;"	m	struct:_httpd_content
name	libhttpd/httpd.h	/^	char	*name;$/;"	m	struct:_httpd_dir
next	libhttpd/httpd.h	/^			*next;$/;"	m	struct:_httpd_dir	typeref:struct:_httpd_dir::
next	libhttpd/httpd.h	/^	struct	_httpd_content 	*next;$/;"	m	struct:_httpd_content	typeref:struct:_httpd_content::_httpd_content
next	libhttpd/httpd.h	/^        struct  ip_acl_s *next;$/;"	m	struct:ip_acl_s	typeref:struct:ip_acl_s::ip_acl_s
nextValue	libhttpd/httpd.h	/^	struct	_httpd_var 	*nextValue,$/;"	m	struct:_httpd_var	typeref:struct:_httpd_var::_httpd_var
nextVariable	libhttpd/httpd.h	/^				*nextVariable;$/;"	m	struct:_httpd_var	typeref:struct:_httpd_var::
path	libhttpd/httpd.h	/^		*path;$/;"	m	struct:_httpd_content
path	libhttpd/httpd.h	/^	char	path[HTTP_MAX_URL],$/;"	m	struct:__anon1
port	libhttpd/httpd.h	/^	int	port,$/;"	m	struct:__anon3
preload	libhttpd/httpd.h	/^	int	(*preload)();$/;"	m	struct:_httpd_content
query	libhttpd/httpd.h	/^		query[HTTP_MAX_URL],$/;"	m	struct:__anon1
readBuf	libhttpd/httpd.h	/^	char	readBuf[HTTP_READ_BUF_LEN + 1],$/;"	m	struct:__anon4
readBufPtr	libhttpd/httpd.h	/^		*readBufPtr,$/;"	m	struct:__anon4
readBufRemain	libhttpd/httpd.h	/^		readBufRemain;$/;"	m	struct:__anon4
referer	libhttpd/httpd.h	/^		referer[HTTP_MAX_URL],$/;"	m	struct:__anon1
request	libhttpd/httpd.h	/^	httpReq	request;$/;"	m	struct:__anon4
request	libhttpd/httpd.h	/^} request;$/;"	t	typeref:struct:__anon4
response	libhttpd/httpd.h	/^			response[HTTP_MAX_URL],$/;"	m	struct:__anon2
response	libhttpd/httpd.h	/^	httpRes response;$/;"	m	struct:__anon4
responseLength	libhttpd/httpd.h	/^	int		responseLength;$/;"	m	struct:__anon2
serverSock	libhttpd/httpd.h	/^		serverSock,$/;"	m	struct:__anon3
startTime	libhttpd/httpd.h	/^		startTime,$/;"	m	struct:__anon3
type	libhttpd/httpd.h	/^	int	type,$/;"	m	struct:_httpd_content
userAgent	libhttpd/httpd.h	/^		userAgent[HTTP_MAX_URL],$/;"	m	struct:__anon1
value	libhttpd/httpd.h	/^		*value;$/;"	m	struct:_httpd_var
variables	libhttpd/httpd.h	/^	httpVar	*variables;$/;"	m	struct:__anon4
LEVEL_ERROR	libhttpd/httpd_priv.h	49;"	d
LEVEL_NOTICE	libhttpd/httpd_priv.h	48;"	d
LIB_HTTPD_H_PRIV	libhttpd/httpd_priv.h	33;"	d
__ANSI_PROTO	libhttpd/httpd_priv.h	37;"	d
__ANSI_PROTO	libhttpd/httpd_priv.h	39;"	d
_isInCidrBlock	libhttpd/ip_acl.c	/^static int _isInCidrBlock(httpd *server, request *r, int addr1, int len1,$/;"	f	file:
httpdAddAcl	libhttpd/ip_acl.c	/^httpAcl *httpdAddAcl(server, acl, cidr, action)$/;"	f
httpdCheckAcl	libhttpd/ip_acl.c	/^int httpdCheckAcl(httpd *server, request *r, httpAcl *acl)$/;"	f
httpdSetDefaultAcl	libhttpd/ip_acl.c	/^void httpdSetDefaultAcl(server, acl)$/;"	f
scanCidr	libhttpd/ip_acl.c	/^static int scanCidr(val, result, length)$/;"	f	file:
ACCEPTABLE	libhttpd/protocol.c	686;"	d	file:
DEC	libhttpd/protocol.c	216;"	d	file:
URL_XALPHAS	libhttpd/protocol.c	671;"	d	file:
URL_XPALPHAS	libhttpd/protocol.c	672;"	d	file:
_DECODE_MAXVAL	libhttpd/protocol.c	217;"	d	file:
_httpd_catFile	libhttpd/protocol.c	/^void _httpd_catFile(request *r, char *path)$/;"	f
_httpd_checkLastModified	libhttpd/protocol.c	/^int _httpd_checkLastModified(request *r, int modTime)$/;"	f
_httpd_decode	libhttpd/protocol.c	/^int _httpd_decode (bufcoded, bufplain, outbufsize)$/;"	f
_httpd_escape	libhttpd/protocol.c	/^char *_httpd_escape(str)$/;"	f
_httpd_findContentDir	libhttpd/protocol.c	/^httpDir *_httpd_findContentDir(server, dir, createFlag)$/;"	f
_httpd_findContentEntry	libhttpd/protocol.c	/^httpContent *_httpd_findContentEntry(request *r, httpDir *dir, char *entryName)$/;"	f
_httpd_formatTimeString	libhttpd/protocol.c	/^void _httpd_formatTimeString(char *ptr, int clock)$/;"	f
_httpd_freeVariables	libhttpd/protocol.c	/^void _httpd_freeVariables(var)$/;"	f
_httpd_from_hex	libhttpd/protocol.c	/^char _httpd_from_hex (c)$/;"	f
_httpd_net_read	libhttpd/protocol.c	/^int _httpd_net_read(sock, buf, len)$/;"	f
_httpd_net_write	libhttpd/protocol.c	/^int _httpd_net_write(sock, buf, len)$/;"	f
_httpd_readBuf	libhttpd/protocol.c	/^int _httpd_readBuf(request *r, char *destBuf, int len)$/;"	f
_httpd_readChar	libhttpd/protocol.c	/^int _httpd_readChar(request *r, char *cp)$/;"	f
_httpd_readLine	libhttpd/protocol.c	/^int _httpd_readLine(request *r, char *destBuf, int len)$/;"	f
_httpd_sanitiseUrl	libhttpd/protocol.c	/^void _httpd_sanitiseUrl(url)$/;"	f
_httpd_send304	libhttpd/protocol.c	/^void _httpd_send304(request *r)$/;"	f
_httpd_send403	libhttpd/protocol.c	/^void _httpd_send403(request *r)$/;"	f
_httpd_send404	libhttpd/protocol.c	/^void _httpd_send404(httpd *server, request *r)$/;"	f
_httpd_sendDirectoryEntry	libhttpd/protocol.c	/^int _httpd_sendDirectoryEntry(httpd *server, request *r, httpContent *entry,$/;"	f
_httpd_sendFile	libhttpd/protocol.c	/^void _httpd_sendFile(httpd *server, request *r, char *path)$/;"	f
_httpd_sendHeaders	libhttpd/protocol.c	/^void _httpd_sendHeaders(request *r, int contentLength, int modTime)$/;"	f
_httpd_sendStatic	libhttpd/protocol.c	/^void _httpd_sendStatic(httpd *server, request *r, char *data)$/;"	f
_httpd_sendText	libhttpd/protocol.c	/^void _httpd_sendText(request *r, char *msg)$/;"	f
_httpd_storeData	libhttpd/protocol.c	/^void _httpd_storeData(request *r, char *query)$/;"	f
_httpd_unescape	libhttpd/protocol.c	/^char * _httpd_unescape(str)$/;"	f
_httpd_writeAccessLog	libhttpd/protocol.c	/^void _httpd_writeAccessLog(httpd *server, request *r)$/;"	f
_httpd_writeErrorLog	libhttpd/protocol.c	/^void _httpd_writeErrorLog(httpd *server, request *r, char *level, char *message)$/;"	f
hex	libhttpd/protocol.c	/^static char *hex = "0123456789ABCDEF";$/;"	v	file:
isAcceptable	libhttpd/protocol.c	/^static unsigned char isAcceptable[96] =$/;"	v	file:
LIBHTTPD_VENDOR	libhttpd/version.c	/^        LIBHTTPD_VENDOR[] =   "Hughes Technologies Pty Ltd";$/;"	v
LIBHTTPD_VERSION	libhttpd/version.c	/^char    LIBHTTPD_VERSION[] =  "1.3",$/;"	v
func_extract_an_archive	libtool	/^func_extract_an_archive ()$/;"	f
func_extract_archives	libtool	/^func_extract_archives ()$/;"	f
func_infer_tag	libtool	/^func_infer_tag ()$/;"	f
func_mktempdir	libtool	/^func_mktempdir ()$/;"	f
func_win32_libid	libtool	/^func_win32_libid ()$/;"	f
module_exists	scripts/init.d/wifidog	/^    module_exists () {$/;"	f
module_in_memory	scripts/init.d/wifidog	/^    module_in_memory () {$/;"	f
test_ipt_REDIRECT	scripts/init.d/wifidog	/^    test_ipt_REDIRECT () {$/;"	f
test_ipt_mac	scripts/init.d/wifidog	/^    test_ipt_mac () {$/;"	f
test_ipt_mark	scripts/init.d/wifidog	/^    test_ipt_mark () {$/;"	f
ACLOCAL	src/Makefile	/^ACLOCAL = \/home\/liping\/wifidog-master\/config\/missing aclocal-1.4$/;"	m
AM_CPPFLAGS	src/Makefile	/^AM_CPPFLAGS =  	-I${top_srcdir}\/libhttpd\/ 	-DSYSCONFDIR='"$(sysconfdir)"' $/;"	m
AR	src/Makefile	/^AR = ar$/;"	m
AS	src/Makefile	/^AS = @AS@$/;"	m
AUTOCONF	src/Makefile	/^AUTOCONF = autoconf$/;"	m
AUTOHEADER	src/Makefile	/^AUTOHEADER = autoheader$/;"	m
AUTOMAKE	src/Makefile	/^AUTOMAKE = \/home\/liping\/wifidog-master\/config\/missing automake-1.4$/;"	m
BUILDROOT	src/Makefile	/^BUILDROOT = $/;"	m
CC	src/Makefile	/^CC = gcc$/;"	m
CCLD	src/Makefile	/^CCLD = $(CC)$/;"	m
CFLAGS	src/Makefile	/^CFLAGS = -g -O2$/;"	m
COMPILE	src/Makefile	/^COMPILE = $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)$/;"	m
CONFIG_CLEAN_FILES	src/Makefile	/^CONFIG_CLEAN_FILES = $/;"	m
CONFIG_HEADER	src/Makefile	/^CONFIG_HEADER = ..\/config.h$/;"	m
CPPFLAGS	src/Makefile	/^CPPFLAGS = $/;"	m
CXX	src/Makefile	/^CXX = g++$/;"	m
CXXCPP	src/Makefile	/^CXXCPP = g++ -E$/;"	m
DEFS	src/Makefile	/^DEFS = -DHAVE_CONFIG_H -I. -I$(srcdir) -I..$/;"	m
DESTDIR	src/Makefile	/^DESTDIR =$/;"	m
DISTFILES	src/Makefile	/^DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)$/;"	m
DIST_COMMON	src/Makefile	/^DIST_COMMON =  Makefile.am Makefile.in$/;"	m
DLLTOOL	src/Makefile	/^DLLTOOL = @DLLTOOL@$/;"	m
DOT	src/Makefile	/^DOT = $/;"	m
DOXYGEN	src/Makefile	/^DOXYGEN = $/;"	m
DSYMUTIL	src/Makefile	/^DSYMUTIL = $/;"	m
ECHO	src/Makefile	/^ECHO = echo$/;"	m
EGREP	src/Makefile	/^EGREP = \/bin\/grep -E$/;"	m
EXEEXT	src/Makefile	/^EXEEXT = $/;"	m
F77	src/Makefile	/^F77 = $/;"	m
GCJ	src/Makefile	/^GCJ = @GCJ@$/;"	m
GCJFLAGS	src/Makefile	/^GCJFLAGS = @GCJFLAGS@$/;"	m
GZIP_ENV	src/Makefile	/^GZIP_ENV = --best$/;"	m
HAVE_LIB	src/Makefile	/^HAVE_LIB = @HAVE_LIB@$/;"	m
HEADERS	src/Makefile	/^HEADERS =  $(noinst_HEADERS)$/;"	m
INSTALL	src/Makefile	/^INSTALL = \/usr\/bin\/install -c$/;"	m
INSTALL_DATA	src/Makefile	/^INSTALL_DATA = ${INSTALL} -m 644$/;"	m
INSTALL_PROGRAM	src/Makefile	/^INSTALL_PROGRAM = ${INSTALL} $(AM_INSTALL_PROGRAM_FLAGS)$/;"	m
INSTALL_SCRIPT	src/Makefile	/^INSTALL_SCRIPT = ${INSTALL}$/;"	m
LDFLAGS	src/Makefile	/^LDFLAGS = $/;"	m
LIB	src/Makefile	/^LIB = @LIB@$/;"	m
LIBS	src/Makefile	/^LIBS = -lnsl -lpthread $/;"	m
LIBTOOL	src/Makefile	/^LIBTOOL = $(SHELL) $(top_builddir)\/libtool$/;"	m
LINK	src/Makefile	/^LINK = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(LDFLAGS) -o $@$/;"	m
LN_S	src/Makefile	/^LN_S = ln -s$/;"	m
LTCOMPILE	src/Makefile	/^LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)$/;"	m
LTLIB	src/Makefile	/^LTLIB = @LTLIB@$/;"	m
MAINT	src/Makefile	/^MAINT = #$/;"	m
MAKEINFO	src/Makefile	/^MAKEINFO = \/home\/liping\/wifidog-master\/config\/missing makeinfo$/;"	m
NMEDIT	src/Makefile	/^NMEDIT = $/;"	m
NORMAL_INSTALL	src/Makefile	/^NORMAL_INSTALL = :$/;"	m
NORMAL_UNINSTALL	src/Makefile	/^NORMAL_UNINSTALL = :$/;"	m
OBJDUMP	src/Makefile	/^OBJDUMP = @OBJDUMP@$/;"	m
OBJECTS	src/Makefile	/^OBJECTS = $(wifidog_OBJECTS) $(wdctl_OBJECTS)$/;"	m
OBJEXT	src/Makefile	/^OBJEXT = o$/;"	m
PACKAGE	src/Makefile	/^PACKAGE = wifidog$/;"	m
POST_INSTALL	src/Makefile	/^POST_INSTALL = :$/;"	m
POST_UNINSTALL	src/Makefile	/^POST_UNINSTALL = :$/;"	m
PRE_INSTALL	src/Makefile	/^PRE_INSTALL = :$/;"	m
PRE_UNINSTALL	src/Makefile	/^PRE_UNINSTALL = :$/;"	m
PROGRAMS	src/Makefile	/^PROGRAMS =  $(bin_PROGRAMS)$/;"	m
RANLIB	src/Makefile	/^RANLIB = ranlib$/;"	m
RC	src/Makefile	/^RC = @RC@$/;"	m
SED	src/Makefile	/^SED = \/bin\/sed$/;"	m
SHELL	src/Makefile	/^SHELL = \/bin\/bash$/;"	m
SOURCES	src/Makefile	/^SOURCES = $(wifidog_SOURCES) $(wdctl_SOURCES)$/;"	m
STRIP	src/Makefile	/^STRIP = strip$/;"	m
TAR	src/Makefile	/^TAR = tar$/;"	m
VERSION	src/Makefile	/^VERSION = 20090925$/;"	m
WIFIDOG_MAJOR_VERSION	src/Makefile	/^WIFIDOG_MAJOR_VERSION = 1$/;"	m
WIFIDOG_MICRO_VERSION	src/Makefile	/^WIFIDOG_MICRO_VERSION = 5$/;"	m
WIFIDOG_MINOR_VERSION	src/Makefile	/^WIFIDOG_MINOR_VERSION = 1$/;"	m
WIFIDOG_VERSION	src/Makefile	/^WIFIDOG_VERSION = 20090925$/;"	m
bin_PROGRAMS	src/Makefile	/^bin_PROGRAMS =  wifidog$(EXEEXT) wdctl$(EXEEXT)$/;"	m
bin_PROGRAMS	src/Makefile	/^bin_PROGRAMS = wifidog 	wdctl$/;"	m
bindir	src/Makefile	/^bindir = ${exec_prefix}\/bin$/;"	m
datadir	src/Makefile	/^datadir = ${prefix}\/share$/;"	m
distdir	src/Makefile	/^distdir = $(top_builddir)\/$(PACKAGE)-$(VERSION)\/$(subdir)$/;"	m
enable_dot	src/Makefile	/^enable_dot = no$/;"	m
enable_html_docs	src/Makefile	/^enable_html_docs = yes$/;"	m
enable_latex_docs	src/Makefile	/^enable_latex_docs = no$/;"	m
exec_prefix	src/Makefile	/^exec_prefix = ${prefix}$/;"	m
host_alias	src/Makefile	/^host_alias = $/;"	m
host_triplet	src/Makefile	/^host_triplet = i686-pc-linux-gnu$/;"	m
includedir	src/Makefile	/^includedir = ${prefix}\/include$/;"	m
infodir	src/Makefile	/^infodir = ${prefix}\/share\/info$/;"	m
libdir	src/Makefile	/^libdir = ${exec_prefix}\/lib$/;"	m
libexecdir	src/Makefile	/^libexecdir = ${exec_prefix}\/libexec$/;"	m
list	src/Makefile	/^	list='$(bin_PROGRAMS)'; for p in $$list; do \\$/;"	m
localstatedir	src/Makefile	/^localstatedir = ${prefix}\/var$/;"	m
mandir	src/Makefile	/^mandir = ${prefix}\/share\/man$/;"	m
mkinstalldirs	src/Makefile	/^mkinstalldirs = $(SHELL) $(top_srcdir)\/config\/mkinstalldirs$/;"	m
noinst_HEADERS	src/Makefile	/^noinst_HEADERS = commandline.h 	common.h 	conf.h 	debug.h 	fw_iptables.h 	firewall.h 	gateway.h 	centralserver.h 	http.h 	auth.h 	client_list.h 	util.h 	wdctl_thread.h 	wdctl.h 	ping_thread.h 	safe.h 	httpd_thread.h$/;"	m
oldincludedir	src/Makefile	/^oldincludedir = \/usr\/include$/;"	m
pkgdatadir	src/Makefile	/^pkgdatadir = $(datadir)\/wifidog$/;"	m
pkgincludedir	src/Makefile	/^pkgincludedir = $(includedir)\/wifidog$/;"	m
pkglibdir	src/Makefile	/^pkglibdir = $(libdir)\/wifidog$/;"	m
prefix	src/Makefile	/^prefix = \/home\/liping\/wifidog-master\/install$/;"	m
sbindir	src/Makefile	/^sbindir = ${exec_prefix}\/sbin$/;"	m
sharedstatedir	src/Makefile	/^sharedstatedir = ${prefix}\/com$/;"	m
srcdir	src/Makefile	/^srcdir = .$/;"	m
subdir	src/Makefile	/^subdir = src$/;"	m
sysconfdir	src/Makefile	/^sysconfdir = ${prefix}\/etc$/;"	m
top_builddir	src/Makefile	/^top_builddir = ..$/;"	m
top_srcdir	src/Makefile	/^top_srcdir = ..$/;"	m
transform	src/Makefile	/^transform = s,x,x,$/;"	m
wdctl_DEPENDENCIES	src/Makefile	/^wdctl_DEPENDENCIES = $/;"	m
wdctl_LDADD	src/Makefile	/^wdctl_LDADD = $(LDADD)$/;"	m
wdctl_LDFLAGS	src/Makefile	/^wdctl_LDFLAGS = $/;"	m
wdctl_OBJECTS	src/Makefile	/^wdctl_OBJECTS =  wdctl.$(OBJEXT)$/;"	m
wdctl_SOURCES	src/Makefile	/^wdctl_SOURCES = wdctl.c$/;"	m
wifidog_DEPENDENCIES	src/Makefile	/^wifidog_DEPENDENCIES =  $(top_builddir)\/libhttpd\/libhttpd.la$/;"	m
wifidog_LDADD	src/Makefile	/^wifidog_LDADD = $(top_builddir)\/libhttpd\/libhttpd.la$/;"	m
wifidog_LDFLAGS	src/Makefile	/^wifidog_LDFLAGS = $/;"	m
wifidog_OBJECTS	src/Makefile	/^wifidog_OBJECTS =  commandline.$(OBJEXT) conf.$(OBJEXT) debug.$(OBJEXT) \\$/;"	m
wifidog_SOURCES	src/Makefile	/^wifidog_SOURCES = commandline.c 	conf.c 	debug.c 	fw_iptables.c 	firewall.c 	gateway.c 	centralserver.c 	http.c 	auth.c 	client_list.c 	util.c 	wdctl_thread.c 	ping_thread.c 	safe.c 	httpd_thread.c$/;"	m
_GNU_SOURCE	src/auth.c	27;"	d	file:
authenticate_client	src/auth.c	/^authenticate_client(request *r)$/;"	f
thread_client_timeout_check	src/auth.c	/^thread_client_timeout_check(const void *arg)$/;"	f
AUTH_ALLOWED	src/auth.h	/^    AUTH_ALLOWED = 1, \/**< Client was granted access by the auth server *\/$/;"	e	enum:__anon13
AUTH_DENIED	src/auth.h	/^    AUTH_DENIED = 0, \/**< Client was denied by the auth server *\/$/;"	e	enum:__anon13
AUTH_ERROR	src/auth.h	/^    AUTH_ERROR = -1, \/**< An error occured during the validation process*\/$/;"	e	enum:__anon13
AUTH_LOCKED	src/auth.h	/^    AUTH_LOCKED = 254 \/**< Account has been locked *\/$/;"	e	enum:__anon13
AUTH_VALIDATION	src/auth.h	/^    AUTH_VALIDATION = 5, \/**< A misnomer.  Client is in 15 min probation to validate his new account *\/$/;"	e	enum:__anon13
AUTH_VALIDATION_FAILED	src/auth.h	/^    AUTH_VALIDATION_FAILED = 6, \/**< Client had X minutes to validate account by email and didn't = too late *\/$/;"	e	enum:__anon13
_AUTH_H_	src/auth.h	28;"	d
_t_authresponse	src/auth.h	/^typedef struct _t_authresponse {$/;"	s
authcode	src/auth.h	/^    t_authcode authcode; \/**< Authentication code returned by the server *\/$/;"	m	struct:_t_authresponse
t_authcode	src/auth.h	/^} t_authcode;$/;"	t	typeref:enum:__anon13
t_authresponse	src/auth.h	/^} t_authresponse;$/;"	t	typeref:struct:_t_authresponse
_connect_auth_server	src/centralserver.c	/^int _connect_auth_server(int level) {$/;"	f
auth_server_request	src/centralserver.c	/^auth_server_request(t_authresponse *authresponse, const char *request_type, const char *ip, const char *mac, const char *token, unsigned long long int incoming, unsigned long long int outgoing)$/;"	f
connect_auth_server	src/centralserver.c	/^int connect_auth_server() {$/;"	f
GATEWAY_MESSAGE_ACCOUNT_LOGGED_OUT	src/centralserver.h	46;"	d
GATEWAY_MESSAGE_ACCOUNT_VALIDATION_FAILED	src/centralserver.h	44;"	d
GATEWAY_MESSAGE_ACTIVATE_ACCOUNT	src/centralserver.h	42;"	d
GATEWAY_MESSAGE_DENIED	src/centralserver.h	40;"	d
REQUEST_TYPE_COUNTERS	src/centralserver.h	37;"	d
REQUEST_TYPE_LOGIN	src/centralserver.h	33;"	d
REQUEST_TYPE_LOGOUT	src/centralserver.h	35;"	d
_CENTRALSERVER_H_	src/centralserver.h	28;"	d
_GNU_SOURCE	src/client_list.c	29;"	d	file:
_client_list_free_node	src/client_list.c	/^_client_list_free_node(t_client * client)$/;"	f
client_get_first_client	src/client_list.c	/^client_get_first_client(void)$/;"	f
client_list_append	src/client_list.c	/^client_list_append(const char *ip, const char *mac, const char *token)$/;"	f
client_list_delete	src/client_list.c	/^client_list_delete(t_client * client)$/;"	f
client_list_find	src/client_list.c	/^client_list_find(const char *ip, const char *mac)$/;"	f
client_list_find_by_ip	src/client_list.c	/^client_list_find_by_ip(const char *ip)$/;"	f
client_list_find_by_mac	src/client_list.c	/^client_list_find_by_mac(const char *mac)$/;"	f
client_list_find_by_token	src/client_list.c	/^client_list_find_by_token(const char *token)$/;"	f
client_list_init	src/client_list.c	/^client_list_init(void)$/;"	f
client_list_mutex	src/client_list.c	/^pthread_mutex_t client_list_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	v
firstclient	src/client_list.c	/^t_client         *firstclient = NULL;$/;"	v
LOCK_CLIENT_LIST	src/client_list.h	82;"	d
UNLOCK_CLIENT_LIST	src/client_list.h	88;"	d
_CLIENT_LIST_H_	src/client_list.h	28;"	d
_t_client	src/client_list.h	/^typedef struct	_t_client {$/;"	s
_t_counters	src/client_list.h	/^typedef struct _t_counters {$/;"	s
counters	src/client_list.h	/^	t_counters	counters;	\/**< @brief Counters for input\/output of$/;"	m	struct:_t_client
fd	src/client_list.h	/^	int	fd;			\/**< @brief Client HTTP socket (valid only$/;"	m	struct:_t_client
fw_connection_state	src/client_list.h	/^	unsigned int fw_connection_state; \/**< @brief Connection state in the$/;"	m	struct:_t_client
incoming	src/client_list.h	/^    unsigned long long	incoming;	\/**< @brief Incoming data total*\/$/;"	m	struct:_t_counters
incoming_history	src/client_list.h	/^    unsigned long long	incoming_history;	\/**< @brief Incoming data before wifidog restarted*\/$/;"	m	struct:_t_counters
ip	src/client_list.h	/^	char	*ip;			\/**< @brief Client Ip address *\/$/;"	m	struct:_t_client
last_updated	src/client_list.h	/^    time_t	last_updated;	\/**< @brief Last update of the counters *\/$/;"	m	struct:_t_counters
mac	src/client_list.h	/^	char	*mac;			\/**< @brief Client Mac address *\/$/;"	m	struct:_t_client
next	src/client_list.h	/^  struct	_t_client *next;        \/**< @brief Pointer to the next client *\/$/;"	m	struct:_t_client	typeref:struct:_t_client::_t_client
outgoing	src/client_list.h	/^    unsigned long long	outgoing;	\/**< @brief Outgoing data total*\/$/;"	m	struct:_t_counters
outgoing_history	src/client_list.h	/^    unsigned long long	outgoing_history;	\/**< @brief Outgoing data before wifidog restarted*\/$/;"	m	struct:_t_counters
t_client	src/client_list.h	/^} t_client;$/;"	t	typeref:struct:_t_client
t_counters	src/client_list.h	/^} t_counters;$/;"	t	typeref:struct:_t_counters
token	src/client_list.h	/^	char	*token;			\/**< @brief Client token *\/$/;"	m	struct:_t_client
parse_commandline	src/commandline.c	/^void parse_commandline(int argc, char **argv) {$/;"	f
restart_orig_pid	src/commandline.c	/^pid_t restart_orig_pid = 0;$/;"	v
restartargv	src/commandline.c	/^char ** restartargv = NULL;$/;"	v
usage	src/commandline.c	/^usage(void)$/;"	f	file:
_COMMANDLINE_H_	src/commandline.h	28;"	d
MAX_BUF	src/common.h	31;"	d
_COMMON_H_	src/common.h	28;"	d
OpCodes	src/conf.c	/^} OpCodes;$/;"	t	typeref:enum:__anon10	file:
TO_NEXT_WORD	src/conf.c	384;"	d	file:
_GNU_SOURCE	src/conf.c	28;"	d	file:
_parse_firewall_rule	src/conf.c	/^_parse_firewall_rule(const char *ruleset, char *leftover)$/;"	f	file:
config	src/conf.c	/^static s_config config;$/;"	v	file:
config_get_config	src/conf.c	/^config_get_config(void)$/;"	f
config_init	src/conf.c	/^config_init(void)$/;"	f
config_init_override	src/conf.c	/^config_init_override(void)$/;"	f
config_mutex	src/conf.c	/^pthread_mutex_t config_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	v
config_notnull	src/conf.c	/^config_notnull(const void *parm, const char *parmname)$/;"	f	file:
config_parse_token	src/conf.c	/^config_parse_token(const char *cp, const char *filename, int linenum)$/;"	f	file:
config_read	src/conf.c	/^config_read(const char *filename)$/;"	f
config_validate	src/conf.c	/^config_validate(void)$/;"	f
get_auth_server	src/conf.c	/^get_auth_server(void)$/;"	f
get_ruleset	src/conf.c	/^get_ruleset(const char *ruleset)$/;"	f
keywords	src/conf.c	/^} keywords[] = {$/;"	v	typeref:struct:__anon11	file:
mark_auth_server_bad	src/conf.c	/^mark_auth_server_bad(t_auth_serv *bad_server)$/;"	f
missing_parms	src/conf.c	/^static int missing_parms;$/;"	v	file:
name	src/conf.c	/^	const char *name;$/;"	m	struct:__anon11	file:
oAuthServAuthScriptPathFragment	src/conf.c	/^	oAuthServAuthScriptPathFragment,$/;"	e	enum:__anon10	file:
oAuthServHTTPPort	src/conf.c	/^	oAuthServHTTPPort,$/;"	e	enum:__anon10	file:
oAuthServHostname	src/conf.c	/^	oAuthServHostname,$/;"	e	enum:__anon10	file:
oAuthServLoginScriptPathFragment	src/conf.c	/^	oAuthServLoginScriptPathFragment,$/;"	e	enum:__anon10	file:
oAuthServMsgScriptPathFragment	src/conf.c	/^	oAuthServMsgScriptPathFragment,$/;"	e	enum:__anon10	file:
oAuthServPath	src/conf.c	/^	oAuthServPath,$/;"	e	enum:__anon10	file:
oAuthServPingScriptPathFragment	src/conf.c	/^	oAuthServPingScriptPathFragment,$/;"	e	enum:__anon10	file:
oAuthServPortalScriptPathFragment	src/conf.c	/^	oAuthServPortalScriptPathFragment,$/;"	e	enum:__anon10	file:
oAuthServSSLAvailable	src/conf.c	/^	oAuthServSSLAvailable,$/;"	e	enum:__anon10	file:
oAuthServSSLPort	src/conf.c	/^	oAuthServSSLPort,$/;"	e	enum:__anon10	file:
oAuthServer	src/conf.c	/^	oAuthServer,$/;"	e	enum:__anon10	file:
oBadOption	src/conf.c	/^	oBadOption,$/;"	e	enum:__anon10	file:
oCheckInterval	src/conf.c	/^	oCheckInterval,$/;"	e	enum:__anon10	file:
oClientTimeout	src/conf.c	/^	oClientTimeout,$/;"	e	enum:__anon10	file:
oDaemon	src/conf.c	/^	oDaemon,$/;"	e	enum:__anon10	file:
oDebugLevel	src/conf.c	/^	oDebugLevel,$/;"	e	enum:__anon10	file:
oExternalInterface	src/conf.c	/^	oExternalInterface,$/;"	e	enum:__anon10	file:
oFirewallRule	src/conf.c	/^	oFirewallRule,$/;"	e	enum:__anon10	file:
oFirewallRuleSet	src/conf.c	/^	oFirewallRuleSet,$/;"	e	enum:__anon10	file:
oGatewayAddress	src/conf.c	/^	oGatewayAddress,$/;"	e	enum:__anon10	file:
oGatewayID	src/conf.c	/^	oGatewayID,$/;"	e	enum:__anon10	file:
oGatewayInterface	src/conf.c	/^	oGatewayInterface,$/;"	e	enum:__anon10	file:
oGatewayPort	src/conf.c	/^	oGatewayPort,$/;"	e	enum:__anon10	file:
oHTTPDMaxConn	src/conf.c	/^	oHTTPDMaxConn,$/;"	e	enum:__anon10	file:
oHTTPDName	src/conf.c	/^	oHTTPDName,$/;"	e	enum:__anon10	file:
oHTTPDPassword	src/conf.c	/^        oHTTPDPassword,$/;"	e	enum:__anon10	file:
oHTTPDRealm	src/conf.c	/^	oHTTPDRealm,$/;"	e	enum:__anon10	file:
oHTTPDUsername	src/conf.c	/^        oHTTPDUsername,$/;"	e	enum:__anon10	file:
oHtmlMessageFile	src/conf.c	/^        oHtmlMessageFile,$/;"	e	enum:__anon10	file:
oSyslogFacility	src/conf.c	/^	oSyslogFacility,$/;"	e	enum:__anon10	file:
oTrustedMACList	src/conf.c	/^	oTrustedMACList,$/;"	e	enum:__anon10	file:
oWdctlSocket	src/conf.c	/^	oWdctlSocket,$/;"	e	enum:__anon10	file:
opcode	src/conf.c	/^	OpCodes opcode;$/;"	m	struct:__anon11	file:
parse_auth_server	src/conf.c	/^parse_auth_server(FILE *file, const char *filename, int *linenum)$/;"	f	file:
parse_boolean_value	src/conf.c	/^parse_boolean_value(char *line)$/;"	f	file:
parse_firewall_ruleset	src/conf.c	/^parse_firewall_ruleset(const char *ruleset, FILE *file, const char *filename, int *linenum)$/;"	f	file:
parse_trusted_mac_list	src/conf.c	/^void parse_trusted_mac_list(char *ptr) {$/;"	f
DEFAULT_AUTHSERVAUTHPATHFRAGMENT	src/conf.h	69;"	d
DEFAULT_AUTHSERVLOGINPATHFRAGMENT	src/conf.h	65;"	d
DEFAULT_AUTHSERVMSGPATHFRAGMENT	src/conf.h	67;"	d
DEFAULT_AUTHSERVPATH	src/conf.h	64;"	d
DEFAULT_AUTHSERVPINGPATHFRAGMENT	src/conf.h	68;"	d
DEFAULT_AUTHSERVPORT	src/conf.h	59;"	d
DEFAULT_AUTHSERVPORTALPATHFRAGMENT	src/conf.h	66;"	d
DEFAULT_AUTHSERVSSLAVAILABLE	src/conf.h	62;"	d
DEFAULT_AUTHSERVSSLPORT	src/conf.h	60;"	d
DEFAULT_CHECKINTERVAL	src/conf.h	54;"	d
DEFAULT_CLIENTTIMEOUT	src/conf.h	53;"	d
DEFAULT_CONFIGFILE	src/conf.h	41;"	d
DEFAULT_CONFIGFILE	src/conf.h	44;"	d
DEFAULT_DAEMON	src/conf.h	47;"	d
DEFAULT_DEBUGLEVEL	src/conf.h	48;"	d
DEFAULT_GATEWAYID	src/conf.h	50;"	d
DEFAULT_GATEWAYPORT	src/conf.h	51;"	d
DEFAULT_HTMLMSGFILE	src/conf.h	42;"	d
DEFAULT_HTMLMSGFILE	src/conf.h	45;"	d
DEFAULT_HTTPDMAXCONN	src/conf.h	49;"	d
DEFAULT_HTTPDNAME	src/conf.h	52;"	d
DEFAULT_INTERNAL_SOCK	src/conf.h	58;"	d
DEFAULT_LOG_SYSLOG	src/conf.h	55;"	d
DEFAULT_SYSLOG_FACILITY	src/conf.h	56;"	d
DEFAULT_WDCTL_SOCK	src/conf.h	57;"	d
EXT_INTERFACE_DETECT_RETRY_INTERVAL	src/conf.h	37;"	d
LOCK_CONFIG	src/conf.h	184;"	d
NUM_EXT_INTERFACE_DETECT_RETRY	src/conf.h	34;"	d
UNLOCK_CONFIG	src/conf.h	190;"	d
_CONFIG_H_	src/conf.h	28;"	d
_auth_serv_t	src/conf.h	/^typedef struct _auth_serv_t {$/;"	s
_firewall_rule_t	src/conf.h	/^typedef struct _firewall_rule_t {$/;"	s
_firewall_ruleset_t	src/conf.h	/^typedef struct _firewall_ruleset_t {$/;"	s
_trusted_mac_t	src/conf.h	/^typedef struct _trusted_mac_t {$/;"	s
auth_servers	src/conf.h	/^    t_auth_serv	*auth_servers;	\/**< @brief Auth servers list *\/$/;"	m	struct:__anon9
authserv_auth_script_path_fragment	src/conf.h	/^    char *authserv_auth_script_path_fragment;	\/**< @brief This is the script that talks the wifidog gateway protocol. *\/$/;"	m	struct:_auth_serv_t
authserv_hostname	src/conf.h	/^    char *authserv_hostname;	\/**< @brief Hostname of the central server *\/$/;"	m	struct:_auth_serv_t
authserv_http_port	src/conf.h	/^    int authserv_http_port;	\/**< @brief Http port the central server$/;"	m	struct:_auth_serv_t
authserv_login_script_path_fragment	src/conf.h	/^    char *authserv_login_script_path_fragment;	\/**< @brief This is the script the user will be sent to for login. *\/$/;"	m	struct:_auth_serv_t
authserv_msg_script_path_fragment	src/conf.h	/^    char *authserv_msg_script_path_fragment;	\/**< @brief This is the script the user will be sent to upon error to read a readable message. *\/$/;"	m	struct:_auth_serv_t
authserv_path	src/conf.h	/^    char *authserv_path;	\/**< @brief Path where wifidog resides *\/$/;"	m	struct:_auth_serv_t
authserv_ping_script_path_fragment	src/conf.h	/^    char *authserv_ping_script_path_fragment;	\/**< @brief This is the ping heartbeating script. *\/$/;"	m	struct:_auth_serv_t
authserv_portal_script_path_fragment	src/conf.h	/^    char *authserv_portal_script_path_fragment;	\/**< @brief This is the script the user will be sent to after a successfull login. *\/$/;"	m	struct:_auth_serv_t
authserv_ssl_port	src/conf.h	/^    int authserv_ssl_port;	\/**< @brief Https port the central server$/;"	m	struct:_auth_serv_t
authserv_use_ssl	src/conf.h	/^    int authserv_use_ssl;	\/**< @brief Use SSL or not *\/$/;"	m	struct:_auth_serv_t
block_allow	src/conf.h	/^    int block_allow;		\/**< @brief 1 = Allow rule, 0 = Block rule *\/$/;"	m	struct:_firewall_rule_t
checkinterval	src/conf.h	/^    int checkinterval;		\/**< @brief Frequency the the client timeout check$/;"	m	struct:__anon9
clienttimeout	src/conf.h	/^    int clienttimeout;		\/**< @brief How many CheckIntervals before a client$/;"	m	struct:__anon9
configfile	src/conf.h	/^    char configfile[255];	\/**< @brief name of the config file *\/$/;"	m	struct:__anon9
daemon	src/conf.h	/^    int daemon;			\/**< @brief if daemon > 0, use daemon mode *\/$/;"	m	struct:__anon9
debuglevel	src/conf.h	/^    int debuglevel;		\/**< @brief Debug information verbosity *\/$/;"	m	struct:__anon9
external_interface	src/conf.h	/^    char *external_interface;	\/**< @brief External network interface name for$/;"	m	struct:__anon9
gw_address	src/conf.h	/^    char *gw_address;		\/**< @brief Internal IP address for our web$/;"	m	struct:__anon9
gw_id	src/conf.h	/^    char *gw_id;		\/**< @brief ID of the Gateway, sent to central$/;"	m	struct:__anon9
gw_interface	src/conf.h	/^    char *gw_interface;		\/**< @brief Interface we will accept connections on *\/$/;"	m	struct:__anon9
gw_port	src/conf.h	/^    int gw_port;		\/**< @brief Port the webserver will run on *\/$/;"	m	struct:__anon9
htmlmsgfile	src/conf.h	/^    char *htmlmsgfile;		\/**< @brief name of the HTML file used for messages *\/$/;"	m	struct:__anon9
httpdmaxconn	src/conf.h	/^    int httpdmaxconn;		\/**< @brief Used by libhttpd, not sure what it$/;"	m	struct:__anon9
httpdname	src/conf.h	/^    char *httpdname;		\/**< @brief Name the web server will return when$/;"	m	struct:__anon9
httpdpassword	src/conf.h	/^    char *httpdpassword;	\/**< @brief Password for HTTP authentication *\/$/;"	m	struct:__anon9
httpdrealm	src/conf.h	/^    char *httpdrealm;		\/**< @brief HTTP Authentication realm *\/$/;"	m	struct:__anon9
httpdusername	src/conf.h	/^    char *httpdusername;	\/**< @brief Username for HTTP authentication *\/$/;"	m	struct:__anon9
internal_sock	src/conf.h	/^    char *internal_sock;		\/**< @brief internal path to socket *\/$/;"	m	struct:__anon9
last_ip	src/conf.h	/^    char *last_ip;	\/**< @brief Last ip used by authserver *\/$/;"	m	struct:_auth_serv_t
log_syslog	src/conf.h	/^    int log_syslog;		\/**< @brief boolean, wether to log to syslog *\/$/;"	m	struct:__anon9
mac	src/conf.h	/^    char   *mac;$/;"	m	struct:_trusted_mac_t
mask	src/conf.h	/^    char *mask;			\/**< @brief Mask for the rule *destination* *\/$/;"	m	struct:_firewall_rule_t
name	src/conf.h	/^    char			*name;$/;"	m	struct:_firewall_ruleset_t
next	src/conf.h	/^    struct _auth_serv_t *next;$/;"	m	struct:_auth_serv_t	typeref:struct:_auth_serv_t::_auth_serv_t
next	src/conf.h	/^    struct _firewall_rule_t *next;$/;"	m	struct:_firewall_rule_t	typeref:struct:_firewall_rule_t::_firewall_rule_t
next	src/conf.h	/^    struct _firewall_ruleset_t	*next;$/;"	m	struct:_firewall_ruleset_t	typeref:struct:_firewall_ruleset_t::_firewall_ruleset_t
next	src/conf.h	/^    struct _trusted_mac_t *next;$/;"	m	struct:_trusted_mac_t	typeref:struct:_trusted_mac_t::_trusted_mac_t
port	src/conf.h	/^    char *port;			\/**< @brief Port to block\/allow *\/$/;"	m	struct:_firewall_rule_t
protocol	src/conf.h	/^    char *protocol;		\/**< @brief tcp, udp, etc ... *\/$/;"	m	struct:_firewall_rule_t
rules	src/conf.h	/^    t_firewall_rule		*rules;$/;"	m	struct:_firewall_ruleset_t
rulesets	src/conf.h	/^    t_firewall_ruleset	*rulesets;	\/**< @brief firewall rules *\/$/;"	m	struct:__anon9
s_config	src/conf.h	/^} s_config;$/;"	t	typeref:struct:__anon9
syslog_facility	src/conf.h	/^    int syslog_facility;	\/**< @brief facility to use when using syslog for$/;"	m	struct:__anon9
t_auth_serv	src/conf.h	/^} t_auth_serv;$/;"	t	typeref:struct:_auth_serv_t
t_firewall_rule	src/conf.h	/^} t_firewall_rule;$/;"	t	typeref:struct:_firewall_rule_t
t_firewall_ruleset	src/conf.h	/^} t_firewall_ruleset;$/;"	t	typeref:struct:_firewall_ruleset_t
t_trusted_mac	src/conf.h	/^} t_trusted_mac;$/;"	t	typeref:struct:_trusted_mac_t
trustedmaclist	src/conf.h	/^    t_trusted_mac *trustedmaclist; \/**< @brief list of trusted macs *\/$/;"	m	struct:__anon9
wdctl_sock	src/conf.h	/^    char *wdctl_sock;		\/**< @brief wdctl path to socket *\/$/;"	m	struct:__anon9
_debug	src/debug.c	/^_debug(char *filename, int line, int level, char *format, ...)$/;"	f
_DEBUG_H_	src/debug.h	28;"	d
debug	src/debug.h	33;"	d
_GNU_SOURCE	src/firewall.c	31;"	d	file:
arp_get	src/firewall.c	/^arp_get(char *req_ip)$/;"	f
fw_allow	src/firewall.c	/^fw_allow(char *ip, char *mac, int fw_connection_state)$/;"	f
fw_clear_authservers	src/firewall.c	/^fw_clear_authservers(void)$/;"	f
fw_deny	src/firewall.c	/^fw_deny(char *ip, char *mac, int fw_connection_state)$/;"	f
fw_destroy	src/firewall.c	/^fw_destroy(void)$/;"	f
fw_init	src/firewall.c	/^fw_init(void)$/;"	f
fw_set_authservers	src/firewall.c	/^fw_set_authservers(void)$/;"	f
fw_sync_with_authserver	src/firewall.c	/^fw_sync_with_authserver(void)$/;"	f
icmp_ping	src/firewall.c	/^icmp_ping(char *host)$/;"	f
rand16	src/firewall.c	/^unsigned short rand16(void) {$/;"	f
FW_MARK_KNOWN	src/firewall.h	/^    FW_MARK_KNOWN = 2,  \/**< @brief The client is known to the firewall *\/ $/;"	e	enum:_t_fw_marks
FW_MARK_LOCKED	src/firewall.h	/^    FW_MARK_LOCKED = 254 \/**< @brief The client has been locked out *\/$/;"	e	enum:_t_fw_marks
FW_MARK_PROBATION	src/firewall.h	/^    FW_MARK_PROBATION = 1, \/**< @brief The client is in probation period and must be authenticated $/;"	e	enum:_t_fw_marks
_FIREWALL_H_	src/firewall.h	28;"	d
_t_fw_marks	src/firewall.h	/^typedef enum _t_fw_marks {$/;"	g
icmp_fd	src/firewall.h	/^int icmp_fd;$/;"	v
t_fw_marks	src/firewall.h	/^} t_fw_marks;$/;"	t	typeref:enum:_t_fw_marks
_GNU_SOURCE	src/fw_iptables.c	28;"	d	file:
fw_quiet	src/fw_iptables.c	/^static int fw_quiet = 0;$/;"	v	file:
iptables_compile	src/fw_iptables.c	/^iptables_compile(const char * table, const char *chain, const t_firewall_rule *rule)$/;"	f	file:
iptables_do_command	src/fw_iptables.c	/^iptables_do_command(const char *format, ...)$/;"	f	file:
iptables_fw_access	src/fw_iptables.c	/^iptables_fw_access(fw_access_t type, const char *ip, const char *mac, int tag)$/;"	f
iptables_fw_clear_authservers	src/fw_iptables.c	/^iptables_fw_clear_authservers(void)$/;"	f
iptables_fw_counters_update	src/fw_iptables.c	/^iptables_fw_counters_update(void)$/;"	f
iptables_fw_destroy	src/fw_iptables.c	/^iptables_fw_destroy(void)$/;"	f
iptables_fw_destroy_mention	src/fw_iptables.c	/^iptables_fw_destroy_mention($/;"	f
iptables_fw_init	src/fw_iptables.c	/^iptables_fw_init(void)$/;"	f
iptables_fw_set_authservers	src/fw_iptables.c	/^iptables_fw_set_authservers(void)$/;"	f
iptables_insert_gateway_id	src/fw_iptables.c	/^iptables_insert_gateway_id(char **input)$/;"	f	file:
iptables_load_ruleset	src/fw_iptables.c	/^iptables_load_ruleset(const char * table, const char *ruleset, const char *chain)$/;"	f	file:
FW_ACCESS_ALLOW	src/fw_iptables.h	/^    FW_ACCESS_ALLOW,$/;"	e	enum:fw_access_t_
FW_ACCESS_DENY	src/fw_iptables.h	/^    FW_ACCESS_DENY$/;"	e	enum:fw_access_t_
TABLE_WIFIDOG_AUTHSERVERS	src/fw_iptables.h	38;"	d
TABLE_WIFIDOG_GLOBAL	src/fw_iptables.h	39;"	d
TABLE_WIFIDOG_INCOMING	src/fw_iptables.h	37;"	d
TABLE_WIFIDOG_KNOWN	src/fw_iptables.h	41;"	d
TABLE_WIFIDOG_LOCKED	src/fw_iptables.h	43;"	d
TABLE_WIFIDOG_OUTGOING	src/fw_iptables.h	34;"	d
TABLE_WIFIDOG_TRUSTED	src/fw_iptables.h	44;"	d
TABLE_WIFIDOG_UNKNOWN	src/fw_iptables.h	42;"	d
TABLE_WIFIDOG_VALIDATE	src/fw_iptables.h	40;"	d
TABLE_WIFIDOG_WIFI_TO_INTERNET	src/fw_iptables.h	35;"	d
TABLE_WIFIDOG_WIFI_TO_ROUTER	src/fw_iptables.h	36;"	d
_FW_IPTABLES_H_	src/fw_iptables.h	28;"	d
fw_access_t	src/fw_iptables.h	/^} fw_access_t;$/;"	t	typeref:enum:fw_access_t_
fw_access_t_	src/fw_iptables.h	/^typedef enum fw_access_t_ {$/;"	g
append_x_restartargv	src/gateway.c	/^void append_x_restartargv(void) {$/;"	f
firstclient	src/gateway.c	/^t_client *firstclient;$/;"	v
get_clients_from_parent	src/gateway.c	/^void get_clients_from_parent(void) {$/;"	f
init_signals	src/gateway.c	/^init_signals(void)$/;"	f	file:
main	src/gateway.c	/^int main(int argc, char **argv) {$/;"	f
main_loop	src/gateway.c	/^main_loop(void)$/;"	f	file:
sigchld_handler	src/gateway.c	/^sigchld_handler(int s)$/;"	f
started_time	src/gateway.c	/^time_t started_time = 0;$/;"	v
termination_handler	src/gateway.c	/^termination_handler(int s)$/;"	f
tid_fw_counter	src/gateway.c	/^static pthread_t tid_fw_counter = 0;$/;"	v	file:
tid_ping	src/gateway.c	/^static pthread_t tid_ping = 0; $/;"	v	file:
webserver	src/gateway.c	/^httpd * webserver = NULL;$/;"	v
_GATEWAY_H_	src/gateway.h	28;"	d
_GNU_SOURCE	src/http.c	30;"	d	file:
http_callback_404	src/http.c	/^http_callback_404(httpd *webserver, request *r)$/;"	f
http_callback_about	src/http.c	/^http_callback_about(httpd *webserver, request *r)$/;"	f
http_callback_auth	src/http.c	/^http_callback_auth(httpd *webserver, request *r)$/;"	f
http_callback_status	src/http.c	/^http_callback_status(httpd *webserver, request *r)$/;"	f
http_callback_wifidog	src/http.c	/^http_callback_wifidog(httpd *webserver, request *r)$/;"	f
http_send_redirect	src/http.c	/^void http_send_redirect(request *r, char *url, char *text)$/;"	f
http_send_redirect_to_auth	src/http.c	/^void http_send_redirect_to_auth(request *r, char *urlFragment, char *text)$/;"	f
send_http_page	src/http.c	/^void send_http_page(request *r, const char *title, const char* message)$/;"	f
_HTTP_H_	src/http.h	28;"	d
_GNU_SOURCE	src/httpd_thread.c	28;"	d	file:
thread_httpd	src/httpd_thread.c	/^thread_httpd(void *args)$/;"	f
_HTTPD_THREAD_H_	src/httpd_thread.h	28;"	d
_GNU_SOURCE	src/ping_thread.c	29;"	d	file:
ping	src/ping_thread.c	/^ping(void)$/;"	f	file:
thread_ping	src/ping_thread.c	/^thread_ping(void *arg)$/;"	f
MINIMUM_STARTED_TIME	src/ping_thread.h	30;"	d
_PING_THREAD_H_	src/ping_thread.h	28;"	d
safe_asprintf	src/safe.c	/^int safe_asprintf(char **strp, const char *fmt, ...) {$/;"	f
safe_fork	src/safe.c	/^pid_t safe_fork(void) {$/;"	f
safe_malloc	src/safe.c	/^void * safe_malloc (size_t size) {$/;"	f
safe_strdup	src/safe.c	/^char * safe_strdup(const char *s) {$/;"	f
safe_vasprintf	src/safe.c	/^int safe_vasprintf(char **strp, const char *fmt, va_list ap) {$/;"	f
_SAFE_H_	src/safe.h	28;"	d
_GNU_SOURCE	src/util.c	31;"	d	file:
execute	src/util.c	/^execute(char *cmd_line, int quiet)$/;"	f
get_ext_iface	src/util.c	/^get_ext_iface(void)$/;"	f
get_iface_ip	src/util.c	/^get_iface_ip(const char *ifname)$/;"	f
get_iface_mac	src/util.c	/^get_iface_mac(const char *ifname)$/;"	f
get_status_text	src/util.c	/^	char * get_status_text() {$/;"	f
ghbn_mutex	src/util.c	/^static pthread_mutex_t ghbn_mutex = PTHREAD_MUTEX_INITIALIZER;$/;"	v	file:
is_auth_online	src/util.c	/^	int is_auth_online() {$/;"	f
is_online	src/util.c	/^	int is_online() {$/;"	f
last_auth_offline_time	src/util.c	/^static time_t last_auth_offline_time = 0;$/;"	v	file:
last_auth_online_time	src/util.c	/^static time_t last_auth_online_time = 0;$/;"	v	file:
last_offline_time	src/util.c	/^static time_t last_offline_time = 0;$/;"	v	file:
last_online_time	src/util.c	/^static time_t last_online_time = 0;$/;"	v	file:
mark_auth_offline	src/util.c	/^	void mark_auth_offline() {$/;"	f
mark_auth_online	src/util.c	/^	void mark_auth_online() {$/;"	f
mark_offline	src/util.c	/^	void mark_offline() {$/;"	f
mark_online	src/util.c	/^	void mark_online() {$/;"	f
served_this_session	src/util.c	/^long served_this_session = 0;$/;"	v
wd_gethostbyname	src/util.c	/^wd_gethostbyname(const char *name)$/;"	f
LOCK_GHBN	src/util.h	65;"	d
STATUS_BUF_SIZ	src/util.h	30;"	d
UNLOCK_GHBN	src/util.h	71;"	d
_UTIL_H_	src/util.h	28;"	d
_GNU_SOURCE	src/wdctl.c	27;"	d	file:
config	src/wdctl.c	/^s_config config;$/;"	v
connect_to_server	src/wdctl.c	/^connect_to_server(char *sock_name)$/;"	f	file:
init_config	src/wdctl.c	/^init_config(void)$/;"	f	file:
main	src/wdctl.c	/^main(int argc, char **argv)$/;"	f
parse_commandline	src/wdctl.c	/^parse_commandline(int argc, char **argv)$/;"	f
send_request	src/wdctl.c	/^send_request(int sock, char *request)$/;"	f	file:
usage	src/wdctl.c	/^usage(void)$/;"	f	file:
wdctl_reset	src/wdctl.c	/^wdctl_reset(void)$/;"	f
wdctl_restart	src/wdctl.c	/^wdctl_restart(void)$/;"	f	file:
wdctl_status	src/wdctl.c	/^wdctl_status(void)$/;"	f	file:
wdctl_stop	src/wdctl.c	/^wdctl_stop(void)$/;"	f	file:
DEFAULT_SOCK	src/wdctl.h	30;"	d
WDCTL_KILL	src/wdctl.h	35;"	d
WDCTL_RESTART	src/wdctl.h	36;"	d
WDCTL_STATUS	src/wdctl.h	33;"	d
WDCTL_STOP	src/wdctl.h	34;"	d
WDCTL_UNDEF	src/wdctl.h	32;"	d
_WDCTL_H_	src/wdctl.h	28;"	d
command	src/wdctl.h	/^	int	command;$/;"	m	struct:__anon12
param	src/wdctl.h	/^	char	*param;$/;"	m	struct:__anon12
s_config	src/wdctl.h	/^} s_config;$/;"	t	typeref:struct:__anon12
socket	src/wdctl.h	/^	char	*socket;$/;"	m	struct:__anon12
_GNU_SOURCE	src/wdctl_thread.c	27;"	d	file:
thread_wdctl	src/wdctl_thread.c	/^thread_wdctl(void *arg)$/;"	f
thread_wdctl_handler	src/wdctl_thread.c	/^thread_wdctl_handler(void *arg)$/;"	f	file:
wdctl_reset	src/wdctl_thread.c	/^wdctl_reset(int fd, char *arg)$/;"	f	file:
wdctl_restart	src/wdctl_thread.c	/^wdctl_restart(int afd)$/;"	f	file:
wdctl_status	src/wdctl_thread.c	/^wdctl_status(int fd)$/;"	f	file:
wdctl_stop	src/wdctl_thread.c	/^wdctl_stop(int fd)$/;"	f	file:
DEFAULT_WDCTL_SOCK	src/wdctl_thread.h	30;"	d
_WDCTL_THREAD_H_	src/wdctl_thread.h	28;"	d
wdctl_socket_server	src/wdctl_thread.h	/^int wdctl_socket_server;$/;"	v
